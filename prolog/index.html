<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Prolog</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#use-cases">Use Cases</a></li><li><a href="#learning-curve">Learning Curve</a></li><li><a href="#resources">Resources</a></li><li><a href="#implementations">Implementations</a><ol><li><a href="#swi-prolog">SWI-Prolog</a><ol><li><a href="#packs">Packs</a></li><li><a href="#debugging">Debugging</a></li><li><a href="#executables">Executables</a></li></ol></li><li><a href="#gnu-prolog">GNU Prolog</a></li><li><a href="#scryer-prolog">Scryer Prolog</a></li><li><a href="#ciao-prolog">Ciao Prolog</a></li><li><a href="#other-implementations">Other Implementations</a></li></ol></li><li><a href="#online-top-level">Online Top Level</a></li><li><a href="#exiting">Exiting</a></li><li><a href="#terminology">Terminology</a></li><li><a href="#syntax">Syntax</a><ol><li><a href="#facts">Facts</a></li><li><a href="#rules">Rules</a></li></ol></li><li><a href="#queries">Queries</a><ol><li><a href="#conjunctions">Conjunctions</a></li><li><a href="#disjunctions">Disjunctions</a></li></ol></li><li><a href="#typical-flow">Typical Flow</a></li><li><a href="#tree-representation">Tree Representation</a></li><li><a href="#data-structures">Data Structures</a><ol><li><a href="#structures">Structures</a></li><li><a href="#lists">Lists</a><ol><li><a href="#appending">Appending</a></li></ol></li><li><a href="#pairs">Pairs</a></li><li><a href="#dicts">Dicts</a></li></ol></li><li><a href="#type-checking">Type Checking</a></li><li><a href="#dynamic-predicates">Dynamic Predicates</a></li><li><a href="#runtime-predicates">Runtime Predicates</a></li><li><a href="#input">Input</a></li><li><a href="#output">Output</a></li><li><a href="#special-characters">Special Characters</a></li><li><a href="#naming-conventions">Naming Conventions</a></li><li><a href="#operators">Operators</a><ol><li><a href="#custom-operators">Custom Operators</a></li></ol></li><li><a href="#strings">Strings</a></li><li><a href="#arithmetic-functions">Arithmetic Functions</a></li><li><a href="#conditional-logic">Conditional Logic</a></li><li><a href="#iteration">Iteration</a></li><li><a href="#help">Help</a></li><li><a href="#listing">Listing</a></li><li><a href="#debugging-1">Debugging</a></li><li><a href="#calling-from-other-languages">Calling From Other Languages</a></li><li><a href="#efficiency">Efficiency</a></li><li><a href="#constraint-logic-programming-over-finite-domains%3A-clp(fd)">Constraint Logic Programming over Finite Domains: CLP(FD)</a></li><li><a href="#unit-tests">Unit Tests</a></li><li><a href="#sudoku">Sudoku</a></li><li><a href="#einstein's-riddle">Einstein's Riddle</a></li><li><a href="#reading-from-urls">Reading from URLs</a></li><li><a href="#definite-clause-grammars-(dcgs)">Definite Clause Grammars (DCGs)</a></li><li><a href="#language-server">Language Server</a></li><li><a href="#miscellaneous-topics">Miscellaneous Topics</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p>Prolog is a logic-based programming language. The name is a contraction of &quot;programming in logic&quot;.</p><p>Prolog first appeared in 1972. It was designed by three computer scientists, Alain Colmerauer (France), Phillipe Roussel (France), and Robert Kowalski (USA/Britain).</p><p>Prolog uses a declarative syntax rather than a procedural one. Instead of writing code that describes &quot;what&quot; to do, the code describes relationships between data values.</p><p>Nearly all Prolog code has one of these four purposes:</p><ol><li><p>Describe a relationship that is always true (aka holds) ... a fact.</p><p>For example:</p></li></ol><pre class="language-prolog"><code class="language-prolog"><span class="token function">father</span><span class="token punctuation">(</span>richard<span class="token punctuation">,</span> mark<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">father</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> amanda<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">father</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> jeremy<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><ol><li><p>Describe a relationship that is conditionally true ... a rule.</p><p>For example, the following rule states that <code>G</code> is a grandfather of <code>C</code> if <code>G</code> is the father of <code>P</code> AND <code>P</code> is either the father or mother of <code>C</code>:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">grandfather</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> C<span class="token punctuation">)</span> <span class="token operator">:=</span><br>  <span class="token function">father</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> P<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token punctuation">(</span><span class="token function">father</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> C<span class="token punctuation">)</span><span class="token operator">;</span> <span class="token function">mother</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> C<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span></code></pre></li><li><p>Ask whether a specific relationship is true ... a query with no variables.</p><p>For example, <code>?- grandfather(richard, amanda).</code> outputs <code>true</code>.</p></li><li><p>Ask for values for which a relationship is true ... a query with variables.</p><p>For example, <code>?- grandfather(G, amanda).</code> sets <code>G</code> to <code>richard</code> Sometimes there are multiple values for which a query holds. For example, the query <code>?- grandfather(richard, G).</code> sets <code>G</code> to <code>amanda</code> and then <code>jeremy</code>. Note how a rule can be used to find values for any of its arguments, searching in multiple directions.</p></li></ol><p>Queries perform &quot;unification&quot; which basically means finding values for variables that cause a relationship to hold. This requires pattern matching search and backtracking. Unification relies on the properties of <a href="https://en.wikipedia.org/wiki/Horn_clause?v=1.0.21" rel="noopener" target="_blank">Horn clauses</a>. A related term is &quot;ground&quot; which refers to an expression that contains no uninstantiated variables.</p><p>The set of facts and rules supplied to the Prolog engine is called a database. Prolog is highly optimized to handle searching large databases.</p><p>Prolog is a homoiconic language, which means its code can be treated as data.</p><p>Prolog has many uses including artificial intelligence, abstract problem solving, symbolic equation solving, and more.</p><p>&quot;IBM Watson is a question-answering computer system capable of answering questions posed in natural language.&quot; It is partially implemented in Prolog.</p><h2 id="use-cases" tabindex="-1">Use Cases</h2><p>Prolog is used in many kinds of applications including:</p><ul><li><p>problem solving</p></li><li><p>specification language</p><p>For example, the Java Virtual Machine (JVM) specification uses Prolog.</p></li><li><p>rule-based systems</p></li><li><p>automation systems</p></li><li><p>robot planning</p></li><li><p>natural language understanding</p></li><li><p>intelligent database retrieval</p></li></ul><h2 id="learning-curve" tabindex="-1">Learning Curve</h2><p>The primary concepts in Prolog such as facts, rules, and queries are easy to understand after seeing a few examples.</p><p>However, writing programs that are entirely based on relationships rather than imperative code makes Prolog very different from other programming languages. This makes learning Prolog somewhat challenging initially. For example, to write a program that compiles some source code into its target representation, define the relationship that describes when source code is related to the target representation.</p><p>Prolog supports a large number of operators and built-in predicates. These take considerable time to learn and master.</p><h2 id="resources" tabindex="-1">Resources</h2><ul><li><p><a href="https://www.youtube.com/watch?v=dKn-BbS_zQQ?v=1.0.21" rel="noopener" target="_blank">A Brief Introduction to Prolog</a> YouTube video by Erik Schierboom</p></li><li><p><a href="https://www.covingtoninnovations.com/mc/plcoding.pdf?v=1.0.21" rel="noopener" target="_blank">Coding guidelines for Prolog</a></p></li><li><p><a href="http://www.gprolog.org?v=1.0.21" rel="noopener" target="_blank">GNU Prolog</a></p></li><li><p><a href="https://www.iso.org/standard/21413.html?v=1.0.21" rel="noopener" target="_blank">ISO Standard for Prolog</a></p></li><li><p><a href="http://lpn.swi-prolog.org/lpnpage.php?pageid=online?v=1.0.21" rel="noopener" target="_blank">Learn Prolog Now!</a></p></li><li><p><a href="https://www.metalevel.at/prolog?v=1.0.21" rel="noopener" target="_blank">The Power of Prolog</a> free, online book with accompanying videos by <a href="https://www.metalevel.at?v=1.0.21" rel="noopener" target="_blank">Markus Triska</a> from the University of Technology in Austria</p></li><li><p><a href="https://link.springer.com/book/10.1007/978-3-642-55481-0?v=1.0.21" rel="noopener" target="_blank">Programming in Prolog</a> Fifth edition book by Clocksin and Mellish</p></li><li><p><a href="https://www.swi-prolog.org?v=1.0.21" rel="noopener" target="_blank">SWI-Prolog</a></p></li><li><p><a href="https://www.linuxlinks.com/excellent-free-books-learn-prolog/?v=1.0.21" rel="noopener" target="_blank">13 Excellent Free Books to Learn Prolog</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Prolog?v=1.0.21" rel="noopener" target="_blank">Wikipedia</a></p></li></ul><h2 id="implementations" tabindex="-1">Implementations</h2><p>There are many implementations of the Prolog programming language. The most popular are described below.</p><p>Many Prolog implementations conform to the <a href="https://www.iso.org/standard/21413.html?v=1.0.21" rel="noopener" target="_blank">ISO Standard for Prolog</a>. This defines the minimum requirements for conforming implementations. Many implementations add features beyond the ISO standard.</p><p>The ISO standard does not require implementations to provide a top level or REPL, but most do. A top level supports interactive entry and evaluation of Prolog queries. The output is a new query, often containing semicolons, that describes the possible solutions. Some top level implementations also supports interactive debugging.</p><p>Several Prolog implementations compile source code to abstract machine code for the Warren Abstract Machine (WAM). Searches in WAM use an efficient hash-based approach.</p><h3 id="swi-prolog" tabindex="-1">SWI-Prolog</h3><p><img alt="SWI-Prolog logo" style="width: 20%" src="/blog/assets/swipl-logo.png?v=1.0.21" title="SWI-Prolog logo"></p><blockquote><p>SWI-Prolog offers a comprehensive free Prolog environment. Since its start in 1987, SWI-Prolog development has been driven by the needs of real world applications. SWI-Prolog is widely used in research and education as well as commercial applications.&quot;</p></blockquote><blockquote><p>Its main author is Jan Wielemaker. The name SWI is derived from Sociaal-Wetenschappelijke Informatica (&quot;Social Science Informatics&quot;), the former name of the group at the University of Amsterdam, where Wielemaker is employed.</p></blockquote><p><a href="https://www.swi-prolog.org?v=1.0.21" rel="noopener" target="_blank">SWI-Prolog</a>. is implemented in a combination of C (48%) and Prolog (39%).</p><p>To install the terminal command <code>swipl</code> in macOS, enter <code>brew install swi-prolog</code></p><p>To start a SWI-Prolog top level from a terminal, enter <code>swipl</code>.</p><p>To specify configuration for all top level sessions, create the file <code>$HOME/.config/swi-prolog/init.pl</code>. For example, this file might contain the following:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">set_prolog_flag</span><span class="token punctuation">(</span>double_quotes<span class="token punctuation">,</span> chars<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><h4 id="packs" tabindex="-1">Packs</h4><p>Packs are add-on libraries.</p><p>To see a list of known packages, browse <a href="https://www.swi-prolog.org/pack/list?p$=$plml?v=1.0.21" rel="noopener" target="_blank">Packs (add-ons) for SWI-Prolog</a>. Alternatively, enter <code>pack_list(substring)</code> where substring is part of one or more pack names.</p><p>To install a pack, enter <code>pack_install(name)</code>. This will download the code from <code>https://www.swi-prolog.org/pack/query</code> and install it.</p><p>The &quot;reif&quot; pack (reified if) implements the <code>if_</code> predicate which is similar to the <code>-&gt;</code> operator, but has some advantages. I could not find good examples of using and could not get it to work.</p><h4 id="debugging" tabindex="-1">Debugging</h4><p>For information on using the debugger in SWI-Prolog, see <a href="https://www.swi-prolog.org/pldoc/man?section=debugoverview?v=1.0.21" rel="noopener" target="_blank">Overview of the Debugger</a>.</p><p>The <code>trace</code> predicate enables tracing of the search to find a query solution.</p><p>The following code defines fact about my family and a rule about grandfathers.</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">female</span><span class="token punctuation">(</span>amanda<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">female</span><span class="token punctuation">(</span>judi<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">female</span><span class="token punctuation">(</span>tami<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">male</span><span class="token punctuation">(</span>jeremy<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">male</span><span class="token punctuation">(</span>mark<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">male</span><span class="token punctuation">(</span>richard<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">father</span><span class="token punctuation">(</span>richard<span class="token punctuation">,</span> mark<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">father</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> amanda<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">father</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> jeremy<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">mother</span><span class="token punctuation">(</span>judi<span class="token punctuation">,</span> mark<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">mother</span><span class="token punctuation">(</span>tami<span class="token punctuation">,</span> amanda<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">mother</span><span class="token punctuation">(</span>tami<span class="token punctuation">,</span> jeremy<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">grandfather_of</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">father</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> P<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token punctuation">(</span><span class="token function">father</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token operator">;</span> <span class="token function">mother</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>To trace the execution of the query <code>grandfather_of(richard, X).</code>, enter <code>trace.</code> and then the query. The screenshot below shows the output. After each line in the trace, press the spacebar to advance to the next term to be evaluated. After a solution is found, press the semicolon key to begin searching for the next solution.</p><p><img alt="SWI-Prolog trace" style="width: 60%" src="/blog/assets/swi-prolog-trace.png?v=1.0.21" title="SWI-Prolog trace"></p><p>The <code>trace</code> predicate enables both the trace and debug modes. To disable these, enter <code>notrace.</code> and <code>nodebug.</code></p><h4 id="executables" tabindex="-1">Executables</h4><p>In SWI-Prolog, to compile a Prolog source file to an executable, enter <code>swipl -o {exe-name} -c {source-name}.pl</code>. For example, <code>swipl -o sukuko -c suduko.pl</code>. Running this executable with <code>./suduko</code> starts a top level session and loads the compiled facts and rules.</p><h3 id="gnu-prolog" tabindex="-1">GNU Prolog</h3><p><img alt="GNU Prolog logo" style="width: 20%" src="/blog/assets/gnu-prolog-logo.png?v=1.0.21" title="GNU Prolog logo"></p><p><a href="http://www.gprolog.org?v=1.0.21" rel="noopener" target="_blank">GNU Prolog</a>. is implemented in a combination of C (84%) and Prolog (15%).</p><p>To install the terminal command <code>gprolog</code> in macOS, enter <code>brew install gnu-prolog</code>.</p><p>To start a GNU Prolog top level from a terminal, enter <code>gprolog</code>.</p><h3 id="scryer-prolog" tabindex="-1">Scryer Prolog</h3><p><img alt="Scryer Prolog logo" style="width: 20%" src="/blog/assets/scryer-prolog-logo.png?v=1.0.21" title="Scryer Prolog logo"></p><p><a href="https://www.scryer.pl?v=1.0.21" rel="noopener" target="_blank">Scryer Prolog</a> &quot;is a free software ISO Prolog system intended to be an industrial strength production environment and a testbed for bleeding edge research in logic and constraint programming.&quot;</p><p>Scryer Prolog is implemented in a combination of Rust (64%) and Prolog (36%).</p><p>To install, enter the following commands:</p><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/mthom/scryer-prolog<br><span class="token builtin class-name">cd</span> scryer-prolog<br><span class="token function">curl</span> https://sh.rustup.rs <span class="token parameter variable">-sSf</span> <span class="token operator">|</span> <span class="token function">sh</span> <span class="token comment"># if cargo is not yet installed</span><br><span class="token function">cargo</span> build <span class="token parameter variable">--release</span></code></pre><p>This creates the executable file <code>target/release/scryer-prolog</code>. Define an alias like <code>scryerp</code> to make this easier to run.</p><p>To start a Scryer Prolog top level from a terminal, enter <code>scryerp</code>.</p><p>To specify configuration for all top level sessions, create the file <code>$HOME/.scryerrc</code>.</p><h3 id="ciao-prolog" tabindex="-1">Ciao Prolog</h3><p><a href="https://ciao-lang.org?v=1.0.21" rel="noopener" target="_blank">Ciao</a> &quot;is a modern Prolog implementation that builds up from a logic-based simple kernel designed to be portable, extensible, and modular.&quot;</p><p>Ciao is implemented in Prolog (72%) and C (23%)</p><p>To install:</p><ol><li><p>Install emacs. In macOS, this can be done by entering <code>brew install emacs</code></p></li><li><p>Enter <code>curl https://ciao-lang.org/boot -sSfL | sh</code></p></li><li><p>Create an alias to the executable. For example:</p><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">alias</span> <span class="token assign-left variable">ciao</span><span class="token operator">=</span><span class="token string">"<span class="token environment constant">$HOME</span>/.ciaoroot/v1.22.0-m5/build/bin/ciao"</span></code></pre></li></ol><p>To start a Ciao top level from a terminal, enter <code>ciao</code>.</p><h3 id="other-implementations" tabindex="-1">Other Implementations</h3><ul><li><a href="http://tau-prolog.org?v=1.0.21" rel="noopener" target="_blank">Tau</a> implemented in JavaScript (95%) and Prolog (5%)</li><li><a href="https://github.com/trealla-prolog/trealla?v=1.0.21" rel="noopener" target="_blank">Trealla</a> implemented in C (82%) and Prolog (18%)</li></ul><h2 id="online-top-level" tabindex="-1">Online Top Level</h2><p>To enter and run Prolog code in a web browser, browse <a href="https://swish.swi-prolog.org?v=1.0.21" rel="noopener" target="_blank">SWISH</a>.</p><p>Enter facts and rules in the left pane. Enter a query in the lower-right pane. Press the &quot;Run!&quot; button or ctrl-return to execute the query.</p><h2 id="exiting" tabindex="-1">Exiting</h2><p>To exit from any Prolog interpreter, enter <code>halt.</code> or press ctrl-d.</p><h2 id="terminology" tabindex="-1">Terminology</h2><table><thead><tr><th>Term</th><th>Meaning</th></tr></thead><tbody><tr><td>term</td><td>the only datatype; has four subtypes listed below</td></tr><tr><td>- number</td><td>integer or floating point</td></tr><tr><td>- atom</td><td>identifier that represents a specific thing</td></tr><tr><td>- variable</td><td>represents a value to be determined</td></tr><tr><td>- compound term</td><td>specific combination of terms; more detail below</td></tr><tr><td>structure</td><td>another name for a compound term</td></tr><tr><td>fact</td><td>description of something that is true</td></tr><tr><td>rule</td><td>relationship involving one or more unknown things (variables)</td></tr><tr><td>predicate</td><td>collection of clauses with the same functor</td></tr><tr><td>clause</td><td>a fact or rule</td></tr><tr><td>query</td><td>asks if a term is true or asks for satisfying variable values</td></tr><tr><td>database</td><td>collection of predicates</td></tr><tr><td>functor name</td><td>name of a predicate</td></tr><tr><td>arity</td><td>number of predicate arguments</td></tr><tr><td>functor</td><td>function name and its arity; written with a slash between</td></tr><tr><td>goal</td><td>rule body expression to be satisfied</td></tr><tr><td>list notation</td><td>comma-separated terms inside square brackets; ex. <code>[a, B, 7]</code></td></tr><tr><td>operator notation</td><td>terms separated by operators; ex. <code>Y = m*X + b</code></td></tr><tr><td>function notation</td><td>operators are written as function calls; ex. <code>*(3, +(1, 2))</code></td></tr><tr><td>unification</td><td>process of searching for variable values that satisfy a goal</td></tr><tr><td>choice point</td><td>represents a choice in the search for a solution</td></tr><tr><td>conjunction</td><td>and'ing terms with comma operator</td></tr><tr><td>disjunction</td><td>or'ing terms with semicolon operator</td></tr></tbody></table><p>A string is treated as a list of atoms where each atom represents a character. This makes it a compound term.</p><p>Every compound term can be written as a functor name followed by an argument list. Each argument can be an atom, a variable, or another compound term. All compound terms, including nested ones, can be represented by a tree structure.</p><p>A rule can be thought of as a special kind of fact that depends on a set of other facts</p><p>Numbers can include underscores for readability. For example, <code>1_234_567</code> makes it more clear that this number is greater than one million.</p><p>The functor for <code>foo(bar, baz)</code> is written as <code>foo/2</code>.</p><p>For more, see <a href="https://swi-prolog.org/pldoc/man?section=glossary" target="_blank">Glossary of Terms</a>.</p><h2 id="syntax" tabindex="-1">Syntax</h2><p>Prolog programs are composed of facts, rules, and queries. All of these are terminated by a period.</p><h3 id="facts" tabindex="-1">Facts</h3><p>A fact states that some relationship is always true.</p><p>A fact is written as a functor (atom) followed by an argument list that is surrounded by parentheses. The argument list contains only atoms, not variables.</p><p>For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">runner</span><span class="token punctuation">(</span>mark<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% says mark is a runner</span><br><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> prolog<span class="token punctuation">)</span> <span class="token comment">% says mark likes prolog</span></code></pre><p>These are facts that say comet is a whippet and spots is a cheetah:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">whippet</span><span class="token punctuation">(</span>comet<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">cheetah</span><span class="token punctuation">(</span>spots<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><h3 id="rules" tabindex="-1">Rules</h3><p>Rules are written as a head and a body separated by the &quot;if&quot; operator <code>:-</code> and terminated by a period. They states that the head holds if all the goals in the body hold. Rules do not return a value like functions in other programming languages.</p><p>The head is a functor name followed by an argument list that is surrounded by parentheses. The head syntax is similar to that of a fact, but its argument list can contain variables.</p><p>The body is a comma (means &quot;and&quot;) or semicolon (means &quot;or&quot;) separated list of goals. Typically each goal is written on a separated line and indented, but this is not required.</p><p>The following rules state that something is fast if it is a cheetah or a whippet.</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">fast</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">cheetah</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">fast</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">whippet</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% The previous two lines can be replaced with the following</span><br><span class="token comment">% where the `;` operator or's its left and right values.</span><br><span class="token comment">% fast(X) :- cheetah(X); whippet(X).</span></code></pre><p>A fact is a degenerate case of a rule whose body only contains <code>true</code>. For example, the following are equivalent:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> ice<span class="token operator">-</span>cream<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> ice<span class="token operator">-</span>cream<span class="token punctuation">)</span> <span class="token operator">:-</span> true<span class="token operator">.</span></code></pre><p>The following rules define what it means for two people to be siblings or sisters.</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% This rule states that siblings must have the same father and the same mother.</span><br><span class="token comment">% It has four goals.</span><br><span class="token function">sibling</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">father</span><span class="token punctuation">(</span>F<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">father</span><span class="token punctuation">(</span>F<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">mother</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">mother</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">sister_of</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token operator">\+</span> X <span class="token operator">=</span> Y<span class="token punctuation">,</span> <span class="token comment">% can't be sister of self</span><br>  <span class="token function">female</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">sibling</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>Often functor names describe the arguments whose relationship is being described, separated by underscores. For example, the rule head <code>parent_child(P, C)</code> makes it clear that the first argument represents a parent and the second argument represents a child. Some might also use the functor name <code>parent_of</code> or simply <code>parent</code>.</p><p>Good functor names are general and describe relationships without implying a direction. Bad function names do neither. For example, functor names containing words like &quot;count&quot;, &quot;drop&quot;, or &quot;find&quot; imply that the clause is meant to be used in a specific direction.</p><p>The <code>is</code> operator evaluates its right-hand side as an arithmetic expression and assign the result to its left-hand side. It should only be used when the right-hand side is an arithmetic expression. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">area</span><span class="token punctuation">(</span>circle<span class="token punctuation">,</span> Radius<span class="token punctuation">,</span> X<span class="token punctuation">)</span> <span class="token operator">:-</span> X <span class="token operator">is</span> pi <span class="token operator">*</span> Radius<span class="token operator">^</span><span class="token number">2.</span><br><span class="token function">area</span><span class="token punctuation">(</span>square<span class="token punctuation">,</span> Side<span class="token punctuation">,</span> X<span class="token punctuation">)</span> <span class="token operator">:-</span> X <span class="token operator">is</span> Side<span class="token operator">^</span><span class="token number">2.</span><br><span class="token function">area</span><span class="token punctuation">(</span>rectangle<span class="token punctuation">,</span> Width<span class="token punctuation">,</span> Height<span class="token punctuation">,</span> X<span class="token punctuation">)</span> <span class="token operator">:-</span> X <span class="token operator">is</span> Width <span class="token operator">*</span> Height<span class="token operator">.</span><br><br><span class="token operator">?-</span> <span class="token function">area</span><span class="token punctuation">(</span>circle<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token number">12.566370614359172</span><span class="token operator">.</span></code></pre><p>TODO: See the version of the area rule that uses clpr in <a href="http://geometry.pl">geometry.pl</a>.</p><p>Rules can only set the value of each argument and variable one time. Once set, they cannot be modified.</p><p>The last goal in a rule can be the built-in predicate <code>true</code> to always succeed. It can also be <code>false</code> or <code>fail</code> to always fail. None of these approaches are commonly used.</p><p>Rules can be recursive. The following rules compute the factorial of an integer:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">factorial</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token operator">!.</span><br><br><span class="token function">factorial</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> F<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  N1 <span class="token operator">is</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  <span class="token function">factorial</span><span class="token punctuation">(</span>N1<span class="token punctuation">,</span> F1<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  F <span class="token operator">is</span> N <span class="token operator">*</span> F1<span class="token operator">.</span><br><br><span class="token operator">?-</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> F<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is F = 120.</span></code></pre><p>Also see the <code>sum</code> example in the &quot;Lists&quot; section.</p><p>When a rule is not working as expected, it may be too general (true for invalid values) or too specific (false for valid values). A common way to fix a rule that is too general is to add more goals. A common way to fix a rule that is too specific is to add more versions of the rule.</p><h2 id="queries" tabindex="-1">Queries</h2><p>Queries test whether a term is true or they find variable values for which the term is true. Queries are written after the characters <code>?-</code>.</p><p>For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% This is a query that asks whether comet is fast.</span><br><span class="token operator">?-</span> <span class="token function">fast</span><span class="token punctuation">(</span>comet<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% true</span><br><br><span class="token comment">% This is a query that asks for something that is fast.</span><br><span class="token operator">?-</span> <span class="token function">fast</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% comet</span></code></pre><p>Suppose the following facts are loaded:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> tacos<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> books<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> running<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>The query <code>likes(X, running)</code> will find &quot;mark&quot;.</p><p>The query <code>likes(mark, X)</code> will find &quot;tacos&quot;, &quot;books&quot;, and &quot;running&quot; that in that order. When a query has multiple matches, as in this example, the interpreter will wait for further input.</p><p>To search for the next match, press the semicolon key. SWI-Prolog also supports pressing the n, r, space, or tab keys to do this. Scryer Prolog supports pressing a to output all remaining solutions.</p><p>To stop searching for matches before the last one is found, press the return key. SWI-Prolog also supports pressing the c or a keys to do this.</p><p>After the last match is found, a prompt for the next query will appear.</p><p>Variables can be used for any argument of a predicate. The unification process will find each set of variable values that cause the predicate to succeed, one set at a time.</p><h3 id="conjunctions" tabindex="-1">Conjunctions</h3><p>The comma operator, read as &quot;and&quot;, is used in rules or queries where multiple goals must be met. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% This rule says that mark likes females that like cycling.</span><br><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">:=</span> <span class="token function">female</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">likes</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> cycling<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% This query asks if mark loves tami AND tami loves mark.</span><br><span class="token operator">?-</span> <span class="token function">loves</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> tami<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">loves</span><span class="token punctuation">(</span>tami<span class="token punctuation">,</span> mark<span class="token punctuation">)</span>`<br><br><span class="token comment">% This query searches for things that both mark and tami love.</span><br><span class="token comment">% X stands for the same value in both goals.</span><br><span class="token operator">?-</span> <span class="token function">loves</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">loves</span><span class="token punctuation">(</span>tami<span class="token punctuation">,</span> X<span class="token punctuation">)</span></code></pre><p>Variables retain their values across query conjunctions, but their values are lost when a query ends. This is a feature of <a href="https://en.wikipedia.org/wiki/Static_single-assignment_form?v=1.0.21" rel="noopener" target="_blank">static single-assignment</a> (SSA) that is used by Prolog. In SSA, &quot;each variable to be assigned exactly once and defined before it is used.&quot; and &quot;every definition (Prolog fact, rule, or query) gets its own version.&quot;</p><p>For example:</p><pre class="language-prolog"><code class="language-prolog">X <span class="token operator">is</span> <span class="token number">6</span><span class="token punctuation">,</span> Y <span class="token operator">is</span> X <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> Z <span class="token operator">is</span> Y <span class="token operator">/</span> <span class="token number">3.</span><br><span class="token comment">% output is X = 6, Y = 12, Z = 4.</span><br><span class="token comment">% Subsequent queries cannot access these values.</span></code></pre><h3 id="disjunctions" tabindex="-1">Disjunctions</h3><p>The semicolon operator, read as &quot;or&quot;, is used in rules or queries where one of a set of goals must be met.</p><p>Earlier we saw a rule that stated something is fast if it is a cheetah or whippet. The following way of writing the rule uses disjunction:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% fast(X) :- cheetah(X); whippet(X).</span></code></pre><h2 id="typical-flow" tabindex="-1">Typical Flow</h2><p>To start a Prolog top level, enter an implementation-specific command such as <code>swipl</code> or <code>gprolog</code>.</p><p>To evaluate a query in the top level, enter the query terminated with a period. If the query does not contain any variables then <code>true</code> or <code>false</code> will be output. If the query does contain variables, a lazy search will be performed to find the first set of values that satisfy the query will be output. To see the next set, press the semicolon key. A period will be output after the last set is found.</p><p>To evaluate arithmetic operators that result in a numeric value, assign the expression to a variable using the <code>=</code> operator. For example, entering <code>X = 1 + 2.</code> will output <code>X = 3.</code></p><p>The typical steps to run a Prolog program are:</p><ol><li>Add facts and rules to a Prolog source file that has an extension of <code>.pl</code></li><li>Load Prolog source files into the Prolog app.</li><li>Enter queries in the Prolog app.</li></ol><p>Unfortunately Prolog and Perl use the same file extension for their source files.</p><p>To load a <code>.pl</code> file in the top level, enter <code>['file-path'].</code> or <code>consult('file-path').</code> If the file is in the current directory, its name can be used without the <code>.pl</code> extension and quotes are not needed inside the square brackets. For example, to load the file <code>demo.pl</code> in the current directory, enter <code>[demo].</code></p><p>Alternatively, pass a source file to the top level when starting it. For example, <code>swipl demo.pl</code></p><p>In SWI-Prolog, after modifying source files that have already been loaded, enter <code>make.</code> to reload all of them.</p><p>To enter new facts and rules in a running session:</p><ul><li>Enter <code>[user].</code> to open stdin as a pseudo file.</li><li>Enter facts and rules.</li><li>Press ctrl-d to close and load the pseudo file.</li></ul><p>It seems this can replace existing facts rather than add to them.</p><h2 id="tree-representation" tabindex="-1">Tree Representation</h2><p>Every Prolog term can be represented as a tree where parent nodes are functors and arguments are children. For example, <code>a(b, c(d, e), f)</code> can be represented as the following tree:</p><ul><li>a/3<ul><li>b</li><li>c/2<ul><li>d</li><li>e</li></ul></li><li>f</li></ul></li></ul><h2 id="data-structures" tabindex="-1">Data Structures</h2><p>ISO Prolog supports three data structures, structures, lists, and pairs. Some Prolog implementations, such as SWI-Prolog, also support dicts.</p><p>SWI-Prolog also supports dicts (a.k.a dictionaries). See <a href="https://eu.swi-prolog.org/pldoc/man?section=bidicts?v=1.0.21" rel="noopener" target="_blank">Dicts: structures with named arguments</a>.</p><h3 id="structures" tabindex="-1">Structures</h3><p>Structures (a.k.a. compound terms) are a bit like structs in some other programming languages. They group related values.</p><p>For example, <code>dog(whippet, comet)</code> is a structure that describes a dog whose breed is &quot;whippet&quot; and whose name is &quot;comet&quot;. In this example, one could think of <code>dog</code> as the type, and whippet and comet are the components of the structure. Developers determine the meaning and order of the components.</p><p>The syntax for a structure is the same as the syntax for a fact.</p><p>Structures can be used in facts and rules. Components of structures can be atoms or variables. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">owns</span><span class="token punctuation">(</span>tami<span class="token punctuation">,</span> <span class="token function">pet</span><span class="token punctuation">(</span>dog<span class="token punctuation">,</span> comet<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">owns</span><span class="token punctuation">(</span>amanda<span class="token punctuation">,</span> <span class="token function">pet</span><span class="token punctuation">(</span>dog<span class="token punctuation">,</span> maisey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">owns</span><span class="token punctuation">(</span>amanda<span class="token punctuation">,</span> <span class="token function">pet</span><span class="token punctuation">(</span>dog<span class="token punctuation">,</span> oscar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">owns</span><span class="token punctuation">(</span>jeremy<span class="token punctuation">,</span> <span class="token function">pet</span><span class="token punctuation">(</span>dog<span class="token punctuation">,</span> ramsay<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% This takes a pet structure and destructures its kind and name.</span><br><span class="token function">print_pet</span><span class="token punctuation">(</span><span class="token function">pet</span><span class="token punctuation">(</span>Kind<span class="token punctuation">,</span> Name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"~w is a ~w.~n"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Name<span class="token punctuation">,</span> Kind<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br>main <span class="token operator">:-</span><br>  <span class="token function">owns</span><span class="token punctuation">(</span>tami<span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'pet = ~w~n'</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">% pet(dog,comet)</span><br><br>  <span class="token function">print_pet</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">% comet is a dog.</span><br><br>  <span class="token function">owns</span><span class="token punctuation">(</span>tami<span class="token punctuation">,</span> <span class="token function">pet</span><span class="token punctuation">(</span>dog<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'name = ~w~n'</span><span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">% comet</span><br><br>  <span class="token function">owns</span><span class="token punctuation">(</span>tami<span class="token punctuation">,</span> <span class="token function">pet</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'kind = ~w, name = ~w~n'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>C<span class="token punctuation">,</span> D<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% dog and comet</span><br><br><span class="token operator">:-</span> main<span class="token operator">.</span></code></pre><p>Structures can be nested. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">person</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> <span class="token function">address</span><span class="token punctuation">(</span><span class="token string">'123 Some Street'</span><span class="token punctuation">,</span> <span class="token string">'Somewhere'</span><span class="token punctuation">,</span> <span class="token string">'MO'</span><span class="token punctuation">,</span> <span class="token number">12345</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br>main <span class="token operator">:-</span><br>  <span class="token function">person</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> <span class="token function">address</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'street = ~w~n'</span><span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% 123 Some Street</span><br><br><span class="token operator">:-</span> main<span class="token operator">.</span></code></pre><h3 id="lists" tabindex="-1">Lists</h3><p>Lists are commonly used to hold collections of elements when there can be any number of elements (even zero), their order matters, and all the elements have the same type (ex. all numbers).</p><p>A list can be written as a comma-separated set of terms surrounded by square brackets. For example, <code>[red, green, blue]</code> is a list of atoms and <code>[R, G, B]</code> is a list of variables that can be unified with any list containing exactly three elements.</p><p>An empty list is written as the atom <code>[]</code> which is called &quot;nil&quot;.</p><p>There are other ways to construct a list.</p><p>The dot function (<code>./2</code>) is the list constructor. It is passed the head and the tail of the list to be constructed. For example, <code>.(H, T)</code> creates a list where <code>H</code> is a single element that is the head and <code>T</code> is a list of elements in the tail. Often variables that represent lists end in &quot;s&quot; (ex. <code>.(E, Es)</code>).</p><p>SWI-Prolog uses a different function name for the list constructor. For example:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token string">'[|]'</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L = [a, b, c].</span></code></pre><p>The head-tail separator <code>|</code> in <code>[H|T]</code> creates a list where H is a single element that is the head and <code>T</code> is a list of elements in the tail. For example, <code>[a | []]</code> is a list containing only <code>a</code> and <code>[a | [b, c]]</code> is equivalent to <code>[a, b, c]</code>. Use of the <code>|</code> operator can be nested. For example, <code>[a | [b | [c]]]</code> is also equivalent to <code>[a, b, c]</code>.</p><p>If the <code>double_quotes</code> flag is set then a double-quoted string (not single-quoted) provides a way to write a list of atoms that correspond to the characters in the string. TODO: Is setting this flag only required in SWI-Prolog? For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">set_prolog_flag</span><span class="token punctuation">(</span>double_quotes<span class="token punctuation">,</span> chars<span class="token punctuation">)</span><span class="token operator">.</span><br>L <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token operator">.</span> <span class="token comment">% atoms, not characters</span><br><span class="token comment">% L = [a, b, c].</span></code></pre><p>The following are all equivalent ways to write the same list:</p><pre class="language-prolog"><code class="language-prolog"><span class="token punctuation">[</span>red<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue<span class="token punctuation">]</span> <span class="token comment">% list notation</span><br><br><span class="token operator">.</span><span class="token punctuation">(</span>red<span class="token punctuation">,</span> <span class="token operator">.</span><span class="token punctuation">(</span>green<span class="token punctuation">,</span> <span class="token operator">.</span><span class="token punctuation">(</span>blue<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">% function notation</span><br><span class="token comment">% In SWI-Prolog, the dots must be replaced by `'[|]'`.</span><br><br><span class="token punctuation">[</span>red <span class="token operator">|</span> <span class="token punctuation">[</span>green <span class="token operator">|</span> <span class="token punctuation">[</span>blue<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">% head-tail separator notation</span><br><span class="token comment">% Specifying a tail of [] for [blue] is optional.</span></code></pre><p>Lists can be nested. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token punctuation">[</span>a<span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> d<span class="token punctuation">,</span> <span class="token punctuation">[</span>e<span class="token punctuation">,</span> <span class="token punctuation">[</span>f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> h<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre><p>A &quot;partial list&quot; is a term that could become a list. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token punctuation">[</span>a <span class="token operator">|</span> T<span class="token punctuation">]</span> <span class="token comment">% will be a list if T is a list</span><br><span class="token punctuation">[</span>a <span class="token operator">|</span> b<span class="token punctuation">]</span> <span class="token comment">% not a list because b is not a list</span><br><span class="token punctuation">[</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> C <span class="token operator">|</span> T<span class="token punctuation">]</span> <span class="token comment">% will be a list of at least three elements if T is a list</span></code></pre><p>To get the sum of numbers in a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">sum_list</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> Sum<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Sum = 6.</span></code></pre><p>If the <code>sum_list</code> predicate didn't exist, it could be implemented with a recursive rule as follows:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">sum_list</span><span class="token punctuation">(</span>List<span class="token punctuation">,</span> Sum<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token comment">% If the list is empty then the sum is zero.</span><br>  List <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">-></span> Sum <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">;</span><br><br>  <span class="token comment">% Otherwise ...</span><br>  List <span class="token operator">=</span><br>    <span class="token comment">% Get the first number and a list of the remaining numbers.</span><br>    <span class="token punctuation">[</span>Head<span class="token operator">|</span>Tail<span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token comment">% Compute the sum of the remaining numbers.</span><br>    <span class="token function">sum_list</span><span class="token punctuation">(</span>Tail<span class="token punctuation">,</span> TailSum<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token comment">% The result is the first number plus that sum.</span><br>    <span class="token comment">% Note the use of the "is" keyword to assign the</span><br>    <span class="token comment">% result of an arithmetic expression to the Sum argument.</span><br>    Sum <span class="token operator">is</span> TailSum <span class="token operator">+</span> Head<span class="token operator">.</span><br><br><span class="token operator">?-</span> <span class="token function">sum_list</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is X = 6.</span></code></pre><p>Anonymous variables (<code>_</code>) can be used to destructure values from a list. For example, the following gets the first and third values. The <code>| _</code> syntax at the end of the list on the left side indicates that we do not care about values in the tail of the list which includes all values after the third.</p><pre class="language-prolog"><code class="language-prolog"><span class="token punctuation">[</span>V1<span class="token punctuation">,</span> _<span class="token punctuation">,</span> V3 <span class="token operator">|</span> _<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">.</span><br><span class="token comment">% output is</span><br><span class="token comment">% V1 = 9,</span><br><span class="token comment">% V3 = 7.</span></code></pre><p>The <code>|</code> operator can be used to get the head and tail of a list. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% This destructures the list passed in into its head and tail.</span><br><span class="token function">print_list_parts</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'head is ~w, tail is ~w'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>H<span class="token punctuation">,</span> T<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token operator">?-</span> <span class="token function">print_list_parts</span><span class="token punctuation">(</span><span class="token punctuation">[</span>red<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is head is red, tail is [green,blue]</span></code></pre><p>The <code>|</code> operator can be used in a recursive rule to iterate over all elements of a list. Destructuring a list into its head and tail can be done in the argument list. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">print_elements</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">print_elements</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:=</span><br>  <span class="token function">writeln</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">print_elements</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token operator">?-</span> <span class="token function">print_elements</span><span class="token punctuation">(</span><span class="token punctuation">[</span>red<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is</span><br><span class="token comment">% red</span><br><span class="token comment">% green</span><br><span class="token comment">% blue</span></code></pre><p>The <code>subtract</code> predicate can be used to create a list that is derived by removing a given element from another list.</p><p>The following code shows how this can be implemented. It serves as one more example of using the <code>|</code> operator.</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% Removing anything from an empty list matches an empty list.</span><br><span class="token function">list_without</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% H is the head of the 1st argument list and T is its tail.</span><br><span class="token comment">% E is the element to removed.</span><br><span class="token comment">% L is a list containing all elements of the first list</span><br><span class="token comment">% with all occurrences of E removed.</span><br><span class="token function">list_without</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">,</span> E<span class="token punctuation">,</span> L<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token comment">% If H matches E ...</span><br>  H <span class="token operator">==</span> E <span class="token operator">-></span><br>    <span class="token comment">% Then the result list L is the same as T with E removed.</span><br>    <span class="token function">list_without</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> E<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">;</span><br>    <span class="token comment">% Otherwise the result list L is a new list with head H</span><br>    <span class="token comment">% and tail is the same as T with E removed.</span><br>    <span class="token function">list_without</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> E<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token punctuation">,</span> L <span class="token operator">=</span> <span class="token punctuation">[</span>H<span class="token operator">|</span>L2<span class="token punctuation">]</span><span class="token operator">.</span></code></pre><p>The <code>maplist</code> predicate can be used to create a list that is derived by applying a given predicate to each element of another list. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">double</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">var</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">-></span> A <span class="token operator">is</span> B <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">;</span> B <span class="token operator">is</span> A <span class="token operator">*</span> <span class="token number">2.</span><br><br><span class="token operator">:-</span> <span class="token function">maplist</span><span class="token punctuation">(</span>double<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">writeln</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is [2, 4, 6]</span></code></pre><p>The <code>reverse</code> function creates a new list containing all the values in a given list in reverse order. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is X = [3, 2, 1].</span></code></pre><p>To get the length of a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">length</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is X = 3.</span></code></pre><p>To determine if two lists have the same length:</p><pre class="language-prolog"><code class="language-prolog">L1 <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> L2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">same_length</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% doesn't output true, but also doesn't fail</span></code></pre><p>To test whether a value is a member of a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">member</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% doesn't output true, but also doesn't fail</span><br><br>L <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">member</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is false</span></code></pre><p>To test whether a list begins with a given sub-list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">prefix</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% doesn't output true, but also doesn't fail</span></code></pre><p>To get the first element of a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>H<span class="token operator">|</span>_<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token operator">.</span><br><span class="token comment">% output is H = a.</span></code></pre><p>To test whether a list ends with a given sub-list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">last</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% doesn't output true, but also doesn't fail</span></code></pre><p>To get the last element of a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">last</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is E = d.</span></code></pre><p>The <code>member</code> function can also be used to iterate over the values in a list. or example, <code>member(X, [3, 7, 9])</code> will set <code>X</code> to each value in the list one at a time.</p><p>To get the list element at a given index:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">nth0</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> L<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% zero-based index</span><br><span class="token comment">% output is E = b.</span><br><br>L <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">nth1</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> L<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% one-based index</span><br><span class="token comment">% output is E = b.</span></code></pre><p>To create a new list that results from adding a value to the beginning of an existing list:</p><pre class="language-prolog"><code class="language-prolog">L1 <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> L2 <span class="token operator">=</span> <span class="token punctuation">[</span>a <span class="token operator">|</span> L1<span class="token punctuation">]</span><span class="token operator">.</span><br><span class="token comment">% output is L2 = [a, b, c, d].</span></code></pre><p>To create a new list that results from adding a value to the end of an existing list:</p><pre class="language-prolog"><code class="language-prolog">L1 <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">append</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> <span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L2 = [a, b, c, d].</span></code></pre><p>To create a new list that results from inserting a value at a given zero-based index in an existing list:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% Inserts x after 2nd element.</span><br>L1 <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">nth0</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> L2<span class="token punctuation">,</span> x<span class="token punctuation">,</span> L1<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L2 = [a, b, x, c].</span></code></pre><p>To create a new list that results from removing only the first occurrence of a given value:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">selectchk</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L = [a, c, b].</span></code></pre><p>The <code>select/3</code> predicate is similar to <code>selectchk/3</code>, but it iterates through every possible removal.</p><p>To create a new list that results from replacing only the first occurrence of a given value:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">selectchk</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L = [a, x, c, b].</span></code></pre><p>The <code>select/4</code> predicate is similar to <code>selectchk/4</code>, but it iterates through every possible replacement.</p><p>To create a new list that results from removing every occurrence of given values:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">subtract</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% could remove more than just b elements</span><br><span class="token comment">% output is L = [a, c].</span></code></pre><p>To get all permutations of a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">permutation</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> Ps<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is</span><br><span class="token comment">% Ps = [1, 2, 3] ;</span><br><span class="token comment">% Ps = [1, 3, 2] ;</span><br><span class="token comment">% Ps = [2, 1, 3] ;</span><br><span class="token comment">% Ps = [2, 3, 1] ;</span><br><span class="token comment">% Ps = [3, 1, 2] ;</span><br><span class="token comment">% Ps = [3, 2, 1] ;</span><br>false<span class="token operator">.</span></code></pre><p>To flatten nested lists:</p><pre class="language-prolog"><code class="language-prolog">L1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token punctuation">[</span>d<span class="token punctuation">,</span> <span class="token punctuation">[</span>e<span class="token punctuation">,</span> f<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">flatten</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is [a, b, c, d, e, f].</span></code></pre><p>To perform run length encoding:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>dog<span class="token punctuation">,</span> dog<span class="token punctuation">,</span> cat<span class="token punctuation">,</span> dog<span class="token punctuation">,</span> dog<span class="token punctuation">,</span> dog<span class="token punctuation">,</span> rabbit<span class="token punctuation">,</span> rabbit<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">clumped</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> C<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is C = [dog-2, cat-1, dog-3, rabbit-2].</span></code></pre><p>To get the smallest or largest value in a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">min_list</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> Min<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Min = 2.</span><br><br>L <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> a<span class="token punctuation">,</span> d<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">min_member</span><span class="token punctuation">(</span>Min<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Min = a.</span><br><br>L <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">max_list</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> Max<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Max = 9.</span><br><br>L <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> a<span class="token punctuation">,</span> d<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">max_member</span><span class="token punctuation">(</span>Max<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Max = d.</span><br><br><span class="token function">younger</span><span class="token punctuation">(</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">person</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> A1<span class="token punctuation">)</span> <span class="token operator">=</span> P1<span class="token punctuation">,</span><br>  <span class="token function">person</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> A2<span class="token punctuation">)</span> <span class="token operator">=</span> P2<span class="token punctuation">,</span><br>  A1 <span class="token operator">&lt;</span> A2<span class="token operator">.</span><br><br><span class="token operator">?-</span> P1 <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span>ann<span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   P2 <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span>bob<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   P3 <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span>carl<span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   People <span class="token operator">=</span> <span class="token punctuation">[</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">,</span> P3<span class="token punctuation">]</span><span class="token punctuation">,</span><br><br>   <span class="token function">min_member</span><span class="token punctuation">(</span>younger<span class="token punctuation">,</span> Py<span class="token punctuation">,</span> People<span class="token punctuation">)</span><span class="token punctuation">,</span><br>   <span class="token function">person</span><span class="token punctuation">(</span>N1<span class="token punctuation">,</span> A1<span class="token punctuation">)</span> <span class="token operator">=</span> Py<span class="token punctuation">,</span><br>   <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"youngest is ~w at age ~w~n"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N1<span class="token punctuation">,</span> A1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   <span class="token comment">% output is youngest is carl at age 19</span><br><br>   <span class="token function">max_member</span><span class="token punctuation">(</span>younger<span class="token punctuation">,</span> Po<span class="token punctuation">,</span> People<span class="token punctuation">)</span><span class="token punctuation">,</span><br>   <span class="token function">person</span><span class="token punctuation">(</span>N2<span class="token punctuation">,</span> A2<span class="token punctuation">)</span> <span class="token operator">=</span> Po<span class="token punctuation">,</span><br>   <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"oldest is ~w at age ~w~n"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>N2<span class="token punctuation">,</span> A2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br>   <span class="token comment">% output is oldest is bob at age 50</span></code></pre><p>To create a list containing a range of sequential integers:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">numlist</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L = [3, 4, 5, 6, 7].</span></code></pre><p>To determine if all the elements in a list are unique:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> a<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">is_set</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% doesn't output true, but also doesn't fail</span><br>L <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">is_set</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is false.</span></code></pre><p>To remove duplicate elements from a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>b<span class="token punctuation">,</span> a<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">list_to_set</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is S = [b, a, c, d].</span></code></pre><p>To find the intersection of two lists:</p><pre class="language-prolog"><code class="language-prolog">L1 <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> L2 <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> b<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">intersection</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">,</span> L3<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L3 = [b, c].</span></code></pre><p>To find the union of two lists:</p><pre class="language-prolog"><code class="language-prolog">L1 <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> L2 <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> b<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">union</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">,</span> L3<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L3 = [a, c, b, d].</span></code></pre><p>To sort a list:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> b<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">sort</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is [a, b, c, d].</span><br><br><span class="token function">age_compare</span><span class="token punctuation">(</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token function">person</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> A1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">person</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> A2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:-</span> A1 <span class="token operator">></span> A2<span class="token operator">.</span><br><span class="token function">age_compare</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token punctuation">,</span> <span class="token function">person</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> A1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">person</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> A2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:-</span> A1 <span class="token operator">&lt;</span> A2<span class="token operator">.</span><br><span class="token function">age_compare</span><span class="token punctuation">(</span><span class="token operator">=</span><span class="token punctuation">,</span> <span class="token function">person</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> A1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">person</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> A2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:-</span> A1 <span class="token operator">=</span> A2<span class="token operator">.</span><br><br><span class="token operator">?-</span> P1 <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span>ann<span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   P2 <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span>bob<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   P3 <span class="token operator">=</span> <span class="token function">person</span><span class="token punctuation">(</span>carl<span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   People <span class="token operator">=</span> <span class="token punctuation">[</span>P1<span class="token punctuation">,</span> P2<span class="token punctuation">,</span> P3<span class="token punctuation">]</span><span class="token punctuation">,</span><br><br>   <span class="token function">predsort</span><span class="token punctuation">(</span>age_compare<span class="token punctuation">,</span> People<span class="token punctuation">,</span> Sorted<span class="token punctuation">)</span><span class="token punctuation">,</span><br>   <span class="token function">writeln</span><span class="token punctuation">(</span>Sorted<span class="token punctuation">)</span><span class="token operator">.</span><br>   <span class="token comment">% output is [person(carl,19),person(ann,35),person(bob,50)]</span></code></pre><p>To determine if one list contains a subset of another:</p><pre class="language-prolog"><code class="language-prolog">L <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> b<span class="token punctuation">,</span> a<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">subset</span><span class="token punctuation">(</span><span class="token punctuation">[</span>b<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% doesn't output true, but also doesn't fail</span><br><br>L <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> b<span class="token punctuation">,</span> a<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">subset</span><span class="token punctuation">(</span><span class="token punctuation">[</span>b<span class="token punctuation">,</span> e<span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% outputs false</span></code></pre><p>For implementations of map, filter, and reduce, see <a href="https://pbrown.me/blog/functional-prolog-map-filter-and-reduce/?v=1.0.21" rel="noopener" target="_blank">Functional Prolog</a>.</p><h4 id="appending" tabindex="-1">Appending</h4><p>The built-in predicate <code>append</code> can create a new list by appending two existing lists. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is X = [1, 2, 3, 4, 5]</span></code></pre><p>The <code>append</code> predicate can also create a new list by appending multiple lists. For example:</p><pre class="language-prolog"><code class="language-prolog">L1 <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> L2 <span class="token operator">=</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">]</span><span class="token punctuation">,</span> L3 <span class="token operator">=</span> <span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">,</span> L3<span class="token punctuation">]</span><span class="token punctuation">,</span> L4<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is L4 = [a, b, c, d, e, f].</span></code></pre><p>If <code>append</code> were not built-in, it could be implemented as follows:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% Appending an empty list to any list gives the second list.</span><br><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> L<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% Appending two lists is the same as appending</span><br><span class="token comment">% the head of the first list (H) to the result of appending</span><br><span class="token comment">% the tail of the first list (L1) to the second list (L2).</span><br><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>L1<span class="token punctuation">]</span><span class="token punctuation">,</span> L2<span class="token punctuation">,</span> <span class="token punctuation">[</span>H<span class="token operator">|</span>L3<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">append</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">,</span> L3<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>Here are several examples of how <code>append</code> can be used:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% Is the result of appending two lists a given result list?</span><br><span class="token operator">?-</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br>true<span class="token operator">.</span><br><br><span class="token comment">% What is the result of appending two lists?</span><br><span class="token operator">?-</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">.</span><br><br><span class="token comment">% What list must be appended to a given list to obtain a given result?</span><br><span class="token operator">?-</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">.</span><br><br><span class="token comment">% What list must be prepended to a given list to obtain a given result?</span><br><span class="token operator">?-</span> <span class="token function">append</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><br><br><span class="token comment">% What lists can be appended to obtain a given result?</span><br><span class="token operator">?-</span> <span class="token function">append</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>Y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">;</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>Y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">;</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>Y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">;</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>Y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">;</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>Y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">;</span></code></pre><h3 id="pairs" tabindex="-1">Pairs</h3><p>A Prolog &quot;pair&quot; is a key and a value. There are two ways to write a pair, <code>k-v</code> or <code>-(k, v)</code>.</p><p>Searches for specific pairs in a list of pairs are sequential. For a more efficient key lookup see the &quot;Dicts&quot; section.</p><p>For details on predicates that operate on pairs, see <a href="https://eu.swi-prolog.org/pldoc/man?section=pairs?v=1.0.21" rel="noopener" target="_blank">library(pairs): Operations on key-value lists</a>.</p><p>To sort a list of pairs on their keys:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">keysort</span><span class="token punctuation">(</span><span class="token punctuation">[</span>c<span class="token operator">-</span>cow<span class="token punctuation">,</span> b<span class="token operator">-</span>bear<span class="token punctuation">,</span> a<span class="token operator">-</span>apple<span class="token punctuation">]</span><span class="token punctuation">,</span> Ps<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Ps = [a-apple, b-bear, c-cow].</span></code></pre><p>To get the keys from a list of pairs:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">pairs_keys</span><span class="token punctuation">(</span><span class="token punctuation">[</span>c<span class="token operator">-</span>cow<span class="token punctuation">,</span> b<span class="token operator">-</span>bear<span class="token punctuation">,</span> a<span class="token operator">-</span>apple<span class="token punctuation">]</span><span class="token punctuation">,</span> Ks<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Ks = [c, b, a].</span></code></pre><p>To get the values from a list of pairs:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">pairs_values</span><span class="token punctuation">(</span><span class="token punctuation">[</span>c<span class="token operator">-</span>cow<span class="token punctuation">,</span> b<span class="token operator">-</span>bear<span class="token punctuation">,</span> a<span class="token operator">-</span>apple<span class="token punctuation">]</span><span class="token punctuation">,</span> Vs<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Vs = [cow, bear, apple].</span></code></pre><p>To get both the keys and the values from a list of pairs:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">pairs_keys_values</span><span class="token punctuation">(</span><span class="token punctuation">[</span>c<span class="token operator">-</span>cow<span class="token punctuation">,</span> b<span class="token operator">-</span>bear<span class="token punctuation">,</span> a<span class="token operator">-</span>apple<span class="token punctuation">]</span><span class="token punctuation">,</span> Ks<span class="token punctuation">,</span> Vs<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Ks = [c, b, a], Vs = [cow, bear, apple].</span></code></pre><p>When a list contains pairs with duplicate keys is sorted on those keys, we can get a new list where the keys are unique values and their values are lists of values. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">%- group_pairs_by_key([a-apple, a-apricot, b-banana, b-blueberry, c-cherry], G).</span><br><span class="token comment">% output is G = [a-[apple, apricot], b-[banana, blueberry], c-[cherry]].</span></code></pre><p>To swap keys and values in a list of pairs AND sort the pairs on their key:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">transpose_pairs</span><span class="token punctuation">(</span><span class="token punctuation">[</span>c<span class="token operator">-</span>cow<span class="token punctuation">,</span> b<span class="token operator">-</span>bear<span class="token punctuation">,</span> a<span class="token operator">-</span>apple<span class="token punctuation">]</span><span class="token punctuation">,</span> Ts<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Ts = [apple-a, bear-b, cow-c].</span></code></pre><p>The <code>map_list_to_pairs</code> predicate takes a predicate and a list of list. It creates a list of pairs where the key of each pair is the result of passing one of the sub-lists to a predicate and the associated value is the sub-list. For example, the following uses the <code>length</code> predicate.</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">map_list_to_pairs</span><span class="token punctuation">(</span><br>     length<span class="token punctuation">,</span><br>     <span class="token punctuation">[</span><span class="token punctuation">[</span>apple<span class="token punctuation">,</span> apricot<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>banana<span class="token punctuation">,</span> blueberry<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>cherry<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>     Ps<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is Ps = [2-[apple, apricot], 2-[banana, blueberry], 1-[cherry]].</span></code></pre><p>The following code implements rules to determine if a queen on a chess board can attach another piece. Note that:</p><ul><li>Each board position is represented by a row-column pair.</li><li>The arguments destructure the keys and values of pairs that are passed in.</li><li>Underscore anonymous variables are used for values that do not matter.</li><li>The cut operator <code>!</code> stops searching after the first solution is found.</li></ul><pre class="language-prolog"><code class="language-prolog"><span class="token function">queen_can_attack</span><span class="token punctuation">(</span>R<span class="token operator">-</span>_<span class="token punctuation">,</span> R<span class="token operator">-</span>_<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token operator">!.</span> <span class="token comment">% same row</span><br><span class="token function">queen_can_attack</span><span class="token punctuation">(</span>_<span class="token operator">-</span>C<span class="token punctuation">,</span> _<span class="token operator">-</span>C<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token operator">!.</span> <span class="token comment">% same column</span><br><span class="token function">queen_can_attack</span><span class="token punctuation">(</span>R1<span class="token operator">-</span>C1<span class="token punctuation">,</span> R2<span class="token operator">-</span>C2<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token comment">% same diagonal</span><br>  <span class="token function">abs</span><span class="token punctuation">(</span>R1 <span class="token operator">-</span> R2<span class="token punctuation">)</span> <span class="token operator">=:=</span> <span class="token function">abs</span><span class="token punctuation">(</span>C1 <span class="token operator">-</span> C2<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><h3 id="dicts" tabindex="-1">Dicts</h3><p>A dictionary, or dict for short, is a hash map. To create one, specify a tag followed by an open curly brace, key/value pairs where there is a colon between each key and value, and the pairs are separated by commas, and a closing curly brace. The tag optionally begins with a module name and a colon. Then it must specific an atom or variable.</p><p>Values in dicts can be other dicts.</p><p>For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">report</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'Hello, ~w ~w!~n'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>P<span class="token operator">.</span>first<span class="token punctuation">,</span> P<span class="token operator">.</span>last<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'I see you are ~w years old~n.'</span><span class="token punctuation">,</span> P<span class="token operator">.</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'Your zip is ~w.~n'</span><span class="token punctuation">,</span> P<span class="token operator">.</span>address<span class="token operator">.</span>zip<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token operator">?-</span> P <span class="token operator">=</span> person<span class="token punctuation">{</span><br>  first<span class="token operator">:</span> <span class="token string">'Mark'</span><span class="token punctuation">,</span><br>  last<span class="token operator">:</span> <span class="token string">'Volkmann'</span><span class="token punctuation">,</span><br>  age<span class="token operator">:</span> <span class="token number">62</span><span class="token punctuation">,</span><br>  address<span class="token operator">:</span> _<span class="token punctuation">{</span><br>    street<span class="token operator">:</span> <span class="token string">'123 Some Street'</span><span class="token punctuation">,</span><br>    city<span class="token operator">:</span> <span class="token string">'Somewhere'</span><span class="token punctuation">,</span><br>    state<span class="token operator">:</span> <span class="token string">'MO'</span><span class="token punctuation">,</span><br>    zip<span class="token operator">:</span> <span class="token number">12345</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token function">report</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% The output is:</span><br><span class="token comment">% Hello, Mark Volkmann!</span><br><span class="token comment">% I see you are 62 years old.</span><br><span class="token comment">% Your zip is 12345.</span></code></pre><p>TODO: Add more detail on working with dicts.</p><h2 id="type-checking" tabindex="-1">Type Checking</h2><p>ISO Prolog provides many built-in predicates that can be used to assert the type of arguments. These are not supported in Scryer Prolog. Instead see <a href="https://www.scryer.pl/si.html?v=1.0.21" rel="noopener" target="_blank">Module si</a>.</p><table><thead><tr><th>Predicate</th><th>Meaning</th></tr></thead><tbody><tr><td><code>var(V)</code></td><td>V is a variable</td></tr><tr><td><code>nonvar(V)</code></td><td>V is not a variable</td></tr><tr><td><code>number(V)</code></td><td>V is any kind of number</td></tr><tr><td><code>integer(V)</code></td><td>V is an integer</td></tr><tr><td><code>float(V)</code></td><td>V is a floating point number</td></tr><tr><td><code>rational(V)</code></td><td>V is a rational number</td></tr><tr><td><code>rational(V, Numerator, Denominator)</code></td><td>V is a rational number with given a numerator and denominator</td></tr><tr><td><code>atom(V)</code></td><td>V is an atom</td></tr><tr><td><code>blob(V)</code></td><td>V is a blob</td></tr><tr><td><code>string(V)</code></td><td>V is a string</td></tr><tr><td><code>atomic(V)</code></td><td>V is not a variable or compound term</td></tr><tr><td><code>compound(V)</code></td><td>V is a compound term</td></tr><tr><td><code>callable(V)</code></td><td>V is an atom or a compound term</td></tr><tr><td><code>ground(V)</code></td><td>V is not a variable or a compound term that holds variables</td></tr><tr><td><code>cyclic_term(V)</code></td><td>V contains cycles (circular references)</td></tr><tr><td><code>acyclic_term(V)</code></td><td>V does not contain cycles (circular references)</td></tr></tbody></table><p>The following code in the file <code>type_checking.pl</code> implements simple rules that perform type checking of an argument.</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% The cut operator `!` tells Prolog to stop searching once a solution is found.</span><br><span class="token function">demo</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">integer</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token string">'integer'</span><span class="token punctuation">,</span> <span class="token operator">!.</span><br><span class="token function">demo</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">float</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token string">'float'</span><span class="token punctuation">,</span> <span class="token operator">!.</span><br><span class="token function">demo</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">rational</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token string">'rational'</span><span class="token punctuation">,</span> <span class="token operator">!.</span><br><span class="token comment">% In SWI-Prolog, only double-quoted strings are considered strings.</span><br><span class="token function">demo</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">string</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token string">'string'</span><span class="token punctuation">,</span> <span class="token operator">!.</span><br><span class="token function">demo</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">atom</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token string">'atom'</span><span class="token punctuation">,</span> <span class="token operator">!.</span><br><br><span class="token function">demo2</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">number</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token string">'number'</span><span class="token punctuation">,</span> <span class="token operator">!.</span><br><br><span class="token function">demo3</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">atomic</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token string">'atomic'</span><span class="token punctuation">,</span> <span class="token operator">!.</span><br><span class="token function">demo3</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">compound</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">=</span> <span class="token string">'compound'</span><span class="token punctuation">,</span> <span class="token operator">!.</span><br><br><span class="token function">demo4</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">ground</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span> <span class="token operator">-></span> T <span class="token operator">=</span> <span class="token string">'ground'</span><span class="token operator">;</span> T <span class="token operator">=</span> <span class="token string">'nonground'</span><span class="token punctuation">,</span> <span class="token operator">!.</span></code></pre><p>The following unit test code in the file <code>type_checking.pl</code> demonstrates using the rules defined above:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% To run these tests, enter `swipl type-checking.plt`</span><br><br><span class="token operator">:-</span> <span class="token function">consult</span><span class="token punctuation">(</span>type_checking<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token operator">:-</span> <span class="token function">begin_tests</span><span class="token punctuation">(</span>type_checking<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'integer'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>float<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'float'</span><span class="token operator">.</span><br><span class="token comment">% See rational_syntax flag to enable 2/3 to be treated as rational.</span><br><span class="token function">test</span><span class="token punctuation">(</span>rational<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token number">2</span>r3<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'rational'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo2</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'number'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'string'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>atom<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'atom'</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>atomic<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo3</span><span class="token punctuation">(</span>true<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'atomic'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>atomic<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo3</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'atomic'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>atomic<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo3</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'atomic'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>atomic<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo3</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'atomic'</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>compound<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo3</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'compound'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>compound<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo3</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'compound'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>compound<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo3</span><span class="token punctuation">(</span>a<span class="token operator">-</span>b<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'compound'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>compound<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo3</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'compound'</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>ground<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo4</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'ground'</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>ground<span class="token punctuation">)</span> <span class="token operator">:-</span> V <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">demo4</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">==</span> <span class="token string">'ground'</span><span class="token operator">.</span><br><br><span class="token comment">% The next line suppresses warning about singleton variable V.</span><br><span class="token operator">:-</span><span class="token function">style_check</span><span class="token punctuation">(</span><span class="token operator">-</span>singleton<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">test</span><span class="token punctuation">(</span>ground<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">demo4</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">,</span> T <span class="token operator">\==</span> <span class="token string">'ground'</span><span class="token operator">.</span><br><br><span class="token operator">:-</span> <span class="token function">end_tests</span><span class="token punctuation">(</span>type_checking<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token operator">:-</span> run_tests<span class="token operator">.</span><br><span class="token operator">:-</span> halt<span class="token operator">.</span></code></pre><h2 id="dynamic-predicates" tabindex="-1">Dynamic Predicates</h2><p>By default predicates cannot be added or deleted in a session. To enable this, run a <code>dynamic</code> query on a specific predicate. Once this is done, a predicate of that type can be added to the beginning with <code>asserta</code> or added to the end with <code>assertz</code>. And predicates of that type can be removed with the <code>retract</code> and <code>retractall</code> functions.</p><p>For example, suppose we have the file <code>likes.pl</code> containing the following:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% Enable adding and removing "likes" predicates that take two arguments.</span><br><span class="token operator">:-</span> <span class="token function">dynamic</span><span class="token punctuation">(</span><span class="token function">likes/2</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> books<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> running<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>A session can do the following:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token punctuation">[</span>likes<span class="token punctuation">]</span><span class="token operator">.</span><br><span class="token operator">?-</span> <span class="token function">assertz</span><span class="token punctuation">(</span><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> reeces<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% adds after existing predicates</span><br><span class="token operator">?-</span> <span class="token function">retract</span><span class="token punctuation">(</span><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> books<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% removes</span><br><span class="token operator">?-</span> <span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% outputs running and reeces</span><br><br><span class="token operator">?-</span> <span class="token function">retractall</span><span class="token punctuation">(</span><span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% removes everything that mark likes</span><br><span class="token operator">?-</span> <span class="token function">retractall</span><span class="token punctuation">(</span><span class="token function">likes</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% removes everything that anybody likes</span><br><span class="token operator">?-</span> <span class="token function">likes</span><span class="token punctuation">(</span>mark<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% outputs nothing</span></code></pre><h2 id="runtime-predicates" tabindex="-1">Runtime Predicates</h2><p>A predicate can be placed in a variable at runtime and later used to create a term with the <code>:..</code> operator which is evaluated using the <code>call</code> predicate. For example:</p><pre class="language-prolog"><code class="language-prolog">P <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token punctuation">,</span> <span class="token comment">% could be set to a different relational operator</span><br>Term <span class="token operator">=..</span> <span class="token punctuation">[</span>P<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">% builds term from list containing functor and arguments</span><br><span class="token function">call</span><span class="token punctuation">(</span>Term<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% evaluates term</span></code></pre><h2 id="input" tabindex="-1">Input</h2><p>The <code>read</code> function reads a string from stdin. For example:</p><pre class="language-prolog"><code class="language-prolog">greet <span class="token operator">:-</span><br>  <span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'Enter your name: '</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">read</span><span class="token punctuation">(</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'Hello, ~w!'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>Enter a name in single or double quotes followed by a period. This is an odd requirement for users! Entering 'Mark'. results in the following output: <code>Hello, Mark!</code>.</p><p>The <code>get</code> function reads a single character and sets a variable to its integer ASCII value.</p><p>To read from a file and write the contents to stdout, use the <code>open</code>, <code>get_char</code>, and <code>close</code> functions. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">processStream</span><span class="token punctuation">(</span>end_of_file<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token operator">!.</span> <span class="token comment">% a "cut" that stops execution</span><br><br><span class="token function">processStream</span><span class="token punctuation">(</span>Char<span class="token punctuation">,</span> Stream<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">write</span><span class="token punctuation">(</span>Char<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">get_char</span><span class="token punctuation">(</span>Stream<span class="token punctuation">,</span> NextChar<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">processStream</span><span class="token punctuation">(</span>NextChar<span class="token punctuation">,</span> Stream<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">readFile</span><span class="token punctuation">(</span>File<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">open</span><span class="token punctuation">(</span>File<span class="token punctuation">,</span> read<span class="token punctuation">,</span> Stream<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">get_char</span><span class="token punctuation">(</span>Stream<span class="token punctuation">,</span> Char<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">processStream</span><span class="token punctuation">(</span>Char<span class="token punctuation">,</span> Stream<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">close</span><span class="token punctuation">(</span>Stream<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'demo.txt'</span><span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>To read from a text file in Scryer Prolog:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">use_module</span><span class="token punctuation">(</span><span class="token function">library</span><span class="token punctuation">(</span>pio<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% for phrase_from_file and phrase_to_stream</span><br><span class="token function">phrase_from_file</span><span class="token punctuation">(</span><span class="token function">seq</span><span class="token punctuation">(</span>Cs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"input.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><span class="token function">phrase_to_stream</span><span class="token punctuation">(</span>Cs<span class="token punctuation">,</span> user_output<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% writes to stdout</span></code></pre><h2 id="output" tabindex="-1">Output</h2><p>The <code>write</code> predicate writes to the current output stream, which defaults to stdout. The atom <code>nl</code> is a built-in that writes a newline character to the current output stream. The <code>writeln</code> predicate combines these (in SWI-Prolog, but not in Scryer Prolog).</p><p>For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nl<span class="token operator">.</span><br><br><span class="token function">writeln</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% same as previous line</span></code></pre><p>The <a href="https://www.swi-prolog.org/pldoc/man?predicate=format/2?v=1.0.21" rel="noopener" target="_blank">format</a> predicate also writes to the current output stream. It takes a format string and a list of values to be substituted into the format string. (In Scryer Prolog, <code>use_module(library(format)).</code> and use the <code>format_</code> predicate.)</p><p>The format string can contain the following control sequences that all begin with a tilde:</p><ul><li><code>~d</code>: decimal</li><li><code>~D</code>: decimal with commas every three digits</li><li><code>~e</code>: floating point in exponential notation</li><li><code>~E</code>: same as <code>~e</code> but with a capital E</li><li><code>~f</code>: floating point without exponential notation</li><li><code>~i</code>: ignores corresponding value; no output</li><li><code>~Nf</code>: float value with only N decimal places</li><li><code>~n</code>: single newline character</li><li><code>~Nn</code>: N newline characters</li><li><code>~Nr</code>: integer converted to radix N For example, <code>~2r</code> outputs a number in binary, <code>~16r</code> outputs a number in lowercase hexadecimal, and <code>~16R</code> outputs an integer in uppercase hexadecimal.</li><li><code>~s</code>: literal string</li><li><code>~t</code>: inserts multiple spaces up to the next tab stop; used to left, center, or right align what follows</li><li><code>~w</code>: writes value of a variable or atom</li><li><code>~N|</code>: sets a tab stop at column N</li><li><code>~N+</code>: sets a tab stop at N columns past last tab stop (A tab stop is assumed at column zero.)</li></ul><p>For more control sequences, see the &quot;format&quot; link above.</p><p>For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'~w likes ~s.'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>mark<span class="token punctuation">,</span> <span class="token string">'Prolog'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% outputs "mark likes Prolog."</span></code></pre><p>Rules can write to the current output stream. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">greet</span><span class="token punctuation">(</span>Name<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'Hello, ~w!'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">greet</span><span class="token punctuation">(</span><span class="token string">'Mark'</span><span class="token punctuation">)</span><br><span class="token comment">% outputs "Hello, Mark!"</span><br>```<br><br>Tab stops can be used to output aligned columns<span class="token operator">.</span><br>For example<span class="token operator">:</span><br><br>```prolog<br><span class="token function">print_row</span><span class="token punctuation">(</span>Row<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token comment">% The 1st list element is left-aligned.</span><br>  <span class="token comment">% The 2nd list element is center-aligned.</span><br>  <span class="token comment">% The 3rd list element is right-aligned.</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"~w~t~10+~t~w~t~10+~t~w~10+~n"</span><span class="token punctuation">,</span> Row<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token operator">:-</span> Rows <span class="token operator">=</span> <span class="token punctuation">[</span><br>     <span class="token punctuation">[</span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">,</span> <span class="token string">"baz"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>     <span class="token punctuation">[</span><span class="token string">"foolish"</span><span class="token punctuation">,</span> <span class="token string">"barking"</span><span class="token punctuation">,</span> <span class="token string">"bazooka"</span><span class="token punctuation">]</span><br>   <span class="token punctuation">]</span><span class="token punctuation">,</span><br>   <span class="token function">maplist</span><span class="token punctuation">(</span>print_row<span class="token punctuation">,</span> Rows<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>The output is:</p><pre class="language-text"><code class="language-text">foo          bar           baz<br>foolish     barking     bazooka</code></pre><p>The <code>put</code> function writes a single ASCII value to the current output stream. It is the counterpart to the <code>get</code> function.</p><p>To write to a file, use the <code>open</code>, <code>write</code>, and <code>close</code> functions. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">writeFile</span><span class="token punctuation">(</span>File<span class="token punctuation">,</span> Text<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">open</span><span class="token punctuation">(</span>File<span class="token punctuation">,</span> write<span class="token punctuation">,</span> Stream<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">write</span><span class="token punctuation">(</span>Stream<span class="token punctuation">,</span> Text<span class="token punctuation">)</span><span class="token punctuation">,</span> nl<span class="token punctuation">,</span><br>  <span class="token function">close</span><span class="token punctuation">(</span>Stream<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'demo.txt'</span><span class="token punctuation">,</span> <span class="token string">'first line\nsecond line'</span><span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>To write to a text file in Scryer Prolog:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">use_module</span><span class="token punctuation">(</span><span class="token function">library</span><span class="token punctuation">(</span>pio<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% for phrase_to_file</span><br><span class="token function">phrase_to_file</span><span class="token punctuation">(</span><span class="token string">"This is\na test."</span><span class="token punctuation">,</span> <span class="token string">"output.txt"</span><span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>To write to a stream in Scryer Prolog (in this case stdout):</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">use_module</span><span class="token punctuation">(</span><span class="token function">library</span><span class="token punctuation">(</span>pio<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% for phrase_to_stream</span><br><span class="token function">phrase_to_stream</span><span class="token punctuation">(</span><span class="token string">"Hello, World!"</span><span class="token punctuation">,</span> user_output<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% writes to stdout</span></code></pre><h2 id="special-characters" tabindex="-1">Special Characters</h2><table><thead><tr><th>Characters</th><th>Meaning</th></tr></thead><tbody><tr><td><code>:-</code></td><td>if; used to define rules</td></tr><tr><td><code>,</code></td><td>logical and</td></tr><tr><td><code>;</code></td><td>logical or</td></tr><tr><td><code>not</code></td><td>logical not</td></tr><tr><td><code>?-</code></td><td>begins a query</td></tr><tr><td><code>.</code></td><td>terminates all commands</td></tr><tr><td><code>%</code></td><td>begins single-line comment</td></tr><tr><td><code>/*</code> and <code>*/</code></td><td>delimits multi-line comment</td></tr></tbody></table><h2 id="naming-conventions" tabindex="-1">Naming Conventions</h2><p>Atoms are sequences of letters, numbers, and underscores that begin with a lowercase letter. They can also be any text enclosed in single quotes (allows spaces). There are also the following special atoms: <code>;</code>, <code>!</code>, <code>[]</code>, and <code>{}</code>.</p><p>Variables are also sequences of letters, numbers, and underscores, but they begin with an uppercase letter or an underscore. An underscore by itself represents an anonymous variable. These can be used as arguments to predicates when the value of an argument does not matter.</p><h2 id="operators" tabindex="-1">Operators</h2><p>Prolog operators can be prefix, infix, or postfix. Of the built-in operators, most are infix, a few are prefix, and none are postfix. Prefix operators are noted below.</p><p>Each operator has left, right, or no associativity.</p><p>Operators can be used in function form. For example, infix operators like <code>+</code> whose usage s typically written like <code>a + b</code> can instead be written as <code>+(a, b)</code>. As another example, <code>X is 3 * (1 + 2).</code> gives the same result (<code>9</code>) as <code>X is *(3, +(1, 2)).</code></p><p>The <code>write_canonical</code> predicate takes any term and outputs it in its equivalent function notation. For example, entering <code>write_canonical(3 * 1 + 2).</code> outputs <code>*(3,+(1,2))</code>.</p><p>Prolog supports the following relational operators for numbers and arithmetic expressions. When the left and/or right side is an expression (ex. <code>X * 2</code>) it is evaluated before the comparison is performed.</p><table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code>=:=</code></td><td>equal value</td></tr><tr><td><code>=\=</code></td><td>not equal value</td></tr><tr><td><code>&lt;</code></td><td>less than</td></tr><tr><td><code>&gt;</code></td><td>greater than</td></tr><tr><td><code>=&lt;</code></td><td>less than or equal</td></tr><tr><td><code>&gt;=</code></td><td>greater than or equal</td></tr></tbody></table><p>Prolog supports the following relational operators for strings:</p><table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code>@&lt;</code></td><td>alphabetically less than</td></tr><tr><td><code>@=&lt;</code></td><td>alphabetically less than or equal</td></tr><tr><td><code>@&gt;</code></td><td>alphabetically greater than</td></tr><tr><td><code>@&gt;=</code></td><td>alphabetically greater than or equal</td></tr></tbody></table><p>Prolog supports the following relational operators for single and compound terms:</p><table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code>==</code></td><td>identical terms</td></tr><tr><td><code>\==</code></td><td>not identical terms</td></tr><tr><td><code>=@=</code></td><td>structurally equivalent terms</td></tr><tr><td><code>\=@=</code></td><td>not structurally equivalent terms</td></tr></tbody></table><p>The <code>dif/2</code> predicate is an alternative to the <code>\==</code> operator. For example, <code>dif(a, b)</code> is the same as <code>a \== b</code>.</p><p>The odd syntax for &quot;equal&quot; and &quot;not equal&quot; was chosen because <code>=</code> is used for unification.</p><p>The odd syntax for &quot;less than or equal&quot; was chosen so it doesn't look like an arrow.</p><p>The following tests demonstrate many of the relational operators:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">test</span><span class="token punctuation">(</span>equal<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  X <span class="token operator">is</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  Y <span class="token operator">is</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  X <span class="token operator">=:=</span> Y<span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>not_equal<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  X <span class="token operator">is</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  Y <span class="token operator">is</span> <span class="token number">2</span><span class="token punctuation">,</span><br>  X <span class="token operator">=\=</span> Y<span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>alphabetically<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token string">'dog'</span> <span class="token operator">@&lt;</span> <span class="token string">'fox'</span><span class="token punctuation">,</span><br>  <span class="token string">'fox'</span> <span class="token operator">@></span> <span class="token string">'dog'</span><span class="token punctuation">,</span><br>  <span class="token string">'dog'</span> <span class="token operator">==</span> <span class="token string">'dog'</span><span class="token punctuation">,</span><br>  <span class="token string">'dog'</span> <span class="token operator">@=&lt;</span> <span class="token string">'dog'</span><span class="token punctuation">,</span><br>  <span class="token string">'dog'</span> <span class="token operator">@>=</span> <span class="token string">'dog'</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>identical<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">x</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">x</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% same functor name and argument variables</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>not_identical<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">x</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">\==</span> <span class="token function">x</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% different argument variables</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>structurally_equivalent<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">x</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">=@=</span> <span class="token function">x</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>not_structurally_equivalent<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">x</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">\=@=</span> <span class="token function">x</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> D<span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">% different arity</span><br>  <span class="token function">x</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span> <span class="token operator">\=@=</span> <span class="token function">y</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> D<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% different functor name</span></code></pre><p>Prolog supports the following arithmetic operators:</p><table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code>+</code></td><td>addition (infix and prefix)</td></tr><tr><td><code>-</code></td><td>subtraction (infix and prefix)</td></tr><tr><td><code>*</code></td><td>multiplication</td></tr><tr><td><code>/</code></td><td>floating point division</td></tr><tr><td><code>//</code></td><td>integer division</td></tr><tr><td><code>div</code></td><td>integer division</td></tr><tr><td><code>rem</code></td><td>remainder of integer division</td></tr><tr><td><code>rdiv</code></td><td>rational number division</td></tr><tr><td><code>mod</code></td><td>modulo</td></tr><tr><td><code>**</code></td><td>exponentiation</td></tr><tr><td><code>^</code></td><td>exponentiation</td></tr></tbody></table><p>Prolog supports the following bitwise operators:</p><p>Prolog supports the following additional operators:</p><table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code>/\</code></td><td>bitwise and</td></tr><tr><td><code>\/</code></td><td>bitwise or</td></tr><tr><td><code>xor</code></td><td>bitwise exclusive or</td></tr><tr><td><code>\</code></td><td>bitwise not (prefix)</td></tr><tr><td><code>&lt;&lt;</code></td><td>bitwise shift left</td></tr><tr><td><code>&gt;&gt;</code></td><td>bitwise shift right</td></tr></tbody></table><p>TODO: Finish documenting the meaning of some of these operators.</p><table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code>--&gt;</code></td><td>used in grammar rules for implementing parsers</td></tr><tr><td><code>:-</code></td><td>appears between the head and body of every rule; read as &quot;if&quot;</td></tr><tr><td><code>?-</code></td><td>prefix operator that appears before every query</td></tr><tr><td><code>|</code></td><td>separates the head and tail of a list in <code>[H| T]</code></td></tr><tr><td><code>,</code></td><td>separates terms to be and'ed</td></tr><tr><td><code>;</code></td><td>separates terms to be or'ed</td></tr><tr><td><code>-&gt;</code></td><td>similar to ternary operator <code>?:</code> in other languages; called &quot;if-then&quot;</td></tr><tr><td><code>\+</code></td><td>prefix operator that succeeds when the goal that follows does not hold</td></tr><tr><td><code>=</code></td><td>attempts to unify LHS with RHS</td></tr><tr><td><code>\=</code></td><td>tests whether two terms cannot be unified</td></tr><tr><td><code>=..</code></td><td>equates a term with a list containing its functor name and arguments; called &quot;univ&quot;</td></tr><tr><td><code>is</code></td><td>attempts to unify LHS with RHS arithmetic expression result</td></tr><tr><td><code>&gt;:&lt;</code></td><td>partial unification between to dictionaries</td></tr><tr><td><code>!</code></td><td>cut; prevents further backtracking</td></tr><tr><td><code>$</code></td><td>similar to <code>!</code> TODO How does it differ?</td></tr><tr><td><code>*-&gt;</code></td><td>soft cut; rarely used</td></tr><tr><td><code>:=</code></td><td>evaluates RHS as JavaScript (odd!)</td></tr><tr><td><code>:&lt;</code></td><td>succeeds when LHS is a sub-dict of RHS dict</td></tr><tr><td><code>?</code></td><td>TODO: Does this compose two predicates?</td></tr><tr><td><code>:</code></td><td></td></tr><tr><td><code>\_</code></td><td></td></tr><tr><td><code>/</code></td><td></td></tr><tr><td><code>.</code></td><td></td></tr><tr><td><code>as</code></td><td></td></tr><tr><td><code>=&gt;</code></td><td></td></tr></tbody></table><p>The <code>:-</code> prefix operator marks a directive to the Prolog system. For example, <code>:- use_module(library(clpfd)).</code></p><p>There are two primary differences between <code>=</code> and <code>is</code>. The first is that the RHS of <code>is</code> must be an arithmetic expression. The second is that <code>is</code> evaluates the RHS whereas <code>=</code> does not.</p><p>One way to evaluate a mathematical expression is to assign it to a variable. For example, we can compute the angle in degrees whose <code>sin</code> is <code>0.5</code> as follows:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% The asin function returns an angle in radians.</span><br><span class="token operator">?-</span> Angle <span class="token operator">is</span> <span class="token function">asin</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">180</span> <span class="token operator">/</span> pi<span class="token operator">.</span><br>Angle <span class="token operator">=</span> <span class="token number">29.999999999999996</span><span class="token operator">.</span></code></pre><p>After evaluating this, the variable <code>Angle</code> is no longer defined.</p><h3 id="custom-operators" tabindex="-1">Custom Operators</h3><p>Custom operators can be defined. There are two required parts, declaration and implementation. The <code>op</code> predicate declares the precedence, type, and name of an operator.</p><p>The precedence is a number between 0 and 1200 where 0 removes the declaration and 1 is the highest precedence. This is used to determine the order in which operators are evaluated in expressions that include multiple operators.</p><p>The type defines whether the operator is:</p><ul><li>prefix: <code>fx</code> or <code>fy</code></li><li>infix: <code>xfx</code>, <code>xfy</code>, or <code>yfx</code></li><li>postfix: <code>xf</code> or <code>yf</code></li></ul><p>The name can be any symbol.</p><p>The following code defines an operator named <code>dbl</code> that doubles a number:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">arithmetic_function</span><span class="token punctuation">(</span><span class="token function">dbl/1</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token operator">:-</span> <span class="token function">op</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token builtin">fx</span><span class="token punctuation">,</span> dbl<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">dbl</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span> <span class="token operator">:-</span> Y <span class="token operator">is</span> X <span class="token operator">*</span> <span class="token number">2.</span><br><br><span class="token operator">?-</span> X <span class="token operator">is</span> dbl <span class="token number">5.</span> <span class="token comment">% gives 10</span></code></pre><p>The expression <code>dbl 5</code> generates the arithmetic expression <code>5 * 2</code> and the <code>is</code> operator evaluates that to get <code>10</code>.</p><p>Existing operators, except the comma operator, can be redefined. The <code>|</code> operator can only be redefined as an infix operator whose precedence is at least 1001.</p><p>The <code>current_op</code> predicate queries operators. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% Get the priority and type of the "is" operator.</span><br><span class="token function">current_op</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> T<span class="token punctuation">,</span> <span class="token string">'is'</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is P = 700, T = xfx.</span><br><br><span class="token comment">% Get all prefix operators.</span><br><span class="token function">current_op</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span> <span class="token builtin">fx</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is P = 1, N = ($); and many more</span><br><span class="token comment">% All the names are output inside parentheses. Why?</span></code></pre><h2 id="strings" tabindex="-1">Strings</h2><p>Literal strings can be delimited with single or double quotes. SWI-Prolog prefers double quotes. To escape a quote inside a literal string, precede it with a backslash.</p><p>A string is represented by a list of characters. In some implementations, such as Scryer Prolog, this is the case by default. In others, such as SWI-Prolog, this must be enabled with <code>?- set_prolog_flag(double_quotes, chars).</code> This means predicates that operate on lists can also operate on strings.</p><p>To get the length of a string, use the <code>atom_length</code> function. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">atom_length</span><span class="token punctuation">(</span><span class="token string">"Mark"</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token number">4.</span></code></pre><p>To create a list of ASCII values from a literal string, use the <code>name</code> function. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token string">'ABC'</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">]</span><span class="token operator">.</span></code></pre><p>To create a string from a list of ASCII values, also use the <code>name</code> function. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">name</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token string">'ABC'</span><span class="token operator">.</span></code></pre><p>To append two strings, convert them to lists of ASCII codes, append those lists, and convert the result back to a string. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">appendStrings</span><span class="token punctuation">(</span>S1<span class="token punctuation">,</span> S2<span class="token punctuation">,</span> SR<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">name</span><span class="token punctuation">(</span>S1<span class="token punctuation">,</span> L1<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">name</span><span class="token punctuation">(</span>S2<span class="token punctuation">,</span> L2<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">append</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">,</span> LR<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">name</span><span class="token punctuation">(</span>SR<span class="token punctuation">,</span> LR<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">appendStrings</span><span class="token punctuation">(</span><span class="token string">'first '</span><span class="token punctuation">,</span> <span class="token string">'second'</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token operator">.</span><br>X <span class="token operator">=</span> <span class="token string">'first second'</span></code></pre><p>To get a single character from a string, convert it to a list of ASCII codes, and use the <code>nth0</code> function. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"Mark"</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">nth0</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> L<span class="token punctuation">,</span> C<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">put</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% 114 (ASCII code for 'r')</span></code></pre><h2 id="arithmetic-functions" tabindex="-1">Arithmetic Functions</h2><p>Prolog supports a large number of functions that return a number. See <a href="https://www.swi-prolog.org/pldoc/man?section=functions?v=1.0.21" rel="noopener" target="_blank">Arithmetic Functions</a>. These include</p><ul><li><code>abs</code>: absolute value</li><li>bitwise operations such as shift and <code>xor</code></li><li><code>ceiling</code>: smallest integer that is greater than or equal to a value</li><li><code>e</code>: value of e (2.71828...)</li><li><code>floor</code>: largest integer that is less than or equal to a value</li><li><code>exp</code>: e to a given power</li><li><code>gcd</code>: greatest common denominator</li><li><code>inf</code>: positive infinity</li><li><code>lcm</code>: least common multiple</li><li><code>log</code>: logarithm base e (natural logarithm)</li><li><code>log10</code>: logarithm base 10</li><li><code>max</code>: maximum of two values</li><li><code>min</code>: minimum of two values</li><li><code>nan</code>: not a number value</li><li><code>pi</code>: value of pi (3.14159...)</li><li><code>random</code>: random integer between zero and an upper bound</li><li><code>random_float</code>: random float between zero and one (exclusive on both ends)</li><li><code>succ</code>: successive value; <code>succ(2, X)</code> gives <code>3</code>; <code>succ(X, 3)</code> gives <code>2</code></li><li><code>truncate</code>: similar to <code>floor</code>, but rounds toward zero for negative numbers</li><li>trigonometry functions</li></ul><h2 id="conditional-logic" tabindex="-1">Conditional Logic</h2><p>Prolog does not have the equivalent of an <code>if</code> or <code>select</code> statement found in many other programming languages. But it does have the <code>-&gt;</code> operator which is somewhat like the ternary operator in other programming languages. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">sign_word</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token punctuation">(</span>X <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">-></span> Y <span class="token operator">=</span> <span class="token string">'zero'</span><span class="token operator">;</span><br>  <span class="token punctuation">(</span>X <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">-></span> Y <span class="token operator">=</span> <span class="token string">'positive'</span><span class="token operator">;</span><br>  Y <span class="token operator">=</span> <span class="token string">'negative'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span></code></pre><h2 id="iteration" tabindex="-1">Iteration</h2><p>Iteration in Prolog is done with recursion.</p><p>To get all the integers starting from one integer and ending at another, use the <code>between</code> function. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% This sets V to 3, 4, 5, 6, and 7.</span><br><span class="token operator">?-</span> <span class="token function">between</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>The <code>between</code> predicate can also be used to test whether a value is between two numbers inclusively. For example, the following are equivalent:</p><pre class="language-prolog"><code class="language-prolog">Row <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">,</span> Row <span class="token operator">=&lt;</span> <span class="token number">7.</span><br><span class="token function">between</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> Row<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><h2 id="help" tabindex="-1">Help</h2><p>To find information about built-ins related to a specific word in SWI-Prolog, enter <code>apropos(word).</code>. For example, <code>apropos(pair).</code> outputs the following:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% LIB pairs_keys/2                        Remove the values from a list of Key-Value pairs.</span><br><span class="token comment">% LIB pairs_values/2                      Remove the keys from a list of Key-Value pairs.</span><br><span class="token comment">% LIB pairs_keys_values/3                 True if Keys holds the keys of Pairs and Values the values.</span><br><span class="token comment">% SWI dict_pairs/3                        Bi-directional mapping between a dict and an ordered list of pairs (see secti ...</span><br><span class="token comment">%   C 'PL_is_pair'()                      Returns non-zero if term is a compound term using the list constructor.</span><br><span class="token comment">% SWI stream_pair/3                       This predicate can be used in mode (-,+,+) to create a stream-pair from an in ...</span><br><span class="token comment">% SEC 'summary-lib-pairs'                 library(pairs)</span><br><span class="token comment">% LIB protobuf_map_pairs/3                Convert between a list of protobuf map entries (in the form DictTag{key:Key,  ...</span><br><span class="token comment">% LIB transpose_pairs/2                   Swap Key-Value to Value-Key.</span><br><span class="token comment">% LIB json_dict_pairs/2                   This hook may be used to order the keys of an object.</span><br><span class="token comment">% LIB map_list_to_pairs/3                 Create a Key-Value list by mapping each element of List.</span><br><span class="token comment">% LIB group_pairs_by_key/2                Group values with equivalent (==/2) consecutive keys.</span><br><span class="token comment">% ISO keysort/2                           Sort a list of pairs.</span><br><span class="token comment">% LIB all_distinct/1                      True iff Vars are pairwise distinct.</span><br><span class="token comment">%   C 'PL_clear_hash_table'()             Delete all key-value pairs from the table.</span><br><span class="token comment">%   C 'PL_advance_hash_table_enum'()      Get the next key-value pair from a cursor.</span><br><span class="token comment">%   C 'PL_new_hash_table'()               Create a new table for size key-value pairs.</span><br><span class="token comment">% SEC pairs                               library(pairs): Operations on key-value lists</span><br><span class="token comment">% LIB assoc_to_list/2                     Translate Assoc to a list Pairs of Key-Value pairs.</span><br><span class="token comment">%   C 'PL_STRINGS_MARK'()                 These macros must be paired and create a C block ({...}).</span><br><span class="token comment">% Showing 20 of 52 matches</span><br><span class="token comment">%</span><br><span class="token comment">% Use ?- apropos(Type:Query) or multiple words in Query</span><br><span class="token comment">% to restrict your search.  For example:</span><br><span class="token comment">%</span><br><span class="token comment">%   ?- apropos(iso:open).</span><br><span class="token comment">%   ?- apropos('open file').</span></code></pre><p>For more detailed help on a specific predicate, enter <code>help(functor/arity).</code> For example, <code>help(between/3).</code></p><h2 id="listing" tabindex="-1">Listing</h2><p>To list all the clauses (facts and rules) known in the current session, enter <code>listing.</code>. The output will contain many built-in clauses in addition to those you loaded.</p><p>To list only the clauses for a given functor name, enter <code>listing(functor-name).</code> This will list all matching clauses regardless of arity.</p><p>For example, <code>listing(append).</code> shows the implementation of this functor name.</p><h2 id="debugging-1" tabindex="-1">Debugging</h2><p>To see all the steps used to evaluate a predicate, turn on trace mode by entering <code>trace.</code></p><p>Enter a query and press the return key after viewing the result of each step in the evaluation.</p><p>When finished debugging, enter <code>notrace.</code> to turn this mode off.</p><h2 id="calling-from-other-languages" tabindex="-1">Calling From Other Languages</h2><p>SWI-Prolog can be called from C. See <a href="https://www.swi-prolog.org/pldoc/man?section=calling-prolog-from-c?v=1.0.21" rel="noopener" target="_blank">Calling Prolog from C</a>.</p><p>TODO: Which other programming languages can call SWI-Prolog?</p><h2 id="efficiency" tabindex="-1">Efficiency</h2><p>For information about the performance of Prolog, see <a href="https://www.metalevel.at/prolog/efficiency?v=1.0.21" rel="noopener" target="_blank">Efficiency of Prolog</a>.</p><h2 id="constraint-logic-programming-over-finite-domains%3A-clp(fd)" tabindex="-1">Constraint Logic Programming over Finite Domains: CLP(FD)</h2><p>The library <a href="https://www.swi-prolog.org/man/clpfd.html?v=1.0.21" rel="noopener" target="_blank">clpfd</a> implements Constraint Logic Programming over Finite Domains. This supports two primary use cases:</p><ul><li>declarative integer arithmetic</li><li>combinatorial problems</li></ul><p>This library supports a different, powerful way to write Prolog rules.</p><p>For example, the following rules describe the relationship between a geometry shape and its area:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">use_module</span><span class="token punctuation">(</span><span class="token function">library</span><span class="token punctuation">(</span>clpr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">area</span><span class="token punctuation">(</span>circle<span class="token punctuation">,</span> Radius<span class="token punctuation">,</span> X<span class="token punctuation">)</span> <span class="token operator">:-</span> Pi <span class="token operator">is</span> pi<span class="token punctuation">,</span> <span class="token punctuation">{</span>X <span class="token operator">=</span> Pi <span class="token operator">*</span> Radius<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">.</span><br><span class="token function">area</span><span class="token punctuation">(</span>square<span class="token punctuation">,</span> Side<span class="token punctuation">,</span> X<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token punctuation">{</span>X <span class="token operator">=</span> Side<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">.</span><br><span class="token function">area</span><span class="token punctuation">(</span>rectangle<span class="token punctuation">,</span> Width<span class="token punctuation">,</span> Height<span class="token punctuation">,</span> X<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token punctuation">{</span>X <span class="token operator">=</span> Width <span class="token operator">*</span> Height<span class="token punctuation">}</span><span class="token operator">.</span></code></pre><p>The following is another way to describe the relationship between a circle and its area without using CLP:</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">radius_area</span><span class="token punctuation">(</span>R<span class="token punctuation">,</span> A<span class="token punctuation">)</span> <span class="token operator">:-</span><br>    <span class="token function">ground</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">% tests whether R is not a free variable</span><br>    A <span class="token operator">is</span> pi <span class="token operator">*</span> R<span class="token operator">^</span><span class="token number">2.</span><br><br><span class="token function">radius_area</span><span class="token punctuation">(</span>R<span class="token punctuation">,</span> A<span class="token punctuation">)</span> <span class="token operator">:-</span><br>    <span class="token function">ground</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">% tests whether A is not a free variable</span><br>    R <span class="token operator">is</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>A <span class="token operator">/</span> pi<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>When using CLP, compare values with <code>#=</code> instead of <code>=:=</code>.</p><h2 id="unit-tests" tabindex="-1">Unit Tests</h2><p>SCI-Prolog includes a unit testing framework called &quot;Test Box&quot;. See <a href="https://www.swi-prolog.org/pldoc/doc_for?object=section(%27packages/plunit.html%27)?v=1.0.21" rel="noopener" target="_blank">Prolog Unit Tests</a>.</p><p>Code for unit tests can be placed in the same source file as the rules they test. Alternatively, test code can be placed in a separate file with an extension of <code>.plt</code>.</p><p>The following code demonstrates implementing unit tests for the built-in <code>append</code> rule.</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% This line is only needed to load predicates from another file.</span><br><span class="token comment">% :- consult({file-name}).</span><br><br><span class="token operator">:-</span> <span class="token function">begin_tests</span><span class="token punctuation">(</span>append<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>append_assertions<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>append_make_first<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">append</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">assertion</span><span class="token punctuation">(</span>X <span class="token operator">==</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token operator">!.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>append_make_second<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">assertion</span><span class="token punctuation">(</span>X <span class="token operator">==</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">test</span><span class="token punctuation">(</span>append_make_third<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">assertion</span><span class="token punctuation">(</span>X <span class="token operator">==</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token operator">:-</span> <span class="token function">end_tests</span><span class="token punctuation">(</span>append<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token operator">:-</span> run_tests<span class="token operator">.</span><br><span class="token operator">:-</span> halt<span class="token operator">.</span></code></pre><p>If the code above is in a file named <code>append.plt</code> then the tests can be run by entering <code>swipl append.plt</code>. If the last two lines in the code above are omitted, use the following instead: <code>swipl -g run_tests -t halt your/file.pl</code></p><p>The <code>test</code> rule takes a test name (atom or string) and an optional list of options. Supported options include:</p><ul><li><code>setup</code>: takes a goal to execute before the test is run</li><li><code>cleanup</code>: takes a goal to execute after the test is run</li><li><code>forall</code>: takes a generator and runs the test for each generated value</li><li><code>throws</code>: takes an error and verifies that the test throws the error</li><li><code>error</code>: takes an error and verifies that the test throws <code>error(Error, _Context)</code></li><li>several other options that seem less valuable</li></ul><p>The <code>assertion</code> rule prints assertions that fail. When this is not used, the output will only provide the name of the test that failed.</p><p>If a test ends with a choice point, a warning message will be output. To prevent this, end the test with the cut operator (<code>, !.</code>) or include the option <code>nondet</code>.</p><h2 id="sudoku" tabindex="-1">Sudoku</h2><p>Prolog can be used to solve puzzles such as <a href="https://en.wikipedia.org/wiki/Sudoku?v=1.0.21" rel="noopener" target="_blank">Sudoku</a>.</p><p>The following code is based on code from Markus Triska in the SWI-Prolog manual.</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">use_module</span><span class="token punctuation">(</span><span class="token function">library</span><span class="token punctuation">(</span>clpfd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">sudoku</span><span class="token punctuation">(</span>Rows<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token comment">% Verify that Rows is a list with 9 elements.</span><br>  <span class="token function">length</span><span class="token punctuation">(</span>Rows<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Verify that all elements are lists</span><br>  <span class="token comment">% with the same length as Rows which is 9.</span><br>  <span class="token function">maplist</span><span class="token punctuation">(</span><span class="token function">same_length</span><span class="token punctuation">(</span>Rows<span class="token punctuation">)</span><span class="token punctuation">,</span> Rows<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Create a flattened list of all the values (Vs), and verify</span><br>  <span class="token comment">% that all elements in Vs are a number in the range 1 to 9.</span><br>  <span class="token function">append</span><span class="token punctuation">(</span>Rows<span class="token punctuation">,</span> Vs<span class="token punctuation">)</span><span class="token punctuation">,</span> Vs ins <span class="token number">1.</span><span class="token operator">.</span><span class="token number">9</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Verify that all element values in all rows</span><br>  <span class="token comment">% are unique within their row.</span><br>  <span class="token function">maplist</span><span class="token punctuation">(</span>all_distinct<span class="token punctuation">,</span> Rows<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Create a list of lists that represent the columns.</span><br>  <span class="token function">transpose</span><span class="token punctuation">(</span>Rows<span class="token punctuation">,</span> Columns<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Verify that all element values in all columns</span><br>  <span class="token comment">% are unique within their column.</span><br>  <span class="token function">maplist</span><span class="token punctuation">(</span>all_distinct<span class="token punctuation">,</span> Columns<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Assign a variable name to each of the 9 rows.</span><br>  <span class="token punctuation">[</span>R1<span class="token punctuation">,</span> R2<span class="token punctuation">,</span> R3<span class="token punctuation">,</span> R4<span class="token punctuation">,</span> R5<span class="token punctuation">,</span> R6<span class="token punctuation">,</span> R7<span class="token punctuation">,</span> R8<span class="token punctuation">,</span> R9<span class="token punctuation">]</span> <span class="token operator">=</span> Rows<span class="token punctuation">,</span><br><br>  <span class="token comment">% Verify that the element values in every 3x3 block</span><br>  <span class="token comment">% are unique within their block.</span><br>  <span class="token function">blocks</span><span class="token punctuation">(</span>R1<span class="token punctuation">,</span> R2<span class="token punctuation">,</span> R3<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">blocks</span><span class="token punctuation">(</span>R4<span class="token punctuation">,</span> R5<span class="token punctuation">,</span> R6<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">blocks</span><span class="token punctuation">(</span>R7<span class="token punctuation">,</span> R8<span class="token punctuation">,</span> R9<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% When a block is empty, its element values (which are none)</span><br><span class="token comment">% can be considered unique.</span><br><span class="token function">blocks</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% When a block is not empty, get its 9 values</span><br><span class="token comment">% and verify that they are unique.</span><br><span class="token function">blocks</span><span class="token punctuation">(</span><span class="token punctuation">[</span>R1C1<span class="token punctuation">,</span>R1C2<span class="token punctuation">,</span>R1C3<span class="token operator">|</span>T1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>R2C1<span class="token punctuation">,</span>R2C2<span class="token punctuation">,</span>R2C3<span class="token operator">|</span>T2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>R3C1<span class="token punctuation">,</span>R3C2<span class="token punctuation">,</span>R3C3<span class="token operator">|</span>T3<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">all_distinct</span><span class="token punctuation">(</span><span class="token punctuation">[</span>R1C1<span class="token punctuation">,</span> R1C2<span class="token punctuation">,</span> R1C3<span class="token punctuation">,</span> R2C1<span class="token punctuation">,</span> R2C2<span class="token punctuation">,</span> R2C3<span class="token punctuation">,</span> R3C1<span class="token punctuation">,</span> R3C2<span class="token punctuation">,</span> R3C3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">blocks</span><span class="token punctuation">(</span>T1<span class="token punctuation">,</span> T2<span class="token punctuation">,</span> T3<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% When there a no more rows, stop printing.</span><br><span class="token function">print_rows</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% When there are more rows, print the first row.</span><br><span class="token function">print_rows</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">print_row</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">print_rows</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% When the last element of a row has been printed, print a newline.</span><br><span class="token function">print_row</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:-</span> nl<span class="token operator">.</span><br><br><span class="token comment">% When there are more row elements,</span><br><span class="token comment">% print the first one followed by a space.</span><br><span class="token function">print_row</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"~w "</span><span class="token punctuation">,</span> H<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">print_row</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% Each puzzle must contain at least 17 clues.</span><br><br><span class="token function">problem</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">% can solve</span><br>  <span class="token punctuation">[</span><span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">]</span><span class="token punctuation">,</span><br>   <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>   <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">]</span><span class="token punctuation">,</span><br><br>   <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">]</span><span class="token punctuation">,</span><br>   <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">]</span><span class="token punctuation">,</span><br>   <span class="token punctuation">[</span>_<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">]</span><span class="token punctuation">,</span><br><br>   <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>   <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">]</span><span class="token punctuation">,</span><br>   <span class="token punctuation">[</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span>_<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token operator">:-</span> <span class="token function">problem</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> Rows<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">sudoku</span><span class="token punctuation">(</span>Rows<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">print_rows</span><span class="token punctuation">(</span>Rows<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>This outputs the following solution:</p><pre class="language-text"><code class="language-text">9 8 7 6 5 4 3 2 1<br>2 4 6 1 7 3 9 8 5<br>3 5 1 9 2 8 7 4 6<br>1 2 8 5 3 7 6 9 4<br>6 3 4 8 9 2 1 5 7<br>7 9 5 4 6 1 8 3 2<br>5 1 9 2 8 6 4 7 3<br>4 7 2 3 1 9 5 6 8<br>8 6 3 7 4 5 2 1 9</code></pre><h2 id="einstein's-riddle" tabindex="-1">Einstein's Riddle</h2><p>Einstein's riddle, aka <a href="https://en.wikipedia.org/wiki/Zebra_Puzzle?v=1.0.21" rel="noopener" target="_blank">Zebra Puzzle</a>, describes a set of known facts and relationships and asks you to find some set of unknown values.</p><p>There are several examples of this type of puzzle.</p><p>One begins with &quot;Three kids went to a superheroes dress birthday party.&quot; The following code solves this puzzle.</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% The names of the three kids are Ethan, Ali and Anya.</span><br><span class="token function">kid</span><span class="token punctuation">(</span>ethan<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">kid</span><span class="token punctuation">(</span>ali<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">kid</span><span class="token punctuation">(</span>anya<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% They dressed up as Spiderman, Captain America and Iron Man.</span><br><span class="token function">hero</span><span class="token punctuation">(</span>spiderman<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">hero</span><span class="token punctuation">(</span>captain_america<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">hero</span><span class="token punctuation">(</span>iron_man<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% The kids are 6, 8 and 10 years old.</span><br><span class="token function">age</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">age</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">age</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% Anya was dressed up as Spiderman.</span><br><span class="token function">kid_hero_age</span><span class="token punctuation">(</span>anya<span class="token punctuation">,</span> spiderman<span class="token punctuation">,</span> A<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">age</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% Ethan was not dressed up as Captain America.</span><br><span class="token function">kid_hero_age</span><span class="token punctuation">(</span>ethan<span class="token punctuation">,</span> H<span class="token punctuation">,</span> A<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">hero</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">age</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> H<span class="token operator">\=</span>captain_america<span class="token operator">.</span><br><br><span class="token comment">% The youngest kid dressed up as Spiderman.</span><br><span class="token function">kid_hero_age</span><span class="token punctuation">(</span>K<span class="token punctuation">,</span> spiderman<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">:-</span> <span class="token function">kid</span><span class="token punctuation">(</span>K<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% The kid who is 8 years old dressed up as Captain America.</span><br><span class="token function">kid_hero_age</span><span class="token punctuation">(</span>K<span class="token punctuation">,</span> captain_america<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">kid</span><span class="token punctuation">(</span>K<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% Three values are distinct if this holds.</span><br><span class="token function">different</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> C<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  A <span class="token operator">\=</span> B<span class="token punctuation">,</span> A <span class="token operator">\=</span> C<span class="token punctuation">,</span> B <span class="token operator">\=</span> C<span class="token operator">.</span> <span class="token comment">% use distinct list?</span><br><br><span class="token comment">% Determine the missing information.</span><br><span class="token function">solve</span><span class="token punctuation">(</span>K1<span class="token punctuation">,</span> H1<span class="token punctuation">,</span> A1<span class="token punctuation">,</span> K2<span class="token punctuation">,</span> H2<span class="token punctuation">,</span> A2<span class="token punctuation">,</span> K3<span class="token punctuation">,</span> H3<span class="token punctuation">,</span> A3<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">kid_hero_age</span><span class="token punctuation">(</span>K1<span class="token punctuation">,</span> H1<span class="token punctuation">,</span> A1<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">kid_hero_age</span><span class="token punctuation">(</span>K2<span class="token punctuation">,</span> H2<span class="token punctuation">,</span> A2<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">kid_hero_age</span><span class="token punctuation">(</span>K3<span class="token punctuation">,</span> H3<span class="token punctuation">,</span> A3<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">different</span><span class="token punctuation">(</span>K1<span class="token punctuation">,</span> K2<span class="token punctuation">,</span> K3<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">different</span><span class="token punctuation">(</span>H1<span class="token punctuation">,</span> H2<span class="token punctuation">,</span> H3<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">different</span><span class="token punctuation">(</span>A1<span class="token punctuation">,</span> A2<span class="token punctuation">,</span> A3<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token operator">!.</span><br><br><span class="token operator">:-</span> <span class="token function">solve</span><span class="token punctuation">(</span>K1<span class="token punctuation">,</span> H1<span class="token punctuation">,</span> A1<span class="token punctuation">,</span> K2<span class="token punctuation">,</span> H2<span class="token punctuation">,</span> A2<span class="token punctuation">,</span> K3<span class="token punctuation">,</span> H3<span class="token punctuation">,</span> A3<span class="token punctuation">)</span><span class="token punctuation">,</span><br>   S <span class="token operator">=</span> <span class="token string">"~w is ~w and dressed as ~w.~n"</span><span class="token punctuation">,</span><br>   <span class="token function">format</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> <span class="token punctuation">[</span>K1<span class="token punctuation">,</span> A1<span class="token punctuation">,</span> H1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   <span class="token function">format</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> <span class="token punctuation">[</span>K2<span class="token punctuation">,</span> A2<span class="token punctuation">,</span> H2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   <span class="token function">format</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> <span class="token punctuation">[</span>K3<span class="token punctuation">,</span> A3<span class="token punctuation">,</span> H3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   halt<span class="token operator">.</span></code></pre><p>The output is:</p><pre><code>anya is 6 and dressed as spiderman.
ethan is 10 and dressed as iron_man.
ali is 8 and dressed as captain_america.
</code></pre><p>The classic Zebra puzzle is a bit more difficult. It asks you to determine who owns a zebra.</p><p>There are five nationalities: englishman, japanese, norwegian, spaniard, and ukrainian.</p><p>There are five houses colors: blue, green, ivory, red, and yellow.</p><p>There are five drinks: coffee, milk, orange_juice, tea, and water.</p><p>There are five smokes: chesterfields, kools, lucky_strike, old_gold, and parliaments.</p><p>There are five pets: dog, fox, horse, snails, and zebra.</p><p>The following code solves this puzzle.</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% The relation arguments are Nationality, Color, Drinks, Smokes, and Pet.</span><br><br><span class="token comment">% List element A is on the left of list element B</span><br><span class="token comment">% if appending $ something onto a list</span><br><span class="token comment">% beginning with A,B results in a given list.</span><br><span class="token function">on_left</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> Ls<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">append</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> <span class="token punctuation">[</span>A<span class="token punctuation">,</span>B<span class="token operator">|</span>_<span class="token punctuation">]</span><span class="token punctuation">,</span> Ls<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% List element A is on the right of list element B</span><br><span class="token comment">% if B is on the left of A.</span><br><span class="token function">on_right</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> Ls<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">on_left</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> A<span class="token punctuation">,</span> Ls<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% List elements A and B are adjacent</span><br><span class="token comment">% if A is on the left or right side of B.</span><br><span class="token function">adjacent</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> Ls<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">on_left</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> Ls<span class="token punctuation">)</span><span class="token operator">;</span> <span class="token function">on_right</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> Ls<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% This gets a list of all the houses contain all their details.</span><br><span class="token function">houses</span><span class="token punctuation">(</span>Hs<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token comment">% There are five houses.</span><br>  <span class="token function">length</span><span class="token punctuation">(</span>Hs<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The Englishman lives in the red house.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>englishman<span class="token punctuation">,</span> red<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The Spaniard owns the dog.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>spaniard<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Coffee is drunk in the green house.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> green<span class="token punctuation">,</span> coffee<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The Ukrainian drinks tea.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>ukrainian<span class="token punctuation">,</span> _<span class="token punctuation">,</span> tea<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The green house is immediately to the right of the ivory house.</span><br>  <span class="token function">on_left</span><span class="token punctuation">(</span><br>    <span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> ivory<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> green<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The Old Gold smoker owns snails.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> old_gold<span class="token punctuation">,</span> snails<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Kools are smoked in the yellow house.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> yellow<span class="token punctuation">,</span> _<span class="token punctuation">,</span> kools<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Milk is drunk in the middle house.</span><br>  Hs <span class="token operator">=</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> milk<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">]</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The Norwegian lives in the first house.</span><br>  Hs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">relation</span><span class="token punctuation">(</span>norwegian<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">|</span> _<span class="token punctuation">]</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The man who smokes Chesterfields lives in</span><br>  <span class="token comment">% the house next to the man with the fox.</span><br>  <span class="token function">adjacent</span><span class="token punctuation">(</span><br>    <span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> chesterfields<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> fox<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Kools are smoked in the house next to the house where the horse is kept.</span><br>  <span class="token function">adjacent</span><span class="token punctuation">(</span><br>    <span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> kools<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> horse<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The Lucky Strike smoker drinks orange juice.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> orange_juice<span class="token punctuation">,</span> lucky_strike<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The Japanese smokes Parliaments.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>japanese<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> parliaments<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% The Norwegian lives next to the blue house.</span><br>  <span class="token function">adjacent</span><span class="token punctuation">(</span><br>    <span class="token function">relation</span><span class="token punctuation">(</span>norwegian<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> blue<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span><br>    Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Someone drinks water.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> water<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>  <span class="token comment">% Someone owns a zebra.</span><br>  <span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> zebra<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">zebra_owner</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">:-</span><br>	<span class="token function">houses</span><span class="token punctuation">(</span>Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br>	<span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> zebra<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br>	<span class="token operator">!.</span><br><br><span class="token function">water_drinker</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">:-</span><br>	<span class="token function">houses</span><span class="token punctuation">(</span>Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br>	<span class="token function">member</span><span class="token punctuation">(</span><span class="token function">relation</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> _<span class="token punctuation">,</span> water<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span> Hs<span class="token punctuation">)</span><span class="token punctuation">,</span><br>	<span class="token operator">!.</span><br><br><span class="token function">print_houses</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">print_houses</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">relation</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> C<span class="token punctuation">,</span> D<span class="token punctuation">,</span> S<span class="token punctuation">,</span> P<span class="token punctuation">)</span> <span class="token operator">=</span> H<span class="token punctuation">,</span><br>  <span class="token comment">%S = "The ~w lives in the ~w house, drinks ~w, smokes ~w, and owns a ~w.~n",</span><br>  <span class="token comment">%format(S, [N, C, D, S, P]),</span><br>  <span class="token function">format</span><span class="token punctuation">(</span><br>    <span class="token string">"The ~w lives in the ~w house, drinks ~w, smokes ~w, and owns a ~w.~n"</span><span class="token punctuation">,</span><br>    <span class="token punctuation">[</span>N<span class="token punctuation">,</span> C<span class="token punctuation">,</span> D<span class="token punctuation">,</span> S<span class="token punctuation">,</span> P<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">print_houses</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token operator">:-</span> <span class="token function">houses</span><span class="token punctuation">(</span>Hs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">print_houses</span><span class="token punctuation">(</span>Hs<span class="token punctuation">)</span><span class="token operator">.</span></code></pre><p>The output is:</p><pre><code>The norwegian lives in the yellow house, drinks water, smokes kools, and owns a fox.
The ukrainian lives in the blue house, drinks tea, smokes chesterfields, and owns a horse.
The englishman lives in the red house, drinks milk, smokes old_gold, and owns a snails.
The spaniard lives in the ivory house, drinks orange_juice, smokes lucky_strike, and owns a dog.
The japanese lives in the green house, drinks coffee, smokes parliaments, and owns a zebra.
</code></pre><h2 id="reading-from-urls" tabindex="-1">Reading from URLs</h2><p>The following code prints all the tag names found in an HTML document. They are indented to represent their position in the DOM hierarchy. This was only tested in SWI-Prolog.</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">use_module</span><span class="token punctuation">(</span><span class="token function">library</span><span class="token punctuation">(</span>http<span class="token operator">/</span>http_open<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% for http_open</span><br><br><span class="token comment">% N occurrences of the ASCII code A is described by the string S.</span><br><span class="token comment">% For example, repeat(5, 32, S) sets S to a string containing 5 spaces.</span><br><span class="token function">repeat</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> A<span class="token punctuation">,</span> S<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token function">length</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">maplist</span><span class="token punctuation">(</span><span class="token operator">=</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">atom_codes</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% This is used if 2nd argument is an element structure.</span><br><span class="token comment">% element structure components are Tag, Attributes, and Children.</span><br><span class="token function">print_tag</span><span class="token punctuation">(</span>Level<span class="token punctuation">,</span> <span class="token function">element</span><span class="token punctuation">(</span>Tag<span class="token punctuation">,</span> _<span class="token punctuation">,</span> Children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:-</span>  <span class="token comment">%</span><br>  Indent <span class="token operator">is</span> Level <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span><br>  <span class="token function">repeat</span><span class="token punctuation">(</span>Indent<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> Spaces<span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">write</span><span class="token punctuation">(</span>Spaces<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">write</span><span class="token punctuation">(</span>Tag<span class="token punctuation">)</span><span class="token punctuation">,</span> nl<span class="token punctuation">,</span><br>  NextLevel <span class="token operator">is</span> Level <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  <span class="token function">maplist</span><span class="token punctuation">(</span><span class="token function">print_tag</span><span class="token punctuation">(</span>NextLevel<span class="token punctuation">)</span><span class="token punctuation">,</span> Children<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% This is used if 2nd argument is not an element structure.</span><br><span class="token function">print_tag</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% ignore</span><br><br><span class="token comment">% This provides a starting level of 0.</span><br><span class="token function">print_tag</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">print_tag</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> E<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token function">process</span><span class="token punctuation">(</span>In<span class="token punctuation">)</span> <span class="token operator">:-</span><br>  <span class="token comment">% copy_stream_data(In, user_output). % for debugging</span><br>  <span class="token function">load_html</span><span class="token punctuation">(</span>In<span class="token punctuation">,</span> DOM<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>  <span class="token function">maplist</span><span class="token punctuation">(</span>print_tag<span class="token punctuation">,</span> DOM<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token operator">:-</span> <span class="token function">setup_call_cleanup</span><span class="token punctuation">(</span><br>     <span class="token comment">% Must use single, not double quotes around URL!</span><br>     <span class="token function">http_open</span><span class="token punctuation">(</span><span class="token string">'https://mvolkmann.github.io'</span><span class="token punctuation">,</span> In<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>     <span class="token function">process</span><span class="token punctuation">(</span>In<span class="token punctuation">)</span><span class="token punctuation">,</span><br>     <span class="token function">close</span><span class="token punctuation">(</span>In<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span></code></pre><h2 id="definite-clause-grammars-(dcgs)" tabindex="-1">Definite Clause Grammars (DCGs)</h2><p>A DCG defines a set of grammar rules (GR) where each has the syntax <code>GRHead --&gt; GRBody</code>. These describe a sequence of allowed terminals, non-terminals, and goals. Be careful to include two dashes in the arrow and not just one.</p><p>DCGs are not yet part of the ISO Prolog standard, but they are being considered. Most Prolog implementations already support DCGs.</p><p>DCGs are enabled by default in SWI-Prolog, but not in all Prolog implementations. To enable DCGs, it may be necessary to enter <code>:- use_module(library(dcgs)).</code> This can be added to the configuration file for a Prolog implementation so the <code>dcg</code> library is always available. For example, in Scryer Prolog the configuration file is <code>~/.scryerrc</code>.</p><p><code>F//N</code> refers to the non-terminal <code>F</code> with <code>N</code> arguments.</p><p>Predefined non-terminals include:</p><ul><li><code>(,)//2</code>: concatenation; read as &quot;and then&quot;</li><li><code>(|)//2</code>: alternatives; read as &quot;or&quot;</li></ul><p>The predicate <code>phrase(GRBody, L)</code> holds if <code>L</code> is a list that matches <code>GRBody</code> and nothing remains in <code>L</code>.</p><p>For example, the following grammar rules describe sequences that contain any number of <code>x</code> characters.</p><p>Recall that when the <code>double_quotes</code> flag is set to <code>chars</code> then <code>&quot;abc&quot;</code> is the same as <code>[a, b, c]</code>.</p><pre class="language-prolog"><code class="language-prolog">xs <span class="token operator">--></span> <span class="token string">""</span><span class="token operator">.</span><br>xs <span class="token operator">--></span> <span class="token string">"x"</span><span class="token punctuation">,</span> xs<span class="token operator">.</span><br><br><span class="token comment">% To test solutions ...</span><br><span class="token function">phrase</span><span class="token punctuation">(</span>xs<span class="token punctuation">,</span> <span class="token string">"xyx"</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% false</span><br><span class="token function">phrase</span><span class="token punctuation">(</span>xs<span class="token punctuation">,</span> <span class="token string">"xxx"</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% true</span><br><br><span class="token comment">% To complete solutions ...</span><br><span class="token function">phrase</span><span class="token punctuation">(</span>xs<span class="token punctuation">,</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> A<span class="token punctuation">,</span> x<span class="token punctuation">,</span> x<span class="token punctuation">,</span> B<span class="token punctuation">,</span> x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% solution is A = B, B = x.</span><br><br><span class="token comment">% To generate solutions ...</span><br><span class="token function">phrase</span><span class="token punctuation">(</span>xs<span class="token punctuation">,</span> Ls<span class="token punctuation">)</span><span class="token operator">.</span> <span class="token comment">% finds all possible solutions</span></code></pre><p>Every DSG rule can be translated to a standard Prolog rule which is typically longer. Most DSG implementations do this behind the scenes.</p><p>The predicate <code>seq(L)</code> describes a sequence of values. For example, the following finds all combinations of <code>Xs</code> and <code>Ys</code> values that can be concatenated to form <code>&quot;abc&quot;</code>:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">?-</span> <span class="token function">phrase</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">seq</span><span class="token punctuation">(</span>Xs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">seq</span><span class="token punctuation">(</span>Ys<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% output is:</span><br><span class="token comment">% Xs = [], Ys = "abc"</span><br><span class="token comment">% ;  Xs = "a", Ys = "bc"</span><br><span class="token comment">% ;  Xs = "ab", Ys = "c"</span><br><span class="token comment">% ;  Xs = "abc", Ys = []</span></code></pre><p>The following code implements predicates that are often useful when using DCGs:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% Definition of a sequence.</span><br><span class="token comment">% Scryer Prolog provides this in its dcg library.</span><br><span class="token function">seq</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br><span class="token function">seq</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span>H<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">seq</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><br><span class="token comment">% Concatenation of two lists.</span><br><span class="token function">append</span><span class="token punctuation">(</span>Xs<span class="token punctuation">,</span> Ys<span class="token punctuation">,</span> Zs<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">phrase</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">seq</span><span class="token punctuation">(</span>Xs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">seq</span><span class="token punctuation">(</span>Ys<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Zs<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% append("abc", "xyz", L), writeln(L). % output is [a,b,c,x,y,z]</span><br><br><span class="token comment">% Concatenation of any number of lists.</span><br><span class="token comment">% Scryer Prolog provides this in its dcg library.</span><br><span class="token function">seqq</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br><span class="token function">seqq</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token function">seq</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">seqq</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% phrase(seqq(["ab", "cd", "ef"]), L), writeln(L). % output is [a,b,c,d,e,f].</span><br><br><span class="token comment">% qes is the reverse of seq.</span><br><span class="token function">qes</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br><span class="token function">qes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token function">qes</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>H<span class="token punctuation">]</span><span class="token operator">.</span><br><br><span class="token function">palindrome</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span> <span class="token operator">:-</span> <span class="token function">phrase</span><span class="token punctuation">(</span><span class="token function">qes</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">,</span> L<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">% palindrome("mother"). % false</span><br><span class="token comment">% palindrome("mom"). % true</span><br><br><span class="token comment">% This describes any sequence.</span><br><span class="token operator">...</span> <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token operator">.</span><br><br><span class="token comment">% ... can be used to get the last element in a list.</span><br><span class="token comment">% phrase((..., [Last]), "xyz"). % output is Last = z; false.</span><br><br><span class="token comment">% ... can be used to determine if a given sublist</span><br><span class="token comment">% occurs anywhere in a list.</span><br><span class="token comment">% phrase((..., "y", ...), "xyz"). % output is true</span><br><span class="token comment">% phrase((..., "ar", ...), "Mark"). % output is true</span><br><br><span class="token comment">% ... can be used to determine if</span><br><span class="token comment">% any element occurs twice in succession in a list.</span><br><span class="token comment">% phrase((..., [X, X], ...), "Mississippi"). % finds s, s, and p</span></code></pre><p>A DCG can be used to describe a tree structure.</p><pre class="language-prolog"><code class="language-prolog"><span class="token function">nodes</span><span class="token punctuation">(</span>nil<span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br><span class="token function">nodes</span><span class="token punctuation">(</span><span class="token function">node</span><span class="token punctuation">(</span>Node<span class="token punctuation">,</span> L<span class="token punctuation">,</span> R<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span>Node<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">nodes</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">nodes</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token comment">/*<br>phrase(<br>  nodes(<br>    node(<br>      a,<br>      nil,<br>      node(<br>        b,<br>        node(c, nil, nil),<br>        nil<br>      )<br>    )<br>  ),<br>  L<br>). % output is a list of the leaf node values [a, b, c].<br>*/</span></code></pre><p>DCGs can be used for parsing by describing a relationship between lists of characters and syntax trees.</p><p>Grammar bodies can contain Prolog goals in curly braces.</p><p>To enable termination it is sometimes useful to include <code>{false}</code>.</p><p>Another way to achieve termination is to use a different execution strategy such as &quot;SLG resolution&quot;. To enable this, execute the following:</p><pre class="language-prolog"><code class="language-prolog"><span class="token operator">:-</span> <span class="token function">use_module</span><span class="token punctuation">(</span><span class="token function">library</span><span class="token punctuation">(</span>tabling<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token operator">:-</span> table expr<span class="token operator">//</span><span class="token number">0.</span></code></pre><p>The following DCG that describes sequences like <code>1+1+1</code> doesn't naturally terminate due to its use of left recursion. However, it does terminate when SLG resolution is enabled.</p><pre class="language-prolog"><code class="language-prolog">expr <span class="token operator">--></span> <span class="token string">"1"</span><span class="token operator">.</span><br>expr <span class="token operator">--></span> expr<span class="token punctuation">,</span> <span class="token string">"+"</span><span class="token punctuation">,</span> expr<span class="token operator">.</span> <span class="token comment">% uses left recursion</span></code></pre><p>This can be rewritten as follows so it terminates without SLG resolution.</p><pre class="language-prolog"><code class="language-prolog">expr <span class="token operator">--></span> <span class="token string">"1"</span><span class="token punctuation">,</span> expr_rest<span class="token operator">.</span><br>expr_rest <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br>expr_rest <span class="token operator">--></span> <span class="token string">"+"</span><span class="token punctuation">,</span> expr<span class="token operator">.</span></code></pre><p>Using SLG resolution with DCGs is called &quot;Packrat Parsing&quot;.</p><p>Lexical analysis is a relationship between a string and sequence of tokens. For example:</p><pre class="language-prolog"><code class="language-prolog"><span class="token comment">% This uses the "eager consumer rule" which causes</span><br><span class="token comment">% tokens to extend to their maximum length.</span><br><span class="token comment">% Eager consumes check for the nil case ([]) last.</span><br><span class="token comment">% Curly braces on needed here to evaluate a Prolog predicate in a DCG rule.</span><br><span class="token comment">% The char_type predicate here asserts that H is an alphabetic character.</span><br><span class="token function">word</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span>H<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token function">char_type</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span> alphabetic<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">word</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">word</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br><br><span class="token function">words</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br><span class="token function">words</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> ws<span class="token punctuation">,</span> <span class="token function">word</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">,</span> ws<span class="token punctuation">,</span> <span class="token function">words</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><br>ws <span class="token operator">--></span> <span class="token punctuation">[</span>W<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token function">char_type</span><span class="token punctuation">(</span>W<span class="token punctuation">,</span> whitespace<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> ws <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br><br><span class="token comment">% The once predicate wraps another predicate and gives only the first solution.</span><br><span class="token comment">% once(phrase(words(Ws), "The quick brown fox jumps over the lazy dog")).</span><br><span class="token comment">% This does not terminate if the string contains</span><br><span class="token comment">% characters that are not alphabetic or whitespace such as a period.</span><br><br><span class="token function">integer</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token function">digits</span><span class="token punctuation">(</span>Ds<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token function">number_chars</span><span class="token punctuation">(</span>I<span class="token punctuation">,</span> Ds<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token operator">.</span><br><br><span class="token function">digits</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token function">digit</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">digits_remaining</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">digits_remaining</span><span class="token punctuation">(</span><span class="token punctuation">[</span>H<span class="token operator">|</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token function">digit</span><span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">digits_remaining</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token operator">.</span><br><span class="token function">digits_remaining</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">.</span><br><br><span class="token function">digit</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span> <span class="token operator">--></span> <span class="token punctuation">[</span>D<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token function">char_type</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span> decimal_digit<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token operator">.</span><br><br><span class="token comment">% phrase((ws, integer(I), ws), "  1961 ").</span><br><span class="token comment">% I = 1961.</span><br><br><span class="token function">assignment</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span> I<span class="token punctuation">)</span> <span class="token operator">--></span> ws<span class="token punctuation">,</span> <span class="token function">word</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">,</span> ws<span class="token punctuation">,</span> <span class="token string">":="</span><span class="token punctuation">,</span> ws<span class="token punctuation">,</span> <span class="token function">integer</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">,</span> ws<span class="token operator">.</span><br><span class="token comment">% once(phrase(assignment(V, I), "  gretzky := 99 ")).</span><br><span class="token comment">% V = "gretzky", I = 99.</span></code></pre><h2 id="language-server" tabindex="-1">Language Server</h2><p>TODO: How can you install a Prolog language server in Neovim? TODO: See <a href="https://github.com/jamesnvc/lsp_server">https://github.com/jamesnvc/lsp_server</a>.</p><p>TODO: Can you run Prolog code inside Neovim?</p><h2 id="miscellaneous-topics" tabindex="-1">Miscellaneous Topics</h2><p>For multithreading, see the <a href="http://packs.ndrix.com/spawn/index.html?v=1.0.21" rel="noopener" target="_blank">spawn</a> library.</p><p>TODO: Can you create an HTTP server that returns results of a Prolog program?</p></article>