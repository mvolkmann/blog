<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><link rel="stylesheet" href="/blog/assets/github-extensions.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>D3 Pie Charts</h2><h2>Pie Charts</h2><p><img src="/blog/assets/d3-svg-pie-chart.png" alt="SVG pie chart"></p><h3>index.html for pie chart</h3><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>D3 SVG Pie Chart<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://d3js.org/d3.v5.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"><br>      <span class="token selector">body</span> <span class="token punctuation">{</span><br>        <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><br>        <span class="token property">align-items</span><span class="token punctuation">:</span> flex-start<span class="token punctuation">;</span><br><br>        <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">.key</span> <span class="token punctuation">{</span><br>        <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span><br><br>        <span class="token property">background-color</span><span class="token punctuation">:</span> linen<span class="token punctuation">;</span><br>        <span class="token property">margin-left</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span><br>        <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">.player</span> <span class="token punctuation">{</span><br>        <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><br>        <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span><br><br>        <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>        <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">.tooltip</span> <span class="token punctuation">{</span><br>        <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span><br>        <span class="token property">background</span><span class="token punctuation">:</span> lightgray<span class="token punctuation">;</span><br>        <span class="token property">border</span><span class="token punctuation">:</span> solid gray 1px<span class="token punctuation">;</span><br>        <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span><br>        <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token comment">/* initially hidden */</span><br>        <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>        <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pie-chart.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3>pie-chart.js</h3><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> players <span class="token operator">=</span> <span class="token punctuation">[</span><br>  <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Mark'</span><span class="token punctuation">,</span> score<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Tami'</span><span class="token punctuation">,</span> score<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Amanda'</span><span class="token punctuation">,</span> score<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Jeremy'</span><span class="token punctuation">,</span> score<span class="token operator">:</span> <span class="token number">68</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Dasher'</span><span class="token punctuation">,</span> score<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'Maisey'</span><span class="token punctuation">,</span> score<span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">}</span><br><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> totalScore <span class="token operator">=</span> players<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> player</span><span class="token punctuation">)</span> <span class="token operator">=></span> acc <span class="token operator">+</span> player<span class="token punctuation">.</span>score<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pie-chart.js x: totalScore ='</span><span class="token punctuation">,</span> totalScore<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> radius <span class="token operator">=</span> size <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> tooltip <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'tooltip'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> svg <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> g <span class="token operator">=</span> svg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>radius<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>radius<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> color <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleOrdinal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><br>  <span class="token string">'red'</span><span class="token punctuation">,</span><br>  <span class="token string">'orange'</span><span class="token punctuation">,</span><br>  <span class="token string">'yellow'</span><span class="token punctuation">,</span><br>  <span class="token string">'green'</span><span class="token punctuation">,</span><br>  <span class="token string">'blue'</span><span class="token punctuation">,</span><br>  <span class="token string">'purple'</span><br><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> fontColor <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleOrdinal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><br>  <span class="token string">'white'</span><span class="token punctuation">,</span><br>  <span class="token string">'white'</span><span class="token punctuation">,</span><br>  <span class="token string">'black'</span><span class="token punctuation">,</span><br>  <span class="token string">'white'</span><span class="token punctuation">,</span><br>  <span class="token string">'white'</span><span class="token punctuation">,</span><br>  <span class="token string">'white'</span><br><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> pie <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">pie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token parameter">player</span> <span class="token operator">=></span> player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> arc <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">innerRadius</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outerRadius</span><span class="token punctuation">(</span>radius<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> arcs <span class="token operator">=</span> g<br>  <span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'arc'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token function">pie</span><span class="token punctuation">(</span>players<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'arc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>arcs<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'fill'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">color</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">,</span> arc<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> player <span class="token operator">=</span> data<span class="token punctuation">.</span>data<span class="token punctuation">;</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pie-chart.js x: player ='</span><span class="token punctuation">,</span> player<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Configure the tooltip.</span><br>    tooltip<br>      <span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'&lt;br>'</span> <span class="token operator">+</span> player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'left'</span><span class="token punctuation">,</span> d3<span class="token punctuation">.</span>event<span class="token punctuation">.</span>pageX <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'top'</span><span class="token punctuation">,</span> d3<span class="token punctuation">.</span>event<span class="token punctuation">.</span>pageY <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Show the tooltip.</span><br>    tooltip<span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Fade the bar.</span><br>    d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token comment">// Cannot use an arrow function because we need the value of "this".</span><br>  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseout'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Hide the tooltip.</span><br>    tooltip<span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Restore the bar opacity.</span><br>    d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'outline'</span><span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> playerDivs <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>players<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'player'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'background-color'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">color</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">fontColor</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>playerDivs<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">player</span> <span class="token operator">=></span> player<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>playerDivs<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'score'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">player</span> <span class="token operator">=></span> player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2>Loading Data</h2><p>Discuss the <code>csv</code> and <code>json</code> methods.</p><h2>Geo</h2><p>See <a href="https://github.com/d3/d3-geo">https://github.com/d3/d3-geo</a>.</p>