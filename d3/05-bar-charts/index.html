<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><link rel="stylesheet" href="/blog/assets/github-extensions.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>D3 Bar Charts</h2><aside><nav class="toc"><ol><li><a href="#scales">Scales</a></li><li><a href="#using-svg-rect-elements-to-create-a-bar-chart">Using SVG rect elements to create a bar chart</a><ol><li><a href="#index.html">index.html</a></li><li><a href="#bar-chart.js">bar-chart.js</a></li></ol></li><li><a href="#adding-axes">Adding Axes</a><ol><li><a href="#index.html-with-axes">index.html with axes</a></li><li><a href="#bar-chart.js-with-axes">bar-chart.js with axes</a></li></ol></li></ol></nav></aside><article><h2 id="scales">Scales</h2><p>It is common to need to &quot;scale&quot; data values to fit in a range of values that correspond to the width or height of an element such as <code>svg</code>. D3 provides several methods that create a function for doing this. The most commonly used is the <code>scaleLinear</code> method.</p><p>The <code>scaleLinear</code> method returns an object that supports <code>domain</code> and <code>range</code> methods. The domain represents the bounds (min to max) of data values that need to be scaled. The range represents the bounds to which they will be mapped.</p><p>For example, suppose our data is an array of objects that have the properties <code>countryName</code> and <code>population</code>. We want to represent values as low as zero and as high as the highest population value.</p><p>To determine the minimum and maximum data values, we can use the <code>min</code> and <code>max</code> methods. These take an array of data and an optional function the will be passed a data element and returns a value to be considered for determining the minimum or maximum value. For example, we can determine the maximum population in our data with the following:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> maxPopulation <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token parameter">d</span> <span class="token operator">=></span> d<span class="token punctuation">.</span>population<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>If we want to show the values as horizontal bars in an SVG that has a width of 800, the following code creates a function to do this:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> myScale <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> maxPopulation<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The <code>myScale</code> function we have created takes a number between 0 and <code>maxPopulation</code> and it returns a number between 0 and 800.</p><h2 id="using-svg-rect-elements-to-create-a-bar-chart">Using SVG rect elements to create a bar chart</h2><p>When rendering SVG <code>rect</code> elements for each of the bars, we can use this function as follows to set their widths:</p><pre class="language-js"><code class="language-js">  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> <span class="token parameter">d</span> <span class="token operator">=></span> <span class="token function">myScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>population<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Here is HTML and JavaScript code for creating a simple bar chart using D3 and SVG.</p><p><img src="/blog/assets/d3-svg-bar-chart.png" alt="SVG bar chart"></p><h3 id="index.html">index.html</h3><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>D3 SVG Bar Chart<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://d3js.org/d3.v5.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bar-chart.js<span class="token punctuation">"</span></span> <span class="token attr-name">defer</span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"><br>      <span class="token selector">body</span> <span class="token punctuation">{</span><br>        <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">rect</span> <span class="token punctuation">{</span><br>        <span class="token property">fill</span><span class="token punctuation">:</span> cornflowerblue<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">text</span> <span class="token punctuation">{</span><br>        <span class="token property">fill</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="bar-chart.js">bar-chart.js</h3><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> barHeight <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> barMargin <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// vertical spacing between</span><br><span class="token keyword">const</span> barTotal <span class="token operator">=</span> barHeight <span class="token operator">+</span> barMargin<span class="token punctuation">;</span><br><span class="token keyword">const</span> players <span class="token operator">=</span> <span class="token punctuation">[</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Mark'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tami'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Amanda'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Jeremy'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">70</span><span class="token punctuation">}</span><br><span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> svgWidth <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> svgHeight <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span><br><br><span class="token comment">// Get the highest score.</span><br><span class="token keyword">const</span> highScore <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>players<span class="token punctuation">,</span> <span class="token parameter">player</span> <span class="token operator">=></span> player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create a linear scale that maps values from zero to the maximum score</span><br><span class="token comment">// to values from zero to the width of the SVG.</span><br><span class="token keyword">const</span> widthScale <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> highScore<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> svgWidth<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create an SVG element.</span><br><span class="token keyword">const</span> svg <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> svgWidth<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> svgHeight<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create a selection containing one SVG group for each data value</span><br><span class="token comment">// that are translated in the y-direction so they are visually separated.</span><br><span class="token keyword">const</span> barGroups <span class="token operator">=</span> svg<br>  <span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>players<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(0, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">*</span> barTotal<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create a rect for each data value.</span><br>barGroups<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'rect'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> <span class="token parameter">player</span> <span class="token operator">=></span> <span class="token function">widthScale</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> barHeight<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create text for each data value that displays a player name.</span><br>barGroups<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">player</span> <span class="token operator">=></span> player<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">// at beginning of bar</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> barTotal <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// centered vertically</span><br><br><span class="token comment">// Create text for each data value that displays a player score.</span><br>barGroups<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">player</span> <span class="token operator">=></span> player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token parameter">player</span> <span class="token operator">=></span> <span class="token function">widthScale</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token comment">// at end of bar</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> barTotal <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// centered vertically</span></code></pre><h2 id="adding-axes">Adding Axes</h2><p>The D3 methods to create axes do so by mapping a data range to a width to a pixel range. They draw an axis containing tick marks and values. But they do not position the axes relative to a chart. That part is up to you.</p><p>There are four methods for creating an axis. They are <code>axisBottom</code>, <code>axisLeft</code>, <code>axisTop</code>, and <code>axisRight</code>. The differ in the orientation of the axis (horizontal or vertical) and the side of the axis on where tick marks appear.</p><p>The <code>ticks</code> method specifies the number of ticks to display. They will be spaced evenly across the axis.</p><p>The <code>tickFormat</code> method can be set to a function that takes a tick index and returns the label to render for that tick. Pass an empty string to render an empty tick label for all of them.</p><p>The <code>tickSize</code> method specifies the length of each tick. It defaults to 6. Set it to a negative number to draw lines across the chart. For example, <code>.tickSize(-usableHeight)</code>.</p><p>The <code>tickPadding</code> method specifies the space between each tick and corresponding label. It defaults to 3.</p><p>The <code>tickValues</code> method takes an array of labels to be rendered for the ticks. By default the data value is rendered.</p><p><img src="/blog/assets/d3-svg-bar-chart-with-axes.png" alt="SVG bar chart with axes"></p><h3 id="index.html-with-axes">index.html with axes</h3><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>D3 SVG Bar Chart<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://d3js.org/d3.v5.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bar-chart.js<span class="token punctuation">"</span></span> <span class="token attr-name">defer</span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"><br>      <span class="token selector">.bar text</span> <span class="token punctuation">{</span><br>        <span class="token property">fill</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>        <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">body</span> <span class="token punctuation">{</span><br>        <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">.major-x-axis > .tick > line</span> <span class="token punctuation">{</span><br>        <span class="token property">stroke-width</span><span class="token punctuation">:</span> 2<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">.minor-x-axis</span> <span class="token punctuation">{</span><br>        <span class="token property">color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">rect</span> <span class="token punctuation">{</span><br>        <span class="token property">fill</span><span class="token punctuation">:</span> cornflowerblue<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">svg</span> <span class="token punctuation">{</span><br>        <span class="token property">background-color</span><span class="token punctuation">:</span> linen<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">.tooltip</span> <span class="token punctuation">{</span><br>        <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span><br>        <span class="token property">background</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span><br>        <span class="token property">border</span><span class="token punctuation">:</span> solid gray 1px<span class="token punctuation">;</span><br>        <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span><br>        <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token comment">/* initially hidden */</span><br>        <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>        <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br><br>      <span class="token selector">.y-axis .domain</span> <span class="token punctuation">{</span><br>        <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="bar-chart.js-with-axes">bar-chart.js with axes</h3><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token constant">BAR_HEIGHT</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">BAR_MARGIN</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// vertical spacing between</span><br><span class="token keyword">const</span> <span class="token constant">LEFT_PADDING</span> <span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">PADDING</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token constant">SVG_WIDTH</span> <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> barTotal <span class="token operator">=</span> <span class="token constant">BAR_HEIGHT</span> <span class="token operator">+</span> <span class="token constant">BAR_MARGIN</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> players <span class="token operator">=</span> <span class="token punctuation">[</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Mark'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tami'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Amanda'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Jeremy'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">68</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Dasher'</span><span class="token punctuation">,</span> <span class="token literal-property property">score</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">}</span><br><span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token comment">// Leave room for top PADDING, bottom PADDING, and x axis.</span><br><span class="token keyword">const</span> svgHeight <span class="token operator">=</span> <span class="token constant">PADDING</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> players<span class="token punctuation">.</span>length <span class="token operator">*</span> barTotal<span class="token punctuation">;</span><br><span class="token keyword">const</span> usableHeight <span class="token operator">=</span> svgHeight <span class="token operator">-</span> <span class="token constant">PADDING</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> usableWidth <span class="token operator">=</span> <span class="token constant">SVG_WIDTH</span> <span class="token operator">-</span> <span class="token constant">LEFT_PADDING</span> <span class="token operator">-</span> <span class="token constant">PADDING</span><span class="token punctuation">;</span><br><br><span class="token comment">// Get the highest score rounded up to the nearest multiple of 10.</span><br><span class="token keyword">const</span> highScore <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>d3<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>players<span class="token punctuation">,</span> <span class="token parameter">player</span> <span class="token operator">=></span> player<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create a linear scale that maps values from zero to the maximum score</span><br><span class="token comment">// to values from zero to the width of the SVG.</span><br><span class="token keyword">const</span> widthScale <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> highScore<span class="token punctuation">]</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> usableWidth<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create an SVG element.</span><br><span class="token keyword">const</span> svg <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> <span class="token constant">SVG_WIDTH</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> svgHeight<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> tooltip <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'tooltip'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create a selection containing one SVG group for each data value</span><br><span class="token comment">// that are translated in the y-direction so they are visually separated.</span><br><span class="token keyword">const</span> barGroups <span class="token operator">=</span> svg<br>  <span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>players<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><br>    <span class="token string">'transform'</span><span class="token punctuation">,</span><br>    <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">LEFT_PADDING</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PADDING</span> <span class="token operator">+</span> i <span class="token operator">*</span> barTotal<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create a rect for each data value.</span><br>barGroups<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'rect'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">,</span> <span class="token parameter">player</span> <span class="token operator">=></span> <span class="token function">widthScale</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token constant">BAR_HEIGHT</span><span class="token punctuation">)</span><br>  <span class="token comment">// Cannot use an arrow function because we need the value of "this".</span><br>  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseenter'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">player</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Configure the tooltip.</span><br>    tooltip<br>      <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'left'</span><span class="token punctuation">,</span> d3<span class="token punctuation">.</span>event<span class="token punctuation">.</span>pageX <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'top'</span><span class="token punctuation">,</span> d3<span class="token punctuation">.</span>event<span class="token punctuation">.</span>pageY <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Show the tooltip.</span><br>    tooltip<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Fade the bar.</span><br>    d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token comment">// Cannot use an arrow function because we need the value of "this".</span><br>  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseout'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Hide the tooltip.</span><br>    tooltip<span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Restore the bar opacity.</span><br>    d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Create text for each data value that displays a player score.</span><br>barGroups<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">player</span> <span class="token operator">=></span> player<span class="token punctuation">.</span>score<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token parameter">player</span> <span class="token operator">=></span> <span class="token function">widthScale</span><span class="token punctuation">(</span>player<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token comment">// at end of bar</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> barTotal <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// centered vertically</span><br><br><span class="token keyword">const</span> xAxisScale <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> highScore<span class="token punctuation">]</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> usableWidth<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> xAxisMinor <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">axisBottom</span><span class="token punctuation">(</span>xAxisScale<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">ticks</span><span class="token punctuation">(</span>highScore<span class="token punctuation">)</span> <span class="token comment">// show a tick at every 1</span><br>  <span class="token punctuation">.</span><span class="token function">tickFormat</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token comment">// hides labels</span><br>  <span class="token punctuation">.</span><span class="token function">tickSize</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// length of each tick (default is 6)</span><br><span class="token keyword">const</span> xAxisMajor <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">axisBottom</span><span class="token punctuation">(</span>xAxisScale<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">ticks</span><span class="token punctuation">(</span>highScore <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// show a tick at every multiple of 10</span><br>  <span class="token comment">// highStore is guaranteed to be a multiple of 10.</span><br>  <span class="token punctuation">.</span><span class="token function">tickPadding</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// space between end of tick and label; default is 3</span><br>  <span class="token punctuation">.</span><span class="token function">tickSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">//.tickSize(-usableHeight); // to draw across chart</span><br><span class="token keyword">const</span> xAxisTransform <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">LEFT_PADDING</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><br>  <span class="token constant">PADDING</span> <span class="token operator">+</span> players<span class="token punctuation">.</span>length <span class="token operator">*</span> barTotal<br><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>svg<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>xAxisMinor<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'minor-x-axis'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> xAxisTransform<span class="token punctuation">)</span><span class="token punctuation">;</span><br>svg<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>xAxisMajor<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'major-x-axis'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> xAxisTransform<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Generate tick values that will place the ticks</span><br><span class="token comment">// at the vertical center of each of the bars.</span><br><span class="token keyword">const</span> yTickValues <span class="token operator">=</span> players<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> i <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> yAxisScale <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span>players<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// reversed order</span><br>  <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span>usableHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// top to bottom</span><br><span class="token keyword">const</span> yAxis <span class="token operator">=</span> d3<br>  <span class="token punctuation">.</span><span class="token function">axisLeft</span><span class="token punctuation">(</span>yAxisScale<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">ticks</span><span class="token punctuation">(</span>players<span class="token punctuation">.</span>length<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">tickFormat</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> player <span class="token operator">=</span> players<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> player <span class="token operator">?</span> player<span class="token punctuation">.</span>name <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">tickValues</span><span class="token punctuation">(</span>yTickValues<span class="token punctuation">)</span><span class="token punctuation">;</span><br>svg<br>  <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>yAxis<span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">'y-axis'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'transform'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">LEFT_PADDING</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PADDING</span> <span class="token operator">-</span> <span class="token constant">BAR_MARGIN</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></article>