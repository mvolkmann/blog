<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Turso</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#setup">Setup</a></li><li><a href="#cli">CLI</a></li><li><a href="#app-access">App Access</a></li></ol></nav></aside><article><figure style="width: 30%"><img alt="Turso logo" style="border: 0" src="/blog/assets/turso-logo.png?v=1.1.1"></figure><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://turso.tech?v=1.1.1" rel="noopener" target="_blank">Turso</a> is a cloud database that uses SQLite.</p><p>Compute services can be moved to &quot;the edge&quot; so they are closer to users and perform better. But this provides limited benefits if the services need to access databases that are hosted in one location rather than also being on the edge.</p><p>Turso addresses this problem by moving databases to the edge. Each Turso database has one primary and any number of replicas.</p><p>A Turso logical database is a collection of <a href="https://turso.tech/libsql" target="_blank">libSQL</a> databases. libSQL is an open-source fork of SQLite that adds native replication and an HTTP mode. This allows it to replicate and scale with low resource usage. libSQL can support having one logical database per tenant or even one logical database per user.</p><p>Databases can be created and modified in the web UI or using their CLI.</p><p>Turso uses Drizzle ORM.</p><h2 id="setup" tabindex="-1">Setup</h2><ul><li><p>Create a free account.</p></li><li><p>Create your first database.</p><p>The website provides a button that can be clicked to do this.</p></li><li><p>Create a replica for your database in a specific city.</p><p>The website provides a button that can be clicked to do this. I chose Atlanta, Georgia USA.</p></li><li><p>Install the Turso CLI.</p><p>In macOS, enter <code>brew install tursodatabase/tap/turso</code></p></li><li><p>Sign up by entering <code>turso auth signup</code></p></li></ul><h2 id="cli" tabindex="-1">CLI</h2><ul><li><p>Create a database by entering <code>turso db create {db-name}</code></p></li><li><p>View information about the database by entering <code>turso db show {db-name}</code></p><p>This will output the URL, primary location (ex. ord for Chicago), replica location (ex. atl for Atlanta), and size (ex. 4.1 kB).</p></li><li><p>Connect to the database shell by entering <code>turso db shell {db-name}</code></p></li><li><p>Create a table by entering <code>create table todos(id integer primary key autoincrement, text string, done integer);</code></p></li><li><p>List the existing tables by entering <code>.tables</code></p></li><li><p>Output the schema for all tables or a specific table by entering <code>.schema [table-name]</code></p></li><li><p>Insert a row by entering <code>insert into todos (text, done) values('cut grass', 0);</code></p></li><li><p>Update the row by entering <code>update todos set done=1 where id=1;</code></p></li><li><p>Query the table by entering <code>select * from todos;</code></p></li><li><p>Quit the shell by entering <code>.quit</code></p><p>Unlike in SQLite, <code>.exit</code> does not work.</p></li></ul><h2 id="app-access" tabindex="-1">App Access</h2><ul><li><p>Create a directory for the app and <code>cd</code> to it.</p></li><li><p>Create the initial files by entering <code>bun init</code>.</p></li><li><p>Install the client library by entering <code>bun add @libsql/client</code></p></li><li><p>Create an auth token by entering <code>turso db tokens create {db-name}</code></p></li><li><p>Edit <code>.env</code> and add <code>TURSO_AUTH={auth-token}</code>.</p></li><li><p>Get the database URL by entering <code>turso db show {db-name} --url</code></p></li><li><p>Edit <code>index.ts</code> and replace the contents with the following:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>createClient<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@libsql/client'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token function">createClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  url<span class="token operator">:</span> <span class="token string">'{db-url}'</span><span class="token punctuation">,</span><br>  authToken<span class="token operator">:</span> Bun<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">TURSO_TOKEN</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> resultSet <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">'select * from todos'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> <span class="token punctuation">{</span>columns<span class="token punctuation">,</span> rows<span class="token punctuation">}</span> <span class="token operator">=</span> resultSet<span class="token punctuation">;</span><br><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> row <span class="token keyword">of</span> rows<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'---'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> column <span class="token keyword">of</span> columns<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>column<span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Edit <code>package.json</code> and add the following:</p><pre class="language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>  <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"bun run index.ts"</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></li><li><p>Run the app by entering <code>bun dev</code></p></li></ul></article>