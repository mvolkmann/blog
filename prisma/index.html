<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Prisma</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#steps-to-use">Steps to Use</a></li><li><a href="#creating-a-record">Creating a Record</a></li><li><a href="#querying-records">Querying Records</a></li><li><a href="#updating-records">Updating Records</a></li><li><a href="#deleting-records">Deleting Records</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://www.prisma.io?v=1.0.21" rel="noopener" target="_blank">Prisma</a> is the &quot;next-generation Node.js and TypeScript ORM&quot;.</p><p>Prisma supports managing and interacting with the following databases:</p><ul><li>CockroachDB</li><li>Microsoft SQL Server</li><li>MongoDB</li><li>MySQL</li><li>PostgreSQL</li><li>SQLite</li></ul><p>Prisma can be used in the following JavaScript/TypeScript environments:</p><ul><li>AdonisJs</li><li>Express</li><li>koa</li><li>Fastify</li><li>Feathers</li><li>Foal TS</li><li>hapi</li><li>Micro</li><li>NestJS</li><li>Next.js</li><li>Polka</li><li>Sails</li></ul><p>Prisma consists of three parts:</p><ul><li>&quot;Prisma Client&quot; is an &quot;auto-generated and type-safe query builder for Node.js &amp; TypeScript&quot;. It allows interacting with databases using an API rather than SQL statements.</li><li>&quot;Prisma Migrate&quot; is a tool for migrating database schemas when changes are required.</li><li>&quot;Prisma Studio&quot; is a &quot;GUI to view and edit data in your database&quot;.</li></ul><h2 id="steps-to-use" tabindex="-1">Steps to Use</h2><ol><li><p>Define a Prisma schema for a database. This has it's own syntax which is similar to DDL, but not identical. This can be generated from the schema of an existing database.</p></li><li><p>Install Prisma Client by entering &quot;npm install @prisma/client&quot;.</p></li><li><p>Generate code for accessing the database by entering &quot;prisma generate&quot;.</p></li><li><p>Create an instance of the generated <code>PrismaClient</code> with the following code:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@prisma/client'</span><br><span class="token keyword">const</span> prisma <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrismaClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></li></ol><h2 id="creating-a-record" tabindex="-1">Creating a Record</h2><p>The following example creates a User record and an associated Address record.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Can ids be auto-generated?</span><br>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Mark Volkmann'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">'mark@gmail.com'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">create</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token literal-property property">street</span><span class="token operator">:</span> <span class="token string">'123 Some Street'</span><br>        <span class="token literal-property property">city</span><span class="token operator">:</span> <span class="token string">'Somewhere'</span><span class="token punctuation">,</span><br>        <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">'CA'</span><span class="token punctuation">,</span><br>        <span class="token literal-property property">zip</span><span class="token operator">:</span> <span class="token number">123456</span><br>      <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="querying-records" tabindex="-1">Querying Records</h2><p>The following query retrieves all users have a Gmail email address and live in California.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">findMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">endsWith</span><span class="token operator">:</span> <span class="token string">'@gmail.com'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">'CA'</span> <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="updating-records" tabindex="-1">Updating Records</h2><p>The following code updates the email address of a User with a given id.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">12345678</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">'richard@gmail.com'</span> <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="deleting-records" tabindex="-1">Deleting Records</h2><p>The following code deletes one User record with a given id.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">12345678</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The following code deletes all User records with a state of &quot;CA&quot;.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> prisma<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">'CA'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></article>