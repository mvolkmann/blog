<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Web Framework Comparison</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#sample-app">Sample App</a></li><li><a href="#next.js-version">Next.js Version</a></li><li><a href="#htmx-version">htmx Version</a></li><li><a href="#sveltekit-version">SvelteKit Version</a></li><li><a href="#comparing-the-versions">Comparing the Versions</a></li><li><a href="#lighthouse-scores">Lighthouse Scores</a></li><li><a href="#conclusion">Conclusion</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p>React is currently the most popular framework for building web applications. Alternatives like Svelte, Vue, Angular differ from React in some ways, but the fundamental approach used is similar. They generally send HTTP requests to a server that returns data in the form of JSON. Once the JSON is returned to the browser, it is parsed into a JavaScript object. Then the web framework uses that data to update the DOM, resulting in page updates without a full page refresh.</p><p>The SPA frameworks have some support for server-side rendering which moves the generation of HTML from the browser to the server, but the code required to generate the HTML is still the same.</p><p>htmx is a relatively new JavaScript library that takes a very different approach. It still sends HTTP requests to a server, but the server returns snippets of HTML instead of JSON.</p><p>htmx adds support for many new HTML attributes that make it more expressive and powerful. The most used of these new attributes include the following:</p><ul><li><code>hx-trigger</code> specifies the events that triggers a request such as <code>click</code>, <code>submit</code>, and <code>hover</code>.</li><li><code>hx-get</code>, <code>hx-post</code>, <code>hx-put</code>, <code>hx-patch</code>, and <code>hx-delete</code> specify the HTTP verb to use for the request and the URL path where it will be sent.</li><li><code>hx-target</code> specifies where the resulting HTML should go.</li><li><code>hx-swap</code> specifies exactly how the resulting HTML should be inserted.</li></ul><p>The following diagram describes commonly used values for the <code>hx-swap</code> attribute.</p><p><img alt="hx-swap" style="width: 70%" src="/blog/assets/htmx-hx-swap.png?v=1.1.1"></p><p>For more detail on htmx, see my <a href="https://mvolkmann.github.io/blog/topics/#/blog/htmx/" target="_blank">htmx blog page</a>.</p><p>There are many frameworks that leverage React. Next.js is one of the most popular. For details on Next.js, see my <a href="https://mvolkmann.github.io/blog/topics/#/blog/next-js/" target="_blank">Next.js blog page</a>.</p><h2 id="sample-app" tabindex="-1">Sample App</h2><p>Let's implement a web app using Next.js and then implement the same app using SvelteKit and htmx to see how they differ.</p><p>The app manages a collection of dogs. Users can add new dogs. They can also hover over of the table row of an existing dog to reveal buttons for deleting or editing it.</p><p><img alt="Dog CRUD app" style="width: 50%" src="/blog/assets/htmx-dog-crud.png?v=1.1.1"></p><h2 id="next.js-version" tabindex="-1">Next.js Version</h2><p>All the code for the Next.js version of this app can be found in the GitHub repository at <a href="https://github.com/mvolkmann/nextjs-dogs-crud" target="_blank">nextjs-dogs-crud</a>.</p><p>Follow these steps to create the app from scratch.</p><ol><li><p><code>cd</code> to the directory where the app will be created.</p></li><li><p><code>npx create-next-app@latest</code></p><p>I chose the name &quot;dogs-crud&quot; and accepted all the defaults except using Tailwind.</p></li><li><p><code>cd dogs-crud</code></p></li><li><p><code>npm install uuid</code> and <code>npm install --D @types/uuid</code></p><p>This package will be used to generate unique ids for dogs.</p></li><li><p>Delete the following files that will not be used:</p><ul><li><code>public/next.svg</code></li><li><code>public/vercel.svg</code></li><li><code>src/app/page.module.css</code></li></ul></li><li><p>Replace the contents of <code>src/app/global.css</code> with the following:</p><pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> cornflowerblue<span class="token punctuation">;</span><br>  <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">button</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> lightgreen<span class="token punctuation">;</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span><br>  <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br><br>  <span class="token selector">&amp;:disabled</span> <span class="token punctuation">{</span><br>    <span class="token property">background-color</span><span class="token punctuation">:</span> gray<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.buttons</span> <span class="token punctuation">{</span><br>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><br>  <span class="token property">gap</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span><br><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">h1</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">input</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span><br>  <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">label</span> <span class="token punctuation">{</span><br>  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span><br>  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span><br>  <span class="token property">margin-right</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>  <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span><br>  <span class="token property">width</span><span class="token punctuation">:</span> 3rem<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">/* This is used for the table row delete and edit buttons. */</span><br><span class="token selector">.on-hover:hover .show-on-hover</span> <span class="token punctuation">{</span><br>  <span class="token property">visibility</span><span class="token punctuation">:</span> visible<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">/* This is used for the table row delete and edit buttons. */</span><br><span class="token selector">.show-on-hover</span> <span class="token punctuation">{</span><br>  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>2.5<span class="token punctuation">)</span> <span class="token function">translate</span><span class="token punctuation">(</span>0.2rem<span class="token punctuation">,</span> 0.2rem<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">table</span> <span class="token punctuation">{</span><br>  <span class="token property">border-collapse</span><span class="token punctuation">:</span> collapse<span class="token punctuation">;</span><br>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">td,<br>th</span> <span class="token punctuation">{</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid cornflowerblue<span class="token punctuation">;</span><br>  <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">td</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br><br>  <span class="token selector">&amp; button</span> <span class="token punctuation">{</span><br>    <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span><br>    <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token selector">th</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Create the file <code>src/app/api/dogs/dogs.ts</code> containing the following code that manages a collection of dogs in memory:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>v4 <span class="token keyword">as</span> uuidv4<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'uuid'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token punctuation">{</span><br>  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> dogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Dog<span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token string">'Whippet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">}</span><span class="token punctuation">;</span><br>  dogMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deleteDog</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> dogMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dogs<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">:</span> Dog<span class="token punctuation">,</span> b<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">updateDog</span><span class="token punctuation">(</span><br>  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><br>  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><br>  breed<span class="token operator">:</span> <span class="token builtin">string</span><br><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns undefined if not found</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    dog<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span><br>    dog<span class="token punctuation">.</span>breed <span class="token operator">=</span> breed<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Create the file <code>src/app/api/dogs/route.ts</code> containing the following code that handles GET and POST requests:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>addDog<span class="token punctuation">,</span> getDogs<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dogs'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span>_<span class="token operator">:</span> Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token function">getDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">POST</span><span class="token punctuation">(</span>req<span class="token operator">:</span> Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">try</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span><span class="token function">formData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> breed <span class="token operator">=</span> <span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'breed'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> newDog <span class="token operator">=</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>newDog<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token operator">:</span> <span class="token number">201</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>error<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Create the file <code>src/app/api/dogs/[id]/route.ts</code> containing the following code that handles PUT and DELETE requests. The directory name <code>[id]</code> includes the square brackets. This indicates that requests to routes described inside must include an <code>id</code> path parameter.</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>deleteDog<span class="token punctuation">,</span> updateDog<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../dogs'</span><span class="token punctuation">;</span><br><br><span class="token keyword">type</span> <span class="token class-name">Props</span> <span class="token operator">=</span> <span class="token punctuation">{</span><br>  params<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">DELETE</span><span class="token punctuation">(</span>req<span class="token operator">:</span> Request<span class="token punctuation">,</span> <span class="token punctuation">{</span>params<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> Props<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> existed <span class="token operator">=</span> <span class="token function">deleteDog</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>existed <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token punctuation">{</span>error<span class="token operator">:</span> <span class="token string">'dog not found'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    status<span class="token operator">:</span> existed <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">PUT</span><span class="token punctuation">(</span>req<span class="token operator">:</span> Request<span class="token punctuation">,</span> <span class="token punctuation">{</span>params<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> Props<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span><span class="token function">formData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> name <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> breed <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'breed'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token function">updateDog</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<br>    <span class="token operator">?</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><br>    <span class="token operator">:</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>error<span class="token operator">:</span> <span class="token string">'dog not found'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Edit <code>src/app/layout.tsx</code>.</p><p>This file provides the HTML boilerplate that wraps what is rendered by <code>src/app/page.tsx</code> below.</p><ul><li>Delete the two lines that refer to the &quot;Inter&quot; font.</li><li>Change the title from &quot;Create Next App&quot; to &quot;Dogs CRUD&quot;.</li><li>Remove the <code>className</code> attribute from the <code>body</code> element.</li></ul></li><li><p>Replace the contents of <code>src/app/page.tsx</code> with the following:</p><pre class="language-tsx"><code class="language-tsx"><span class="token string">'use client'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>useEffect<span class="token punctuation">,</span> useState<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><br><br><span class="token keyword">type</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>dogMap<span class="token punctuation">,</span> setDogMap<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Dog<span class="token operator">>></span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>selectedDog<span class="token punctuation">,</span> setSelectedDog<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Dog <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token function">loadDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span>dog<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// In order for React to update the UI when `dogMap` changes,</span><br>    <span class="token comment">// we must create a new instance of the Map</span><br>    <span class="token comment">// which can be expensive if the Map is large.</span><br>    <span class="token keyword">const</span> newDogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    newDogMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>id<span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">setDogMap</span><span class="token punctuation">(</span>newDogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">function</span> <span class="token function">deleteDog</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Once again creating a new instance of the Map.</span><br>    <span class="token keyword">const</span> newDogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    newDogMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">setDogMap</span><span class="token punctuation">(</span>newDogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleDelete</span><span class="token punctuation">(</span>event<span class="token operator">:</span> React<span class="token punctuation">.</span>MouseEvent<span class="token operator">&lt;</span>HTMLButtonElement<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'Are you sure?'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> tr <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// It should never fail to find a `tr` that wraps the clicked button.</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tr<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'tr not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/dogs/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tr<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>        method<span class="token operator">:</span> <span class="token string">'DELETE'</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'DELETE failed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token function">deleteDog</span><span class="token punctuation">(</span>tr<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'DELETE failed:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">function</span> <span class="token function">handleEdit</span><span class="token punctuation">(</span>event<span class="token operator">:</span> React<span class="token punctuation">.</span>MouseEvent<span class="token operator">&lt;</span>HTMLButtonElement<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> tr <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// It should never fail to find a `tr` that wraps the clicked button.</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tr<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'tr not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This causes the name and breed of the selected dog</span><br>    <span class="token comment">// to appear in the form at the top.</span><br>    <span class="token function">setSelectedDog</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tr<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleSubmit</span><span class="token punctuation">(</span>event<span class="token operator">:</span> React<span class="token punctuation">.</span>FormEvent<span class="token operator">&lt;</span>HTMLFormElement<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> form <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> url <span class="token operator">=</span> selectedDog <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/dogs/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>selectedDog<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">'/api/dogs'</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>        method<span class="token operator">:</span> selectedDog <span class="token operator">?</span> <span class="token string">'PUT'</span> <span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span><br>        body<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'POST failed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      form<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// clears the form inputs</span><br>      <span class="token keyword">const</span> newDog <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token function">addDog</span><span class="token punctuation">(</span>newDog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token function">setSelectedDog</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'POST failed:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// Called when the page is loaded.</span><br>  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/dogs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dogArray <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Dog<span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> dog <span class="token keyword">of</span> dogArray<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      dogMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>id<span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token function">setDogMap</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Dogs</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Name</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><br>            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><br>            <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><br>            <span class="token attr-name">required</span><br>            <span class="token attr-name">size</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">30</span><span class="token punctuation">}</span></span><br>            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><br>            <span class="token attr-name">defaultValue</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selectedDog <span class="token operator">?</span> selectedDog<span class="token punctuation">.</span>name <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span></span><br>          <span class="token punctuation">/></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>breed<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Breed</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><br>            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>breed<span class="token punctuation">"</span></span><br>            <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>breed<span class="token punctuation">"</span></span><br>            <span class="token attr-name">required</span><br>            <span class="token attr-name">size</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">30</span><span class="token punctuation">}</span></span><br>            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><br>            <span class="token attr-name">defaultValue</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selectedDog <span class="token operator">?</span> selectedDog<span class="token punctuation">.</span>breed <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span></span><br>          <span class="token punctuation">/></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>buttons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit-btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>selectedDog <span class="token operator">?</span> <span class="token string">'Update'</span> <span class="token operator">:</span> <span class="token string">'Add'</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token punctuation">{</span>selectedDog <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><br>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setSelectedDog</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>              Cancel<br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br>          <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span><span class="token plain-text"><br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token plain-text">Name</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><span class="token plain-text"><br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token plain-text">Breed</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token punctuation">{</span><span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>dog <span class="token operator">=></span> <span class="token punctuation">(</span><br>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>on-hover<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token plain-text"><br>              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>breed<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token plain-text"><br>              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>buttons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>                  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>show-on-hover<span class="token punctuation">"</span></span><br>                  <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleDelete<span class="token punctuation">}</span></span><br>                  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><br>                <span class="token punctuation">></span></span><span class="token plain-text"><br>                  <br>                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>                  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>show-on-hover<span class="token punctuation">"</span></span><br>                  <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleEdit<span class="token punctuation">}</span></span><br>                  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><br>                <span class="token punctuation">></span></span><span class="token plain-text"><br>                  <br>                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token plain-text"><br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><br>          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> Home<span class="token punctuation">;</span></code></pre></li><li><p><code>npm run dev</code></p></li><li><p>Browse localhost:3000</p></li><li><p>Add a dog.</p><p>Enter a name and breed in the form at the top. Click the &quot;Add&quot; button to add a new dog.</p></li><li><p>Edit a dog.</p><p>Hover over one of the dog rows and click the pencil icon that appears. Modify the name and/or breed in the form at the top. Click the &quot;Update&quot; button to submit the changes.</p></li><li><p>Delete a dog.</p><p>Hover over one of the dog rows and click the &quot;X&quot; icon that appears. Click the &quot;OK&quot; button in the confirmation dialog to approve the delete.</p></li></ol><h2 id="htmx-version" tabindex="-1">htmx Version</h2><p>Unlike Next.js, the htmx library does not provide a framework for implementing API endpoints. This is both good and bad. The good side is that we can choose any programming language and server framework. For example, we could use Go and the &quot;Go Fiber&quot; library. Or we could use Python and the Fast API, Flask, or Django libraries.</p><p>Most web developers are already familiar with JavaScript, so we will use that for our example app. Specifically, we will use the Bun JavaScript engine and the Hono server library.</p><p>&quot;<a href="https://bun.sh?v=1.1.1" rel="noopener" target="_blank">Bun</a> is a fast JavaScript all-in-one toolkit.&quot; It includes a JavaScript runtime, package manager, bundler, and test runner.</p><p>Bun can be used as a drop-in replacement for npm and Node.js. The Bun runtime supports nearly all Node.js built-in modules. It also supports JSX which we will utilize in our API endpoints to generate HTML.</p><p>For more detail on Bun, see my <a href="https://mvolkmann.github.io/blog/topics/#/blog/bun/" target="_blank">bun blog page</a>.</p><p><a href="https://hono.dev/?v=1.1.1" rel="noopener" target="_blank">Hono</a> is a JavaScript HTTP server library that runs in any JavaScript runtime. For more detail on Hono, see my <a href="https://mvolkmann.github.io/blog/topics/#/blog/hono/" target="_blank">Hono blog page</a>.</p><p>All the code for the htmx version of this app can be found in the GitHub repository at <a href="https://github.com/mvolkmann/htmx-examples/tree/main/htmx-dogs-crud" target="_blank">htmx-dogs-crud</a>.</p><p>Follow these steps to create the app from scratch.</p><ol><li><p>Install Bun.</p><p>Bun does not currently support Windows outside of WSL, but there will be a new version that supports windows very soon.</p><p>Enter <code>curl -fsSL https://bun.sh/install | bash</code></p></li><li><p>Create a new Bun project.</p><ul><li>Create a directory to hold the new project.</li><li><code>cd</code> to the new directory.</li><li>Enter <code>bun init</code> and accept all the defaults for the prompts.</li></ul></li><li><p><code>npm install hono</code></p></li><li><p>Add the following line in <code>tsconfig.json</code> inside the &quot;compilerOptions&quot;:</p><pre class="language-json"><code class="language-json"><span class="token property">"jsxImportSource"</span><span class="token operator">:</span> <span class="token string">"hono/jsx"</span><span class="token punctuation">,</span></code></pre></li><li><p>Add the following in <code>package.json</code>:</p><pre class="language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>  <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"bun run --watch server.tsx"</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></li><li><p>Delete the <code>index.ts</code> file.</p></li><li><p>Create the file <code>server.tsx</code> with the following contents:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token keyword">type</span> <span class="token class-name">Context</span><span class="token punctuation">,</span> Hono<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>serveStatic<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/bun'</span><span class="token punctuation">;</span><br><br><span class="token keyword">type</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">let</span> selectedId <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> dogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Dog<span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token string">'Whippet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// standard web API</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">}</span><span class="token punctuation">;</span><br>  dogMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">dogRow</span><span class="token punctuation">(</span>dog<span class="token operator">:</span> Dog<span class="token punctuation">,</span> updating <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> attrs<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <span class="token comment">// If we are updating an existing dog, we want to replace</span><br>  <span class="token comment">// the table row that describes it with a new table row.</span><br>  <span class="token comment">// Using an out-of-band swap achieves this.</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>updating<span class="token punctuation">)</span> attrs<span class="token punctuation">[</span><span class="token string">'hx-swap-oob'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'true'</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// The "on-hover" CSS class causes the delete and edit buttons</span><br>  <span class="token comment">// for this row to appear when the user hovers over the row.</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>tr <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"on-hover"</span> id<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">row-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dog<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span>attrs<span class="token punctuation">}</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span><br>      <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>breed<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span><br>      <span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"buttons"</span><span class="token operator">></span><br>        <span class="token punctuation">{</span><span class="token comment">/* The `hx-confirm` attribute causes a confirmation dialog to appear<br>            before a DELETE request is sent to the "/dog/{id}" endpoint.<br>            The `hx-delete` attribute specifies the URL<br>            where a DELETE request will be sent.<br>            The `hx-target` attribute specifies that the target of the<br>            request is the closest ancestor `tr` element to this button,<br>            which represents the row that contains this button.<br>            The `hx-swap` attribute specifies that the target element<br>            should be deleted, which removes the table row. */</span><span class="token punctuation">}</span><br>        <span class="token operator">&lt;</span>button<br>          <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"show-on-hover"</span><br>          hx<span class="token operator">-</span>confirm<span class="token operator">=</span><span class="token string">"Are you sure?"</span><br>          hx<span class="token operator">-</span><span class="token keyword">delete</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/dog/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dog<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><br>          hx<span class="token operator">-</span>target<span class="token operator">=</span><span class="token string">"closest tr"</span><br>          hx<span class="token operator">-</span>swap<span class="token operator">=</span><span class="token string">"delete"</span><br>          type<span class="token operator">=</span><span class="token string">"button"</span><br>        <span class="token operator">></span><br>          <br>        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><br>        <span class="token punctuation">{</span><span class="token comment">/* This selects the dog which triggers a selection-change event,<br>            which causes the form to update.<br>            The `hx-get` attribute specifies the URL<br>            where a GET request will be sent.<br>            The `hx-swap` attribute specifies that<br>            nothing on the page will be modified. */</span><span class="token punctuation">}</span><br>        <span class="token operator">&lt;</span>button<br>          <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"show-on-hover"</span><br>          hx<span class="token operator">-</span>get<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'/select/'</span> <span class="token operator">+</span> dog<span class="token punctuation">.</span>id<span class="token punctuation">}</span><br>          hx<span class="token operator">-</span>swap<span class="token operator">=</span><span class="token string">"none"</span><br>          type<span class="token operator">=</span><span class="token string">"button"</span><br>        <span class="token operator">></span><br>          <br>        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Serve static files from the public directory.</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/*'</span><span class="token punctuation">,</span> <span class="token function">serveStatic</span><span class="token punctuation">(</span><span class="token punctuation">{</span>root<span class="token operator">:</span> <span class="token string">'./public'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Deletes the dog with a given id.</span><br>app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/dog/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> existed <span class="token operator">=</span> dogMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>existed<span class="token punctuation">)</span> c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Deselects the currently selected dog.</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/deselect'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  selectedId <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token comment">// Setting the "HX-Trigger" response header causes</span><br>  <span class="token comment">// the specified event to be triggered in the browser.</span><br>  <span class="token comment">// We listen for this event in `index.html` below</span><br>  <span class="token comment">// and send a GET request to the `/form` endpoint</span><br>  <span class="token comment">// to update the form at the top of the page.</span><br>  c<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'HX-Trigger'</span><span class="token punctuation">,</span> <span class="token string">'selection-change'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Gets the proper form for either adding or updating a dog.</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/form'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> selectedDog <span class="token operator">=</span> dogMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>selectedId<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// This attribute causes the `form` to be reset (cleared)</span><br>  <span class="token comment">// after any successful request triggered by the `form`.</span><br>  <span class="token keyword">const</span> attrs<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token string-property property">'hx-on:htmx:after-request'</span><span class="token operator">:</span> <span class="token string">'this.reset()'</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedId<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Update an existing row using a PUT request.</span><br>    <span class="token comment">// A new table row will replace the current one</span><br>    <span class="token comment">// using an out-of-band swap.</span><br>    attrs<span class="token punctuation">[</span><span class="token string">'hx-put'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'/dog/'</span> <span class="token operator">+</span> selectedId<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Add a new row using a POST request.</span><br>    <span class="token comment">// A new table row will be added after the beginning of the</span><br>    <span class="token comment">// `tbody` element, making it the new, first child element.</span><br>    attrs<span class="token punctuation">[</span><span class="token string">'hx-post'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'/dog'</span><span class="token punctuation">;</span><br>    attrs<span class="token punctuation">[</span><span class="token string">'hx-target'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'tbody'</span><span class="token punctuation">;</span><br>    attrs<span class="token punctuation">[</span><span class="token string">'hx-swap'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'afterbegin'</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><br>    <span class="token comment">// The `hx-disabled-elt` element lists the elements that</span><br>    <span class="token comment">// should be disabled while a request is being processed.</span><br>    <span class="token comment">// Submitting the form triggers a request.</span><br>    <span class="token operator">&lt;</span>form hx<span class="token operator">-</span>disabled<span class="token operator">-</span>elt<span class="token operator">=</span><span class="token string">"#submit-btn"</span> <span class="token punctuation">{</span><span class="token operator">...</span>attrs<span class="token punctuation">}</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span>div<span class="token operator">></span><br>        <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"name"</span><span class="token operator">></span>Name<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span><br>        <span class="token operator">&lt;</span>input<br>          id<span class="token operator">=</span><span class="token string">"name"</span><br>          name<span class="token operator">=</span><span class="token string">"name"</span><br>          required<br>          size<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">30</span><span class="token punctuation">}</span><br>          type<span class="token operator">=</span><span class="token string">"text"</span><br>          value<span class="token operator">=</span><span class="token punctuation">{</span>selectedDog<span class="token operator">?.</span>name <span class="token operator">??</span> <span class="token string">''</span><span class="token punctuation">}</span><br>        <span class="token operator">/</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><br>      <span class="token operator">&lt;</span>div<span class="token operator">></span><br>        <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"breed"</span><span class="token operator">></span>Breed<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span><br>        <span class="token operator">&lt;</span>input<br>          id<span class="token operator">=</span><span class="token string">"breed"</span><br>          name<span class="token operator">=</span><span class="token string">"breed"</span><br>          required<br>          size<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">30</span><span class="token punctuation">}</span><br>          type<span class="token operator">=</span><span class="token string">"text"</span><br>          value<span class="token operator">=</span><span class="token punctuation">{</span>selectedDog<span class="token operator">?.</span>breed <span class="token operator">??</span> <span class="token string">''</span><span class="token punctuation">}</span><br>        <span class="token operator">/</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><br>      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"buttons"</span><span class="token operator">></span><br>        <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"submit-btn"</span><span class="token operator">></span><span class="token punctuation">{</span>selectedId <span class="token operator">?</span> <span class="token string">'Update'</span> <span class="token operator">:</span> <span class="token string">'Add'</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><br>        <span class="token punctuation">{</span>selectedId <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><br>          <span class="token operator">&lt;</span>button hx<span class="token operator">-</span>get<span class="token operator">=</span><span class="token string">"/deselect"</span> hx<span class="token operator">-</span>swap<span class="token operator">=</span><span class="token string">"none"</span> type<span class="token operator">=</span><span class="token string">"button"</span><span class="token operator">></span><br>            Cancel<br>          <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><br>        <span class="token punctuation">)</span><span class="token punctuation">}</span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Selects a dog.</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/select/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  selectedId <span class="token operator">=</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// As described above, setting the "HX-Trigger" response header</span><br>  <span class="token comment">// causes the specified event to be triggered in the browser.</span><br>  c<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'HX-Trigger'</span><span class="token punctuation">,</span> <span class="token string">'selection-change'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Gets table rows for all the dogs.</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/table-rows'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  dogs<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">:</span> Dog<span class="token punctuation">,</span> b<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">{</span>dogs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>dog <span class="token operator">=></span> <span class="token function">dogRow</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Creates a dog and returns a table row describing it.</span><br>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">formData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> breed <span class="token operator">=</span> <span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'breed'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token function">dogRow</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Updates a dog and returns a new table row describing it.</span><br><span class="token comment">// The new row will replace the existing row for this dog.</span><br>app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/dog/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">formData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> breed <span class="token operator">=</span> <span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'breed'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> updatedDog <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">}</span><span class="token punctuation">;</span><br>  dogMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> updatedDog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  selectedId <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'HX-Trigger'</span><span class="token punctuation">,</span> <span class="token string">'selection-change'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token function">dogRow</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> app<span class="token punctuation">;</span></code></pre></li><li><p>Create the file <code>public/styles.css</code> containing the same CSS rules we saw in the Next.js <code>src/app/global.css</code> file.</p></li><li><p>Create the file <code>public/index.html</code> containing the following:</p><pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>htmx CRUD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>description<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Dogs CRUD<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/htmx.org@1.9.10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Dogs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><br>    <span class="token comment">&lt;!-- This causes an HTML form to be inserted in this div<br>         when the page is initially loaded, and again<br>         every time a "selection-change" event is dispatched<br>         and bubbles up to the body element.  --></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">hx-trigger</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>load, selection-change from:body<span class="token punctuation">"</span></span> <span class="token attr-name">hx-get</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/form<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>    <span class="token comment">&lt;!-- This causes table rows (tr elements) to be inserted in<br>         the tbody element when the page is initially loaded.<br>         Subsequent changes to the table rows are<br>         handled by elements returned by the the server. --></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">hx-trigger</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>load<span class="token punctuation">"</span></span> <span class="token attr-name">hx-get</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/table-rows<span class="token punctuation">"</span></span> <span class="token attr-name">hx-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tbody<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span><br>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><br>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>Breed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre></li><li><p>Start the server by entering <code>bun dev</code>.</p></li><li><p>Browse localhost:3000.</p></li><li><p>Just like in the Next.js app, add a dog, edit a dog, and delete a dog.</p></li></ol><h2 id="sveltekit-version" tabindex="-1">SvelteKit Version</h2><p>I also implemented the same app using SvelteKit.</p><p>All the code for the SvelteKit version of this app can be found in the GitHub repository at <a href="https://github.com/mvolkmann/htmx-examples/tree/main/svelte-dogs-crud" target="_blank">svelte-dogs-crud</a>.</p><p>I was only able to get the SvelteKit app to run with Node 18.19.1.</p><h2 id="comparing-the-versions" tabindex="-1">Comparing the Versions</h2><p>What conclusions can be drawn from comparing these versions of the app?</p><ul><li><p>Download size</p><p>The htmx library is far smaller than the client-side parts of Next.js and SvelteKit.</p><p>For both Next.js and SvelteKit, the sizes of the downloaded files differ considerably based on whether they are built and run in development or production mode.</p><p>When the Next.js app is run in development mode, the Chrome DevTools Network tab shows the following:</p><ul><li><code>webpack.js</code> - 10.9 kB</li><li><code>main-app.js</code> - 1.6 MB</li><li><code>app-pages-internals.js</code> - 41.7 kB</li><li><code>page.js</code> - 46.2 kB</li></ul><p>for a somewhat shocking total of 1.7 MB.</p><p>When the Next.js app is run in production mode, the Chrome DevTools Network tab shows the following:</p><ul><li><code>webpack-{hash}.js</code> - 2.0 kB</li><li><code>{some-hash-1}.js</code> - 53.9 kb</li><li><code>{some-hash-2}.js</code> - 29.5 kb</li><li><code>main-app-{hash}.js</code> - 809 B</li><li><code>page-{hash}.js</code> - 1.4 kB</li></ul><p>for a more reasonable total of only 87 kB.</p><p>When the SvelteKit app is run in development mode, the Chrome DevTools Network tab reports downloading a whopping 44 files that have a total size of 576 kB.</p><p>When the SvelteKit app is run in production mode, the Chrome DevTools Network tab reports downloading 16 files that have a more reasonable total size of only 41 kB.</p><p>For htmx there is no distinction between development and production modes. When the htmx app is run, the Chrome DevTools Network tab reports only <code>htmx.min.js</code> at 22.3 kB. That is about half the size of the SvelteKit app in production and a quarter of the size of the Next.js app in production.</p></li><li><p>Client-side code</p><p>There is no custom client-side JavaScript code in the htmx version, but there is a lot of it in the Next.js and SvelteKit versions. Compare the Next.js file <code>src/app/page.tsx</code> and the SvelteKit file <code>src/route/+page.svelte</code> to the <code>htmx</code> file <code>public/index.html</code>.</p></li><li><p>Code Length</p><p>The code we had to write for the htmx app is shorter than that for the Next.js and SvelteKit apps.</p><p>The Next.js app consists of the files <code>src/app/layout.tsx</code> (19), <code>src/app/page.tsx</code> (159), <code>src/api/dogs/dogs.ts</code> (41), <code>src/api/dogs/route.ts</code> (18), and <code>src/api/dogs/[id]/route.ts</code> (23) for a total of 241 lines.</p><p>The SvelteKit app consists of the file <code>src/route/+page.svelte</code> (148) <code>src/route/dogs/dogs.ts</code> (41), <code>src/route/dogs/+server.ts</code> (19), and <code>src/route/dogs/[id]/+server.ts</code> (20) for a total of 228 lines.</p><p>The htmx app consists of the files <code>public/index.html</code> (21) and <code>src/server.tsx</code> (163) for a total of 184 lines.</p><p>So compared to the htmx app, code for the Next.js app is 48% longer and code for the SvelteKit app is 40% longer.</p></li><li><p>Number of source files</p><p>The Next.js and SvelteKit versions of the app use more source files than the htmx version. This can be good for separating concerns, but it can be bad when the separarations are somewhat arbitrary.</p><p>The Next.js and SvelteKit server code separates the endpoint implementations based on whether they use a path parameter. The GET and POST requests do not, whereas the PUT and DELETE requests do. The htmx server code colocates these in the same source file, which feels natural since they are related endpoints. That said, depending on the server library you choose, you can decide how to divide the functionality into source files.</p></li><li><p>State</p><p>All the state is only maintained on the server in the htmx app. This greatly simplifies state management. In the Next.js and SvelteKit apps, <code>dogMap</code> is maintained in both the server and client.</p></li><li><p>Reactivity</p><p>The React <code>useState</code> hook automatically triggers updates to the parts of a page that use its state. However, this only happens when the state value changes and modifying key/value pairs in a <code>Map</code> is not recognized as a change. This requires making a copy of a <code>Map</code> for each change that must trigger a page update, which is inefficient.</p><p>Reactivity is SvelteKit does not require making copies of the <code>Map</code>.</p><p>In the htmx approach, the server returns new snippets of HTML that are inserted into the page, so it doesn't need reactivity. For apps where there is state that never needs to be shared with the server, libraries like <a href="https://mvolkmann.github.io/blog/topics/#/blog/alpine/" target="_blank">Alpine</a> and <a href="https://mvolkmann.github.io/blog/topics/#/blog/hyperscript/" target="_blank">_hyperscript</a> can be used. Both are small, client-side JavaScript libraries that make it easy to add reactivity to web pages.</p></li><li><p>Learning curve</p><p>The learning curve for htmx is smaller than for Next.js/React and SvelteKit.</p><p>It's difficult to compare the required learning curves if you are already familiar with React or Svelte. But try to imagine what the difference would be if you did not already have that background.</p></li><li><p>Build process</p><p>The Next.js and SvelteKit approaches requires a build process. The htmx approach may or may not, depending on the selected server-side programming language. Our choice of using Bun removes the need for a build process.</p></li><li><p>Startup time</p><p>The startup time for the Next.js server and the SvelteKit server is noticeably slower than that of the Bun server we chose to use with htmx. In development mode, the Next.js server takes almost 2 seconds to start and the SvelteKit server takes around 1 second. The Bun server startup is practically instantaneous.</p></li><li><p>Persistence</p><p>The server for all three versions of the app holds the dog data in memory. We could modify them to persist the data in a database. But the code would be the same for each version, so this would not be a differentiator.</p></li><li><p>Server-side flexibility</p><p>Next.js and SvelteKit apps typically implement their API endpoints using the framework and write the code in TypeScript. It's also possible to implement the API endpoints using any programming language and server library just like with htmx. However, that doesn't remove the need for writing a lot of client-side JavaScript code and incurring larger JavaScript downloads.</p></li></ul><h2 id="lighthouse-scores" tabindex="-1">Lighthouse Scores</h2><p>The following table shows Chrome Lighthouse scores for all three versions of the app running locally. For Next.js and SvelteKit, separate scores are shown for running in development mode versus production.</p><table><thead><tr><th></th><th style="text-align:right">Next.js dev</th><th style="text-align:right">Next.js prod</th><th style="text-align:right">SvelteKit dev</th><th style="text-align:right">SvelteKit prod</th><th style="text-align:right">htmx</th></tr></thead><tbody><tr><td><strong>Performance</strong></td><td style="text-align:right">56</td><td style="text-align:right">99</td><td style="text-align:right">75</td><td style="text-align:right">98</td><td style="text-align:right">99</td></tr><tr><td><strong>Accessibility</strong></td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td></tr><tr><td><strong>Best Practices</strong></td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td></tr><tr><td><strong>SEO</strong></td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td><td style="text-align:right">100</td></tr><tr><td><strong>First Contentful Paint</strong></td><td style="text-align:right">0.9 s</td><td style="text-align:right">1.0 s</td><td style="text-align:right">1.1 s</td><td style="text-align:right">1.8 s</td><td style="text-align:right">1.6 s</td></tr><tr><td><strong>Largest Contentful Paint</strong></td><td style="text-align:right">9.8 s</td><td style="text-align:right">2.1 s</td><td style="text-align:right">9.9 s</td><td style="text-align:right">2.1 s</td><td style="text-align:right">1.7 s</td></tr><tr><td><strong>Total Blocking Time</strong></td><td style="text-align:right">780 ms</td><td style="text-align:right">0 ms</td><td style="text-align:right">0 ms</td><td style="text-align:right">0 ms</td><td style="text-align:right">0 ms</td></tr><tr><td><strong>Cummulative Layout Shift</strong></td><td style="text-align:right">0.002</td><td style="text-align:right">0.002</td><td style="text-align:right">0.002</td><td style="text-align:right">0.002</td><td style="text-align:right">0.002</td></tr><tr><td><strong>Speed Index</strong></td><td style="text-align:right">0.9s</td><td style="text-align:right">1.1s</td><td style="text-align:right">1.1s</td><td style="text-align:right">1.8s</td><td style="text-align:right">1.6s</td></tr></tbody></table><p>These scores show that both Next.js and SvelteKit have dubious scores for &quot;Largest Contentful Paint&quot; when running in development mode. Perhaps that doesn't really matter.</p><p>When running in production mode, all of them have reasonably good scores.</p><h2 id="conclusion" tabindex="-1">Conclusion</h2><p>Htmx has a number of benefits over single page app (SPA) frameworks like React, Svelte, Vue, and Angular. In my opinion, the largest benefits are simplicity and a return to focusing on the web fundamentals of HTML and CSS. I feel more productive when using htmx.</p><p>I encourage you to give htmx a try in the next web app you create and judge for yourself whether it simplifies web development and makes you more productive.</p></article>