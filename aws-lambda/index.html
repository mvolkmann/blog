<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>AWS Lambda</h2><aside><nav class="toc"><ol><li><a href="#basics">Basics</a></li><li><a href="#accessing-dynamodb-in-a-lambda-function">Accessing DynamoDB in a Lambda Function</a></li></ol></nav></aside><article><style>img {
        border: 1px solid gray;
    }</style><h2 id="basics" tabindex="-1">Basics</h2><p>The steps to create a Java-based AWS Lambda function are:</p><ul><li><p>In IDEA, create a new Java Gradle project that uses Kotlin for the Gradle file.</p></li><li><p>In the file <code>build.gradle.kts</code>:</p><ul><li><p>Add the following dependencies:</p><pre class="language-kotlin"><code class="language-kotlin"><span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"com.amazonaws:aws-lambda-java-core:1.2.1"</span></span><span class="token punctuation">)</span><br><span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"com.amazonaws:aws-lambda-java-events:3.11.0"</span></span><span class="token punctuation">)</span></code></pre></li><li><p>Add the following task definition:</p><pre class="language-kotlin"><code class="language-kotlin">tasks<span class="token punctuation">.</span><span class="token function">jar</span> <span class="token punctuation">{</span><br>    manifest <span class="token punctuation">{</span><br>        attributes<span class="token punctuation">[</span><span class="token string-literal singleline"><span class="token string">"Main-Class"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"org.example.HelloLambda"</span></span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></li></ul></li><li><p>Create the file <code>src/main/java/org/example/HelloLambda.java</code> containing the following:</p><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span><br><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>amazonaws<span class="token punctuation">.</span>services<span class="token punctuation">.</span>lambda<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>amazonaws<span class="token punctuation">.</span>services<span class="token punctuation">.</span>lambda<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">RequestHandler</span></span><span class="token punctuation">;</span><br><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span><br><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloLambda</span> <span class="token keyword">implements</span> <span class="token class-name">RequestHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><br>    <span class="token annotation punctuation">@Override</span><br>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> input<span class="token punctuation">,</span> <span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token string">"Hello, "</span> <span class="token operator">+</span> input<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></li><li><p>In a terminal, enter <code>./gradlew jar</code>. This will create the file <code>build/libs/AWSLambdaDemo-1.0-SNAPSHOT.jar</code>.</p></li><li><p>Browse <a href="https://aws.amazon.com">https://aws.amazon.com</a>.</p></li><li><p>Click the &quot;Sign In to the Console&quot; button in the upper-right.</p></li><li><p>If you do not see &quot;Console Home&quot; and a &quot;Lambda&quot; link ...</p><ul><li>Click the waffle button in the upper-left.</li><li>Click &quot;Compute&quot; in the left nav.</li></ul></li><li><p>Click &quot;Lambda&quot;</p></li><li><p>Click the &quot;Create a function&quot; button.</p></li><li><p>Select the &quot;Author from scratch&quot; radio button (selected by default).</p></li><li><p>Enter a value for &quot;Function name&quot;.</p></li><li><p>Select a &quot;Runtime&quot; Java version such as &quot;Java 21&quot;.</p></li><li><p>Select an &quot;Architecture&quot; such as &quot;x86_64&quot; (selected by default).</p></li><li><p>Click the &quot;Create function&quot; button at the bottom.</p></li><li><p>Click the &quot;Upload from&quot; dropdown and select &quot;.zip or .jar file&quot;.</p></li><li><p>Click the &quot;Upload&quot; button.</p></li><li><p>Select the <code>.jar</code> file created above and click the &quot;Upload&quot; button.</p></li><li><p>Click the &quot;Save&quot; button.</p></li><li><p>In the &quot;Runtime settings&quot; section, click the &quot;Edit&quot; button.</p></li><li><p>Change the &quot;Handler&quot; string to &quot;org.example.HelloLambda::handleRequest&quot;.</p></li><li><p>Click the &quot;Save&quot; button.</p></li><li><p>Click the &quot;Test&quot; tab.</p></li><li><p>Enter an &quot;Event name&quot; like &quot;demo&quot;.</p></li><li><p>In the &quot;Event JSON&quot; section, change the content to the following:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"World"</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Click the &quot;Save&quot; button.</p></li><li><p>Click the &quot;Test&quot; button.</p></li><li><p>Expand &quot;Details&quot; in the light green section at the top.</p></li><li><p>Verify that output is &quot;Hello, World!&quot;.</p></li></ul><h2 id="accessing-dynamodb-in-a-lambda-function" tabindex="-1">Accessing DynamoDB in a Lambda Function</h2><p>Let's walk through the code and the steps to perform CRUD opertions in a DynamoDB index using a Lambda function.</p><p>The index being used contains the following attributes:</p><ul><li><code>pk</code>: the partition key which holds a unique value for each document</li><li><code>sk</code>: the sort key whose value is &quot;dog&quot; for every document</li><li><code>name</code>: the name of a dog</li><li><code>breed</code>: the breed of the dog</li></ul><p>The following code in the file <code>src/main/java/org/example/HelloLambda.java</code> implements a Lambda function that performs all the CRUD operations in a DynamoDB database.</p><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span><br><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>amazonaws<span class="token punctuation">.</span>services<span class="token punctuation">.</span>lambda<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>amazonaws<span class="token punctuation">.</span>services<span class="token punctuation">.</span>lambda<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">RequestHandler</span></span><span class="token punctuation">;</span><br><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span><br><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>services<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span></span><span class="token class-name">DynamoDbClient</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>enhanced<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span></span><span class="token class-name">DynamoDbEnhancedClient</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>enhanced<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span></span><span class="token class-name">DynamoDbTable</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>enhanced<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span></span><span class="token class-name">Key</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>enhanced<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span></span><span class="token class-name">TableSchema</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>services<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">DynamoDbException</span></span><span class="token punctuation">;</span><br><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><br><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloLambda</span> <span class="token keyword">implements</span> <span class="token class-name">RequestHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOG</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">HelloLambda</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> tableName <span class="token operator">=</span> <span class="token string">"dogs"</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">DynamoDbTable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dog</span><span class="token punctuation">></span></span> dogsTable<span class="token punctuation">;</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">HelloLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name">DynamoDbClient</span> client <span class="token operator">=</span> <span class="token class-name">DynamoDbClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token class-name">DynamoDbEnhancedClient</span> enhancedClient <span class="token operator">=</span><br>            <span class="token class-name">DynamoDbEnhancedClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dynamoDbClient</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        dogsTable <span class="token operator">=</span><br>            enhancedClient<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span>tableName<span class="token punctuation">,</span> <span class="token class-name">TableSchema</span><span class="token punctuation">.</span><span class="token function">fromBean</span><span class="token punctuation">(</span><span class="token class-name">Dog</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> breed<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DynamoDbException</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> pk <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span>pk<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        dogsTable<span class="token punctuation">.</span><span class="token function">putItem</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span> pk<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Dog</span> dog<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DynamoDbException</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Key</span> key <span class="token operator">=</span> <span class="token class-name">Key</span><br>            <span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">partitionValue</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span><span class="token function">getPk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">sortValue</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span><span class="token function">getSk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        dogsTable<span class="token punctuation">.</span><span class="token function">deleteItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DynamoDbException</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dog</span><span class="token punctuation">></span></span> dogs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">while</span> <span class="token punctuation">(</span>dogs<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Dog</span> dog <span class="token operator">=</span> dogs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">Dog</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> pk<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DynamoDbException</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Key</span> key <span class="token operator">=</span> <span class="token class-name">Key</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partitionValue</span><span class="token punctuation">(</span>pk<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sortValue</span><span class="token punctuation">(</span><span class="token string">"dog"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span> dogsTable<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dog</span><span class="token punctuation">></span></span> <span class="token function">getAllIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> dogsTable<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">/**<br>     * Returns a list of Dog objects sorted in ascending order on their names.<br>     */</span><br>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dog</span><span class="token punctuation">></span></span> <span class="token function">getAllList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name">SortedSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dog</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dog</span><span class="token punctuation">></span></span> iter <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dog</span><span class="token punctuation">></span></span> dogs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">while</span> <span class="token punctuation">(</span>dogs<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Dog</span> dog <span class="token operator">=</span> dogs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token constant">LOG</span><span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"printAll: dog = {}"</span><span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">rename</span><span class="token punctuation">(</span><span class="token class-name">String</span> pk<span class="token punctuation">,</span> <span class="token class-name">String</span> newName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DynamoDbException</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Dog</span> dog <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>pk<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        dog<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>newName<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        dogsTable<span class="token punctuation">.</span><span class="token function">putItem</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token annotation punctuation">@Override</span><br>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> input<span class="token punctuation">,</span> <span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">deleteAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> pk <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"Comet"</span><span class="token punctuation">,</span> <span class="token string">"Whippet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"Oscar"</span><span class="token punctuation">,</span> <span class="token string">"German Shorthaired Pointer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">rename</span><span class="token punctuation">(</span>pk<span class="token punctuation">,</span> <span class="token string">"Fireball"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">printAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span> <span class="token string">"Hello, "</span> <span class="token operator">+</span> input<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The following code in the file <code>src/main/java/org/example/Dog.java</code> defines the <code>Dog</code> class used above:</p><pre class="language-java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span><br><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>enhanced<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">DynamoDbBean</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>enhanced<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">DynamoDbPartitionKey</span></span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token import"><span class="token namespace">software<span class="token punctuation">.</span>amazon<span class="token punctuation">.</span>awssdk<span class="token punctuation">.</span>enhanced<span class="token punctuation">.</span>dynamodb<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">DynamoDbSortKey</span></span><span class="token punctuation">;</span><br><br><span class="token annotation punctuation">@DynamoDbBean</span><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dog</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">private</span> <span class="token class-name">String</span> pk<span class="token punctuation">;</span><br>    <span class="token keyword">private</span> <span class="token class-name">String</span> sk<span class="token punctuation">;</span><br>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span><br>    <span class="token keyword">private</span> <span class="token class-name">String</span> breed<span class="token punctuation">;</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token class-name">String</span> pk<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> breed<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>pk <span class="token operator">=</span> pk<span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>sk <span class="token operator">=</span> <span class="token string">"dog"</span><span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>breed <span class="token operator">=</span> breed<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token annotation punctuation">@Override</span><br>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Dog</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getBreed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>breed<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBreed</span><span class="token punctuation">(</span><span class="token class-name">String</span> breed<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>breed <span class="token operator">=</span> breed<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token annotation punctuation">@DynamoDbPartitionKey</span><br>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pk<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPk</span><span class="token punctuation">(</span><span class="token class-name">String</span> pk<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>pk <span class="token operator">=</span> pk<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token annotation punctuation">@DynamoDbSortKey</span><br>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sk<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSk</span><span class="token punctuation">(</span><span class="token class-name">String</span> sk<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>sk <span class="token operator">=</span> sk<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token annotation punctuation">@Override</span><br>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token string">"Dog [pk="</span> <span class="token operator">+</span> pk <span class="token operator">+</span> <span class="token string">", sk="</span> <span class="token operator">+</span> sk <span class="token operator">+</span><br>            <span class="token string">", name="</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">", breed="</span> <span class="token operator">+</span> breed <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The following <code>build.gradle.kts</code> file is used to create a <code>.zip</code> file that contains everything needed to deploy the Lambda function:</p><pre class="language-kotlin"><code class="language-kotlin">plugins <span class="token punctuation">{</span><br>    <span class="token function">id</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"java"</span></span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br>group <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"org.example"</span></span><br>version <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"1.0-SNAPSHOT"</span></span><br><br>repositories <span class="token punctuation">{</span><br>    <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br>dependencies <span class="token punctuation">{</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"ch.qos.logback:logback-classic:1.5.7"</span></span><span class="token punctuation">)</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"com.amazonaws:aws-lambda-java-core:1.2.3"</span></span><span class="token punctuation">)</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"com.amazonaws:aws-lambda-java-events:3.13.0"</span></span><span class="token punctuation">)</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"org.slf4j:slf4j-api:2.0.16"</span></span><span class="token punctuation">)</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"software.amazon.awssdk:dynamodb:2.27.6"</span></span><span class="token punctuation">)</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"software.amazon.awssdk:dynamodb-enhanced:2.27.6"</span></span><span class="token punctuation">)</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"software.amazon.awssdk:bom:2.27.6"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"software.amazon.awssdk:auth:2.27.6"</span></span><span class="token punctuation">)</span><br>    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"software.amazon.awssdk:core:2.27.6"</span></span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br>tasks<span class="token punctuation">.</span><span class="token function">jar</span> <span class="token punctuation">{</span><br>    manifest <span class="token punctuation">{</span><br>        attributes<span class="token punctuation">[</span><span class="token string-literal singleline"><span class="token string">"Main-Class"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"org.example.HelloLambda"</span></span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>tasks<span class="token punctuation">.</span>register<span class="token operator">&lt;</span>Zip<span class="token operator">></span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"zip"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token function">into</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"lib"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">from</span><span class="token punctuation">(</span>tasks<span class="token punctuation">.</span><span class="token function">named</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"jar"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>        <span class="token function">from</span><span class="token punctuation">(</span>configurations<span class="token punctuation">.</span>runtimeClasspath<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br>    <span class="token function">into</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"resources"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">from</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"src/main/resources"</span></span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The following <code>src/resources/logback.xml</code> file configures the use of SLF4J logging:</p><pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">></span></span><br>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">></span></span>%d{yyyy-MM-dd HH:mm:ss} %-5level %logger{36} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">></span></span><br><br>    <span class="token comment">&lt;!-- Set the root logger level --></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INFO<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>STDOUT<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">></span></span><br><br>    <span class="token comment">&lt;!-- Set logging level for specific packages --></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.example<span class="token punctuation">"</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>TRACE<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span></code></pre><p>To build the <code>.zip</code> file, enter <code>./gradlew zip</code>.</p><p>To upload the <code>.zip</code> file:</p><p>Click the &quot;Upload from&quot; button and select &quot;.zip or .jar file&quot; in the following screenshot.</p><p><img alt="AWS Lambda code upload #1" style="width: 100%" src="/blog/assets/aws-lambda-code-upload1.png?v=1.1.1"></p><p>Click the &quot;Upload&quot; button in the following screenshot.</p><p><img alt="AWS Lambda code upload #2" style="width: 60%" src="/blog/assets/aws-lambda-code-upload2.png?v=1.1.1"></p><p>Select the generated <code>.zip</code> file and click the &quot;Upload&quot; button in the following screenshot.</p><p><img alt="AWS Lambda code upload #3" style="width: 90%" src="/blog/assets/aws-lambda-code-upload3.png?v=1.1.1"></p><p>Click the &quot;Save&quot; button in the following screenshot.</p><p><img alt="AWS Lambda code upload #4" style="width: 60%" src="/blog/assets/aws-lambda-code-upload4.png?v=1.1.1"></p><p>To test the Lambda function:</p><p>Click the &quot;Test&quot; tab and click the &quot;Test&quot; button in the following screenshot.</p><p><img alt="AWS Lambda test #1" style="width: 100%" src="/blog/assets/aws-lambda-test1.png?v=1.1.1"></p><p>Expand the &quot;Details&quot; section and examine the &quot;Log output&quot; section in the following screenshot.</p><p><img alt="AWS Lambda test #2" style="width: 100%" src="/blog/assets/aws-lambda-test2.png?v=1.1.1"></p><p>To verify that the DynamoDB index was properly updated:</p><ul><li>Go the AWS Console Home page.</li><li>Click the &quot;DynamoDB&quot; link.</li><li>Click the &quot;Tables&quot; link.</li><li>Click the link for the specific table that was updated.</li><li>Click the &quot;Explore table items&quot; button.</li><li>Verify the documents shown in the &quot;Items returned&quot; section.</li></ul><p>This will display something similar to the screenshot below.</p><p><img alt="AWS DynamoDB results" style="width: 100%" src="/blog/assets/aws-dynamodb-results.png?v=1.1.1"></p></article>