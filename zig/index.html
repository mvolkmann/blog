<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Zig</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#used-by">Used By</a></li><li><a href="#run-time-checks">Run-time Checks</a></li><li><a href="#resources">Resources</a></li><li><a href="#installing">Installing</a></li><li><a href="#getting-started">Getting Started</a></li><li><a href="#tools">Tools</a></li><li><a href="#style">Style</a></li><li><a href="#projects">Projects</a><ol><li><a href="#zig-build">Zig build</a></li><li><a href="#custom-steps">Custom Steps</a></li></ol></li><li><a href="#packages%2Fmodules">Packages/Modules</a></li><li><a href="#comments">Comments</a></li><li><a href="#printing">Printing</a></li><li><a href="#types">Types</a><ol><li><a href="#primitive-types">Primitive Types</a></li><li><a href="#non-primitive-types">Non-primitive Types</a></li></ol></li><li><a href="#variables">Variables</a></li><li><a href="#optionals-(aka-nullables)">Optionals (aka Nullables)</a></li><li><a href="#keywords">Keywords</a></li><li><a href="#operators">Operators</a></li><li><a href="#pointers">Pointers</a></li><li><a href="#ranges">Ranges</a></li><li><a href="#enumerations">Enumerations</a></li><li><a href="#arrays">Arrays</a></li><li><a href="#slices">Slices</a></li><li><a href="#defer-and-errdefer">defer and errdefer</a></li><li><a href="#strings">Strings</a></li><li><a href="#structs">Structs</a></li><li><a href="#tuples">Tuples</a></li><li><a href="#unions">Unions</a></li><li><a href="#blocks">Blocks</a></li><li><a href="#control-structures">Control Structures</a><ol><li><a href="#if-expressions">if Expressions</a></li><li><a href="#switch-expressions">switch Expressions</a></li><li><a href="#while-expressions">while Expressions</a></li><li><a href="#for-expressions">for Expressions</a></li><li><a href="#labeled-blocks">Labeled Blocks</a></li></ol></li><li><a href="#error-handling">Error Handling</a></li><li><a href="#unreachable-code-paths">Unreachable Code Paths</a></li><li><a href="#functions">Functions</a></li><li><a href="#duck-typing-with-anytype">Duck Typing with anytype</a></li><li><a href="#comptime-keyword">comptime Keyword</a></li><li><a href="#inline-keyword">inline Keyword</a></li><li><a href="#reflection">Reflection</a></li><li><a href="#allocators">Allocators</a></li><li><a href="#standard-library">Standard Library</a><ol><li><a href="#arraylist">ArrayList</a></li><li><a href="#multiarraylist">MultiArrayList</a></li><li><a href="#hashmap">HashMap</a></li><li><a href="#sets">Sets</a></li></ol></li><li><a href="#builtin-functions">Builtin Functions</a><ol><li><a href="#math-builtin-functions-(25)">Math Builtin Functions (25)</a></li><li><a href="#bitwise-builtin-functions-(8)">Bitwise Builtin Functions (8)</a></li><li><a href="#atomic-and-memory-builtin-functions-(12)">Atomic and Memory Builtin Functions (12)</a></li><li><a href="#cast-and-conversion-builtin-functions-(20)">Cast and Conversion Builtin Functions (20)</a></li><li><a href="#programming-builtin-functions-(18)">Programming Builtin Functions (18)</a></li><li><a href="#runtime-and-async-builtin-functions-(3)">Runtime and Async Builtin Functions (3)</a></li><li><a href="#introspection-builtin-functions-(11)">Introspection Builtin Functions (11)</a></li><li><a href="#metaprogramming-builtin-functions-(10)">Metaprogramming Builtin Functions (10)</a></li><li><a href="#other-builtin-functions-(11)">Other Builtin Functions (11)</a></li><li><a href="#hashmap-1">HashMap</a></li><li><a href="#sets-1">Sets</a></li><li><a href="#multiarraylist-1">MultiArrayList</a></li></ol></li><li><a href="#builtin-functions-1">Builtin Functions</a><ol><li><a href="#math-builtin-functions">Math Builtin Functions</a></li><li><a href="#bitwise-builtin-functions">Bitwise Builtin Functions</a></li><li><a href="#atomic-and-memory-builtin-functions">Atomic and Memory Builtin Functions</a></li><li><a href="#cast-and-conversion-builtin-functions">Cast and Conversion Builtin Functions</a></li><li><a href="#programming-builtin-functions">Programming Builtin Functions</a></li><li><a href="#runtime-and-async-builtin-functions">Runtime and Async Builtin Functions</a></li><li><a href="#introspection-builtin-functions">Introspection Builtin Functions</a></li><li><a href="#metaprogramming-builtin-functions">Metaprogramming Builtin Functions</a></li><li><a href="#other-builtin-functions">Other Builtin Functions</a></li><li><a href="#hashmap-2">HashMap</a></li><li><a href="#sets-2">Sets</a></li><li><a href="#multiarraylist-2">MultiArrayList</a></li></ol></li><li><a href="#builtin-functions-2">Builtin Functions</a><ol><li><a href="#math-builtin-functions-1">Math Builtin Functions</a></li><li><a href="#bitwise-builtin-functions-1">Bitwise Builtin Functions</a></li><li><a href="#atomic-and-memory-builtin-functions-1">Atomic and Memory Builtin Functions</a></li><li><a href="#cast-and-conversion-builtin-functions-1">Cast and Conversion Builtin Functions</a></li><li><a href="#programming-builtin-functions-1">Programming Builtin Functions</a></li><li><a href="#runtime-and-async-builtin-functions-1">Runtime and Async Builtin Functions</a></li><li><a href="#introspection-builtin-functions-1">Introspection Builtin Functions</a></li><li><a href="#metaprogramming-builtin-functions-1">Metaprogramming Builtin Functions</a></li><li><a href="#other-builtin-functions-1">Other Builtin Functions</a></li></ol></li><li><a href="#tests">Tests</a></li><li><a href="#command-line-arguments">Command-line Arguments</a></li><li><a href="#safety-checks">Safety Checks</a></li><li><a href="#stack-example">Stack Example</a></li><li><a href="#writing-and-reading-files">Writing and Reading Files</a></li><li><a href="#http">HTTP</a></li><li><a href="#compiling-c-and-c%2B%2B">Compiling C and C++</a></li><li><a href="#continue-cleanup-of-everything-below-here!">CONTINUE CLEANUP OF EVERYTHING BELOW HERE!</a></li></ol></nav></aside><article><style>img {
        border: 1px solid gray;
    }</style><h2 id="overview" tabindex="-1">Overview</h2><figure style="width: 50%"><img alt="Ziggy, the Zig mascot" src="/blog/assets/ziggy.svg?v=1.0.22"><figcaption>Ziggy, the lizard Zig mascot</figcaption></figure><p><a href="https://ziglang.org?v=1.0.22" rel="noopener" target="_blank">Zig</a> is a free, open source, high performance, systems programming language. It is a modern alternative to C with similar syntax such as statements terminated with semicolons and conditions in parentheses.</p><p>Zig provides a complete, LLVM-based toolchain for creating, developing, building, and testing apps written in Zig, C, and C++. There are advantages to building apps with the Zig compiler even if they have no Zig code and only use C and/or C++ code.</p><p>Zig is suitable for applications that care deeply about performance, binary size, and/or memory usage. Often these concerns justify the tedium of manual memory management that is required due to lack of automated garbage collection.</p><p>One appeal of Zig is that it is simpler than C++ and Rust.</p><p>Zig emphasizes:</p><ul><li><p>No hidden control flow</p><p>Examples of hidden control flow in other languages include exception handling, operator overloading, destructors, and decorators.</p></li><li><p>No hidden memory allocations</p><p>All memory allocation is performed by allocators that the developer selects. Each kind of allocation implements a different allocation strategy. Zig does not support closures, so allocations to not outlive their scope.</p></li><li><p>No preprocessors or macros</p><p>In place of these, Zig uses code that runs at compile-time, indicated by the <code>comptime</code> keyword.</p></li><li><p>Having only one way to accomplish each task.</p></li></ul><p>Zig includes:</p><ul><li>a package manager</li><li>a build system that is simpler that the combinations of build tools typically used with C and C++</li><li>a build system API (used in <code>build.zig</code> files)</li><li>cross-compilation support</li><li>a test runner</li><li>ability to target all platforms supported by LLVM, including WebAssembly</li></ul><p>Zig is not an object-oriented (OO) programming language. There is no support for defining classes, using inheritance, or using polymorphism. However, Zig does support defining structs with methods and for many applications that is close enough to OO.</p><p>Andrew Kelly began work on Zig in August, 2015 (first commit). The first public release was in February, 2016.</p><p>Despite still being in beta, it has been adopted by many projects. The current version of Zig is 0.11.0 and is expected to reach 1.0 in 2025.</p><p>Development of Zig is managed by the Zig Software Foundation (ZSF) which is a non-profit organization. &quot;The mission of the Zig Software Foundation is to promote, protect, and advance the Zig programming language, to support and facilitate the growth of a diverse and international community of Zig programmers, and to provide education and guidance to students, teaching the next generation of programmers to be competent, ethical, and to hold each other to high standards.&quot;</p><p>Originally the Zig compiler was implemented in C++. The 0.10.0 version of Zig changed to a self-hosted compiler which means it is implemented in Zig.</p><h2 id="used-by" tabindex="-1">Used By</h2><ul><li><p><a href="https://bun.sh?v=1.0.22" rel="noopener" target="_blank">Bun</a> - a JavaScript/TypeScript runtime and toolchain, is primarily written in Zig. Bun has many advantages over Node.js and Deno including much better performance.</p></li><li><p><a href="https://tigerbeetle.com?v=1.0.22" rel="noopener" target="_blank">TigerBeetle</a> is &quot;the world's fastest financial accounting database&quot;.</p></li><li><p><a href="https://www.roc-lang.org?v=1.0.22" rel="noopener" target="_blank">Roc</a> - &quot;a fast, friendly, functional language&quot; &quot;Roc's compiler has always been written in Rust. Roc's standard library was briefly written in Rust, but was soon rewritten in Zig.&quot;</p></li><li><p><a href="https://machengine.org?v=1.0.22" rel="noopener" target="_blank">Mach</a> - a game engine and graphics toolkit, is implemented in Zig.</p></li><li><p><a href="https://www.uber.com/blog/bootstrapping-ubers-infrastructure-on-arm64-with-zig/?v=1.0.22" rel="noopener" target="_blank">Uber</a> uses Zig to build its C++ applications for x86_64 and arm64.</p></li><li><p><a href="https://mitchellh.com/ghostty?v=1.0.22" rel="noopener" target="_blank">Ghosty</a> terminal emulator</p></li></ul><h2 id="run-time-checks" tabindex="-1">Run-time Checks</h2><p>Zig provides the following run-time checks:</p><ul><li>bounds checking of array and slice indexing at compile-time when index is known at compile-time and at run-time otherwise</li><li>pointers cannot be null unless declared to be optional</li><li>optional pointers must be checked for null before they are dereferenced</li><li>tagged unions cannot be accessed without verifying the tag</li><li>detects arithmetic underflow and overflow when casting between numeric types</li><li>checks for correct alignment when casting between pointer types</li></ul><h2 id="resources" tabindex="-1">Resources</h2><ul><li><a href="https://ziglang.org?v=1.0.22" rel="noopener" target="_blank">Zig home page</a></li><li><a href="https://ziglang.org/documentation/master/std/#A;std?v=1.0.22" rel="noopener" target="_blank">Zig Standard Library</a></li><li><a href="https://github.com/ziglang/zig?v=1.0.22" rel="noopener" target="_blank">Zig GitHub repository</a></li><li><a href="https://blog.logrocket.com/getting-started-zig-programming-language/?v=1.0.22" rel="noopener" target="_blank">Getting started with the Zig programming language</a></li><li><a href="https://ziglings.org?v=1.0.22" rel="noopener" target="_blank">Ziglings</a> - &quot;A series of tiny broken programs ... By fixing them, you'll learn how to read and write Zig code.&quot;</li><li><a href="https://ziglearn.org?v=1.0.22" rel="noopener" target="_blank">ziglearn.org</a></li><li><a href="https://discord.com/servers/zig-programming-language-605571803288698900?v=1.0.22" rel="noopener" target="_blank">Zig Discord server</a></li><li><a href="https://en.wikipedia.org/wiki/Zig_(programming_language)?v=1.0.22" rel="noopener" target="_blank">Wikipedia</a></li><li><a href="https://zig.news?v=1.0.22" rel="noopener" target="_blank">Zig News</a></li><li><a href="https://github.com/nrdmn/awesome-zig?v=1.0.22" rel="noopener" target="_blank">awesome-zig</a> collection of open-source Zig libraries</li></ul><h2 id="installing" tabindex="-1">Installing</h2><p>To install, download a platform-specific zip or tar file from the <a href="https://ziglang.org/download/?v=1.0.22" rel="noopener" target="_blank">Releases</a> page, expand it, move the directory this creates to a desired location, set the environment variable <code>ZIG_PATH</code> to point to this directory, and add <code>ZIG_PATH</code> to the list of directories in the <code>PATH</code> environment variable.</p><p>Consider downloading a nightly build in order to use the very latest version.</p><p>In macOS and easier option is to install Zig with Homebrew by entering <code>brew install zig</code>. However, this may currently only work on Macs with Intel-based processors.</p><p>For more detail on installation options, see <a href="https://ziglang.org/learn/getting-started/#installing-zig?v=1.0.22" rel="noopener" target="_blank">Installing Zig</a>.</p><h2 id="getting-started" tabindex="-1">Getting Started</h2><p>The following code, in the file <code>hello.zig</code> is a basic hello world program.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// s for string, d for decimal</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Hello {s}! {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token string">"Zig"</span><span class="token punctuation">,</span> <span class="token number">2023</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The first argument to <code>print</code> is a format string that can contain <code>{}</code> placeholders where values are to be inserted. The second argument to <code>print</code> is a literal array that holds values to be inserted in place of the format string placeholders. The syntax <code>.{}</code> is the literal syntax for both arrays and structs (more on these later). This can contain a comma-separated list of either array items or struct field assignments.</p><p>The <code>zig</code> executable handles everything that can be done with a Zig program. For help on what it can do, enter <code>zig --help</code>. For help on a specific command that follows <code>zig</code>, enter <code>zig {command} --help</code>.</p><p>To build and run the program above, enter <code>zig run hello.zig</code>.</p><p>To create an executable, enter <code>zig build-exe --name hello hello.zig</code>.</p><p>To run the executable, enter <code>./hello</code>.</p><p>To format a <code>.zig</code> source file, enter <code>zig fmt {file-name}.zig</code>.</p><p>There is no linter for Zig, but the Zig compiler provides more guidance than most compilers.</p><p>To see a list of Zig guiding principles, enter <code>zig zen</code>.</p><p>Later we will discuss Zig projects that typically contain multiple <code>.zig</code> source files.</p><h2 id="tools" tabindex="-1">Tools</h2><p>For VS Code, see the extension <a href="https://github.com/ziglang/vscode-zig?v=1.0.22" rel="noopener" target="_blank">Zig Language</a>.</p><p>Editor extensions typically handle unused variables by adding a line that uses them. For example, if the variable <code>foo</code> is unused, the line <code>_ = foo;</code> will be added immediately after its declaration.</p><h2 id="style" tabindex="-1">Style</h2><p>Zig has an official <a href="https://ziglang.org/documentation/0.11.0/#Style-Guide?v=1.0.22" rel="noopener" target="_blank">Style Guide</a> that is not enforced by the compiler. At a high level it specifies the following:</p><ul><li>4-space indentation</li><li>open braces on the same line or the last of wrapped lines</li><li>maximum line length is 100</li><li>function names should be camelCase<ul><li>but functions that return a type should be TitleCase</li></ul></li><li>type names should be TitleCase</li><li>variable names should be snake_case</li><li>names of files that define a struct should have the same name as the struct which uses TitleCase</li><li>all other file names should be snake_case</li><li>directory names should be snake_case</li></ul><h2 id="projects" tabindex="-1">Projects</h2><p>To create a new Zig project, create a directory for it, cd to the directory, and enter <code>zig init-exe</code>. This creates the file <code>build.zig</code> and a <code>src</code> directory containing the file <code>main.zig</code>.</p><h3 id="zig-build" tabindex="-1">Zig build</h3><p>The file <code>build.zig</code> is a build script that uses the compiler API. Modify this file to change the characteristics of executable that is produced and to modify the &quot;steps&quot;.</p><p>For help on build options, enter <code>zig build --help</code> or <code>-h</code>.</p><p>Build steps are similar to npm <code>package.json</code> scripts. To see the available steps, enter <code>zig build --list-steps</code> or <code>-l</code>. The steps provided by default are:</p><ul><li><code>install</code>: copies build artifacts to the default install path</li><li><code>uninstall</code>: removes build artifacts from the default install path</li><li><code>run</code>: runs the app</li><li><code>test</code>: runs all the unit tests</li></ul><p>To run a step, enter <code>zig build {step-name}</code>. If no step name is provided, it defaults to <code>install</code>.</p><p>The file <code>main.zig</code> is the starting point of the project. Like many <code>.zig</code> files, this begins by importing the standard library with <code>const std = @import(&quot;std&quot;);</code> It also defines the main function with <code>pub fn main() !void { ... }</code>. The <code>!</code> means the function can return an error value. If an error is returned from the <code>main</code> function, it panics and prints a stack trace.</p><p>To build an executable, <code>cd</code> to a project directory that contains a <code>build.zig</code> file and enter <code>zig build</code>. This runs the <code>build</code> function defined in the <code>build.zig</code> file. It creates an executable file with same name as the project in the <code>zig-out/bin</code> directory.</p><p>To customize the optimizations to be performed, add the <code>-Doptimize=value</code> where <code>value</code> is one of the following:</p><table><thead><tr><th><code>-Doptimize</code> value</th><th>Runtime safety checks</th><th>Optimizations</th></tr></thead><tbody><tr><td><code>Debug</code></td><td>Yes</td><td>No</td></tr><tr><td><code>ReleaseSafe</code></td><td>Yes</td><td>Yes (speed)</td></tr><tr><td><code>ReleaseFast</code></td><td>No</td><td>Yes (speed)</td></tr><tr><td><code>ReleaseSmall</code></td><td>No</td><td>Yes (size)</td></tr></tbody></table><p>By default, executables are created for the current CPU architecture and OS and the <code>Debug</code> optimizations are applied.</p><p>To build an executable for a different target, add the <code>-Dtarget</code> option with a value that describes a CPU architecture followed by a dash and an operating system. For example, to build a Windows executable add <code>-Dtarget=x86_64-windows</code>. This creates a file with a <code>.exe</code> extension in the <code>zig-out/bin</code> directory.</p><p>To see a list of supported targets, enter <code>zig targets</code>. This outputs a large amount of JSON. See the values of the keys &quot;arch&quot; and &quot;os&quot; which are JSON arrays of string values.</p><p>To build and run the app, enter <code>zig build run</code>.</p><p>To build and run all the tests, enter <code>zig build test</code>. This runs all tests found in <code>main.zig</code> and all <code>.zig</code> files that are directly or indirectly imported from <code>main.zig</code>. Tests in unused <code>.zig</code> files are not run.</p><p>The object files produced by the compiler are stored in the <code>zig-cache</code> directory. This allows subsequent builds to avoid recompiling source files that have not changed since the last build.</p><p>The executable file produced by a build is stored in <code>zig-out/bin/{project-name}</code>.</p><h3 id="custom-steps" tabindex="-1">Custom Steps</h3><p>The <code>build.zig</code> file in a project can define additional steps. To do this, define what the step does in a function like the following:</p><pre class="language-zig"><code class="language-zig"><span class="token comment">// The first parameter is "self" and second is "progress",</span><br><span class="token comment">// but use "_" if unused.</span><br><span class="token comment">// The fields in a std.build.Step struct instance include</span><br><span class="token comment">// name, dependencies, dependants, state, and more.</span><br><span class="token comment">// The std.Progress.Node struct instance doesn't seem very useful.</span><br><span class="token keyword">fn</span> <span class="token function">demoTask</span><span class="token punctuation">(</span>step<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>std<span class="token punctuation">.</span>build<span class="token punctuation">.</span>Step</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>std<span class="token punctuation">.</span>Progress<span class="token punctuation">.</span>Node</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"in {s} task\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>step<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// demo</span><br><br>    <span class="token comment">// Print the name of each step field.</span><br>    <span class="token comment">// const fieldNames = std.meta.fieldNames(std.build.Step);</span><br>    <span class="token comment">// for (fieldNames) |fieldName| {</span><br>    <span class="token comment">//     print("step field = {s}\n", .{fieldName});</span><br>    <span class="token comment">// }</span><br><br>    <span class="token comment">// Print the name of each progress field.</span><br>    <span class="token comment">// const fieldNames = std.meta.fieldNames(std.Progress.Node);</span><br>    <span class="token comment">// for (fieldNames) |fieldName| {</span><br>    <span class="token comment">//     print("progress field = {s}\n", .{fieldName});</span><br>    <span class="token comment">// }</span><br><span class="token punctuation">}</span></code></pre><p>Then register this function inside the provided <code>build</code> function as follows:</p><pre class="language-zig"><code class="language-zig">    <span class="token comment">// The first argument is the step name and the second is the</span><br>    <span class="token comment">// description that appears when `zig build --list-steps` is entered.</span><br>    <span class="token keyword">const</span> demo_step <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token string">"demo"</span><span class="token punctuation">,</span> <span class="token string">"does stuff"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    demo_step<span class="token punctuation">.</span>makeFn <span class="token operator">=</span> demoTask<span class="token punctuation">;</span><br><br>    <span class="token comment">// Optionally depend on another step such as the "run" step</span><br>    <span class="token comment">// to execute it before the custom step.</span><br>    <span class="token comment">// demo_step.dependOn(&amp;run_cmd.step);</span></code></pre><p>To run this custom step, enter <code>zig build demo</code>.</p><h2 id="packages%2Fmodules" tabindex="-1">Packages/Modules</h2><p>Zig uses the terms &quot;package&quot; and &quot;module&quot; interchangeably to refer to a collection of public variables and functions that are defined in a source file.</p><p>To define a package, create a source file whose file name is the package name. Prefix all constants and functions to be exposed with the <code>pub</code> keyword. The file can also define non-public variables and functions that are only used by other functions defined in the file.</p><p>For example, the file <code>my_package.zig</code> could contains the following:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">pub</span> <span class="token keyword">const</span> gretzky <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">double</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>To import a package, use the builtin function <code>@import</code>. The file path passed to this function can be absolute, relative, or the name of a builtin packages such as &quot;std&quot;. The <code>@import</code> function returns a <code>struct</code> instance whose fields are the public values defined in the imported file.</p><p>For example, to import and use the package defined in <code>my_package.zig</code> above within the file <code>main.zig</code>, write the following:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"my_package.zig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"gretzky = {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>pkg<span class="token punctuation">.</span>gretzky<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 99</span><br><br>    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> result <span class="token operator">=</span> pkg<span class="token punctuation">.</span><span class="token function">double</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result = {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span><br><span class="token punctuation">}</span></code></pre><p>The Zig standard library uses the same mechanism described above, but in a nested fashion. Here is a portion of the files in the Zig GitHub repository that define the standard library:</p><ul><li><code>lib</code><ul><li><code>std</code><ul><li><p><code>std.zig</code></p><pre class="language-zig"><code class="language-zig"><span class="token keyword">pub</span> <span class="token keyword">const</span> array_hash_map <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"array_hash_map.zig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">pub</span> <span class="token keyword">const</span> ArrayHashMap <span class="token operator">=</span> array_hash_map<span class="token punctuation">.</span>ArrayHashMap<span class="token punctuation">;</span><br><span class="token keyword">pub</span> <span class="token keyword">const</span> ArrayHashMapUnmanaged <span class="token operator">=</span><br>    array_hash_map<span class="token punctuation">.</span>ArrayHashMapUnmanaged<span class="token punctuation">;</span><br><span class="token keyword">pub</span> <span class="token keyword">const</span> ArrayList <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"array_list.zig"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span><br><span class="token comment">// more top-level types</span><br><br><span class="token keyword">pub</span> <span class="token keyword">const</span> atomic <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"atomic.zig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">// more top-level namespaces from other source files</span><br><br><span class="token comment">// more stuff</span></code></pre></li><li><p><code>array_hash_map.zig</code>: imported by <code>std.zig</code></p></li><li><p><code>array_list.zig</code>: imported by <code>std.zig</code></p></li><li><p><code>atomic.zig</code>: imported by <code>std.zig</code></p></li><li><p><code>atomic</code></p><ul><li><code>Atomic.zig</code>: imported by <code>atomic.zig</code></li><li><code>queue.zig</code>: imported by <code>atomic.zig</code></li><li><code>stack.zig</code>: imported by <code>atomic.zig</code></li></ul></li><li><p><code>math.zig</code>: imported by <code>std.zig</code></p></li><li><p><code>math</code></p><ul><li><code>acos.zig</code>: imported by <code>math.zig</code></li><li><code>acosh.zig</code>: imported by <code>math.zig</code></li><li>... more <code>.zig</code> files imported by <code>math.zig</code></li></ul></li></ul></li></ul></li></ul><h2 id="comments" tabindex="-1">Comments</h2><p>Single-line comments begin with <code>//</code>.</p><p>Zig does not support multi-line comments. It relies on code editors to make it easy to comment and uncomment ranges of lines.</p><p>Top-level comments begin with <code>//!</code>. These are used to document the current module (source file).</p><p>Doc comments begin with <code>///</code>. These are used to document variables and functions.</p><h2 id="printing" tabindex="-1">Printing</h2><p>Zig provides several functions that write to stderr. Perhaps the most commonly used is <code>std.debug.print</code>. Others include <code>std.log.info</code>, <code>std.log.debug</code>, <code>std.log.warn</code>, and <code>std.log.err</code>, in order from least to most severe.</p><p>The <code>print</code> function takes a format string and a possibly empty literal array of values to be inserted in place of the format string placeholders. The format string can contain placeholders with the syntax <code>{specifier}</code> that indicate where values in the second argument are to be inserted.</p><p>The following format specifiers are supported:</p><table><thead><tr><th>Specifier</th><th>Prints</th></tr></thead><tbody><tr><td><code>any</code></td><td>value of any type using its default format</td></tr><tr><td><code>b</code></td><td>integer value in binary notation</td></tr><tr><td><code>c</code></td><td>integer as ASCII character (maximum of 8 bits)</td></tr><tr><td><code>d</code></td><td>numeric value in decimal notation</td></tr><tr><td><code>e</code></td><td>floating point value in scientific notation</td></tr><tr><td><code>o</code></td><td>integer value in octal notation</td></tr><tr><td><code>s</code></td><td>slices of <code>u8</code></td></tr><tr><td><code>s</code></td><td>pointer-to-many and C pointers of <code>u8</code></td></tr><tr><td><code>u</code></td><td>integer as UTF-8 sequence (maximum of 21 bits)</td></tr><tr><td><code>X</code></td><td>numeric value in uppercase hexadecimal notation</td></tr><tr><td><code>x</code></td><td>numeric value in lowercase hexadecimal notation</td></tr><tr><td><code>?</code></td><td>optional value as either the unwrapped value or <code>null</code>;<br>may be followed by a format specifier for the underlying value</td></tr><tr><td><code>!</code></td><td>error union value as either the unwrapped value or the formatted error value;<br>may be followed by a format specifier for the underlying value</td></tr><tr><td><code>*</code></td><td>address of the value</td></tr></tbody></table><p>Often placeholders do not need to specify a format because the correct formatting is used by default. In these cases, placeholders can be written as <code>{}</code>.</p><p>A common error is to pass a single value as the second argument instead of a literal array. The compiler will output the error &quot;expected tuple or struct argument, found {type-passed}&quot;.</p><p>The <code>std.log.*</code> functions take the same arguments as <code>std.debug.print</code>, but produce output the begins with their level followed by a colon and a space. For example, <code>std.log.warn(&quot;{} is too large!&quot;, .{score});</code> prints a message like &quot;warning: 19 is too large!&quot;. These log functions add their own newline at the end of each output.</p><p>To set the logging level, define the public constant <code>std_options</code>. For example, the following suppresses output from <code>std.log.info</code> and <code>std-log-debug</code>.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">pub</span> <span class="token keyword">const</span> <span class="token class-name">std_options</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    <span class="token comment">// This sets the default logging level.</span><br>    <span class="token comment">// Set to .info, .debug, .warn, or .err.</span><br>    <span class="token keyword">pub</span> <span class="token keyword">const</span> log_level <span class="token operator">=</span> <span class="token punctuation">.</span>warn<span class="token punctuation">;</span><br><br>    <span class="token comment">// This sets scope-specific logging levels.</span><br>    <span class="token keyword">pub</span> <span class="token keyword">const</span> log_scope_levels <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>std<span class="token punctuation">.</span>log<span class="token punctuation">.</span>ScopeLevel</span><span class="token punctuation">{</span><br>        <span class="token comment">// Can have one line like this for each scope.</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>scope <span class="token operator">=</span> <span class="token punctuation">.</span>my_library<span class="token punctuation">,</span> <span class="token punctuation">.</span>level <span class="token operator">=</span> <span class="token punctuation">.</span>info <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Log messages can be scoped to a particular part of an project. This is useful for better identifying log messages and for filtering log output from specific parts of a project.</p><p>Use the following instead of <code>std.log</code> to scope the log messages.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> log <span class="token operator">=</span> std<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">scoped</span><span class="token punctuation">(</span><span class="token punctuation">.</span>my_library<span class="token punctuation">)</span><span class="token punctuation">;</span><br>log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"testing"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output is "info(my_library): testing"</span></code></pre><p>TODO: How can you specify scope-specific logging levels?</p><p>For more detail, see <a href="https://gist.github.com/kassane/a81d1ae2fa2e8c656b91afee8b949426?v=1.0.22" rel="noopener" target="_blank">A simple overview of Zig's std.log</a>.</p><p>To write to stdout instead of stderr, do the following:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> stdout <span class="token operator">=</span> std<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token function">getStdOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> sow <span class="token operator">=</span> stdout<span class="token punctuation">.</span><span class="token function">writer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">try</span> sow<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Hello, {s}!\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token string">"world"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Structs can specify how they should be formatted for printing by implementing the <code>format</code> function. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    name<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>    breed<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>    age<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br><br>    <span class="token keyword">const</span> Self <span class="token operator">=</span> <span class="token builtin">@This</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">format</span><span class="token punctuation">(</span><br>        value<span class="token punctuation">:</span> <span class="token class-name">Self</span><span class="token punctuation">,</span><br>        <span class="token keyword">comptime</span> _<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>        _<span class="token punctuation">:</span> <span class="token class-name">std<span class="token punctuation">.</span>fmt<span class="token punctuation">.</span>FormatOptions</span><span class="token punctuation">,</span><br>        writer<span class="token punctuation">:</span> <span class="token keyword">anytype</span><span class="token punctuation">,</span><br>    <span class="token punctuation">)</span> <span class="token class-name">std<span class="token punctuation">.</span>os<span class="token punctuation">.</span>WriteError<span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> writer<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><br>            <span class="token string">"{s} is a {d} year old {s}."</span><span class="token punctuation">,</span><br>            <span class="token punctuation">.</span><span class="token punctuation">{</span> value<span class="token punctuation">.</span>name<span class="token punctuation">,</span> value<span class="token punctuation">.</span>age<span class="token punctuation">,</span> value<span class="token punctuation">.</span>breed <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token class-name">Dog</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Comet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"whippet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>dog<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Comet is a 3 year old whippet.</span><br><span class="token punctuation">}</span></code></pre><h2 id="types" tabindex="-1">Types</h2><p>Types in Zig, such as builtin types like <code>i32</code> and custom <code>struct</code> types, are first-class values. This means they can be assigned to variables, assigned to struct fields, passed to functions, and returned from functions.</p><h3 id="primitive-types" tabindex="-1">Primitive Types</h3><p>Zig supports a large number of primitive types.</p><ul><li><p>signed integers: <code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>i128</code>, or <code>i{any-number}</code></p></li><li><p>unsigned integers: <code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>u128</code>, or <code>u{any-number}</code></p><p>The <code>u8</code> type can be used to hold a single character. Single character literals are enclosed in single quotes.</p></li><li><p>floating point: <code>f16</code>, <code>f32</code>, <code>f64</code>, <code>f80</code>, <code>f128</code></p></li><li><p><code>isize</code>, <code>usize</code></p><p>These are signed and unsigned integers whose size is the pointer size of the current CPU.</p></li><li><p>C types: <code>c_char</code>, <code>c_short</code>, <code>c_ushort</code>, <code>c_int</code>, <code>c_uint</code>, <code>c_long</code>, <code>c_ulong</code>, <code>c_longlong</code>, <code>c_ulonglong</code>, <code>c_longdouble</code></p></li><li><p><code>bool</code> - boolean</p></li><li><p><code>anyopaque</code></p></li><li><p><code>void</code> - no value</p></li><li><p><code>noreturn</code></p><p>This is the type of functions that never finish. It is also the type of <code>break</code>, <code>continue</code>, <code>return</code>, <code>unreachable</code>, and the construct <code>while (true) { â€¦ }</code>.</p></li><li><p><code>type</code> - describes a type</p></li><li><p><code>anyerror</code></p></li><li><p><code>comptime_int</code> and <code>comptime_float</code></p><p>These are the types of compile-time known, literal integer and floating point values.</p></li></ul><p>In addition to these primitive types, &quot;arbitrary bit-width integers can be referenced by using an identifier of <code>i</code> or <code>u</code> followed by digits.&quot; For example, the identifier <code>u3</code> refers to an unsigned 3-bit integer. &quot;The maximum allowed bit-width of an integer type is 65535.&quot;</p><h3 id="non-primitive-types" tabindex="-1">Non-primitive Types</h3><p>The following is summary of Zig types from the Ziglings exercise #058. These will be discussed in more detail in subsequent sections.</p><table><thead><tr><th>Type</th><th>Meaning</th></tr></thead><tbody><tr><td><code>u8</code></td><td>single item</td></tr><tr><td><code>*u8</code></td><td>single-item pointer</td></tr><tr><td><code>[]u8</code></td><td>slice (size known at runtime)</td></tr><tr><td><code>[5]u8</code></td><td>array of 5 u8s</td></tr><tr><td><code>[*]u8</code></td><td>many-item pointer (zero or more)</td></tr><tr><td><code>enum</code></td><td><code>{a, b}</code> set of unique values a and b</td></tr><tr><td><code>error</code></td><td><code>{e, f}</code> set of unique error values e and f</td></tr><tr><td><code>struct</code></td><td><code>{y: u8, z: i32}</code> group of values y and z</td></tr><tr><td><code>union(enum)</code></td><td><code>{a: u8, b: i32}</code> single value either u8 or i32</td></tr></tbody></table><br><aside>Values of any of the above types can be assigned as "var" or "const" to allow or disallow changes (mutability) via the assigned name:<pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> a<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// immutable</span><br><span class="token keyword">var</span> b<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//   mutable</span></code></pre><p>We can also make error unions or optional types from any of the above:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">var</span> a<span class="token punctuation">:</span> <span class="token class-name">E<span class="token operator">!</span><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// can be u8 or error from set E</span><br><span class="token keyword">var</span> b<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment">// can be u8 or null</span></code></pre></aside><h2 id="variables" tabindex="-1">Variables</h2><p>The syntax for declaring a variable is:</p><pre class="language-zig"><code class="language-zig"><span class="token punctuation">{</span><span class="token keyword">const</span><span class="token operator">|</span><span class="token keyword">var</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token punctuation">:</span> <span class="token builtin-type keyword">type</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>The parts inside curly braces are required and the parts inside square brackets are optional.</p><p>Variable declared with <code>const</code> are immutable and variable declared with <code>var</code> are mutable. Using <code>const</code> is preferred when the value will not be modified.</p><p>Variable names must begin with a letter and are composed of letters, numbers, and ?. Variable names cannot match a keyword (listed in the next section). The convention for variable names is to use snake_case.</p><p>The type can be omitted if it can be inferred from the value.</p><p>An initial value is required, but can be set to <code>undefined</code> as way of stating that a value will be assigned later. The compiler does not currently check that the variable is set to another value before it is used. Accessing a variable that is still set to <code>undefined</code> produces unexpected results. Runtime checks for this may be added in the future.</p><p>There are four kinds of values a variable or expression can have that indicate that it doesn't have a real value, each with a different meaning.</p><ul><li><code>undefined</code>: no value yet and should not be used until one is assigned</li><li><code>null</code>: currently has no value, but may have before and may have later</li><li><code>void</code>: there will never be a value</li><li>any kind of error: no value because an error occurred</li></ul><p>The builtin function <code>@as</code> performs an explicit type coercion. This can be used to ensure that the initial value is treated as a specific type. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> limit <span class="token operator">=</span> <span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">i8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{d} is {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> limit<span class="token punctuation">,</span> <span class="token builtin">@typeName</span><span class="token punctuation">(</span><span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5 is i8</span></code></pre><p>Variable shadowing is not allowed. Variables cannot have the same name as another in an outer scope.</p><p>Zig does not allow unused variables. Editor extensions/plugins such as vscode-zig can add lines like <code>_ = my_variable</code> for each unused variable on save so they appear to be used. This feature may be enabled by default, can be disabled. In vscode-zig, the &quot;Zls: Enable Autofix&quot; option controls this.</p><h2 id="optionals-(aka-nullables)" tabindex="-1">Optionals (aka Nullables)</h2><p>The types of variables, struct fields, and function parameters can be optional. This allows them to have the value <code>null</code>. To declare a type to be optional, add a question mark before their type and give them a default value which may be <code>null</code>.</p><p>The following code demonstrates many features of working with optionals:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"optional"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> a<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i8</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// not optional</span><br>    <span class="token comment">// Placing "?" before a type makes it optional.</span><br>    <span class="token comment">// Only optional variables can be set to "null".</span><br>    <span class="token keyword">var</span> b<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span><span class="token builtin-type keyword">i8</span></span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br><br>    <span class="token comment">//TODO: Why does Zig require casting the 0 and null values here?</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This form of "if" statement can only be used with optional values.</span><br>    <span class="token comment">// If non-null, the unwrapped value is placed in value.</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">|</span>value<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>        <span class="token keyword">unreachable</span><span class="token punctuation">;</span> <span class="token comment">// verifies that b is non-null</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// The orelse operator unwraps the value if non-null</span><br>    <span class="token comment">// and uses the value that follows if null.</span><br>    <span class="token comment">// This is why the cast here is to i8 instead of ?i8.</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>b <span class="token keyword">orelse</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// "b.?" is equivalent to "b orelse unreachable".</span><br>    <span class="token comment">// It unwraps the value which is why the cast here is to i8 instead of ?i8.</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>b<span class="token operator">.?</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    b <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>b <span class="token keyword">orelse</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// _ = b.?; // results in "panic: attempt to use null value"</span><br><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">|</span>_<span class="token operator">|</span> <span class="token punctuation">{</span> <span class="token comment">// not using the unwrapped value</span><br>        <span class="token keyword">unreachable</span><span class="token punctuation">;</span> <span class="token comment">// verifies that b is null</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// This is a struct with optional fields.</span><br><span class="token keyword">const</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    name<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span>String</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>    breed<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span>String</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// This demonstrates using the orelse operator</span><br><span class="token comment">// which unwraps the value if non-null</span><br><span class="token comment">// and uses the value that follows if null.</span><br><span class="token keyword">fn</span> <span class="token function">present</span><span class="token punctuation">(</span>dog<span class="token punctuation">:</span> <span class="token class-name">Dog</span><span class="token punctuation">)</span> <span class="token class-name">String</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> dog<span class="token punctuation">.</span>name <span class="token keyword">orelse</span> dog<span class="token punctuation">.</span>breed <span class="token keyword">orelse</span> <span class="token string">"unknown"</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"struct with optional fields"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dog1 <span class="token operator">=</span> <span class="token class-name">Dog</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Comet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"Whippet"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dog2 <span class="token operator">=</span> <span class="token class-name">Dog</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Oscar"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dog3 <span class="token operator">=</span> <span class="token class-name">Dog</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"Beagle"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dog4 <span class="token operator">=</span> <span class="token class-name">Dog</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>Dog</span><span class="token punctuation">{</span> dog1<span class="token punctuation">,</span> dog2<span class="token punctuation">,</span> dog3<span class="token punctuation">,</span> dog4 <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"Comet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog1<span class="token punctuation">.</span>breed<span class="token punctuation">,</span> <span class="token string">"Whippet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"Oscar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span>breed<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog3<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog3<span class="token punctuation">.</span>breed<span class="token punctuation">,</span> <span class="token string">"Beagle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog4<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog4<span class="token punctuation">.</span>breed<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">//TODO: Why is the cast to String necessary here?</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">present</span><span class="token punctuation">(</span>dog1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Comet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">present</span><span class="token punctuation">(</span>dog2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Oscar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">present</span><span class="token punctuation">(</span>dog3<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Beagle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">present</span><span class="token punctuation">(</span>dog4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"unknown"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The output from this loop should be:</span><br>    <span class="token comment">// name = Comet</span><br>    <span class="token comment">// breed = Whippet</span><br>    <span class="token comment">// present = Comet</span><br>    <span class="token comment">// name = Oscar</span><br>    <span class="token comment">// present = Oscar</span><br>    <span class="token comment">// breed = Beagle</span><br>    <span class="token comment">// present = Beagle</span><br>    <span class="token comment">// present = unknown</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>dogs<span class="token punctuation">)</span> <span class="token operator">|</span>dog<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token operator">|</span>name<span class="token operator">|</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"name = {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span> <span class="token operator">|</span>breed<span class="token operator">|</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"breed = {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>breed<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"present = {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token function">present</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="keywords" tabindex="-1">Keywords</h2><p>Zig supports the following keywords which cannot be used as the names of variables, function parameters, or struct fields:</p><p><code>addrspace</code>, <code>align</code>, <code>allowzero</code>, <code>and</code>, <code>anyframe</code>, <code>anytype</code>, <code>asm</code>, <code>async</code>, <code>await</code>, <code>break</code>, <code>callconv</code>, <code>catch</code>, <code>comptime</code>, <code>const</code>, <code>continue</code>, <code>defer</code>, <code>else</code>, <code>enum</code>, <code>errdefer</code>, <code>error</code>, <code>export</code>, <code>extern</code>, <code>fn</code>, <code>for</code>, <code>if</code>, <code>inline</code>, <code>linksection</code>, <code>noalias</code>, <code>noinline</code>, <code>nosuspend</code>, <code>opaque</code>, <code>or</code>, <code>orelse</code>, <code>packed</code>, <code>pub</code>, <code>resume</code>, <code>return</code>, <code>struct</code>, <code>suspend</code>, <code>switch</code>, <code>test</code>, <code>threadlocal</code>, <code>try</code>, <code>union</code>, <code>unreachable</code>, <code>usingnamespace</code>, <code>var</code>, <code>volatile</code>, and <code>while</code>.</p><h2 id="operators" tabindex="-1">Operators</h2><ul><li><p>arithmetic: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></p></li><li><p>operator assignment: <code>+=</code>, <code>-=</code>, <code>\*=</code>, <code>/=</code>, <code>%/</code></p></li><li><p>relational: <code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code></p></li><li><p>logical: <code>and</code> (not <code>&amp;&amp;</code>), <code>or</code> (not <code>||</code>), <code>!</code> (not <code>not</code>)</p><p>The first two provide short-circuiting and therefore can affect control flow. Operators that merely produce a value, like <code>!</code>, are symbols instead of words.</p></li><li><p>bitwise: <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>&amp;</code>, <code>|</code>, <code>^</code>, <code>~</code></p></li><li><p>bitwise assignment: <code>&lt;&lt;=</code>, <code>&gt;&gt;=</code>, <code>&amp;=</code>, <code>|=</code>, <code>^=</code></p></li><li><p>unwrapped value or other value: <code>orelse</code></p></li><li><p>array concatenation: <code>++</code></p></li><li><p>array multiplication: <code>**</code></p></li><li><p>pointer dereference: <code>.*</code></p></li><li><p>address of: <code>&amp;</code></p></li><li><p>merge error sets: <code>||</code></p></li><li><p>many <a href="https://en.wikipedia.org/wiki/Integer_overflow?v=1.0.22" rel="noopener" target="_blank">wrapping</a> operators</p></li><li><p>many <a href="https://en.wikipedia.org/wiki/Saturation_arithmetic#:~:text=Saturation%20arithmetic%20is%20a%20version,a%20minimum%20and%20maximum%20value.?v=1.0.22" rel="noopener" target="_blank">saturating</a> operators</p></li><li><p>does not support the <code>++</code> and <code>-â€”</code> operators found in C</p></li></ul><h2 id="pointers" tabindex="-1">Pointers</h2><p>To get a pointer to the data of a variable, use <code>&amp;variable_name</code>.</p><p>To dereference a pointer, use <code>variable_name.*</code>. This syntax can be used with chaining when the value is a <code>struct</code> to access a struct field. For example, <code>dogPtr.*.name</code>. But the compiler treats <code>dogPtr.name</code> as the same.</p><p>A pointer to a non-<code>const</code> value can be used to modify the value regardless of whether the pointer itself is <code>const</code>. A pointer to <code>const</code> value cannot be used to modify the value.</p><p>The <code>.*</code> syntax can be used on the left or right sign of an assignment. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">touchdown</span><span class="token punctuation">(</span>scorePtr<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span> extraPoint<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">bool</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> current <span class="token operator">=</span> scorePtr<span class="token operator">.*</span><span class="token punctuation">;</span><br>    scorePtr<span class="token operator">.*</span> <span class="token operator">+=</span> <span class="token number">6</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>scorePtr<span class="token operator">.*</span><span class="token punctuation">,</span> current <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>extraPoint<span class="token punctuation">)</span> scorePtr<span class="token operator">.*</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"primitive pointers"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> score<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><br>    <span class="token comment">// Only need try here because touchdown uses expectEqual.</span><br>    <span class="token keyword">try</span> <span class="token function">touchdown</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>score<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>score<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Pointer variables cannot be set to <code>null</code> unless they are declared to be optional with <code>?</code>.</p><p>Zig supports two kinds of pointers, single-item and many-item. The following table describes several types that involve pointers. The first three are a single-item pointer and the rest (ones with square brackets) are many-item pointers.</p><table><thead><tr><th>Type</th><th>Meaning</th></tr></thead><tbody><tr><td><code>*T</code></td><td>pointer to a T value</td></tr><tr><td><code>?*T</code></td><td>optional pointer to a T value</td></tr><tr><td><code>*?T</code></td><td>pointer to an optional T value</td></tr><tr><td><code>[*]T</code></td><td>pointer to an unknown number of T values</td></tr><tr><td><code>?[*]T</code></td><td>optional pointer to an unknown number of T values</td></tr><tr><td><code>[*]?T</code></td><td>pointer to an unknown number of optional T values</td></tr><tr><td><code>?[*]?T</code></td><td>optional pointer to an unknown number of optional T values</td></tr></tbody></table><p>The type <code>[*]T</code> is a slice of pointers to values of type T.</p><p>Here are examples of obtaining and using pointers.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span> breed<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token builtin-type keyword">u8</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"struct pointers"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> dog <span class="token operator">=</span> <span class="token class-name">Dog</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Comet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"whippet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dogPtr <span class="token operator">=</span> <span class="token operator">&amp;</span>dog<span class="token punctuation">;</span> <span class="token comment">// single-item pointer</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"Comet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dogPtr<span class="token operator">.*</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"Comet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dogPtr<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"Comet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// automatic dereferencing</span><br><br>    <span class="token comment">// Pointers can only be used to modify a struct property</span><br>    <span class="token comment">// if the struct instance is not const.</span><br>    dogPtr<span class="token operator">.*</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Oscar"</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"Oscar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Create an array of Dog instances.</span><br>    <span class="token keyword">var</span> dogs <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>Dog</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Comet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"whippet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Oscar"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"whippet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token comment">// Iterate over the dogs and increment their age.</span><br>    <span class="token comment">// &amp;dogs gives a many-item pointer.</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>dogs<span class="token punctuation">)</span> <span class="token operator">|</span><span class="token operator">*</span>d<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token comment">// d.*.age += 1; // This works.</span><br>        d<span class="token punctuation">.</span>age <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// But this also works and is shorter.</span><br>        <span class="token comment">// In C we could use "d->age++;",</span><br>        <span class="token comment">// but Zig only uses ++ to concatenate arrays.</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dogs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dogs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="ranges" tabindex="-1">Ranges</h2><p>Ranges of numbers have an inclusive lower bound and an upper bound that is either exclusive or inclusive. For example, the range <code>5..7</code> with two dots includes the values 5 and 6 and the range <code>5...7</code> with three dots includes the values 5, 6 and 7.</p><p>Exclusive ranges can be used to create a slice from an array, but not inclusive.</p><p>Inclusive ranges can be used in switch branches, but not exclusive.</p><p>I was unable to find rationale for these limitations.</p><h2 id="enumerations" tabindex="-1">Enumerations</h2><p>The <code>enum</code> keyword is used to define an enumeration. For example, <code>const Color = enum { red, yellow, blue };</code>.</p><p>Enum instances like <code>Color.yellow</code> have a unique ordinal value. These values start from zero by default and increment by one. Enum instances cannot have associated data.</p><p>To get the ordinal value of an enum instance, use the builtin function <code>@intFromEnum(enumValue)</code>. For example, <code>@intFromEnum(Color.yellow)</code> returns <code>1</code>.</p><p>Enums are typically defined at the global scope rather than inside a function.</p><p>Enum values can override their default ordinal value. Subsequent enum values that do not also override their default value increment from the ordinal value of the previous enum value.</p><p>Enums can define methods that can be called on instances. These methods can be called on an instance or an instance can be passed to them.</p><p>Here is a an example that demonstrates all of these features.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token comment">// A type must be specified for an enum</span><br><span class="token comment">// in order to override its default ordinal values.</span><br><span class="token keyword">const</span> <span class="token class-name">Color</span> <span class="token operator">=</span> <span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    red<span class="token punctuation">,</span> <span class="token comment">// defaults to 0</span><br>    yellow<span class="token punctuation">,</span> <span class="token comment">// assigned 1</span><br>    blue <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token comment">// overrides default of 2</span><br>    green<span class="token punctuation">,</span> <span class="token comment">// assigned 8</span><br><br>    <span class="token keyword">const</span> favorite <span class="token operator">=</span> Color<span class="token punctuation">.</span>yellow<span class="token punctuation">;</span><br><br>    <span class="token comment">// The type name "Color" is available here when define outside a function,</span><br>    <span class="token comment">// but not when defined inside a function (container-scope).</span><br>    <span class="token comment">// pub fn isPrimary(self: Color) bool {</span><br>    <span class="token comment">//     return self == Color.red or self == Color.yellow or self == Color.blue;</span><br>    <span class="token comment">// }</span><br><br>    <span class="token comment">// Using "Self" like this works regardless of whether the enum</span><br>    <span class="token comment">// is defined inside or outside of a function.</span><br>    <span class="token keyword">const</span> Self <span class="token operator">=</span> <span class="token builtin">@This</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">isPrimary</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name">Self</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">bool</span></span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> self <span class="token operator">==</span> Self<span class="token punctuation">.</span>red <span class="token keyword">or</span> self <span class="token operator">==</span> Self<span class="token punctuation">.</span>yellow <span class="token keyword">or</span> self <span class="token operator">==</span> Self<span class="token punctuation">.</span>blue<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"enum"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> c <span class="token operator">=</span> Color<span class="token punctuation">.</span>green<span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"c = {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>c<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// enum_demo.main.Color.green</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@intFromEnum</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">!</span>c<span class="token punctuation">.</span><span class="token function">isPrimary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">!</span>Color<span class="token punctuation">.</span><span class="token function">isPrimary</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>yellow<span class="token punctuation">.</span><span class="token function">isPrimary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="arrays" tabindex="-1">Arrays</h2><p>Arrays are contiguous memory with compile-time known, fixed length and zero-based indexes.</p><p>Slices are similar to arrays, but their length is not known until run-time. A slice is created by referencing (not copying) a subset of an array or other slice using range syntax.</p><p>Arrays own their data, whereas slices are pointers to data they do not own.</p><p>Both arrays and slices have a <code>len</code> field that holds their length. The length cannot be changed. For a dynamically-sized array, consider using <a href="https://ziglang.org/documentation/master/std/#A;std:ArrayList" target="_blank">ArrayList</a>.</p><p>Array types have the syntax <code>[length]type</code>. For example, <code>[5]i32</code> is an array of five integers.</p><p>The length can be replaced by an underscore when it can be inferred from an initial value. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> dice_rolls <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>To get a subset of an array, called a &quot;slice&quot;, reference a range of its items. For example, <code>dice_rolls[2..4]</code> gives a &quot;slice&quot; of the items at index 2 and 3. Note that the <code>..</code> operator creates a range where the upper bound is exclusive. The <code>...</code> operator, which creates a range where the upper bound is inclusive, cannot be used to create a slice.</p><p>The upper index of the range can be omitted to get all the items from a given index to the end. For example, <code>dice_rolls[2..]</code>.</p><p>It is idiomatic to use the type <code>usize</code> for variables that hold array indexes.</p><p>The following code demonstrates several operations on arrays.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqualSlices <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqualSlices<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"arrays"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create a mutable array so it can be modified later.</span><br>    <span class="token keyword">var</span> dice_rolls <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>dice_rolls<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Use a for loop to iterate over the items in an array or slice.</span><br>    <span class="token comment">// A for loop can iterate over multiple arrays at the same time.</span><br>    <span class="token comment">// This is being used to iterate over the array elements AND their indices.</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>dice_rolls<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">..</span><span class="token punctuation">)</span> <span class="token operator">|</span>roll<span class="token punctuation">,</span> index<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>roll<span class="token punctuation">,</span> dice_rolls<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Copy an array.</span><br>    <span class="token keyword">const</span> copy<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> dice_rolls<span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>copy<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dice_rolls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>copy <span class="token operator">!=</span> <span class="token operator">&amp;</span>dice_rolls<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Get a slice of an array.</span><br>    <span class="token keyword">const</span> subset <span class="token operator">=</span> dice_rolls<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> expected_subset <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualSlices</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>expected_subset<span class="token punctuation">,</span> subset<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Modify array items in-place.</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>dice_rolls<span class="token punctuation">)</span> <span class="token operator">|</span><span class="token operator">*</span>roll<span class="token operator">|</span> <span class="token punctuation">{</span><br>        roll<span class="token operator">.*</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>roll<span class="token operator">.*</span> <span class="token operator">></span> <span class="token number">6</span><span class="token punctuation">)</span> roll<span class="token operator">.*</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token comment">// print("{any}\n", .{dice_rolls});</span><br>    <span class="token keyword">const</span> expected_modifications <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualSlices</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>expected_modifications<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dice_rolls<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Concatenate two arrays.</span><br>    <span class="token keyword">const</span> more_rolls <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> combined_rolls <span class="token operator">=</span> dice_rolls <span class="token operator">++</span> more_rolls<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> expected_combined <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualSlices</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>expected_combined<span class="token punctuation">,</span> <span class="token operator">&amp;</span>combined_rolls<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Multidimensional arrays are created by nesting single-dimension arrays.</p><h2 id="slices" tabindex="-1">Slices</h2><p>A slice is an array-like collection of values whose length is not known until run-time. A slice references (doesn't copy) a range of indexes from an array or another slice. The range must be specified with indexes separated by two dots which means the start index is inclusive and the end index is exclusive.</p><p>Slice types have the syntax <code>[]type</code> with no length specified in the square brackets. For example, <code>[]u8</code> is a slice of <code>u8</code> values.</p><p>The following code demonstrates creating, accessing, and modifying slices:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"slice"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>array<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This slice is immutable.</span><br>    <span class="token keyword">const</span> slice <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// use [0..] to include all elements</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>slice<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>slice<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>slice<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This slice is mutable because it was</span><br>    <span class="token comment">// created from a pointer to an array.</span><br>    <span class="token keyword">const</span> arrayPtr <span class="token operator">=</span> <span class="token operator">&amp;</span>array<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> slice2 <span class="token operator">=</span> arrayPtr<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token comment">// The slice and array share memory,</span><br>    <span class="token comment">// so modifying one also modifies the other.</span><br>    slice2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="defer-and-errdefer" tabindex="-1">defer and errdefer</h2><p>The <code>defer</code> keyword specifies an expression to evaluate when the containing block exits. This is often used to deallocate memory allocated on the preceding line or perform some other kind of cleanup. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">var</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>heap<span class="token punctuation">.</span>page_allocator<span class="token punctuation">;</span><br><span class="token keyword">var</span> myList <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">defer</span> myList<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Defer expressions cannot use the &quot;return&quot; keyword.</p><p>The <code>errdefer</code> keyword specifies an expression to evaluate if an error is returned from the current scope. See the example in the &quot;Error Handling&quot; section.</p><h2 id="strings" tabindex="-1">Strings</h2><p>Strings are represented by arrays of type <code>[]u8</code> (mutable) or <code>[]const u8</code> (immutable). This treats strings like a collection of bytes rather than Unicode characters.</p><p>It is convenient to define an alias for this type with the following:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span></code></pre><p>Literal strings are delimited by double quotes.</p><p>Multi-line strings precede each line with double backslashes. A newline character is added at the end of each line except the last. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> multiline <span class="token operator">=</span><br><span class="token string">    \\Out of memory.<br>    \\We wish to hold the whole sky,<br>    \\But we never will.</span><br><span class="token punctuation">;</span></code></pre><p>Zig only provides the ability to operate on strings as byte arrays. There are Zig libraries that provide additional capabilities such as operating on Unicode characters.</p><p>The following string operations are supported using byte arrays.</p><table><thead><tr><th>Operation</th><th>Example</th></tr></thead><tbody><tr><td>assign to variable</td><td>var name: []u8 = &quot;Mark&quot;;</td></tr><tr><td>get a byte</td><td>const letter2 = name[1]; // a</td></tr><tr><td>modify a byte</td><td>name[1] = 'o'; // now &quot;Mork&quot;</td></tr></tbody></table><p>One way to create an array of strings is to use an array initializer as follows:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> colors <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>String</span><span class="token punctuation">{</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>To write to a string, use <code>std.fmt.bufPrint</code> or <code>std.io.fixedBufferStream</code>. Using <code>bufPrint</code> is good when all the content can be specified in one call. Using <code>fixedBufferStream</code> allows content to be collected over multiple calls. The following code demonstrates both approaches.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqualStrings <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqualStrings<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"basic"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// s is a pointer to the string.</span><br>    <span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token string">"Hello, world!"</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> T <span class="token operator">=</span> <span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// 13 is the length and 0 is the sentinel (terminator) value.</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token builtin">@typeName</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"*const [13:0]u8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"multiline"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> singleLine <span class="token operator">=</span> <span class="token string">"Out of memory.\nWe wish to hold the whole sky,\nBut we never will."</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> multiline <span class="token operator">=</span><br><span class="token string">        \\Out of memory.<br>        \\We wish to hold the whole sky,<br>        \\But we never will.</span><br>    <span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span>singleLine<span class="token punctuation">,</span> multiline<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"starts and ends with"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token string">"abcde"</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token string">"ab"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectStringStartsWith</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"ab"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token string">"de"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectStringEndsWith</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"de"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"bufPrint"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> buffer<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">try</span> std<span class="token punctuation">.</span>fmt<span class="token punctuation">.</span><span class="token function">bufPrint</span><span class="token punctuation">(</span><br>        <span class="token operator">&amp;</span>buffer<span class="token punctuation">,</span><br>        <span class="token string">"{d} {s} {d}"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token char">'A'</span><span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token string">"65 Hello 19"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"fixedBufferStream"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> buffer<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> fbs <span class="token operator">=</span> std<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token function">fixedBufferStream</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> writer <span class="token operator">=</span> fbs<span class="token punctuation">.</span><span class="token function">writer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    _ <span class="token operator">=</span> <span class="token keyword">try</span> writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"one"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns # of bytes written</span><br>    <span class="token keyword">try</span> writer<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"-{s}"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token string">"two"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> writer<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"-{s}"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token string">"three"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token string">"one-two-three"</span><span class="token punctuation">,</span> fbs<span class="token punctuation">.</span><span class="token function">getWritten</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The <code>std.io</code> namespace provides several functions for split/tokenize strings based on specified delimiters. Split returns a slice from each delimiter whereas tokenize treats consecutive delimiters as one. For example, splitting <code>&quot;red,green,,,blue&quot;</code> on the comma delimiter gives <code>&quot;red&quot;</code>, <code>&quot;green&quot;</code>, <code>&quot;&quot;</code>, <code>&quot;&quot;</code>, and <code>&quot;blue&quot;</code> and tokenizing the same string gives <code>&quot;red&quot;</code>, <code>&quot;green&quot;</code>, and <code>&quot;blue&quot;</code>.</p><p>The following code demonstrates each of these.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqualStrings <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqualStrings<span class="token punctuation">;</span><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"split"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>String</span><span class="token punctuation">{</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"blue"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> colors1 <span class="token operator">=</span> <span class="token string">"red,green,,,blue"</span><span class="token punctuation">;</span><br>    <span class="token comment">// This returns an iterator that provides values obtained by</span><br>    <span class="token comment">// splitting on a single delimiter that is a single value.</span><br>    <span class="token keyword">var</span> iter1 <span class="token operator">=</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">splitScalar</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> colors1<span class="token punctuation">,</span> <span class="token char">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> index<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter1<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>color<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span>expected<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        index <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">const</span> colors2 <span class="token operator">=</span> <span class="token string">"red;-)green;-);-);-)blue"</span><span class="token punctuation">;</span><br>    <span class="token comment">// This returns an iterator that provides values obtained by</span><br>    <span class="token comment">// splitting on a single delimiter that is a sequence of values.</span><br>    <span class="token keyword">var</span> iter2 <span class="token operator">=</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">splitSequence</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> colors2<span class="token punctuation">,</span> <span class="token string">";-)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>color<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span>expected<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        index <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> colors3 <span class="token operator">=</span> <span class="token string">"red,green,; blue"</span><span class="token punctuation">;</span><br>    <span class="token comment">// This returns an iterator that provides values obtained by</span><br>    <span class="token comment">// splitting on any one of the given delimiters.</span><br>    <span class="token keyword">var</span> iter3 <span class="token operator">=</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">splitAny</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> colors3<span class="token punctuation">,</span> <span class="token string">",; "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter3<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>color<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span>expected<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        index <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"tokenize"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>String</span><span class="token punctuation">{</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> colors1 <span class="token operator">=</span> <span class="token string">"red,green,,,blue"</span><span class="token punctuation">;</span><br>    <span class="token comment">// This returns an iterator that provides values obtained by</span><br>    <span class="token comment">// splitting on a single delimiter that is a single value.</span><br>    <span class="token keyword">var</span> iter1 <span class="token operator">=</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">tokenizeScalar</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> colors1<span class="token punctuation">,</span> <span class="token char">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> index<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter1<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>color<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span>expected<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        index <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">const</span> colors2 <span class="token operator">=</span> <span class="token string">"red;-)green;-);-);-)blue"</span><span class="token punctuation">;</span><br>    <span class="token comment">// This returns an iterator that provides values obtained by</span><br>    <span class="token comment">// splitting on a single delimiter that is a sequence of values.</span><br>    <span class="token keyword">var</span> iter2 <span class="token operator">=</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">tokenizeSequence</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> colors2<span class="token punctuation">,</span> <span class="token string">";-)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>color<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span>expected<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        index <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> colors3 <span class="token operator">=</span> <span class="token string">"red,green,; ,; blue"</span><span class="token punctuation">;</span><br>    <span class="token comment">// This returns an iterator that provides values obtained by</span><br>    <span class="token comment">// splitting on any one of the given delimiters.</span><br>    <span class="token keyword">var</span> iter3 <span class="token operator">=</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">tokenizeAny</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> colors3<span class="token punctuation">,</span> <span class="token string">",; "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter3<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>color<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span>expected<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        index <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>TODO: Finish from <a href="https://www.huy.rocks/everyday/01-04-2022-zig-strings-in-5-minutes">https://www.huy.rocks/everyday/01-04-2022-zig-strings-in-5-minutes</a></p><p>The following code demonstrates using the zig-string library.</p><p>For more functionality, including Unicode support, use a string library such as <a href="https://github.com/JakubSzark/zig-string?v=1.0.22" rel="noopener" target="_blank">zig-string</a> or <a href="https://codeberg.org/dude_the_builder/zigstr?v=1.0.22" rel="noopener" target="_blank">zigstr</a>.</p><pre class="language-zig"><code class="language-zig"><span class="token comment">// This demonstrates using the zig-string library</span><br><span class="token comment">// at https://github.com/JakubSzark/zig-string.</span><br><span class="token comment">// You can just copy the file zig-string.zig.</span><br><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> assert <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>assert<span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"./zig-string.zig"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>String<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"strings"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br><br>    <span class="token keyword">var</span> myString <span class="token operator">=</span> String<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> myString<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Use functions provided</span><br>    <span class="token keyword">try</span> myString<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    _ <span class="token operator">=</span> myString<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token string">"ab"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> myString<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">"cde"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">assert</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token string">"abcde"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// TODO: This is not working!</span><br>    <span class="token comment">// const mySubstr = myString.substr(1, 3);</span><br>    <span class="token comment">// print("mySubstr = {any}\n", .{mySubstr});</span><br><br>    myString<span class="token punctuation">.</span><span class="token function">toUppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// modifies in place</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token string">"ABCDE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    myString<span class="token punctuation">.</span><span class="token function">toLowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// modifies in place</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token string">"abcde"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">var</span> copy <span class="token operator">=</span> <span class="token keyword">try</span> myString<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> copy<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    copy<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// modifies in place</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>copy<span class="token punctuation">.</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token string">"edcba"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token operator">!</span>myString<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    myString<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">var</span> santa <span class="token operator">=</span> <span class="token keyword">try</span> String<span class="token punctuation">.</span><span class="token function">init_with_contents</span><span class="token punctuation">(</span>allocator<span class="token punctuation">,</span> <span class="token string">"Ho"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> santa<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>santa<span class="token punctuation">.</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token string">"Ho"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> santa<span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// will have 3 occurrences after this</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>santa<span class="token punctuation">.</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token string">"HoHoHo"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// TODO: Why must this be var and not const?</span><br>    <span class="token keyword">var</span> colors <span class="token operator">=</span> <span class="token keyword">try</span> String<span class="token punctuation">.</span><span class="token function">init_with_contents</span><span class="token punctuation">(</span>allocator<span class="token punctuation">,</span> <span class="token string">"red,green,blue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> colors<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Splits into []u8 slices.  This works.</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>colors<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>c1<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">assert</span><span class="token punctuation">(</span>std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">eql</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> c1<span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>colors<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>c2<span class="token operator">|</span> <span class="token punctuation">{</span><br>            <span class="token function">assert</span><span class="token punctuation">(</span>std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">eql</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> c2<span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> padded <span class="token operator">=</span> <span class="token keyword">try</span> String<span class="token punctuation">.</span><span class="token function">init_with_contents</span><span class="token punctuation">(</span>allocator<span class="token punctuation">,</span> <span class="token string">"  foo "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    padded<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// trims in place</span><br>    <span class="token comment">// Also see trimStart and trimEnd.</span><br>    <span class="token function">assert</span><span class="token punctuation">(</span>padded<span class="token punctuation">.</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Splits into String slices.  This does not work!</span><br>    <span class="token comment">// var color1 = try colors.splitToString(",", 0);</span><br>    <span class="token comment">// if (color1) |c1| {</span><br>    <span class="token comment">//     defer c1.deinit();</span><br>    <span class="token comment">//     assert(c1.cmp("red"));</span><br>    <span class="token comment">//     const color2 = try colors.splitToString(",", 4);</span><br>    <span class="token comment">//     if (color2) |c2| {</span><br>    <span class="token comment">//         defer c2.deinit();</span><br>    <span class="token comment">//         assert(c2.cmp("green"));</span><br>    <span class="token comment">//     }</span><br>    <span class="token comment">// }</span><br><br>    <span class="token comment">// This demonstrates splitting a []u8 instead of a zig-string String.</span><br>    <span class="token keyword">const</span> colorsArray <span class="token operator">=</span> <span class="token string">"red,green,blue"</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> splits <span class="token operator">=</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> colorsArray<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>splits<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>chunk<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"chunk = {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>chunk<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="structs" tabindex="-1">Structs</h2><p>A <code>struct</code> is a custom type that holds a collection of optional fields and optional methods. Struct fields and methods cannot be made private. They are always visible outside the <code>struct</code> definition.</p><p>The following code demonstrates defining and using a <code>struct</code>:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> sqrt <span class="token operator">=</span> std<span class="token punctuation">.</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">square</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> std<span class="token punctuation">.</span>math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token builtin-type keyword">f32</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// Structs must be defined with const or comptime, not var.</span><br><span class="token keyword">const</span> <span class="token class-name">Point</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    x<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// default value</span><br>    y<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// default value</span><br><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">distanceToOrigin</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name">Point</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">square</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">square</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">distanceTo</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name">Point</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token class-name">Point</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> dx <span class="token operator">=</span> self<span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">;</span><br>        <span class="token keyword">const</span> dy <span class="token operator">=</span> self<span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">;</span><br>        <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">square</span><span class="token punctuation">(</span>dx<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">square</span><span class="token punctuation">(</span>dy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This function is called on the struct name instead of an instance</span><br>    <span class="token comment">// because its first parameter is not an instance.</span><br>    <span class="token comment">// Invoke this with Point.identify("I am a");</span><br>    <span class="token comment">// to print "I am a Point."</span><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">identify</span><span class="token punctuation">(</span>prefix<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>        std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} Point.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>prefix<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// Typically this would be a method on the Point struct,</span><br><span class="token comment">// but we want to demonstrate passing a pointer to a struct</span><br><span class="token comment">// to enable modifying fields.</span><br><span class="token keyword">fn</span> <span class="token function">translate</span><span class="token punctuation">(</span>pt<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>Point</span><span class="token punctuation">,</span> dx<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span><span class="token punctuation">,</span> dy<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    pt<span class="token punctuation">.</span>x <span class="token operator">+=</span> dx<span class="token punctuation">;</span><br>    pt<span class="token punctuation">.</span>y <span class="token operator">+=</span> dy<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"Point struct"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// modified later</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> p2 <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>p3<span class="token punctuation">.</span><span class="token function">distanceToOrigin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> p4 <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>p3<span class="token punctuation">.</span><span class="token function">distanceTo</span><span class="token punctuation">(</span>p4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>Point<span class="token punctuation">.</span><span class="token function">distanceTo</span><span class="token punctuation">(</span>p3<span class="token punctuation">,</span> p4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This iterates over all the fields of the Point struct,</span><br>    <span class="token comment">// prints the name, the type, and the value in the p1 instance.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// TODO: Why does this only work with "inline"?</span><br>    <span class="token keyword">inline</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>field<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"found field {s} with type {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> field<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token builtin">@typeName</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token builtin-type keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value in p1 is {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token builtin">@as</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token builtin-type keyword">type</span><span class="token punctuation">,</span> <span class="token builtin">@field</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> field<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Passing a pointer so the struct instance can be modified.</span><br>    <span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The fields of a <code>struct</code> can be given default values that are used when instances are created without specifying a value for each field. For example, the declaration of the field <code>x</code> in the <code>Point</code> struct above can be replaced with <code>x: f32 = 1</code>. We can then create a <code>Point</code> instances without specifying a value for <code>x</code>. For example, <code>const my_point = Point{.y = 2}</code> creates an instance where the <code>x</code> field has the value <code>1</code>.</p><p>The <code>std.debug.print</code> function does a reasonable job of printing <code>struct</code> instances without any format specifier. For example, after setting the <code>p1</code> variable in the code above, we could add <code>print(&quot;p1 = {}\n&quot;, .{p1});</code> to produce the following output:</p><pre class="language-text"><code class="language-text">p1 = struct_demo.Point{ .x = 3.0e+00, .y = 4.0e+00 }</code></pre><p>The syntax for a literal struct is the same as the syntax for a literal array. <code>.{}</code> can contain a comma-separated list of either array items or struct field assignments. This syntax can be used to assign a struct instance to a variable or pass one to a function. A struct definition specified with the <code>struct</code> keyword is not required. In this sense it is similar to creating objects in JavaScript.</p><p>The following example creates a <code>struct</code> instance with four properties.</p><pre class="language-zig"><code class="language-zig">    <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span>key1 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// type is bool</span><br>        <span class="token punctuation">.</span>key2 <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token comment">// type is comptime_int</span><br>        <span class="token punctuation">.</span>key3 <span class="token operator">=</span> <span class="token char">'x'</span><span class="token punctuation">,</span> <span class="token comment">// type is comptime_int (value is 120)</span><br>        <span class="token punctuation">.</span>key4 <span class="token operator">=</span> <span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token comment">// type is *const [4:0]u8; 0 is the alignment</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin-type keyword">bool</span><span class="token punctuation">,</span> <span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>key1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>key1<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin-type keyword">comptime_int</span><span class="token punctuation">,</span> <span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>key2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>key2<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin-type keyword">comptime_int</span><span class="token punctuation">,</span> <span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>key3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token char">'x'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>key3<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>key4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>key4<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>To get information about all the fields in a struct, use <code>std.meta.fields</code>. For example, the following code can be added to the test above. For each field it prints the name, the type, and its value in the <code>p1</code> instance. TODO: Maybe add a section just on Zig reflection.</p><pre class="language-zig"><code class="language-zig">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// TODO: Why does this only work with "inline"?</span><br>    <span class="token keyword">inline</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>field<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"found field {s} with type {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> field<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token builtin">@typeName</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token builtin-type keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value in p1 is {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token builtin">@as</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token builtin-type keyword">type</span><span class="token punctuation">,</span> <span class="token builtin">@field</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> field<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br></code></pre><p>When a struct instance in one variable is assigned to another, a copy is created. To avoid making a copy, get a pointer instead.</p><p>A <code>struct</code> can be responsible for managing its own memory.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">pub</span> <span class="token keyword">const</span> <span class="token class-name">PathManager</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    paths<span class="token punctuation">:</span> std<span class="token punctuation">.</span><span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    allocator<span class="token punctuation">:</span> <span class="token class-name">std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span>Allocator</span><span class="token punctuation">,</span><br><br>    <span class="token comment">// ...</span><br><br>    <span class="token keyword">fn</span> <span class="token function">appendFilePaths</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>PathManager</span><span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> dir <span class="token operator">=</span> std<span class="token punctuation">.</span>fs<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">try</span> dir<span class="token punctuation">.</span><span class="token function">openFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token punctuation">.</span>read _only <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">defer</span> file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        <span class="token keyword">const</span> metadata <span class="token operator">=</span> <span class="token keyword">try</span> file<span class="token punctuation">.</span><span class="token function">metadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>metadata<span class="token punctuation">.</span><span class="token function">kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            std<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>File<span class="token punctuation">.</span>Kind<span class="token punctuation">.</span>file <span class="token operator">=></span> <span class="token punctuation">{</span><br>                <span class="token keyword">const</span> abs_path <span class="token operator">=</span> <span class="token keyword">try</span> dir<span class="token punctuation">.</span><span class="token function">realpathAlloc</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>allocator<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span><br>                <span class="token keyword">errdefer</span> self<span class="token punctuation">.</span>allocator<span class="token punctuation">.</span><span class="token function">free</span><span class="token punctuation">(</span>abs_path<span class="token punctuation">)</span><span class="token punctuation">;</span><br>                <span class="token keyword">try</span> self<span class="token punctuation">.</span>paths<span class="token punctuation">.</span><span class="token function">append</span> <span class="token punctuation">(</span>abs_path<span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><span class="token punctuation">,</span><br>            std<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>File<span class="token punctuation">.</span>Kind<span class="token punctuation">.</span>directory <span class="token operator">=></span> <span class="token punctuation">{</span><br>                <span class="token keyword">var</span> next_dir <span class="token operator">=</span> <span class="token keyword">try</span> dir<span class="token punctuation">.</span><span class="token function">openIterableDir</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                <span class="token keyword">defer</span> next_dir<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                <span class="token keyword">var</span> iter <span class="token operator">=</span> next_dir<span class="token punctuation">.</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">try</span> iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>                    <span class="token keyword">const</span> next_path <span class="token operator">=</span> <span class="token keyword">try</span> std<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>allocator<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> path<span class="token punctuation">,</span> entry<span class="token punctuation">.</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                    <span class="token keyword">defer</span> self<span class="token punctuation">.</span>allocator<span class="token punctuation">.</span><span class="token function">free</span><span class="token punctuation">(</span>next_path<span class="token punctuation">)</span><span class="token punctuation">;</span><br>                    <span class="token keyword">try</span> self<span class="token punctuation">.</span><span class="token function">appendFilePaths</span><span class="token punctuation">(</span>next_path<span class="token punctuation">)</span><span class="token punctuation">;</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><span class="token punctuation">,</span><br>            <span class="token keyword">else</span> <span class="token operator">=></span> <span class="token keyword">return</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Using the custom struct above:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>heap<span class="token punctuation">.</span>page_allocator<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> manager <span class="token operator">=</span> <span class="token keyword">try</span> PathManager<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token string">"src"</span><span class="token punctuation">,</span> <span class="token string">"test"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> manager<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>TODO: Add an example of a generic struct using <code>comptime</code>.</p><h2 id="tuples" tabindex="-1">Tuples</h2><p>Tuples are anonymous structs without specified field names. The field names default to indexes.</p><p>The following code demonstrates using a tuple:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> trait <span class="token operator">=</span> std<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>trait<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"tuple"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Casting the integer and float literal values</span><br>    <span class="token comment">// to specific types is optional.</span><br>    <span class="token comment">// The compiler will know the element types in this tuple</span><br>    <span class="token comment">// and can use them in the "inline for" loop below.</span><br>    <span class="token comment">// This is important because the types passed to</span><br>    <span class="token comment">// "trait.isZigString" must be known at compile-time.</span><br>    <span class="token keyword">const</span> tuple <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">f32</span><span class="token punctuation">,</span> <span class="token number">3.14</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">'A'</span><span class="token punctuation">,</span> <span class="token string">"hello"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>tuple<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>tuple<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>tuple<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>tuple<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3.14</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>tuple<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token char">'A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>tuple<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>tuple<span class="token punctuation">.</span>@"<span class="token number">4</span><span class="token string">", "</span>hello"<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// alternate way to index</span><br><br>    <span class="token comment">// This loop must be "inline".</span><br>    <span class="token keyword">inline</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>tuple<span class="token punctuation">)</span> <span class="token operator">|</span>value<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> T <span class="token operator">=</span> <span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"type of {any} is {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> value<span class="token punctuation">,</span> T <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token comment">// comptime must be used here because the argument</span><br>        <span class="token comment">// to isZigString must be comptime-known.</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">comptime</span> trait<span class="token punctuation">.</span><span class="token function">isZigString</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value is {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value is {any}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Destructuring can be used to get the elements of a tuple,</span><br>    <span class="token comment">// but all the elements must be matched.</span><br>    <span class="token comment">// Zig only supports destructuring of tuples.</span><br>    <span class="token keyword">const</span> e1<span class="token punctuation">,</span> <span class="token keyword">const</span> e2<span class="token punctuation">,</span> <span class="token keyword">const</span> e3<span class="token punctuation">,</span> <span class="token keyword">const</span> e4<span class="token punctuation">,</span> <span class="token keyword">const</span> e5 <span class="token operator">=</span> tuple<span class="token punctuation">;</span><br>    _ <span class="token operator">=</span> e3<span class="token punctuation">;</span><br>    _ <span class="token operator">=</span> e4<span class="token punctuation">;</span><br>    _ <span class="token operator">=</span> e5<span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>e1<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>e2<span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="unions" tabindex="-1">Unions</h2><p>A bare <code>union</code> defines a set of fields that a value can have where only one is active at a time. Each field can have a different type.</p><p>A tagged <code>union</code> adds the use of an <code>enum</code> that lists the possible field names s in a union. This allows the union to be used in a <code>switch</code> statement.</p><p>An &quot;inferred enum&quot; union is a simpler alternative to a tagged <code>union</code> that is useful when a separate `enum`` is not needed for other purposes.</p><p>The following code demonstrates using all three kinds of unions:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"union"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token class-name">Identifier</span> <span class="token operator">=</span> <span class="token keyword">union</span> <span class="token punctuation">{</span><br>        name<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>        number<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> id1 <span class="token operator">=</span> <span class="token class-name">Identifier</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"top secret"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> id2 <span class="token operator">=</span> <span class="token class-name">Identifier</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">1234</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>id1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"top secret"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>id2<span class="token punctuation">.</span>number<span class="token punctuation">,</span> <span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"tagged union"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token class-name">IdentifierTag</span> <span class="token operator">=</span> <span class="token keyword">enum</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> number <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> <span class="token class-name">Identifier</span> <span class="token operator">=</span> <span class="token keyword">union</span><span class="token punctuation">(</span>IdentifierTag<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        name<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>        number<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> ids <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>Identifier</span><span class="token punctuation">{</span><br>        <span class="token class-name">Identifier</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">1234</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token class-name">Identifier</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"top secret"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ids<span class="token punctuation">)</span> <span class="token operator">|</span>id<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token punctuation">.</span>name <span class="token operator">=></span> <span class="token operator">|</span>name<span class="token operator">|</span> <span class="token punctuation">{</span><br>                <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"top secret"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><span class="token punctuation">,</span><br>            <span class="token punctuation">.</span>number <span class="token operator">=></span> <span class="token operator">|</span>number<span class="token operator">|</span> <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> <span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"inferred enum union"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token class-name">Identifier</span> <span class="token operator">=</span> <span class="token keyword">union</span><span class="token punctuation">(</span><span class="token keyword">enum</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        name<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>        number<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> ids <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>Identifier</span><span class="token punctuation">{</span><br>        <span class="token class-name">Identifier</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">1234</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token class-name">Identifier</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"top secret"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ids<span class="token punctuation">)</span> <span class="token operator">|</span>id<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token punctuation">.</span>name <span class="token operator">=></span> <span class="token operator">|</span>name<span class="token operator">|</span> <span class="token punctuation">{</span><br>                <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"top secret"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><span class="token punctuation">,</span><br>            <span class="token punctuation">.</span>number <span class="token operator">=></span> <span class="token operator">|</span>number<span class="token operator">|</span> <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> <span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="blocks" tabindex="-1">Blocks</h2><p>Blocks are lines of code surrounded by curly braces that define a variable scope.</p><p>Labelled blocks are expressions that return a value. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token label">myLabel</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Add code to compute a value here.</span><br>    <span class="token keyword">break</span> <span class="token punctuation">:</span><span class="token label">myLabel</span> some_value<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="control-structures" tabindex="-1">Control Structures</h2><p>Zig supports four control structures, <code>if</code>, <code>switch</code>, <code>while</code>, and <code>for</code>. All of these can be used as expressions that result in a value.</p><h3 id="if-expressions" tabindex="-1">if Expressions</h3><p>The syntax for <code>if</code> expressions is nearly identical to that of C <code>if</code> statements. The most basic form follows:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">if</span> <span class="token punctuation">(</span>cond1<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// code goes here</span><br><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cond2<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// code goes here</span><br><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    <span class="token comment">// code goes here</span><br><span class="token punctuation">}</span></code></pre><p>The conditions must evaluate to a <code>bool</code> value. Other types of values are not interpreted as truthy or falsely.</p><p>Here is an example that includes random number generation and simplifies output of strings type is typically <code>[]const u8</code>.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token comment">// The value of the first argument to print must be known at compile time.</span><br><span class="token keyword">fn</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">comptime</span> text<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token function">print</span><span class="token punctuation">(</span>text <span class="token operator">++</span> <span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// prng is short for pseudo random number generator.</span><br>    <span class="token keyword">var</span> prng <span class="token operator">=</span> std<span class="token punctuation">.</span>rand<span class="token punctuation">.</span>DefaultPrng<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token label">blk</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> seed<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u64</span></span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br>        <span class="token comment">// try can only be used inside a function.</span><br>        <span class="token keyword">try</span> std<span class="token punctuation">.</span>os<span class="token punctuation">.</span><span class="token function">getrandom</span><span class="token punctuation">(</span>std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">asBytes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>seed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">break</span> <span class="token punctuation">:</span><span class="token label">blk</span> seed<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Generate a random integer from 1 to 3.</span><br>    <span class="token keyword">const</span> value <span class="token operator">=</span> prng<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intRangeAtMost</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value = {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"one"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"two"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"other"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Zig does not support the ternary operator from C. An <code>if</code> expression can be used instead. The following example sets the variable <code>value</code> to either <code>19</code> or <code>21</code>.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">)</span> <span class="token number">19</span> <span class="token keyword">else</span> <span class="token number">21</span><span class="token punctuation">;</span></code></pre><p>An <code>if</code> expression can test whether a variable with an optional type is currently set to <code>null</code>. If not, the value is unwrapped and made available in the body. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">if</span> <span class="token punctuation">(</span>variable<span class="token punctuation">)</span> <span class="token operator">|</span>value<span class="token operator">|</span> <span class="token punctuation">{</span><br>    <span class="token comment">// use value here</span><br><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// optional part</span><br>    <span class="token comment">// value was null</span><br><span class="token punctuation">}</span></code></pre><p>Here is an example that demonstrates using an optional integer.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">report</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span><span class="token builtin-type keyword">i8</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span> <span class="token operator">|</span>value<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value = {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value is null\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> wrapper<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span><span class="token builtin-type keyword">i8</span></span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>    <span class="token function">report</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    wrapper <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span><br>    <span class="token function">report</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The following code demonstrates testing whether a variable with an optional type is currently set to null without unwrapping the value.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">if</span> <span class="token punctuation">(</span>variable <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// code goes here</span><br><span class="token punctuation">}</span></code></pre><p>An <code>if</code> expression can test whether a value is an error or a non-error value. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">canReturnError</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>value<span class="token operator">|</span> <span class="token punctuation">{</span><br>    <span class="token comment">// handle success</span><br><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token operator">|</span>err<span class="token operator">|</span> <span class="token keyword">switch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    MyErrorSet<span class="token punctuation">.</span>FirstCase <span class="token operator">=></span> <span class="token comment">// handle this error</span><br>    <span class="token operator">...</span><br><span class="token punctuation">}</span></code></pre><h3 id="switch-expressions" tabindex="-1">switch Expressions</h3><p>The syntax for <code>switch</code> expressions is a bit different than in C <code>switch</code> statements.</p><p>Cases are referred to as &quot;branches&quot;. Branches can match a single value, a list of values, or a range of values. These are followed by the <code>=&gt;</code> operator which is followed by an expression, a statement, or a block of code.</p><p>It must be possible to coerce all branch values to a common type. Supported branch value types include numbers and enums. Switching on strings is not supported.</p><p>Here is an example that demonstrates all the branch options:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token comment">// The value of the first argument to print must be known at compile time.</span><br><span class="token keyword">fn</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">comptime</span> text<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token function">print</span><span class="token punctuation">(</span>text <span class="token operator">++</span> <span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// prng is short for pseudo random number generator.</span><br>    <span class="token keyword">var</span> prng <span class="token operator">=</span> std<span class="token punctuation">.</span>rand<span class="token punctuation">.</span>DefaultPrng<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token label">blk</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> seed<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u64</span></span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br>        <span class="token comment">// try can only be used inside a function.</span><br>        <span class="token keyword">try</span> std<span class="token punctuation">.</span>os<span class="token punctuation">.</span><span class="token function">getrandom</span><span class="token punctuation">(</span>std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">asBytes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>seed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">break</span> <span class="token punctuation">:</span><span class="token label">blk</span> seed<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Generate a random integer from 1 to 3.</span><br>    <span class="token keyword">const</span> value <span class="token operator">=</span> prng<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intRangeAtMost</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value = {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token number">1</span> <span class="token operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"one"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><br>        <span class="token comment">// Double-dot ranges have an exclusive upper bound.</span><br>        <span class="token comment">// Triple-dot ranges have an inclusive upper bound.</span><br>        <span class="token comment">// Only triple-dot ranges are allowed here.</span><br>        <span class="token number">2</span><span class="token operator">...</span><span class="token number">5</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token comment">// braces are only required for multiple statements</span><br>            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"two to five"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span><br><br>        <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"six, eight, or ten"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span><br><br>        <span class="token comment">// The else branch must be specified</span><br>        <span class="token comment">// unless the other branches are exhaustive.</span><br>        <span class="token keyword">else</span> <span class="token operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"other"</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Here is an example of a <code>switch</code> expression used to obtain a value:</p><pre class="language-zig"><code class="language-zig">    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">switch</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token number">1</span> <span class="token operator">=></span> <span class="token string">"single"</span><span class="token punctuation">,</span><br>        <span class="token number">2</span> <span class="token operator">=></span> <span class="token string">"couple"</span><span class="token punctuation">,</span><br>        <span class="token number">3</span> <span class="token operator">=></span> <span class="token string">"few"</span><span class="token punctuation">,</span><br>        <span class="token keyword">else</span> <span class="token operator">=></span> <span class="token string">"many"</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result = {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here is an example of switching on an <code>enum</code> value. The <code>else</code> branch is not needed because the branches are exhaustive.</p><pre class="language-zig"><code class="language-zig">    <span class="token keyword">const</span> <span class="token class-name">Color</span> <span class="token operator">=</span> <span class="token keyword">enum</span> <span class="token punctuation">{</span> red<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> favorite <span class="token operator">=</span> Color<span class="token punctuation">.</span>blue<span class="token punctuation">;</span><br>    <span class="token comment">// var favorite: Color = .blue; // alternate syntax</span><br>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>favorite<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token punctuation">.</span>red <span class="token operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hot"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>green <span class="token operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"warm"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>blue <span class="token operator">=></span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"cold"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span></code></pre><h3 id="while-expressions" tabindex="-1">while Expressions</h3><p>The syntax for <code>while</code> expressions is nearly identical to that of C <code>while</code> statements.</p><p>Here are examples of <code>while</code> expressions that demonstrate using the <code>break</code> and <code>continue</code> statements which can optionally be followed by a label to jump to an outer loop.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> value<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This loop outputs 1, 2, 3.</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        value <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token comment">// This loop outputs 1, 2, 4, 5.</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>value <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        value <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span><br><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>A <code>while</code> expression can be used like a <code>C</code> <code>for</code> loop where a single update is specified in a second pair of parentheses (referred to as a &quot;continue expression&quot;) that is separated from the first pair with a colon. Here is an example.</p><pre class="language-zig"><code class="language-zig">    value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token comment">// This loop outputs 1, 2, 3.</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>value <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>value <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span></code></pre><p>If the condition passed to a <code>while</code> expression evaluates to <code>null</code>, the loop exits. This can be used to iterate over the return values of a function that has a optional return type.</p><p>Here is an example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token keyword">var</span> counter<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br><span class="token keyword">fn</span> <span class="token function">nextCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">?</span><span class="token builtin-type keyword">u8</span></span> <span class="token punctuation">{</span><br>    counter <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>counter <span class="token operator">></span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> counter<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// This loop terminates when the nextCounter function returns null.</span><br>    <span class="token comment">// It outputs 2, 4, 6.</span><br>    <span class="token comment">// If a "continue expression" is included,</span><br>    <span class="token comment">// the colon and that come after the capture in pipes.</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">nextCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>c<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>c<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>A <code>while</code> expression can be used to obtain a value. The value is specified by a <code>break</code> statement with a value. If it is possible for the loop to exit without hitting a <code>break</code> statement, add an <code>else</code> clause to specify the value. The <code>else</code> clause is only evaluated if the loop does not <code>break</code>. Here is an example:</p><pre class="language-zig"><code class="language-zig">    value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token comment">// result is "triple" if value starts a 1</span><br>    <span class="token comment">// and "not found" if value starts at 0.</span><br>    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>value <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">break</span> <span class="token string">"triple"</span><span class="token punctuation">;</span><br>        value <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token string">"not found"</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result = {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>A <code>while</code> expression can catch errors when its expression evaluates to an error. The <code>else</code> clause is only evaluated if an error occurs. Here is an example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token comment">// TODO: Can errors contain associated data?</span><br><span class="token keyword">const</span> FetchError <span class="token operator">=</span> <span class="token keyword">error</span><span class="token punctuation">{</span>TooBig<span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> count<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br><span class="token keyword">fn</span> <span class="token function">fetchCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name">FetchError<span class="token operator">!</span><span class="token builtin-type keyword">u8</span></span> <span class="token punctuation">{</span><br>    count <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">></span> <span class="token number">6</span><span class="token punctuation">)</span> FetchError<span class="token punctuation">.</span>TooBig <span class="token keyword">else</span> count<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// This loop terminates when the fetchCount function returns an error.</span><br>    <span class="token comment">// It outputs 2, 4, 6 followed by "error.TooBig".</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">fetchCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>c<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>c<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token operator">|</span>err<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"err = {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>err<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3 id="for-expressions" tabindex="-1">for Expressions</h3><p>The syntax for <code>for</code> expressions is very different from C <code>for</code> statements. They can be used in several ways.</p><p>A <code>for</code> expression can iterate over the items in an array or slice. Here is an example.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create an array of numbers.</span><br>    <span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This loop outputs all the numbers.</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token operator">|</span>number<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>number<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Create a slice from an inclusive index to an exclusive index.</span><br>    <span class="token keyword">const</span> slice <span class="token operator">=</span> numbers<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This loop outputs 20, 30, 40</span><br>    <span class="token comment">// which are the numbers at index 1, 2, and 3.</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>slice<span class="token punctuation">)</span> <span class="token operator">|</span>number<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>number<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>A <code>for</code> expression can iterate over a range of integers. Here is an example:</p><pre class="language-zig"><code class="language-zig">    <span class="token comment">// Iterate over a range of numbers where</span><br>    <span class="token comment">// the first is included and the last is not.</span><br>    <span class="token comment">// This loop outputs 10, 11, 12, 13, 14, but not 15.</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">..</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">|</span>number<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>number<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span></code></pre><p>A <code>for</code> expression can iterate over any number of arrays and slices at the same time. Each must have the same length. Here is an example:</p><pre class="language-zig"><code class="language-zig">    <span class="token keyword">const</span> letters <span class="token operator">=</span> <span class="token string">"ABCDE"</span><span class="token punctuation">;</span><br>    <span class="token comment">// This loop outputs the ASCII code of each letter</span><br>    <span class="token comment">// followed by the number at the same index.</span><br>    <span class="token comment">// The letters and numbers arrays must have the same length.</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>letters<span class="token punctuation">,</span> numbers<span class="token punctuation">)</span> <span class="token operator">|</span>letter<span class="token punctuation">,</span> number<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{} - {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> letter<span class="token punctuation">,</span> number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span></code></pre><p>An open-ended range starting from zero can be iterated over at the same time as other arrays or slices. Here is an example that outputs the index of each value in the `numbers`` array along with the corresponding number:</p><pre class="language-zig"><code class="language-zig">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">..</span><span class="token punctuation">,</span> numbers<span class="token punctuation">)</span> <span class="token operator">|</span>index<span class="token punctuation">,</span> number<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{} - {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> index<span class="token punctuation">,</span> number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span></code></pre><p>To mutate array or slice items in a loop, iterate over pointers to the items. Here is an example:</p><pre class="language-zig"><code class="language-zig">    <span class="token keyword">var</span> mutable <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>mutable<span class="token punctuation">)</span> <span class="token operator">|</span><span class="token operator">*</span>item<span class="token operator">|</span> <span class="token punctuation">{</span><br>        item<span class="token operator">.*</span> <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// doubles</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">const</span> expected <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token comment">// If this fails, the output is "error: TestExpectedEqual"</span><br>    <span class="token comment">// followed by a stack trace.</span><br>    <span class="token comment">// It does not indicate which items are not equal.</span><br>    <span class="token keyword">try</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span><span class="token function">expectEqualSlices</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>mutable<span class="token punctuation">,</span> <span class="token operator">&amp;</span>expected<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>A <code>for</code> expression can be used to obtain a value. The value is specified by a <code>break</code> statement with a value. If it is possible for the loop to exit without hitting a <code>break</code> statement, add an <code>else</code> clause to specify the value. The <code>else</code> clause is only evaluated if the loop does not <code>break</code>. Here is an example:</p><pre class="language-zig"><code class="language-zig">    <span class="token comment">// result is "triple" if the range starts a 1</span><br>    <span class="token comment">// and "not found" if the range starts at 0.</span><br>    <span class="token comment">// It seems "for" expressions can use double-dot ranges,</span><br>    <span class="token comment">// but not triple-dot ranges. Why?</span><br>    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">break</span> <span class="token string">"triple"</span><span class="token punctuation">;</span><br>        value <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token string">"not found"</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result = {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Like <code>while</code> expressions, <code>for</code> expressions can use <code>break</code> and <code>continue</code> statements which can optionally be followed by a label to jump to an outer loop.</p><h3 id="labeled-blocks" tabindex="-1">Labeled Blocks</h3><p>Labeled blocks turn a block into an expression with a value. They can be used to compute the value of a variable or a switch branch.</p><p>The syntax for labeled blocks was borrowed from <a href="https://doc.rust-lang.org/reference/expressions/loop-expr.html#labelled-block-expressions?v=1.0.22" rel="noopener" target="_blank">Rust</a>.</p><p>The value of a labeled block is specified using a <code>break</code> statement that includes the block label.</p><p>By convention, must block labels in Zig are &quot;blk&quot;.</p><p>For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"labeled block"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token label">blk</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> ms <span class="token operator">=</span> std<span class="token punctuation">.</span>time<span class="token punctuation">.</span><span class="token function">milliTimestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token builtin">@divFloor</span><span class="token punctuation">(</span>ms <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">break</span> <span class="token punctuation">:</span><span class="token label">blk</span> s<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Often labeled blocks can be replaced by a single expression.</span><br>    <span class="token keyword">const</span> s2 <span class="token operator">=</span> <span class="token builtin">@divFloor</span><span class="token punctuation">(</span>std<span class="token punctuation">.</span>time<span class="token punctuation">.</span><span class="token function">milliTimestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="error-handling" tabindex="-1">Error Handling</h2><p>Errors are represented by enum values that cannot carry additional data. For example, the following defines an error set with two possible values:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> EvalError <span class="token operator">=</span> <span class="token keyword">error</span> <span class="token punctuation">{</span> Negative<span class="token punctuation">,</span> TooHigh <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>An error can be returned from a function in the same way as returning a value. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">return</span> EvalError<span class="token punctuation">.</span>TooHigh<span class="token punctuation">;</span></code></pre><p>Functions that can return errors must indicate this by preceding their return type with <code>!</code>. They can optionally specify an error set before the <code>!</code> that describes the possible errors that can be returned. If no error set is specified, the compiler determines the possible errors from the function body.</p><p>When calling a function that can return an error, preceding the call with the <code>try</code> keyword causes the calling function to return the error that is returned by the called function. Note that <code>try someFn();</code> is equivalent to <code>someFn() catch |e| return e;</code>.</p><p>The following code demonstrates defining a function that specifies an error set:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> EvalError <span class="token operator">=</span> <span class="token keyword">error</span><span class="token punctuation">{</span> Negative<span class="token punctuation">,</span> TooHigh <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">double</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i8</span></span><span class="token punctuation">)</span> <span class="token class-name">EvalError<span class="token operator">!</span><span class="token builtin-type keyword">i8</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> EvalError<span class="token punctuation">.</span>Negative<span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">return</span> EvalError<span class="token punctuation">.</span>TooHigh<span class="token punctuation">;</span><br>    <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 8</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result = {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    result <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// panics with error: .Negative</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result = {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Omitting the error set from a function return type is not the same as specifying the error set <code>anyerror</code>. Using <code>anyerror</code> means that absolutely any kind of error can be returned, whereas omiting the error set means the compiler will determine the possible errors.</p><p>When the error set is omitted from the function return type, the function can return single error values that are no part of a predefined error set.</p><p>The following code demonstrates defining a function that does not specify an error set:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">fn</span> <span class="token function">double</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">i32</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">error</span><span class="token punctuation">.</span>Negative<span class="token punctuation">;</span> <span class="token comment">// note use of error keyword</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">error</span><span class="token punctuation">.</span>TooHigh<span class="token punctuation">;</span><br>    <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 8</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result = {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    result <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// panics with error: Negative</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result = {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The following code demonstrates many features of Zig error handling:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token comment">// The "expectEqual" function has the following signature:</span><br><span class="token comment">// fn expectEqual(expected: anytype, actual: @TypeOf(expected)) !void</span><br><span class="token comment">// So the second argument is cast to the type of the first.</span><br><span class="token comment">// If the expected value is a literal value,</span><br><span class="token comment">// it must be cast with "@as" if it is the first argument,</span><br><span class="token comment">// but not if it is the second.</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> expectError <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectError<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> EvalError <span class="token operator">=</span> <span class="token keyword">error</span><span class="token punctuation">{</span> Negative<span class="token punctuation">,</span> TooHigh <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">double</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i8</span></span><span class="token punctuation">)</span> <span class="token class-name">EvalError<span class="token operator">!</span><span class="token builtin-type keyword">i8</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> EvalError<span class="token punctuation">.</span>Negative<span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">return</span> EvalError<span class="token punctuation">.</span>TooHigh<span class="token punctuation">;</span><br>    <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"error handling"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// The "try" before the call to "double"</span><br>    <span class="token comment">// causes any error returned by "double" to be returned,</span><br>    <span class="token comment">// which would cause this test to fail.</span><br>    <span class="token comment">// "try someFn();" is equivalent to "someFn() catch |err| return err;"</span><br>    <span class="token comment">// try expectEqual(@as(i8, 4), try double(2)); // requires cast</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token keyword">try</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// does not require cast</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectError</span><span class="token punctuation">(</span>EvalError<span class="token punctuation">.</span>Negative<span class="token punctuation">,</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectError</span><span class="token punctuation">(</span>EvalError<span class="token punctuation">.</span>TooHigh<span class="token punctuation">,</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// "catch" provides a value to use if *any* error is returned.</span><br>    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">catch</span> <span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">i8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    result <span class="token operator">=</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span> <span class="token keyword">catch</span> <span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">i8</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// We can test for specific errors.</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">double</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> EvalError<span class="token punctuation">.</span>Negative<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">double</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">,</span> EvalError<span class="token punctuation">.</span>TooHigh<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">fn</span> <span class="token function">safeDouble</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i8</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">i8</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// This makes the specific error available in the catch block.</span><br>    <span class="token keyword">return</span> <span class="token function">double</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">catch</span> <span class="token operator">|</span>err<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"safeDouble caught {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>err<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">==</span> EvalError<span class="token punctuation">.</span>Negative<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">==</span> EvalError<span class="token punctuation">.</span>TooHigh<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"catch"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">safeDouble</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">safeDouble</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">safeDouble</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// This function differs from "double" in that in uses "errdefer".</span><br><span class="token keyword">fn</span> <span class="token function">doubleErrdefer</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i8</span></span><span class="token punctuation">)</span> <span class="token class-name">EvalError<span class="token operator">!</span><span class="token builtin-type keyword">i8</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">errdefer</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"double returned an error for {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> <span class="token function">double</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"errdefer"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">doubleErrdefer</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This prints "double returned an error for -1".</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">doubleErrdefer</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> EvalError<span class="token punctuation">.</span>Negative<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This prints "double returned an error for 101".</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">doubleErrdefer</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">,</span> EvalError<span class="token punctuation">.</span>TooHigh<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="unreachable-code-paths" tabindex="-1">Unreachable Code Paths</h2><p>The <code>unreachable</code> statement asserts that a code path should never be reached. This calls the builtin <code>panic</code> function with the message &quot;reached unreachable code&quot; which terminates the application and outputs a stack trace.</p><h2 id="functions" tabindex="-1">Functions</h2><p>The syntax for defining a function is:</p><pre class="language-zig"><code class="language-zig"><span class="token punctuation">[</span><span class="token keyword">pub</span><span class="token punctuation">]</span> <span class="token keyword">fn</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">[</span>parameter<span class="token operator">-</span>list<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span><span class="token operator">-</span><span class="token builtin-type keyword">type</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><br>    <span class="token punctuation">{</span>body<span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Anonymous functions (lambdas) are not supported. For the rationale, see <a href="https://github.com/ziglang/zig/issues/1717?v=1.0.22" rel="noopener" target="_blank">issue 1717</a>.</p><p>Marking a function as <code>pub</code> makes it available to be imported from outside its source file.</p><p>The convention for function names is to use camelCase.</p><p>The parameter list is a comma-separated list of parameter declarations. The syntax for each parameter declaration is <code>{name}: {type}</code>.</p><p>Zig does not support &quot;vararg&quot; functions, so functions that would have a variable number of arguments in other languages take a literal array (<code>.{}</code>) instead.</p><p>Function parameters cannot be modified.</p><p>The return type syntax is <code>[error-type][!][return-type]</code>. For example:</p><ul><li><code>i32</code> means an integer is returned and no errors can be returned</li><li><code>!i32</code> means an integer or one of the errors inferred from the function body is returned</li><li><code>anyerror!i32</code> means an integer or any kind of error is returned</li><li><code>MyErrorSet!i32</code> means an integer or one of the errors in <code>MyErrorSet</code> is returned</li></ul><p>When an error occurs in a function, an error <code>enum</code> value is returned. Zig does not support throwing exceptions.</p><p>To call a function that returns a value and not use it, assign it to <code>_</code>. For example, <code>_ = someFn();</code></p><p>When a function returns, all stack memory allocations made in the function are freed. A common way to allow a function to modify data that is not freed when the function returns is to pass a pointer to data owned by the caller and modify that inside the function.</p><p>Literal strings are known and compile-time and stored in memory that is not part of the stack or the heap. A function can create a literal string and return it since it will not be freed when the function exits.</p><p>Async functions are not currently supported, but there are plans to support them in the future.</p><p>The return type of a function can be inferred from the type of one of its arguments. The following code demonstrates this with a function that squares any kind of number, returning the same type.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectApproxEqAbs <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectApproxEqAbs<span class="token punctuation">;</span><br><br><span class="token comment">// Calls with a non-number do not compile</span><br><span class="token comment">// because the "*" cannot be applied to them.</span><br><span class="token keyword">fn</span> <span class="token function">square</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token keyword">anytype</span><span class="token punctuation">)</span> <span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"function return type inference"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i8</span></span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">square</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> x<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span> <span class="token operator">=</span> <span class="token number">3.1</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectApproxEqAbs</span><span class="token punctuation">(</span><span class="token function">square</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9.61</span><span class="token punctuation">,</span> <span class="token number">0.001</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The return type of a function can be determined with a <code>switch</code> expression For examples of this, see this <a href="https://sourcegraph.com/search?q=context:global+lang:Zig+fn.*%5C)%5C+switch&patternType=regexp&sm=1&groupBy=repo?v=1.0.22" rel="noopener" target="_blank">Sourcegraph search</a>.</p><h2 id="duck-typing-with-anytype" tabindex="-1">Duck Typing with anytype</h2><p>Functions can have parameters with the type <code>anytype</code>. As the name implies, this allows any kind of value to be passed. However, the compiler will verify that the value can be used correctly by the function body. This supports &quot;duck typing&quot;.</p><p>The following code demonstrates using <code>anytype</code> for duck typing.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectApproxEqAbs <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectApproxEqAbs<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token class-name">Animal</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span><br>    top_speed<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u32</span></span><span class="token punctuation">,</span> <span class="token comment">// miles per hour</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token class-name">Car</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    make<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span><br>    model<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span><br>    year<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u16</span></span><span class="token punctuation">,</span><br>    top_speed<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u32</span></span><span class="token punctuation">,</span> <span class="token comment">// miles per hour</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token class-name">Wrong</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    top_speed<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span><span class="token punctuation">,</span> <span class="token comment">// not expected type of u32</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// The first argument must be a struct with</span><br><span class="token comment">// a top_speed field that is an integer.</span><br><span class="token keyword">fn</span> <span class="token function">travelTime</span><span class="token punctuation">(</span>thing<span class="token punctuation">:</span> <span class="token keyword">anytype</span><span class="token punctuation">,</span> distance<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u32</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">f32</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// We could use @TypeOf(thing) and functions like</span><br>    <span class="token comment">// std.meta.trait.hasField and std.meta.trait.isIntegral</span><br>    <span class="token comment">// to verify that "thing" meets our criteria.</span><br>    <span class="token comment">// However, there is no need to do that because the compiler will</span><br>    <span class="token comment">// verify that "thing" has a "top_speed" field that is an integer</span><br>    <span class="token comment">// just because it is used that way here.</span><br>    <span class="token keyword">const</span> s<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span> <span class="token operator">=</span> <span class="token builtin">@floatFromInt</span><span class="token punctuation">(</span>thing<span class="token punctuation">.</span>top_speed<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// We can't eliminate the local variable d because</span><br>    <span class="token comment">// @floatFromInt requires that we specify the result type.</span><br>    <span class="token keyword">const</span> d<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span> <span class="token operator">=</span> <span class="token builtin">@floatFromInt</span><span class="token punctuation">(</span>distance<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> d <span class="token operator">/</span> s<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"anytype"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> cheetah <span class="token operator">=</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"cheetah"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>top_speed <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> distance <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// miles</span><br>    <span class="token keyword">const</span> tolerance <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectApproxEqAbs</span><span class="token punctuation">(</span><br>        <span class="token keyword">try</span> <span class="token function">travelTime</span><span class="token punctuation">(</span>cheetah<span class="token punctuation">,</span> distance<span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token number">0.2667</span><span class="token punctuation">,</span><br>        tolerance<span class="token punctuation">,</span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> ferrari <span class="token operator">=</span> <span class="token class-name">Car</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span>make <span class="token operator">=</span> <span class="token string">"Ferrari"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>model <span class="token operator">=</span> <span class="token string">"F40"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>year <span class="token operator">=</span> <span class="token number">1992</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>top_speed <span class="token operator">=</span> <span class="token number">201</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectApproxEqAbs</span><span class="token punctuation">(</span><br>        <span class="token keyword">try</span> <span class="token function">travelTime</span><span class="token punctuation">(</span>ferrari<span class="token punctuation">,</span> distance<span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token number">0.0995</span><span class="token punctuation">,</span><br>        tolerance<span class="token punctuation">,</span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This results in a compile error which is good because</span><br>    <span class="token comment">// the first argument is struct whose top_speed field is not an integer.</span><br>    <span class="token comment">// const wrong = Wrong{ .top_speed = 1.0 };</span><br>    <span class="token comment">// _ = try travelTime(wrong, distance);</span><br><br>    <span class="token comment">// This results in a compile error which is good because</span><br>    <span class="token comment">// the first argument is not a struct with a "top_speed" field.</span><br>    <span class="token comment">// _ = try travelTime("wrong", distance);</span><br><span class="token punctuation">}</span></code></pre><h2 id="comptime-keyword" tabindex="-1">comptime Keyword</h2><p>The <code>comptime</code> keyword marks items that must be known at compile-time. It can be applied to:</p><ul><li>function parameters</li><li>variables declared inside functions</li><li>expressions such as function calls</li><li>blocks of code</li></ul><p>The initial values of variables declared at the container level (outside any function) are automatically evaluated at compile-time.</p><p>Code executed at compile-time has several limitations.</p><ul><li>It cannot have side-effects such as performing I/O operations or sending network requests.</li><li>It cannot perform more that a fixed number of branching operations such as loop iterations or recursive calls. This limit can be set by calling <code>@setEvalBranchQuota(quota)</code>. The limit defaults to 1000 and cannot be set lower than this.</li></ul><p>Compile-time calls to the <code>assert</code> function that fail result in compile errors.</p><p>The <code>comptime</code> keyword has many uses, one of which is implementing generic types. For example, the following code defines the function <code>makeNode</code> that takes a <code>comptime</code> parameter and creates a <code>struct</code> type for a tree node whose value has a specific type.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> stdout <span class="token operator">=</span> std<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token function">getStdOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> sow <span class="token operator">=</span> stdout<span class="token punctuation">.</span><span class="token function">writer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">makeNode</span><span class="token punctuation">(</span><span class="token keyword">comptime</span> T<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">type</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">type</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> Self <span class="token operator">=</span> <span class="token builtin">@This</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        <span class="token comment">// left and right are optional pointers to</span><br>        <span class="token comment">// another instance of this struct type.</span><br>        left<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span><span class="token operator">*</span>Self</span><span class="token punctuation">,</span><br>        right<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span><span class="token operator">*</span>Self</span><span class="token punctuation">,</span><br>        value<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span><br><br>        <span class="token keyword">fn</span> <span class="token function">init</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token class-name">Self</span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> <span class="token class-name">Self</span><span class="token punctuation">{</span><br>                <span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>                <span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>                <span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">,</span><br>            <span class="token punctuation">}</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">depthFirstPrint</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>Self</span><span class="token punctuation">,</span> indent<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>            <span class="token comment">// Ignoring errors for simplicity.</span><br>            sow<span class="token punctuation">.</span><span class="token function">writeByteNTimes</span><span class="token punctuation">(</span><span class="token char">' '</span><span class="token punctuation">,</span> indent <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>            <span class="token comment">// The value of specifier will be known at compile-time.</span><br>            <span class="token keyword">const</span> specifier <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>T <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span> <span class="token string">"s"</span> <span class="token keyword">else</span> <span class="token string">""</span><span class="token punctuation">;</span><br>            <span class="token comment">// The format argument to the print function</span><br>            <span class="token comment">// must be known at compile-time.</span><br>            <span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token string">"- {"</span> <span class="token operator">++</span> specifier <span class="token operator">++</span> <span class="token string">"}\n"</span><span class="token punctuation">;</span><br>            <span class="token comment">// Ignoring errors for simplicity.</span><br>            sow<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>self<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>            <span class="token comment">// Recursively print the left and right nodes.</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">|</span>left<span class="token operator">|</span> left<span class="token punctuation">.</span><span class="token function">depthFirstPrint</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">|</span>right<span class="token operator">|</span> right<span class="token punctuation">.</span><span class="token function">depthFirstPrint</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">fn</span> <span class="token function">treeOfIntegers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> Node <span class="token operator">=</span> <span class="token function">makeNode</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node1 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node2 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token operator">&amp;</span>node2<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node3 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token operator">&amp;</span>node3<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node4 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node2<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token operator">&amp;</span>node4<span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span><span class="token function">depthFirstPrint</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">fn</span> <span class="token function">treeOfStrings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> Node <span class="token operator">=</span> <span class="token function">makeNode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node1 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"one"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node2 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"two"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token operator">&amp;</span>node2<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node3 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"three"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token operator">&amp;</span>node3<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node4 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"four"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node2<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token operator">&amp;</span>node4<span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span><span class="token function">depthFirstPrint</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">const</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    name<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>    breed<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>    age<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br><br>    <span class="token keyword">const</span> Self <span class="token operator">=</span> <span class="token builtin">@This</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">format</span><span class="token punctuation">(</span><br>        value<span class="token punctuation">:</span> <span class="token class-name">Self</span><span class="token punctuation">,</span><br>        <span class="token keyword">comptime</span> _<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>        _<span class="token punctuation">:</span> <span class="token class-name">std<span class="token punctuation">.</span>fmt<span class="token punctuation">.</span>FormatOptions</span><span class="token punctuation">,</span><br>        writer<span class="token punctuation">:</span> <span class="token keyword">anytype</span><span class="token punctuation">,</span><br>    <span class="token punctuation">)</span> <span class="token class-name">std<span class="token punctuation">.</span>os<span class="token punctuation">.</span>WriteError<span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> writer<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><br>            <span class="token string">"{s} is a {d} year old {s}."</span><span class="token punctuation">,</span><br>            <span class="token punctuation">.</span><span class="token punctuation">{</span> value<span class="token punctuation">.</span>name<span class="token punctuation">,</span> value<span class="token punctuation">.</span>age<span class="token punctuation">,</span> value<span class="token punctuation">.</span>breed <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">treeOfDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> Node <span class="token operator">=</span> <span class="token function">makeNode</span><span class="token punctuation">(</span>Dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node1 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Dog</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Maisey"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"Treeing Walker Coonhound"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node2 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Dog</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Ramsay"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"Native American Indian Dog"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token operator">&amp;</span>node2<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node3 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Dog</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Oscar"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"German Short-haired Pointer"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token operator">&amp;</span>node3<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> node4 <span class="token operator">=</span> Node<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Dog</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Comet"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"Whippet"</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    node2<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token operator">&amp;</span>node4<span class="token punctuation">;</span><br>    node1<span class="token punctuation">.</span><span class="token function">depthFirstPrint</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token function">treeOfIntegers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Output is</span><br>    <span class="token comment">// - 1</span><br>    <span class="token comment">//   - 2</span><br>    <span class="token comment">//     - 4</span><br>    <span class="token comment">//   - 3</span><br><br>    <span class="token function">treeOfStrings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Output is</span><br>    <span class="token comment">// - one</span><br>    <span class="token comment">//   - two</span><br>    <span class="token comment">//     - four</span><br>    <span class="token comment">//   - three</span><br><br>    <span class="token function">treeOfDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Output is</span><br>    <span class="token comment">// - Maisey is a 3 year old Treeing Walker Coonhound.</span><br>    <span class="token comment">//   - Ramsay is a 3 year old Native American Indian Dog.</span><br>    <span class="token comment">//     - Comet is a 3 year old Whippet.</span><br>    <span class="token comment">//   - Oscar is a 3 year old German Short-haired Pointer.</span><br><span class="token punctuation">}</span></code></pre><p>The following code computes the value of a container-level variable, <code>total</code>, at compile-time.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token comment">// []u32 is a slice which is a pointer type already.</span><br><span class="token keyword">fn</span> <span class="token function">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u32</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">u32</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// When this function is called at the container level, the</span><br>    <span class="token comment">// next line gives the error "comptime call of extern function".</span><br>    <span class="token comment">// print("in sum\n", .{});</span><br>    <span class="token keyword">var</span> _sum<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u32</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>numbers<span class="token punctuation">)</span> <span class="token operator">|</span>number<span class="token operator">|</span> <span class="token punctuation">{</span><br>        _sum <span class="token operator">+=</span> number<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> _sum<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">const</span> scores <span class="token operator">=</span> <span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token builtin-type keyword">u32</span></span><span class="token punctuation">{</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// This passes a pointer to the scores array to the</span><br><span class="token comment">// `sum` function which is executed at compile-time.</span><br><span class="token keyword">const</span> total <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>scores<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token comment">// Since total is computed at compile-time, the generated</span><br>    <span class="token comment">// binary doesn't compute it and only has to print 150.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"total = {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>total<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The <a href="https://godbolt.org/?v=1.0.22" rel="noopener" target="_blank">Compiler Explorer</a> website provides an online code editor and compiler for many languages. The screenshot below demonstrates the effect of evaluating code at compile-time on the generated assembly language instructions. Note that the generated code for the <code>demo</code> function just returns 150 and doesn't need to compute it because that is already done at compile-time.</p><p><img alt="Zig in Compiler Explorer" style="width: 100%" src="/blog/assets/zig-godbolt.png?v=1.0.22" title="Zig in Compiler Explorer"></p><p>The builtin types <code>comptime_int</code> and <code>comptime_float</code> represent integer and floating point values that are known at compile-time and whose size is not specified. Variables of these types must be either <code>const</code> or <code>comptime</code>. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> my_int <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> my_float <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"my_int type is {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>my_int<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// comptime_int</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"my_float type is {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>my_float<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// comptime_float</span><br><span class="token punctuation">}</span></code></pre><h2 id="inline-keyword" tabindex="-1">inline Keyword</h2><p>The <code>inline</code> keyword can be applied to functions, for loops, and while loops.</p><p>This screenshot shows the assembly code generated for a non-inline function.</p><p><img alt="Zig non-inline function" style="width: 100%" src="/blog/assets/zig-non-inline-function.png?v=1.0.22" title="Zig non-inline function"></p><p>This screenshot shows the assembly code generated for the same function when changed to be <code>inline</code>.</p><p><img alt="Zig inline function" style="width: 100%" src="/blog/assets/zig-inline-function.png?v=1.0.22" title="Zig inline function"></p><h2 id="reflection" tabindex="-1">Reflection</h2><p>The following builtin functions support reflection:</p><ul><li><code>@This()</code> when inside a <code>struct</code> definition, returns its type.</li><li><code>@TypeOf</code> returns the type of a given variable.</li><li><code>@typeName</code> returns the name of a given type as a string.</li><li><code>@typeInfo</code> returns information about a given type.</li><li><code>std.meta.fields</code> returns information about the fields in a struct.</li><li><code>std.meta.trait.hasField</code> methods determine if a struct contains a field with a given name.</li><li><code>std.meta.trait.hasFn</code> methods determine if a struct contains a function with a given name.</li><li><code>std.meta.trait.*</code> methods determine the kind of a type. These include <code>isConstPtr</code>, <code>isContainer</code>, <code>isExtern</code>, <code>isFloat</code>, <code>isIndexable</code>, <code>isIntegral</code>, <code>isManyItemPtr</code>, <code>isNumber</code>, <code>isPacked</code>, <code>isPtrTo</code>, <code>isSignedInt</code>, <code>isSingleItemPtr</code>, <code>isSlice</code>, <code>isSliceOf</code>, <code>isTuple</code>, <code>isUnsignedInt</code>, and <code>isZigString</code>.</li></ul><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> trait <span class="token operator">=</span> std<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>trait<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span> breed<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token builtin-type keyword">u8</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">nextInteger</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">,</span> bigger<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">bool</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bigger<span class="token punctuation">)</span> n <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">else</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> d <span class="token operator">=</span> <span class="token class-name">Dog</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Comet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>breed <span class="token operator">=</span> <span class="token string">"whippet"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Struct reflection</span><br>    <span class="token comment">// This for loop must be inline.</span><br>    <span class="token keyword">inline</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">fields</span><span class="token punctuation">(</span>Dog<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>field<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> T <span class="token operator">=</span> field<span class="token punctuation">.</span><span class="token builtin-type keyword">type</span><span class="token punctuation">;</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><br>            <span class="token string">"Dog struct has field \"{s}\" with type {s}\n"</span><span class="token punctuation">,</span><br>            <span class="token punctuation">.</span><span class="token punctuation">{</span> field<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token builtin">@typeName</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token punctuation">}</span><br>        <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token builtin">@field</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> field<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token comment">// comptime is required here because the compiler needs to know the type.</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">comptime</span> trait<span class="token punctuation">.</span><span class="token function">isNumber</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value is {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">comptime</span> trait<span class="token punctuation">.</span><span class="token function">isZigString</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"value is {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Function reflection</span><br>    <span class="token keyword">const</span> T <span class="token operator">=</span> <span class="token builtin">@TypeOf</span><span class="token punctuation">(</span>nextInteger<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"nextInteger type is {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>T<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fn(i32, bool) i32</span><br>    <span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token builtin">@typeInfo</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>info <span class="token operator">==</span> <span class="token punctuation">.</span>Fn<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// if T is a function type ...</span><br>        <span class="token comment">// This for loop must be inline.</span><br>        <span class="token keyword">inline</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">..</span><span class="token punctuation">,</span> info<span class="token punctuation">.</span>Fn<span class="token punctuation">.</span>params<span class="token punctuation">)</span> <span class="token operator">|</span>number<span class="token punctuation">,</span> param<span class="token operator">|</span> <span class="token punctuation">{</span><br>            <span class="token comment">// Can't get parameter name, only type.</span><br>            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"parameter {d} type is {any}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> number<span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token builtin-type keyword">type</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"return type is {any}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>info<span class="token punctuation">.</span>Fn<span class="token punctuation">.</span>return_type<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>In the code above, <code>info</code> is a <code>std.builtin.Type</code> instance. It is compared to <code>.Fn</code> to test whether <code>T</code> is a function type. A <code>Type</code> instance can be compared to any of these: <code>.AnyFrame</code>, <code>.Array</code>, <code>.Bool</code>, <code>.ComptimeFloat</code>, <code>.ComptimeInt</code>, <code>.Enum</code>, <code>.EnumLiteral</code>, <code>.ErrorSet</code>, <code>.ErrorUnion</code>, <code>.Float</code>, <code>.Fn</code>, <code>.Frame</code>, <code>.Int</code>, <code>.NoReturn</code>, <code>.Null</code>, <code>.Opaque</code>, <code>.Optional</code>, <code>.Pointer</code>, <code>.Struct</code>, <code>.Undefined</code>, <code>.Union</code>, <code>.Vector</code>, and <code>.Void</code></p><h2 id="allocators" tabindex="-1">Allocators</h2><p>All memory allocation in Zig is done through allocators. There are many provided allocators that each use a different memory management strategy. New allocators can be defined to implement custom memory management strategies.</p><p>For guidelines on selecting an allocator, see <a href="https://ziglang.org/documentation/master/#Choosing-an-Allocator?v=1.0.22" rel="noopener" target="_blank">Choosing an Allocator</a>.</p><p>TODO: Show an example of creating and using an allocator. TODO: You have already done this somewhere in this file.</p><p>The <code>defer</code> keyword is followed by a statement or block of code to be executed when the containing block terminates. This is often used to free memory that was allocated by an allocator. Keeping code that allocates and frees memory together is less error-prone than allocating memory, writing a bunch of code that uses it, and having to remember to free it after all that code.</p><ul><li><p><code>std.heap.ArenaAllocator</code></p><p>This allocator uses an &quot;arena&quot; to handle the task of freeing the memory of everything allocated by it when it goes out of scope. This allows allocating memory for many things that donâ€™t need to be individually freed. All that is required is to use <code>defer arena.deinit();</code> one time right after the <code>ArenaAllocator</code> is created.</p><p>The following code demonstrates using this allocator.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> base_allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"ArenaAllocator"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> arena <span class="token operator">=</span> std<span class="token punctuation">.</span>heap<span class="token punctuation">.</span>ArenaAllocator<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>base_allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> arena<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> allocator <span class="token operator">=</span> arena<span class="token punctuation">.</span><span class="token function">allocator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">var</span> list1 <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no need to deinit</span><br>    <span class="token keyword">try</span> list1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"one"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"two"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"three"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list1<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">var</span> list2 <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no need to deinit</span><br>    <span class="token keyword">try</span> list2<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list2<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list2<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// No memory is leaked even though we didn't deinit the lists.</span><br><span class="token punctuation">}</span></code></pre></li><li><p><code>std.heap.c_allocator</code></p><p>When C code is linked, this allocator allows using <code>malloc</code>.</p></li><li><p><code>std.heap.FixedBufferAllocator</code></p><p>This takes a buffer and transform it into an allocator. It is useful to reuse previously allocated memory.</p></li><li><p><code>std.heap.GeneralPurposeAllocator</code></p><p>This is a configurable allocator that can detect certain errors while using heap memory.</p></li><li><p><code>std.heap.LogToWriterAllocator</code></p><p>This allocator is similar to <code>std.heap.LoggingAllocator</code>, but allows specifying where the log messages should be written (such as a file).</p></li><li><p><code>std.heap.LoggingAllocator</code></p><p>This wraps another allocator and logs all the allocations and frees for debugging purposes. The following code demonstrates this.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> gpa <span class="token operator">=</span> std<span class="token punctuation">.</span>heap<span class="token punctuation">.</span><span class="token function">GeneralPurposeAllocator</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// can't be const</span><br>    <span class="token keyword">var</span> la <span class="token operator">=</span> std<span class="token punctuation">.</span>heap<span class="token punctuation">.</span><span class="token function">loggingAllocator</span><span class="token punctuation">(</span>gpa<span class="token punctuation">.</span><span class="token function">allocator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// can't be const</span><br>    <span class="token keyword">const</span> allocator <span class="token operator">=</span> la<span class="token punctuation">.</span><span class="token function">allocator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">var</span> list <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ArrayList</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> list<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// allocates 128 bytes</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending orange"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"orange"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending yellow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"yellow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending green"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"green"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending blue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending purple"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"purple"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending white"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending gray"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"gray"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending black"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// allocs 320 bytes &amp; deallocs previous 128 bytes</span><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"appending brown"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"brown"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span>items<span class="token punctuation">)</span> <span class="token operator">|</span>color<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">log</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"end of main"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// frees 320 bytes</span><br><span class="token punctuation">}</span></code></pre></li><li><p><code>std.heap.MemoryPool</code></p><p>This allocator allocates memory for only one type and is very fast. Use this in code that needs to allocate a large number of instances of one type.</p></li><li><p><code>std.heap.page_allocator</code></p><p>This allocator allocates memory in chunks of the OS page size.</p></li><li><p><code>std.heap.raw_c_allocator</code></p><p>This allocator asserts that allocations are within <code>@alignOf(std.c.max_align_t)</code> and directly calls <code>malloc</code>/<code>free</code>. It can be used with <code>ArenaAllocator</code> and is more optimal in that case than `std.heap.c_allocator``.</p></li><li><p><code>std.heap.SbrkAllocator</code></p><p>This is a low-level allocator. See <a href="https://en.wikipedia.org/wiki/Sbrk?v=1.0.22" rel="noopener" target="_blank">sbrk</a>.</p></li><li><p><code>std.heap.ScopedLoggingAllocator</code></p><p>Same as the above but it goes directly to the std.log function, this time with our good ol' scope</p></li><li><p><code>std.heap.StackFallbackAllocator</code></p><p>Some stack, some heap: IF the stack is not enough, go to the heap</p></li><li><p><code>std.heap.ThreadSafeAllocator</code></p><p>Covers an allocator in a way that calling it between threads is safe (not exactly fast tho)</p></li><li><p><code>std.heap.WasmAllocator</code></p><p>Wasm is your friend, use this to allocate. Generally used as a backing allocator for GeneralPurpose or Arena</p></li><li><p><code>std.heap.WasmPageAllocator</code></p><p>Dumber WasmAllocator, useful for when you actually wanna do your own memory management via &quot;pages&quot;</p></li><li><p><code>std.testing.allocator</code></p><p>This can only be used inside a <code>test</code> block. It detects memory leaks.</p></li><li><p>`std.testing.FailingAllocator``</p><p>This fails after a given number of allocations. It is useful for testing how a program handles out of memory conditions. It must be passed another allocator such as <code>std.testing.allocator</code>. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> testing <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">;</span><br><span class="token keyword">var</span> allocator <span class="token operator">=</span> testing<span class="token punctuation">.</span>FailingAllocator<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li></ul><h2 id="standard-library" tabindex="-1">Standard Library</h2><p>The Zig <a href="https://ziglang.org/documentation/master/std/?v=1.0.22" rel="noopener" target="_blank">standard library</a> provides many &quot;commonly used algorithms, data structures, and definitions&quot;.</p><p>To use the standard library in a source file, add the following line near the top of the file:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The standard library defines many namespaces that define types, functions, values, and error sets. Some of these define additional child namespaces.</p><p>The top-level namespaces in the standard library include the following:</p><ul><li><code>array_hash_map</code> - defines several kinds of hash maps that preserve insertion order</li><li><code>ascii</code> - ASCII text processing</li><li><code>atomic</code> - memory ordering, atomic data structures, and operations</li><li><code>base64</code> - Base64 encoding/decoding</li><li><code>bit_set</code> - bit manipulation data structures</li><li><code>builtin</code> - comptime-available information about the build environment, such as the target and optimization mode</li><li><code>c</code> - provides access to many standard C functions such as <code>bind</code>, <code>connect</code>, <code>fork</code>, <code>free</code>, <code>malloc</code>, and <code>send</code></li><li><code>coff</code> - Common Object File Format (COFF)</li><li><code>compress</code> - compression algorithms such as zlib, zstd, and more</li><li><code>comptime_string_map</code> - defines compile-time known has maps with string keys</li><li><code>crypto</code> - cryptography</li><li><code>cstr</code> - defines values used when working with C strings</li><li><code>debug</code> - debug printing, allocation and other debug helpers</li><li><code>dwarf</code> - Debugging With Arbitrary Record Formats (DWARF) debugging data format</li><li><code>elf</code> - Executable and Linking Format (ELF)</li><li><code>enums</code> - enum-related metaprogramming helpers</li><li><code>event</code> - evented I/O data structures</li><li><code>fifo</code> - first in, first out data structures</li><li><code>fmt</code> - string formatting and parsing (e.g. parsing numbers out of strings)</li><li><code>fs</code> - file system-related functionality</li><li><code>hash_map</code> - defines several kinds of hash maps that do not preserve insertion order</li><li><code>hash</code> - fast hashing functions (i.e. not cryptographically secure)</li><li><code>heap</code> - allocator implementations</li><li><code>http</code> - HTTP client and server</li><li><code>io</code> - I/O streams, reader/writer interfaces and common helpers</li><li><code>json</code> - JSON parsing and serialization</li><li><code>leb</code> - Little Endian Base (LEB128) encoding</li><li><code>log</code> - standardized interface for logging</li><li><code>macho</code> - Mach Object (Mach-O) file format</li><li><code>math</code> - mathematical constants and operations</li><li><code>mem</code> - functions for comparing, searching, and manipulating memory</li><li><code>meta</code> - metaprogramming helpers</li><li><code>net</code> - networking</li><li><code>os</code> - wrappers around OS-specific APIs</li><li><code>packed_int_array</code> - a set of array and slice types that bit-pack integer elements</li><li><code>pdb</code> - Program Database (PDB) file format</li><li><code>process</code> - accessors for process-related info (e.g. command line arguments) and spawning of child processes</li><li><code>rand</code> - fast pseudo-random number generators (i.e. not cryptographically secure)</li><li><code>simd</code> - single Instruction Multiple Data (SIMD) helpers</li><li><code>sort</code> - sorting</li><li><code>start</code> - defines a couple of undocumented functions</li><li><code>tar</code> - Tape Archive (tar) archive format compression/decompression</li><li><code>testing</code> - testing allocator, testing assertions, and other helpers for testing code</li><li><code>time</code> - sleep, obtaining the current time, conversion constants, and more</li><li><code>tz</code> - time zones</li><li><code>unicode</code> - UTF-8 and UTF-16LE encoding/decoding</li><li><code>valgrind</code> - helpers for integrating with Valgrind</li><li><code>wasm</code> - constants and types representing the WebAssembly (Wasm) binary format</li><li><code>zig</code> - tokenizing and parsing of Zig code and other Zig-specific language tooling</li></ul><p>Some of the most commonly used parts are described in the subsections below.</p><h3 id="arraylist" tabindex="-1">ArrayList</h3><p>The <a href="https://ziglang.org/documentation/master/std/#A;std:ArrayList" target="_blank">ArrayList</a> data structure is &quot;a contiguous, growable list of items in memory.&quot;</p><p>Instances of <code>ArrayList</code> have the fields <code>items</code>, <code>capacity</code>, and <code>allocator</code>. Instances have the methods <code>append</code>, <code>appendSlice</code>, <code>clone</code>, <code>deinit</code>, <code>getLast</code>, <code>getLastOrNull</code>, <code>init</code>, <code>insert</code>, <code>insertSlice</code>, <code>orderedRemove</code>, <code>pop</code>, <code>popOrNull</code>, <code>replaceRange</code>, <code>writer</code>, and many more.</p><p>The following code demonstrates common operations on HashMaps.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqualStrings <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqualStrings<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"ArrayList"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> list <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ArrayList</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> list<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">appendSlice</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token class-name"><span class="token punctuation">[</span>_<span class="token punctuation">]</span>String</span><span class="token punctuation">{</span> <span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the list entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span>items<span class="token punctuation">)</span> <span class="token operator">|</span>value<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// There is no method to test if an ArrayList` contains a given value.</span><br>    <span class="token comment">// It's more efficient to use a `BufSet` when that is needed.</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span>String<span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">getLastOrNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span>String<span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">popOrNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"pink"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// Also see the replaceRange method.</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">orderedRemove</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span>String<span class="token punctuation">,</span> <span class="token string">"pink"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">appendNTimes</span><span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// length was 2</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span>String<span class="token punctuation">,</span> <span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">getLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    list<span class="token punctuation">.</span><span class="token function">clearAndFree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h3 id="multiarraylist" tabindex="-1">MultiArrayList</h3><p>A <a href="https://ziglang.org/documentation/master/std/#A;std:MultiArrayList?v=1.0.22" rel="noopener" target="_blank">MultiArrayList</a> is similar to an <code>ArrayList</code> in that it to stores a sequence of elements. However, the elements must be instances of a <code>struct</code> or <code>union</code> type.</p><p>Each field is stored in a separate array which makes it easy to obtain a slice containing all the values for a given field. Such a slice can used to create a <code>Vector</code> which supports <a href="https://en.wikipedia.org/wiki/Single_instruction,_multiple_data?v=1.0.22" rel="noopener" target="_blank">SIMD</a> operations.</p><p>The following code demonstrates several common operations on <code>MultiArrayList</code> instances:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token class-name">Range</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    min<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span><span class="token punctuation">,</span><br>    max<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span><span class="token punctuation">,</span><br>    current<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">f32</span></span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"MultiArrayList"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Unlike "ArrayList" instances, "MultiArrayList" instances</span><br>    <span class="token comment">// do not store an allocator in order to optimize memory used.</span><br>    <span class="token comment">// This is why an allocator must be passed</span><br>    <span class="token comment">// to methods like "append" and "insert".</span><br>    <span class="token keyword">var</span> list <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">MultiArrayList</span><span class="token punctuation">(</span>Range<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> list<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Optionally set the total capacity before appending elements</span><br>    <span class="token comment">// to avoid having to allocate memory multiple times.</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">ensureTotalCapacity</span><span class="token punctuation">(</span>allocator<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> r1 <span class="token operator">=</span> <span class="token class-name">Range</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>max <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>allocator<span class="token punctuation">,</span> r1<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>allocator<span class="token punctuation">,</span> <span class="token class-name">Range</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>min <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>max <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">25</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Insert an element at a specific index, zero in this case.</span><br>    <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>allocator<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Range</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>min <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>max <span class="token operator">=</span> <span class="token number">9999</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">1234</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Set an element at a specific index, zero in this case.</span><br>    list<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Range</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>min <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>max <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">1234</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// After the insert, r1 was moved to index 1.</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r1<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The "items" method gets a slice of the values for a given field.</span><br>    <span class="token keyword">const</span> currents<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin-type keyword">f32</span></span> <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">items</span><span class="token punctuation">(</span><span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> vector<span class="token punctuation">:</span> <span class="token builtin">@Vector</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token builtin-type keyword">f32</span><span class="token punctuation">)</span> <span class="token operator">=</span> currents<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">..</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">.*</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token builtin">@reduce</span><span class="token punctuation">(</span><span class="token punctuation">.</span>Add<span class="token punctuation">,</span> vector<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> <span class="token number">1309.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h3 id="hashmap" tabindex="-1">HashMap</h3><p>A hash map is a collection of key/value pairs.</p><p><a href="https://ziglang.org/documentation/master/std/#A;std:HashMap" target="_blank">std.HashMap</a> is a low-level implementation that requires supplying a hashing function.<br></p><p><a href="https://ziglang.org/documentation/master/std/#A;std:AutoHashMap" target="_blank">std.AutoHashMap</a> provides a good hashing function for most key types. The first argument is the key type and the second is the value type. When the key type is <code>[]const u8</code>, the following error is triggered: &quot;std.auto_hash.autoHash does not allow slices here ([]const u8) because the intent is unclear. Consider using std.StringHashMap for hashing the contents of []const u8.&quot;</p><p>The following code creates an <code>AutoHashMap</code> where the keys are strings and the values are unsigned integers.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoHashMap</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://ziglang.org/documentation/master/std/#A;std:AutoArrayHashMap" target="_blank">std.AutoArrayHashMap</a> is similar to <code>std.AutoHashMap</code>. It differs in the following was described in the docs:</p><ul><li>&quot;Insertion order is preserved.&quot;</li><li>&quot;Deletions perform a swap removal on the entries list.&quot;</li><li>&quot;Modifying the hash map while iterating is allowed, however, one must understand the well-defined behavior when mixing insertions and deletions with iteration.</li><li>The <code>values</code> method &quot;returns the backing array of values&quot;.</li></ul><p><a href="https://ziglang.org/documentation/master/std/#A;std:StringHashMap" target="_blank">std.StringHashMap</a> provides a good hashing function for string keys. The argument is the value type.</p><p>The following code demonstrates common operations on <code>HashMap</code>s.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqualStrings <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqualStrings<span class="token punctuation">;</span><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"AutoArrayHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoArrayHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">var</span> name <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token keyword">orelse</span> <span class="token string">""</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">orderedRemove</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"AutoHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Iterate over the map keys.</span><br>    <span class="token keyword">var</span> iter2 <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keyIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> number <span class="token operator">=</span> key<span class="token operator">.*</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>name<span class="token operator">|</span> <span class="token punctuation">{</span><br>            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">var</span> name <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token keyword">orelse</span> <span class="token string">""</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// try expectEqual(map.get(99), null);</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"ComptimeStringMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create an array of tuples.</span><br>    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Create a compile-time map of string keys to u8 values.</span><br>    <span class="token comment">// Since an immutable map with a fixed size is being created,</span><br>    <span class="token comment">// there is no need to deinit it.</span><br>    <span class="token keyword">const</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ComptimeStringMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span>kvs<span class="token punctuation">)</span> <span class="token operator">|</span>kv<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> kv<span class="token punctuation">.</span>key<span class="token punctuation">,</span> kv<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"StringHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// The keys are strings and the values are unsigned integers.</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">StringHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Iterate over the map keys.</span><br>    <span class="token keyword">var</span> iter2 <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keyIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {any}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> key<span class="token operator">.*</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token operator">.*</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p><a href="https://ziglang.org/documentation/master/std/#A;std:ComptimeStringMap" target="_blank">std.ComptimeStringMap</a> provides an alternative to <code>StringHashMap</code> for immutable hash maps with string keys whose entries are fixed at compile-time. It has a much simpler API that the hash maps described above and does not require memory cleanup by calling a <code>deinit</code> method.</p><p>The <code>ComptimeStringMap</code> function takes two arguments. The first is the value type and the second is an array of key/value tuples.</p><p>The following code demonstrates common operations on a <code>ComptimeStringMap</code>.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"ComptimeStringMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create an array of tuples.</span><br>    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Create a compile-time map of string keys to u8 values.</span><br>    <span class="token keyword">const</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ComptimeStringMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span>kvs<span class="token punctuation">)</span> <span class="token operator">|</span>kv<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> kv<span class="token punctuation">.</span>key<span class="token punctuation">,</span> kv<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h3 id="sets" tabindex="-1">Sets</h3><p>A <a href="https://ziglang.org/documentation/master/std/#A;std:BufSet?v=1.0.22" rel="noopener" target="_blank">BufSet</a> is a set of string values.</p><p>An <a href="https://ziglang.org/documentation/master/std/#A;std:EnumSet?v=1.0.22" rel="noopener" target="_blank">EnumSet</a> is a set of enum values.</p><p>A <a href="https://ziglang.org/documentation/master/std/#A;std:DynamicBitSet?v=1.0.22" rel="noopener" target="_blank">DynamicBitSet</a> is a set of bit values.</p><p>For sets of other kinds of values, consider using a <code>HashMap</code> where the values have the type <code>void</code>.</p><p>The following code demonstrates common operations on both of these kinds of sets.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"BufSet"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> set <span class="token operator">=</span> std<span class="token punctuation">.</span>BufSet<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> set<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the set keys.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> set<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>key<span class="token operator">.*</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"EnumSet"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token class-name">Color</span> <span class="token operator">=</span> <span class="token keyword">enum</span> <span class="token punctuation">{</span> red<span class="token punctuation">,</span> orange<span class="token punctuation">,</span> yellow<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue<span class="token punctuation">,</span> purple<span class="token punctuation">,</span> white<span class="token punctuation">,</span> black <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This does not use an allocator and does not have a `deinit` method.</span><br>    <span class="token keyword">var</span> set <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">EnumSet</span><span class="token punctuation">(</span>Color<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">initEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// To begin with all enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initFull();</span><br><br>    <span class="token comment">// To begin with a subset of the enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initMany(&amp;[_]Color{ .orange, .yellow });</span><br><br>    <span class="token comment">// To begin with one of the enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initOne(.orange);</span><br><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>orange<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>black<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the set keys.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> set<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// There are many more methods on `EnumSet` instances.</span><br><span class="token punctuation">}</span></code></pre><h2 id="builtin-functions" tabindex="-1">Builtin Functions</h2><p>Zig provides over 100 (118 as of 10/23) <a href="https://ziglang.org/documentation/master/#Builtin-Functions?v=1.0.22" rel="noopener" target="_blank">builtin functions</a>. These are known to the compiler and do not require importing in order to use them.</p><p>The name of every builtin function begins with &quot;@&quot;. If <code>@</code> is followed by an uppercase letter then the function returns a type.</p><p>While the builtin functions are invoked like normal functions, some have behavior that normal functions cannot replicate.</p><p>The official documentation at the link above does not categorize the builtin functions. The YouTube video <a href="https://www.youtube.com/watch?v=V0sthxzzN3U?v=1.0.22" rel="noopener" target="_blank">A Look at Zig's Built-ins</a> from Loris Cro uses the categories below:</p><h3 id="math-builtin-functions-(25)" tabindex="-1">Math Builtin Functions (25)</h3><p>The math builtin functions can take advantage of CPU-specific capabilities to achieve better performance than functions in the standard library found in <code>std.math</code>. However, this is partially achieved by providing less error checking.</p><p>Most of the math builtin functions can operator on a single float or a <code>Vector</code> of floats. When passed a <code>Vector</code> of floats, they return a new <code>Vector</code> of floats.</p><ul><li><code>@addWithOverflow</code> -</li><li><code>@ceil</code> - returns the ceiling of a float or Vector of floats</li><li><code>@cos</code> - returns the cosine of a float or Vector of floats</li><li><code>@divExact</code> - returns the quotient of two numbers</li><li><code>@divFloor</code> -</li><li><code>@divTrunc</code> -</li><li><code>@exp</code> -</li><li><code>@exp2</code> -</li><li><code>@fabs</code> - returns the absolute value of the float or Vector of floats</li><li><code>@floor</code> - returns the floor of a float or Vector of floats</li><li><code>@log</code> -</li><li><code>@log10</code> -</li><li><code>@log2</code> -</li><li><code>@max</code> -</li><li><code>@min</code> -</li><li><code>@mod</code> -</li><li><code>@mulAdd</code> -</li><li><code>@mulWithOverflow</code> -</li><li><code>@rem</code> -</li><li><code>@round</code> -</li><li><code>@sin</code> - returns the sine of a float or Vector of floats</li><li><code>@sqrt</code> -returns the square root of a float or Vector of floats</li><li><code>@subWithOverflow</code> -</li><li><code>@tan</code> - returns the tangent of a float or Vector of floats</li><li><code>@trunc</code> -</li></ul><h3 id="bitwise-builtin-functions-(8)" tabindex="-1">Bitwise Builtin Functions (8)</h3><ul><li><code>@bitReverse</code> -</li><li><code>@byteSwap</code> -</li><li><code>@clz</code> -</li><li><code>@ctz</code> -</li><li><code>@popCount</code> -</li><li><code>@shlExact</code> -</li><li><code>@shlWithOverflow</code> -</li><li><code>@shrExact</code> -</li></ul><h3 id="atomic-and-memory-builtin-functions-(12)" tabindex="-1">Atomic and Memory Builtin Functions (12)</h3><ul><li><code>@atomicLoad</code> -</li><li><code>@atomicRmw</code> -</li><li><code>@atomicStore</code> -</li><li><code>@cmpxchgStrong</code> -</li><li><code>@cmpxchgWeak</code> -</li><li><code>@fence</code> -</li><li><code>@memcpy</code> -</li><li><code>@memset</code> -</li><li><code>@shuffle</code> -</li><li><code>@splat</code> -</li><li><code>@wasmMemoryGrow</code> -</li><li><code>@wasmMemorySize</code> -</li></ul><h3 id="cast-and-conversion-builtin-functions-(20)" tabindex="-1">Cast and Conversion Builtin Functions (20)</h3><p>In general, using <code>@as</code> is preferred over other casting functions. Casts can be combined with introspection functions to achieve better error handling.</p><ul><li><code>@alignCast</code> -</li><li><code>@addrSpaceCast</code> -</li><li><code>@as</code> -</li><li><code>@bitCast</code> -</li><li><code>@constCast</code> -</li><li><code>@enumFromInt</code> -</li><li><code>@errorCast</code> -</li><li><code>@errorFromInt</code> -</li><li><code>@floatCast</code> -</li><li><code>@floatFromInt</code> -</li><li><code>@intCast</code> -</li><li><code>@intFromBool</code> -</li><li><code>@intFromEnum</code> -</li><li><code>@intFromError</code> -</li><li><code>@intFromFloat</code> -</li><li><code>@intFromPtr</code> -</li><li><code>@ptrCast</code> -</li><li><code>@ptrFromInt</code> -</li><li><code>@truncate</code> -</li><li><code>@volatileCast</code> -</li></ul><h3 id="programming-builtin-functions-(18)" tabindex="-1">Programming Builtin Functions (18)</h3><ul><li><p><code>@cDefine</code> -</p></li><li><p><code>@cImport</code> -</p></li><li><p><code>@cInclude</code> -</p></li><li><p><code>@cUndef</code> -</p></li><li><p><code>@cVaArg</code></p></li><li><p><code>@cVaCopy</code></p></li><li><p><code>@cVaEnd</code></p></li><li><p><code>@cVaStart</code></p></li><li><p><code>@compileError</code> -</p></li><li><p><code>@compileLog</code> -</p></li><li><p><code>@embedFile</code></p><p>This reads a file at compile time and embeds the text in the compiled code as if it were a literal string. The file path can be absolute or relative.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqualStrings <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqualStrings<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"embedFile"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token builtin">@embedFile</span><span class="token punctuation">(</span><span class="token string">"./file_io/data.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">"Hello, World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p><code>@export</code> -</p></li><li><p><code>@import</code> -</p></li><li><p><code>@setAlignStack</code> -</p></li><li><p><code>@setCold</code> -</p></li><li><p><code>@setEvalBranchQuota</code> -</p></li><li><p><code>@setFloatMode</code> -</p></li><li><p><code>@setRuntimeSafety</code> -</p></li></ul><h3 id="runtime-and-async-builtin-functions-(3)" tabindex="-1">Runtime and Async Builtin Functions (3)</h3><ul><li><code>@breakpoint</code> -</li><li><code>@frameAddress</code> -</li><li><code>@panic</code> -</li></ul><h3 id="introspection-builtin-functions-(11)" tabindex="-1">Introspection Builtin Functions (11)</h3><ul><li><code>@alignOf</code> -</li><li><code>@bitOffsetOf</code> -</li><li><code>@bitSizeOf</code> -</li><li><code>@errorName</code> -</li><li><code>@errorReturnTrace</code> -</li><li><code>@fieldParentPtr</code> -</li><li><code>@frameAddress</code> -</li><li><code>@returnAddress</code> -</li><li><code>@sizeOf</code> -</li><li><code>@src</code> -</li><li><code>@tagName</code> -</li></ul><h3 id="metaprogramming-builtin-functions-(10)" tabindex="-1">Metaprogramming Builtin Functions (10)</h3><ul><li><p><code>@This</code> - returns the type of the containing <code>enum</code>, <code>struct</code>, or <code>union</code></p></li><li><p><code>@Type</code> - returns the type that corresponds to an instance of the <code>std.builtin.Type</code> struct</p></li><li><p><code>@TypeOf</code> - returns the type of a given value</p></li><li><p><code>@call</code> - calls a given function with arguments in a tuple</p><p>The <a href="?v=1.0.22" rel="noopener" target="_blank">@call</a> function takes a <a href="https://ziglang.org/documentation/master/std/#A;std:builtin.CallModifier?v=1.0.22" rel="noopener" target="_blank">CallModifier</a> enum value, a function, and arguments in a tuple. The CallModifier enum values are <code>auto</code> (most common), <code>always_inline</code>, <code>always_tail</code>, <code>async_kw</code>, <code>compile_time</code>, <code>never_inline</code>, <code>never_tail</code>, and <code>no_async</code>.</p><p>The following code demonstrates using <code>@call</code>.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"@call"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token builtin">@call</span><span class="token punctuation">(</span><span class="token punctuation">.</span>auto<span class="token punctuation">,</span> add<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p><code>@field</code> -</p></li><li><p><code>@hasDecl</code> -</p></li><li><p><code>@hasField</code> -</p></li><li><p><code>@typeInfo</code> - returns an instance of the <code>std.builtin.Type</code> struct that describes a given type</p></li><li><p><code>@typeName</code> - returns the string name of a given type</p></li><li><p><code>@unionInit</code> -</p></li></ul><h3 id="other-builtin-functions-(11)" tabindex="-1">Other Builtin Functions (11)</h3><p>TODO: Find the proper category for these!</p><ul><li><code>@Vector</code> -</li><li><code>@extern</code> -</li><li><code>@inComptime</code> -</li><li><code>@offsetOf</code> -</li><li><code>@prefetch</code> -</li><li><code>@reduce</code> -</li><li><code>@select</code> -</li><li><code>@trap</code> -</li><li><code>@workGroupId</code> -</li><li><code>@workGroupSize</code> -</li><li><code>@workItemId</code> -</li></ul><h3 id="hashmap-1" tabindex="-1">HashMap</h3><p>A hash map is a collection of key/value pairs.</p><p><a href="https://ziglang.org/documentation/master/std/#A;std:HashMap" target="_blank">std.HashMap</a> is a low-level implementation that requires supplying a hashing function.<br></p><p><a href="https://ziglang.org/documentation/master/std/#A;std:AutoHashMap" target="_blank">std.AutoHashMap</a> provides a good hashing function for most key types. The first argument is the key type and the second is the value type. When the key type is <code>[]const u8</code>, the following error is triggered: &quot;std.auto_hash.autoHash does not allow slices here ([]const u8) because the intent is unclear. Consider using std.StringHashMap for hashing the contents of []const u8.&quot;</p><p>The following code creates an <code>AutoHashMap</code> where the keys are strings and the values are unsigned integers.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoHashMap</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://ziglang.org/documentation/master/std/#A;std:AutoArrayHashMap" target="_blank">std.AutoArrayHashMap</a> is similar to <code>std.AutoHashMap</code>. It differs in the following was described in the docs:</p><ul><li>&quot;Insertion order is preserved.&quot;</li><li>&quot;Deletions perform a swap removal on the entries list.&quot;</li><li>&quot;Modifying the hash map while iterating is allowed, however, one must understand the well-defined behavior when mixing insertions and deletions with iteration.</li><li>The <code>values</code> method &quot;returns the backing array of values&quot;.</li></ul><p><a href="https://ziglang.org/documentation/master/std/#A;std:StringHashMap" target="_blank">std.StringHashMap</a> provides a good hashing function for string keys. The argument is the value type.</p><p>A <code>HashMap</code> can be used as a set where the values are <code>{}</code>.</p><p>The following code demonstrates common operations on <code>HashMap</code>s.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqualStrings <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqualStrings<span class="token punctuation">;</span><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"AutoArrayHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoArrayHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">var</span> name <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token keyword">orelse</span> <span class="token string">""</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">orderedRemove</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"AutoHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Iterate over the map keys.</span><br>    <span class="token keyword">var</span> iter2 <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keyIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> number <span class="token operator">=</span> key<span class="token operator">.*</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>name<span class="token operator">|</span> <span class="token punctuation">{</span><br>            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">var</span> name <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token keyword">orelse</span> <span class="token string">""</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// try expectEqual(map.get(99), null);</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"ComptimeStringMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create an array of tuples.</span><br>    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Create a compile-time map of string keys to u8 values.</span><br>    <span class="token comment">// Since an immutable map with a fixed size is being created,</span><br>    <span class="token comment">// there is no need to deinit it.</span><br>    <span class="token keyword">const</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ComptimeStringMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span>kvs<span class="token punctuation">)</span> <span class="token operator">|</span>kv<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> kv<span class="token punctuation">.</span>key<span class="token punctuation">,</span> kv<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"StringHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// The keys are strings and the values are unsigned integers.</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">StringHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Iterate over the map keys.</span><br>    <span class="token keyword">var</span> iter2 <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keyIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {any}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> key<span class="token operator">.*</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token operator">.*</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p><a href="https://ziglang.org/documentation/master/std/#A;std:ComptimeStringMap" target="_blank">std.ComptimeStringMap</a> provides an alternative to <code>StringHashMap</code> for immutable hash maps with string keys whose entries are fixed at compile-time. It has a much simpler API that the hash maps described above and does not require memory cleanup by calling a <code>deinit</code> method.</p><p>The <code>ComptimeStringMap</code> function takes two arguments. The first is the value type and the second is an array of key/value tuples.</p><p>The following code demonstrates common operations on a <code>ComptimeStringMap</code>.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"ComptimeStringMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create an array of tuples.</span><br>    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Create a compile-time map of string keys to u8 values.</span><br>    <span class="token keyword">const</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ComptimeStringMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span>kvs<span class="token punctuation">)</span> <span class="token operator">|</span>kv<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> kv<span class="token punctuation">.</span>key<span class="token punctuation">,</span> kv<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h3 id="sets-1" tabindex="-1">Sets</h3><p>A <a href="https://ziglang.org/documentation/master/std/#A;std:BufSet?v=1.0.22" rel="noopener" target="_blank">BufSet</a> is a set of string values.</p><p>An <a href="https://ziglang.org/documentation/master/std/#A;std:EnumSet?v=1.0.22" rel="noopener" target="_blank">EnumSet</a> is a set of enum values.</p><p>The following code demonstrates common operations on both of these kinds of sets.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"BufSet"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> set <span class="token operator">=</span> std<span class="token punctuation">.</span>BufSet<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> set<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the set keys.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> set<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>key<span class="token operator">.*</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"EnumSet"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token class-name">Color</span> <span class="token operator">=</span> <span class="token keyword">enum</span> <span class="token punctuation">{</span> red<span class="token punctuation">,</span> orange<span class="token punctuation">,</span> yellow<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue<span class="token punctuation">,</span> purple<span class="token punctuation">,</span> white<span class="token punctuation">,</span> black <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This does not use an allocator and does not have a `deinit` method.</span><br>    <span class="token keyword">var</span> set <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">EnumSet</span><span class="token punctuation">(</span>Color<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">initEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// To begin with all enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initFull();</span><br><br>    <span class="token comment">// To begin with a subset of the enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initMany(&amp;[_]Color{ .orange, .yellow });</span><br><br>    <span class="token comment">// To begin with one of the enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initOne(.orange);</span><br><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>orange<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>black<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the set keys.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> set<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// There are many more methods on `EnumSet` instances.</span><br><span class="token punctuation">}</span></code></pre><h3 id="multiarraylist-1" tabindex="-1">MultiArrayList</h3><p>The <a href="https://ziglang.org/documentation/master/std/#A;std:MultiArrayList?v=1.0.22" rel="noopener" target="_blank">MultiArrayList</a> data structure &quot;stores a list of a struct or tagged union type&quot;. &quot;Instead of storing a single list of items, MultiArrayList stores separate lists for each field of the struct or lists of tags and bare unions.&quot;</p><p>TODO: Add an example.</p><h2 id="builtin-functions-1" tabindex="-1">Builtin Functions</h2><p>Zig provides over 100 <a href="https://ziglang.org/documentation/master/#Builtin-Functions?v=1.0.22" rel="noopener" target="_blank">builtin functions</a>. These are known to the compiler and do not require importing in order to use them.</p><p>The name of every builtin function begins with &quot;@&quot;. If <code>@</code> is followed by an uppercase letter then the function returns a type.</p><p>While the builtin functions are invoked like normal functions, some have behavior that normal functions cannot replicate.</p><p>The official documentation at the link above does not categorize the builtin functions. The YouTube video <a href="https://www.youtube.com/watch?v=V0sthxzzN3U?v=1.0.22" rel="noopener" target="_blank">A Look at Zig's Built-ins</a> from Loris Cro uses the categories below:</p><h3 id="math-builtin-functions" tabindex="-1">Math Builtin Functions</h3><p>The math builtin functions can take advantage of CPU-specific capabilities to achieve better performance than functions in the standard library found in <code>std.math</code>. However, this is partially achieved by providing less error checking.</p><p>Some of these functions can operator on <code>Vector</code> types. TODO: Which ones?</p><ul><li><code>@abs</code> -</li><li><code>@addWithOverflow</code> -</li><li><code>@ceil</code> -</li><li><code>@cos</code> -</li><li><code>@divExact</code> -</li><li><code>@divFloor</code> -</li><li><code>@divTrunc</code> -</li><li><code>@exp</code> -</li><li><code>@exp2</code> -</li><li><code>@flor</code> -</li><li><code>@log</code> -</li><li><code>@log10</code> -</li><li><code>@log2</code> -</li><li><code>@max</code> -</li><li><code>@min</code> -</li><li><code>@mod</code> -</li><li><code>@mulAdd</code> -</li><li><code>@mulWithOverflow</code> -</li><li><code>@rem</code> -</li><li><code>@round</code> -</li><li><code>@sin</code> -</li><li><code>@sqrt</code> -</li><li><code>@subWithOverflow</code> -</li><li><code>@tan</code> -</li><li><code>@trunc</code> -</li></ul><h3 id="bitwise-builtin-functions" tabindex="-1">Bitwise Builtin Functions</h3><ul><li><code>@bitReverse</code> -</li><li><code>@byteSwap</code> -</li><li><code>@clz</code> -</li><li><code>@ctz</code> -</li><li><code>@popCount</code> -</li><li><code>@shlExact</code> -</li><li><code>@shlWithOverflow</code> -</li><li><code>@shrExact</code> -</li></ul><h3 id="atomic-and-memory-builtin-functions" tabindex="-1">Atomic and Memory Builtin Functions</h3><ul><li><code>@atomicLoad</code> -</li><li><code>@atomicRmw</code> -</li><li><code>@atomicStore</code> -</li><li><code>@cmpxchgStrong</code> -</li><li><code>@cmpxchgWeak</code> -</li><li><code>@fence</code> -</li><li><code>@memcpy</code> -</li><li><code>@memset</code> -</li><li><code>@shuffle</code> -</li><li><code>@splat</code> -</li><li><code>@wasmMemoryGrow</code> -</li><li><code>@wasmMemorySize</code> -</li></ul><h3 id="cast-and-conversion-builtin-functions" tabindex="-1">Cast and Conversion Builtin Functions</h3><p>In general, using <code>@as</code> is preferred over other casting functions. Casts can be combined with introspection functions to achieve better error handling.</p><ul><li><code>@alignCast</code> -</li><li><code>@addrSpaceCast</code> -</li><li><code>@as</code> -</li><li><code>@bitCast</code> -</li><li><code>@boolToInt</code> -</li><li><code>@constCast</code> -</li><li><code>@enumFroInt</code> -</li><li><code>@errSetCast</code> -</li><li><code>@errorCas</code> -</li><li><code>@errorFromInt</code> -</li><li><code>@floatCast</code> -</li><li><code>@floatFromInt</code> -</li><li><code>@intCast</code> -</li><li><code>@intFromBool</code> -</li><li><code>@intFromEnum</code> -</li><li><code>@intFromError</code> -</li><li><code>@intFromFloat</code> -</li><li><code>@intFromPtr</code> -</li><li><code>@ptrCast</code> -</li><li><code>@ptrFromInt</code> -</li><li><code>@truncate</code> -</li><li><code>@volatileCast</code> -</li></ul><h3 id="programming-builtin-functions" tabindex="-1">Programming Builtin Functions</h3><ul><li><code>@cDefine</code> -</li><li><code>@cImport</code> -</li><li><code>@cInclude</code> -</li><li><code>@cUndef</code> -</li><li><code>@cVaArg</code></li><li><code>@cVaCopy</code></li><li><code>@cVaEnd</code></li><li><code>@cVaStart</code></li><li><code>@compileError</code> -</li><li><code>@compileLog</code> -</li><li><code>@embedFile</code> -</li><li><code>@export</code> -</li><li><code>@import</code> -</li><li><code>@setAlignStack</code> -</li><li><code>@setCold</code> -</li><li><code>@setEvalBranchQuota</code> -</li><li><code>@setFloatMode</code> -</li><li><code>@setRuntimeSafety</code> -</li></ul><h3 id="runtime-and-async-builtin-functions" tabindex="-1">Runtime and Async Builtin Functions</h3><ul><li><code>@Frame</code> -</li><li><code>@asyncCall</code> -</li><li><code>@breakpoint</code> -</li><li><code>@frameSize</code> -</li><li><code>@frame</code> -</li><li><code>@panic</code> -</li></ul><h3 id="introspection-builtin-functions" tabindex="-1">Introspection Builtin Functions</h3><ul><li><code>@alignOf</code> -</li><li><code>@bitOffsetOf</code> -</li><li><code>@bitSizeOf</code> -</li><li><code>@byteOffsetOf</code> -</li><li><code>@errorName</code> -</li><li><code>@errorReturnTrace</code> -</li><li><code>@fieldParentPtr</code> -</li><li><code>@frameAddress</code> -</li><li><code>@returnAddress</code> -</li><li><code>@sizeOf</code> -</li><li><code>@src</code> -</li><li><code>@tagName</code> -</li></ul><h3 id="metaprogramming-builtin-functions" tabindex="-1">Metaprogramming Builtin Functions</h3><ul><li><code>@TagType</code> -</li><li><code>@This</code> -</li><li><code>@TypeOf</code> -</li><li><code>@Type</code> -</li><li><code>@call</code> -</li><li><code>@field</code> -</li><li><code>@hasDecl</code> -</li><li><code>@hasField</code> -</li><li><code>@typeInfo</code> -</li><li><code>@typeName</code> -</li><li><code>@unionInit</code> -</li></ul><h3 id="other-builtin-functions" tabindex="-1">Other Builtin Functions</h3><ul><li></li></ul><h3 id="hashmap-2" tabindex="-1">HashMap</h3><p>A hash map is a collection of key/value pairs.</p><p><a href="https://ziglang.org/documentation/master/std/#A;std:HashMap" target="_blank">std.HashMap</a> is a low-level implementation that requires supplying a hashing function.<br></p><p><a href="https://ziglang.org/documentation/master/std/#A;std:AutoHashMap" target="_blank">std.AutoHashMap</a> provides a good hashing function for most key types. The first argument is the key type and the second is the value type. When the key type is <code>[]const u8</code>, the following error is triggered: &quot;std.auto_hash.autoHash does not allow slices here ([]const u8) because the intent is unclear. Consider using std.StringHashMap for hashing the contents of []const u8.&quot;</p><p>The following code creates an <code>AutoHashMap</code> where the keys are strings and the values are unsigned integers.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoHashMap</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://ziglang.org/documentation/master/std/#A;std:AutoArrayHashMap" target="_blank">std.AutoArrayHashMap</a> is similar to <code>std.AutoHashMap</code>. It differs in the following was described in the docs:</p><ul><li>&quot;Insertion order is preserved.&quot;</li><li>&quot;Deletions perform a swap removal on the entries list.&quot;</li><li>&quot;Modifying the hash map while iterating is allowed, however, one must understand the well-defined behavior when mixing insertions and deletions with iteration.</li><li>The <code>values</code> method &quot;returns the backing array of values&quot;.</li></ul><p><a href="https://ziglang.org/documentation/master/std/#A;std:StringHashMap" target="_blank">std.StringHashMap</a> provides a good hashing function for string keys. The argument is the value type.</p><p>A <code>HashMap</code> can be used as a set where the values are <code>{}</code>.</p><p>The following code demonstrates common operations on <code>HashMap</code>s.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqualStrings <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqualStrings<span class="token punctuation">;</span><br><span class="token keyword">const</span> String <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"AutoArrayHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoArrayHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">var</span> name <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token keyword">orelse</span> <span class="token string">""</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">orderedRemove</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"AutoHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">AutoHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Iterate over the map keys.</span><br>    <span class="token keyword">var</span> iter2 <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keyIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> number <span class="token operator">=</span> key<span class="token operator">.*</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>name<span class="token operator">|</span> <span class="token punctuation">{</span><br>            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">var</span> name <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span> <span class="token keyword">orelse</span> <span class="token string">""</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqualStrings</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// try expectEqual(map.get(99), null);</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"ComptimeStringMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create an array of tuples.</span><br>    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Create a compile-time map of string keys to u8 values.</span><br>    <span class="token comment">// Since an immutable map with a fixed size is being created,</span><br>    <span class="token comment">// there is no need to deinit it.</span><br>    <span class="token keyword">const</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ComptimeStringMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span>kvs<span class="token punctuation">)</span> <span class="token operator">|</span>kv<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> kv<span class="token punctuation">.</span>key<span class="token punctuation">,</span> kv<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"StringHashMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// The keys are strings and the values are unsigned integers.</span><br>    <span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">StringHashMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the map entries.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>entry<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> entry<span class="token punctuation">.</span>key_ptr<span class="token operator">.*</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>value_ptr<span class="token operator">.*</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Iterate over the map keys.</span><br>    <span class="token keyword">var</span> iter2 <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keyIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {any}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> key<span class="token operator">.*</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token operator">.*</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The `get` method returns an optional value.</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> removed <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>removed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p><a href="https://ziglang.org/documentation/master/std/#A;std:ComptimeStringMap" target="_blank">std.ComptimeStringMap</a> provides an alternative to <code>StringHashMap</code> for immutable hash maps with string keys whose entries are fixed at compile-time. It has a much simpler API that the hash maps described above and does not require memory cleanup by calling a <code>deinit</code> method.</p><p>The <code>ComptimeStringMap</code> function takes two arguments. The first is the value type and the second is an array of key/value tuples.</p><p>The following code demonstrates common operations on a <code>ComptimeStringMap</code>.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"ComptimeStringMap"</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create an array of tuples.</span><br>    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Gretzky"</span><span class="token punctuation">,</span> <span class="token number">99</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Orr"</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>        <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token string">"Ratelle"</span><span class="token punctuation">,</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>len<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Create a compile-time map of string keys to u8 values.</span><br>    <span class="token keyword">const</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ComptimeStringMap</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span>kvs<span class="token punctuation">)</span> <span class="token operator">|</span>kv<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s} number is {d}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> kv<span class="token punctuation">.</span>key<span class="token punctuation">,</span> kv<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token builtin">@as</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token operator">.?</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h3 id="sets-2" tabindex="-1">Sets</h3><p>A <a href="https://ziglang.org/documentation/master/std/#A;std:BufSet?v=1.0.22" rel="noopener" target="_blank">BufSet</a> is a set of string values.</p><p>An <a href="https://ziglang.org/documentation/master/std/#A;std:EnumSet?v=1.0.22" rel="noopener" target="_blank">EnumSet</a> is a set of enum values.</p><p>The following code demonstrates common operations on both of these kinds of sets.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> expect <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expect<span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">test</span> <span class="token string">"BufSet"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">;</span><br>    <span class="token keyword">var</span> set <span class="token operator">=</span> std<span class="token punctuation">.</span>BufSet<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> set<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Orr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">"Ratelle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the set keys.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> set<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>key<span class="token operator">.*</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"Gretzky"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"EnumSet"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token class-name">Color</span> <span class="token operator">=</span> <span class="token keyword">enum</span> <span class="token punctuation">{</span> red<span class="token punctuation">,</span> orange<span class="token punctuation">,</span> yellow<span class="token punctuation">,</span> green<span class="token punctuation">,</span> blue<span class="token punctuation">,</span> purple<span class="token punctuation">,</span> white<span class="token punctuation">,</span> black <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// This does not use an allocator and does not have a `deinit` method.</span><br>    <span class="token keyword">var</span> set <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">EnumSet</span><span class="token punctuation">(</span>Color<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">initEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// To begin with all enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initFull();</span><br><br>    <span class="token comment">// To begin with a subset of the enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initMany(&amp;[_]Color{ .orange, .yellow });</span><br><br>    <span class="token comment">// To begin with one of the enum values in the set ...</span><br>    <span class="token comment">// var set = std.EnumSet(Color).initOne(.orange);</span><br><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>orange<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    set<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">.</span>black<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Iterate over the set keys.</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> set<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>key<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expect</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// There are many more methods on `EnumSet` instances.</span><br><span class="token punctuation">}</span></code></pre><h3 id="multiarraylist-2" tabindex="-1">MultiArrayList</h3><p>The <a href="https://ziglang.org/documentation/master/std/#A;std:MultiArrayList?v=1.0.22" rel="noopener" target="_blank">MultiArrayList</a> data structure &quot;stores a list of a struct or tagged union type&quot;. &quot;Instead of storing a single list of items, MultiArrayList stores separate lists for each field of the struct or lists of tags and bare unions.&quot;</p><p>TODO: Add an example.</p><h2 id="builtin-functions-2" tabindex="-1">Builtin Functions</h2><p>Zig provides over 100 <a href="https://ziglang.org/documentation/master/#Builtin-Functions?v=1.0.22" rel="noopener" target="_blank">builtin functions</a>. These are known to the compiler and do not require importing in order to use them.</p><p>The name of every builtin function begins with &quot;@&quot;. If <code>@</code> is followed by an uppercase letter then the function returns a type.</p><p>While the builtin functions are invoked like normal functions, some have behavior that normal functions cannot replicate.</p><p>The official documentation at the link above does not categorize the builtin functions. The YouTube video <a href="https://www.youtube.com/watch?v=V0sthxzzN3U?v=1.0.22" rel="noopener" target="_blank">A Look at Zig's Built-ins</a> from Loris Cro uses the categories below:</p><h3 id="math-builtin-functions-1" tabindex="-1">Math Builtin Functions</h3><p>The math builtin functions can take advantage of CPU-specific capabilities to achieve better performance than functions in the standard library found in <code>std.math</code>. However, this is partially achieved by providing less error checking.</p><p>Some of these functions can operator on <code>Vector</code> types. TODO: Which ones?</p><ul><li><code>@abs</code> -</li><li><code>@addWithOverflow</code> -</li><li><code>@ceil</code> -</li><li><code>@cos</code> -</li><li><code>@divExact</code> -</li><li><code>@divFloor</code> -</li><li><code>@divTrunc</code> -</li><li><code>@exp</code> -</li><li><code>@exp2</code> -</li><li><code>@flor</code> -</li><li><code>@log</code> -</li><li><code>@log10</code> -</li><li><code>@log2</code> -</li><li><code>@max</code> -</li><li><code>@min</code> -</li><li><code>@mod</code> -</li><li><code>@mulAdd</code> -</li><li><code>@mulWithOverflow</code> -</li><li><code>@rem</code> -</li><li><code>@round</code> -</li><li><code>@sin</code> -</li><li><code>@sqrt</code> -</li><li><code>@subWithOverflow</code> -</li><li><code>@tan</code> -</li><li><code>@trunc</code> -</li></ul><h3 id="bitwise-builtin-functions-1" tabindex="-1">Bitwise Builtin Functions</h3><ul><li><code>@bitReverse</code> -</li><li><code>@byteSwap</code> -</li><li><code>@clz</code> -</li><li><code>@ctz</code> -</li><li><code>@popCount</code> -</li><li><code>@shlExact</code> -</li><li><code>@shlWithOverflow</code> -</li><li><code>@shrExact</code> -</li></ul><h3 id="atomic-and-memory-builtin-functions-1" tabindex="-1">Atomic and Memory Builtin Functions</h3><ul><li><code>@atomicLoad</code> -</li><li><code>@atomicRmw</code> -</li><li><code>@atomicStore</code> -</li><li><code>@cmpxchgStrong</code> -</li><li><code>@cmpxchgWeak</code> -</li><li><code>@fence</code> -</li><li><code>@memcpy</code> -</li><li><code>@memset</code> -</li><li><code>@shuffle</code> -</li><li><code>@splat</code> -</li><li><code>@wasmMemoryGrow</code> -</li><li><code>@wasmMemorySize</code> -</li></ul><h3 id="cast-and-conversion-builtin-functions-1" tabindex="-1">Cast and Conversion Builtin Functions</h3><p>In general, using <code>@as</code> is preferred over other casting functions. Casts can be combined with introspection functions to achieve better error handling.</p><ul><li><code>@alignCast</code> -</li><li><code>@addrSpaceCast</code> -</li><li><code>@as</code> -</li><li><code>@bitCast</code> -</li><li><code>@boolToInt</code> -</li><li><code>@constCast</code> -</li><li><code>@enumFroInt</code> -</li><li><code>@errSetCast</code> -</li><li><code>@errorCas</code> -</li><li><code>@errorFromInt</code> -</li><li><code>@floatCast</code> -</li><li><code>@floatFromInt</code> -</li><li><code>@intCast</code> -</li><li><code>@intFromBool</code> -</li><li><code>@intFromEnum</code> -</li><li><code>@intFromError</code> -</li><li><code>@intFromFloat</code> -</li><li><code>@intFromPtr</code> -</li><li><code>@ptrCast</code> -</li><li><code>@ptrFromInt</code> -</li><li><code>@truncate</code> -</li><li><code>@volatileCast</code> -</li></ul><h3 id="programming-builtin-functions-1" tabindex="-1">Programming Builtin Functions</h3><ul><li><code>@cDefine</code> -</li><li><code>@cImport</code> -</li><li><code>@cInclude</code> -</li><li><code>@cUndef</code> -</li><li><code>@cVaArg</code></li><li><code>@cVaCopy</code></li><li><code>@cVaEnd</code></li><li><code>@cVaStart</code></li><li><code>@compileError</code> -</li><li><code>@compileLog</code> -</li><li><code>@embedFile</code> -</li><li><code>@export</code> -</li><li><code>@import</code> -</li><li><code>@setAlignStack</code> -</li><li><code>@setCold</code> -</li><li><code>@setEvalBranchQuota</code> -</li><li><code>@setFloatMode</code> -</li><li><code>@setRuntimeSafety</code> -</li></ul><h3 id="runtime-and-async-builtin-functions-1" tabindex="-1">Runtime and Async Builtin Functions</h3><ul><li><code>@Frame</code> -</li><li><code>@asyncCall</code> -</li><li><code>@breakpoint</code> -</li><li><code>@frameSize</code> -</li><li><code>@frame</code> -</li><li><code>@panic</code> -</li></ul><h3 id="introspection-builtin-functions-1" tabindex="-1">Introspection Builtin Functions</h3><ul><li><code>@alignOf</code> -</li><li><code>@bitOffsetOf</code> -</li><li><code>@bitSizeOf</code> -</li><li><code>@byteOffsetOf</code> -</li><li><code>@errorName</code> -</li><li><code>@errorReturnTrace</code> -</li><li><code>@fieldParentPtr</code> -</li><li><code>@frameAddress</code> -</li><li><code>@returnAddress</code> -</li><li><code>@sizeOf</code> -</li><li><code>@src</code> -</li><li><code>@tagName</code> -</li></ul><h3 id="metaprogramming-builtin-functions-1" tabindex="-1">Metaprogramming Builtin Functions</h3><ul><li><code>@TagType</code> -</li><li><code>@This</code> -</li><li><code>@TypeOf</code> -</li><li><code>@Type</code> -</li><li><code>@call</code> -</li><li><code>@field</code> -</li><li><code>@hasDecl</code> -</li><li><code>@hasField</code> -</li><li><code>@typeInfo</code> -</li><li><code>@typeName</code> -</li><li><code>@unionInit</code> -</li></ul><h3 id="other-builtin-functions-1" tabindex="-1">Other Builtin Functions</h3><ul><li></li></ul><h2 id="tests" tabindex="-1">Tests</h2><p>Unit tests can be included in source files in order to test the functions they define.</p><p>Each test is described by the <code>test</code> keyword followed by a test description string (or a function name) and a block of code.</p><p>The block of code uses functions whose names begin with <code>expect</code> to make assertions. Calls to these functions must be preceded by the <code>try</code> keyword. For information about these functions, see the <a href="https://ziglang.org/documentation/master/std/#A;std:testing?v=1.0.22" rel="noopener" target="_blank">std.testing documentation</a>.</p><p>The <code>expect</code> function takes a single argument that must be an expression that evaluates to a <code>bool</code> value.</p><p>The <code>expectEquals</code> function takes two arguments which are expressions representing an expected and actual value. Using <code>expectedEquals</code> provided better failure messages than <code>equal</code>.</p><p>Other testing functions include:</p><ul><li><code>expectApproxEqAbs</code> - tests that two numbers are within a given tolerance</li><li><code>expectApproxEqRel</code> - similar to <code>expectApproxEqAbs</code>, but the tolerance is multiplied by the larger of the absolute values of the two numbers being compared</li><li><code>expectEqualDeep</code> - tests deep equality of arrays, slices, structs, unions, vectors, and more</li><li><code>expectEqualSentinel</code> - compares sequences that are terminated by a sentinel value</li><li><code>expectEqualSlices</code> - compares slices</li><li><code>expectEqualStrings</code> - compares strings</li><li><code>expectError</code> - compares a value to an expected error</li><li><code>expectFmt</code> - tests the string produced by inserting arguments into a format string</li><li><code>expectStringEndsWith</code> - tests whether a ends begins with another</li><li><code>expectStringStartsWith</code> - tests whether a string begins with another</li></ul><p>The functions <code>expectApproxEqAbs</code>, <code>expectApproxEqRel</code>, <code>expectEqual</code>, and <code>expectEqualDeep</code> all have the parameters <code>expected: anytype, actual: @TypeOf(expected)</code>. This causes the second argument to be cast to the type of the first. If the expected value is a literal value, it must be cast with &quot;@as&quot; if it is the first argument, but not if it is the second. So it is typically easier to pass the actual value as the first argument and the expected value as the second argument.</p><p>All tests in a source file are executed by running <code>zig test {file-name}.zig</code>. To run specific tests, add the <code>--test-filter {text}</code> option which causes it to only run tests whose description contains the given text.</p><p>To temporarily skip a test, add the line <code>return error.SkipZigTest</code>. TODO: Will the compiler complain about unreachable code TODO: if this is the first line in the test?</p><p>Here is a basic example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">i32</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token class-name">add</span> <span class="token punctuation">{</span> <span class="token comment">// uses a function name</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// passes</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"add works"</span> <span class="token punctuation">{</span> <span class="token comment">// uses a description string</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// passes</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fails</span><br><span class="token punctuation">}</span></code></pre><p>If an <code>expect</code> call fails, its test stops, but other tests are still run. The output includes the following:</p><ul><li>a message of the form &quot;Test [{m}/{n}] test.{test-description}... FAIL (TestUnexpectedResult)&quot; for each failed test</li><li>a stack trace is output that shows the failing <code>expect</code> (only one of them?)</li><li>a summary of the form &quot;{n1} passed; {n2} skipped; {n3} failed&quot;</li></ul><p>To test for memory leaks, use the <code>std.testing.allocator</code> for all memory allocation. This allocation can only be used in <code>test</code> blocks.</p><p>To run tests in multiple source files, create a new source file that imports all of them and pass that source file to <code>zig test</code>. For example:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">test</span> <span class="token punctuation">{</span><br>  _ <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"file1.zig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  _ <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"file2.zig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  _ <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"file3.zig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>TODO: Also see std.testing.refAllDecls and std.testing.refAllDeclsRecursive. TODO: Is there another way to do this by modifying a project <code>build.zig</code> file?</p><p>To determine whether code is running in a test, import the variable <code>is_test</code> with <code>@import(&quot;builtin&quot;).is_test</code>. This can be used to avoid running certain code in a test or only run certain code in a test. It can also be used only use <code>std.testing.allocator</code> when running in a test.</p><p>Enter <code>zig test --help</code> to see options that affect tests.</p><h2 id="command-line-arguments" tabindex="-1">Command-line Arguments</h2><p>When running a Zig programming using <code>zig run</code>, command-line arguments must be preceded by <code>--</code>. For example, <code>zig run commmand_line_args_demo.zig -- foo bar</code>. The first argument will be the path to the executable and the remaining arguments will be the actual command-line arguments.</p><p>The following code demonstrates getting command-line arguments and copying them into an <code>ArrayList</code> to simply using them.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>heap<span class="token punctuation">.</span>page_allocator<span class="token punctuation">;</span><br><br><span class="token keyword">fn</span> <span class="token function">getCmdLineArgs</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token keyword">anytype</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> iter <span class="token operator">=</span> std<span class="token punctuation">.</span>process<span class="token punctuation">.</span><span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">while</span> <span class="token punctuation">(</span>iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>arg<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token keyword">try</span> list<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> args <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> args<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">getCmdLineArgs</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"arg count is {d}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>args<span class="token punctuation">.</span>items<span class="token punctuation">.</span>len<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"second arg is {s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>args<span class="token punctuation">.</span>items<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>items<span class="token punctuation">)</span> <span class="token operator">|</span>arg<span class="token operator">|</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>arg<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="safety-checks" tabindex="-1">Safety Checks</h2><p>The Zig compiler detects many code issues and run-time safety checks catch even more. These safety checks don't flag every possible mistake, but they come close. More safety checks are planned in the future.</p><p>The following is a list of the current checks from the <a href="https://ziglang.org/documentation/0.11.0/#Undefined-Behavior?v=1.0.22" rel="noopener" target="_blank">Undefined Behavior</a> section of the Zig Language Reference:</p><ul><li>attempt to unwrap error</li><li>attempt to unwrap null</li><li>builtin overflow functions</li><li>cast negative number to unsigned integer</li><li>cast truncates data</li><li>default operations</li><li>division by zero</li><li>exact division remainder</li><li>exact left shift overflow</li><li>exact right shift overflow</li><li>incorrect pointer alignment</li><li>index out of bounds</li><li>integer overflow</li><li>invalid enum cast</li><li>invalid error code</li><li>invalid error set cast</li><li>out of bounds float to integer cast</li><li>pointer cast invalid null</li><li>reaching unreachable code</li><li>remainder division by zero</li><li>standard library math functions</li><li>wrapping operations</li><li>wrong union field access</li></ul><h2 id="stack-example" tabindex="-1">Stack Example</h2><p>This example is based on the Primeagen video at <a href="https://www.youtube.com/watch?v=xIPrwrBAU2c?v=1.0.22" rel="noopener" target="_blank">Zig Data Structure Katas</a>.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> log <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><span class="token keyword">const</span> Allocator <span class="token operator">=</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span>Allocator<span class="token punctuation">;</span> <span class="token comment">// memory allocator interface</span><br><span class="token keyword">const</span> expectEqual <span class="token operator">=</span> std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>expectEqual<span class="token punctuation">;</span><br><br><span class="token comment">// This creates a struct that represents</span><br><span class="token comment">// a stack whose values are a given type.</span><br><span class="token keyword">fn</span> <span class="token function">Stack</span><span class="token punctuation">(</span><span class="token keyword">comptime</span> T<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">type</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">type</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> <span class="token class-name">Node</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span> next<span class="token punctuation">:</span> <span class="token operator">?</span><span class="token operator">*</span>Node <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>        <span class="token comment">// Gets the type of the struct we are inside.</span><br>        <span class="token keyword">const</span> Self <span class="token operator">=</span> <span class="token builtin">@This</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        length<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">usize</span></span><span class="token punctuation">,</span><br>        head<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">?</span><span class="token operator">*</span>Node</span><span class="token punctuation">,</span> <span class="token comment">// optional pointer</span><br>        allocator<span class="token punctuation">:</span> <span class="token class-name">Allocator</span><span class="token punctuation">,</span> <span class="token comment">// passed to init below</span><br><br>        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">:</span> <span class="token class-name">Allocator</span><span class="token punctuation">)</span> <span class="token class-name">Self</span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> <span class="token punctuation">.</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>head <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>allocator <span class="token operator">=</span> allocator <span class="token punctuation">}</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">deinit</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>Self</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>            <span class="token keyword">while</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> _ <span class="token operator">=</span> self<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            self<span class="token operator">.*</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">push</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>Self</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>            <span class="token keyword">var</span> node <span class="token operator">=</span> <span class="token keyword">try</span> self<span class="token punctuation">.</span>allocator<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>Node<span class="token punctuation">)</span><span class="token punctuation">;</span><br>            node<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span><br>            node<span class="token punctuation">.</span>next <span class="token operator">=</span> self<span class="token punctuation">.</span>head<span class="token punctuation">;</span><br>            self<span class="token punctuation">.</span>length <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>            self<span class="token punctuation">.</span>head <span class="token operator">=</span> node<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">pop</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>Self</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">?</span>T</span> <span class="token punctuation">{</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>head<span class="token punctuation">)</span> <span class="token operator">|</span>unwrapped<span class="token operator">|</span> <span class="token punctuation">{</span><br>                <span class="token keyword">defer</span> self<span class="token punctuation">.</span>allocator<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span>unwrapped<span class="token punctuation">)</span><span class="token punctuation">;</span><br>                self<span class="token punctuation">.</span>length <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>                self<span class="token punctuation">.</span>head <span class="token operator">=</span> unwrapped<span class="token punctuation">.</span>next<span class="token punctuation">;</span><br>                <span class="token keyword">return</span> unwrapped<span class="token punctuation">.</span>value<span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">print</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>Self</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"\nStack length is {}.\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>self<span class="token punctuation">.</span>length<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">var</span> node <span class="token operator">=</span> self<span class="token punctuation">.</span>head<span class="token punctuation">;</span><br>            <span class="token keyword">while</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">|</span>unwrapped<span class="token operator">|</span> <span class="token punctuation">{</span><br>                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"=> {}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>unwrapped<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                node <span class="token operator">=</span> unwrapped<span class="token punctuation">.</span>next<span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">test</span> <span class="token string">"stack"</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> IntStack <span class="token operator">=</span> <span class="token function">Stack</span><span class="token punctuation">(</span><span class="token builtin-type keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> stack <span class="token operator">=</span> IntStack<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>std<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> stack<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    stack<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output is suppressed in tests</span><br><br>    <span class="token keyword">var</span> value <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    value <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    value <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">expectEqual</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="writing-and-reading-files" tabindex="-1">Writing and Reading Files</h2><p>The standard libraries <code>std.fs</code> and <code>std.os</code> define many I/O functions. Here is an example of writing and reading a text file.</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> std <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"std"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> print <span class="token operator">=</span> std<span class="token punctuation">.</span>debug<span class="token punctuation">.</span>print<span class="token punctuation">;</span><br><br><span class="token comment">// Creates and writes a file in the current working directory.</span><br><span class="token keyword">fn</span> <span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dir <span class="token operator">=</span> std<span class="token punctuation">.</span>fs<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">try</span> dir<span class="token punctuation">.</span><span class="token function">createFile</span><span class="token punctuation">(</span><span class="token string">"data.txt"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> file<span class="token punctuation">.</span><span class="token function">writeAll</span><span class="token punctuation">(</span><span class="token string">"Hello, World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// Reads a file in the current working directory.</span><br><span class="token keyword">fn</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dir <span class="token operator">=</span> std<span class="token punctuation">.</span>fs<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">try</span> dir<span class="token punctuation">.</span><span class="token function">openFile</span><span class="token punctuation">(</span><span class="token string">"data.txt"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">defer</span> file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">var</span> buffer<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token builtin-type keyword">u8</span></span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> length <span class="token operator">=</span> <span class="token keyword">try</span> file<span class="token punctuation">.</span><span class="token function">readAll</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"read {} bytes\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>length<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 13</span><br>    <span class="token keyword">const</span> content <span class="token operator">=</span> buffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">..</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"{s}\n"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span>content<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello, World!</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token operator">!</span><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span><br>    <span class="token keyword">try</span> <span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="http" tabindex="-1">HTTP</h2><p>TODO: See <a href="https://github.com/zigzap/zap">https://github.com/zigzap/zap</a> which may be the only Zig HTTP server now.</p><h2 id="compiling-c-and-c%2B%2B" tabindex="-1">Compiling C and C++</h2><p>Zig provides tooling to compile both C and C++ code.</p><p>Here is a C hello world program in the file <code>hello.c</code>.</p><pre class="language-c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><br><br><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hello, World!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>To build this, enter <code>zig cc hello.c -o hello</code>. To run the resulting executable, enter <code>./hello</code>.</p><p>Here is a C++ hello world program in the file <code>hello.cpp</code>.</p><pre class="language-cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><br><br><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Hello World!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>To build this, enter <code>zig c++ hello.cpp -o hello</code>. To run the resulting executable, enter <code>./hello</code>.</p><h2 id="continue-cleanup-of-everything-below-here!" tabindex="-1">CONTINUE CLEANUP OF EVERYTHING BELOW HERE!</h2><p>Learn about async/await.</p><ul><li>Functions can specify the type of errors they can return by preceding the ! in the return type with an error type or probably an error set.</li><li>Precede function return types with ? if null can be returned.</li><li>Investigate Zig string libraries.</li><li>does it always catch when memory is not freed?</li><li>supports low-level memory control using allocators<ul><li>page_allocator, c_allocator, ArenaAllocator, FixedBufferAllocator, GeneralPurposeAllocator, std.testing.allocator</li></ul></li><li>not memory-safe like Rust</li><li>no operator overloading</li><li>no exceptions; functions that can fail must return an error value (typically an enum?)</li><li>comptime blocks run at compile time; takes the place of preprocessor directives and macros</li><li>comptime variables are initialized at compile time</li><li>has a builtin testing framework that uses the <code>test</code> keyword followed by a description string and a block of code that implements the test; enter <code>zig test {file-path}</code> to run the tests in a given file</li><li><code>zig cc</code> is an alternate C/C++ compiler<ul><li>can build a platform-specific executable for the current platform</li><li>can build an executable for a specified platform</li><li>can find bugs that standard C/C++ compilers do not</li></ul></li></ul><p>From <a href="http://ziglearn.org">ziglearn.org</a>:</p><p>Blocks in Zig are expressions and can be given labels, which are used to yield values. Here, we are using a label called blk. Blocks yield values, meaning that they can be used in place of a value. The value of an empty block + is a value of the type void</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">test</span> <span class="token string">"labelled blocks"</span><br>    <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token label">bik</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> sum<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u32</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> i<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">u32</span></span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> sum <span class="token operator">+=</span> i<span class="token punctuation">;</span><br>        <span class="token keyword">break</span> blk sum<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span> <span class="token punctuation">(</span><span class="token builtin">@Type0f</span> <span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin-type keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>This can be seen as being equivalent to C's i++.</p><pre class="language-zig"><code class="language-zig"><span class="token label">blk</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> tmp <span class="token operator">=</span> i<span class="token punctuation">;</span><br>    i <span class="token operator">+=</span> <span class="token number">1</span><br>    <span class="token keyword">break</span> <span class="token punctuation">:</span><span class="token label">blk</span> tmp<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Are these the same return types? !i32 anyerror!i32</p><p>Learn about anonymous structs which are called &quot;tuples&quot;. Can they be used like JavaScript objects.</p><p>Printing type names:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> m1 <span class="token operator">=</span> <span class="token keyword">try</span> allocator<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> m2 <span class="token operator">=</span> <span class="token keyword">try</span> allocator<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> m3 <span class="token operator">=</span> <span class="token keyword">try</span> allocator<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>std<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"{s}"</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token builtin">@typeName</span> <span class="token punctuation">(</span><span class="token builtin">@Type0f</span><span class="token punctuation">(</span>m3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>See zig-arena-allocator.jpg in Downloads.</p><p>Lambdas are not supported, but there aren't often needed in Zig. You can do something like this instead with a struct:</p><pre class="language-zig"><code class="language-zig"><span class="token keyword">var</span> map <span class="token operator">=</span> std<span class="token punctuation">.</span><span class="token function">StringArrayHashMap</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>allocator<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">defer</span> map<span class="token punctuation">.</span><span class="token function">deinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">try</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token class-name">SortContext</span> <span class="token operator">=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>    keys<span class="token punctuation">:</span> <span class="token class-name"><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">const</span> <span class="token builtin-type keyword">u8</span></span><span class="token punctuation">,</span><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">lessThan</span><span class="token punctuation">(</span>ctx<span class="token punctuation">:</span> <span class="token builtin">@This</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a_index<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">usize</span></span><span class="token punctuation">,</span> b_index<span class="token punctuation">:</span> <span class="token class-name"><span class="token builtin-type keyword">usize</span></span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">bool</span></span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> std<span class="token punctuation">.</span>mem<span class="token punctuation">.</span><span class="token function">lessThan</span><span class="token punctuation">(</span><span class="token builtin-type keyword">u8</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>a_index<span class="token punctuation">]</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span>keys<span class="token punctuation">[</span>b_index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>map<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token class-name">SortContext</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>keys <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">keys</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>See zig-error-with-associated-data.jpg in Downloads.</p><p>See zig-struct-with-method.png in Downloads. See zig-struct-with-method-calling-2-ways.png in Downloads. See zig-generics.jpg in Downloads. See zip-enum-and-associated-data.jpg in Downloads.</p><p>Demonstrate calling your own C and C++. ode from Zig. No support for interfaces. Errors cannot hold associated data. Use out parameters. Can transpile Zig to C. having a trailing comma after the last field in a struct changes how zig formats the code. It will keep each field on a separate line. If you remove the trailing comma from the last field, and all the fields will fit on a single line, then the formatter will do that.</p><p>To create a new library, enter <code>zip init-lib</code>.</p><p>Data types include u8 (single byte unsigned integer), â€¦ Strings are delimited with double quotes.</p><p>Constant and variable declarations must be initialized to some value. When can the type be inferred from the initial value? If the initial value is â€œundefinedâ€ (means uninitialized), does the compiler enforce that it is assigned before it is used? I assume this is different from making it nullable with a â€œ?â€ before the type.</p><p>To declare an array,</p><ul><li>can be const or var</li><li>number of elements comes first, then the type, then the initial values in curly braces</li><li>ex. const name = [3]i32{10, 20, 30};</li><li>ex. var name = [_]i32{10, 20, 30}; // length is inferred from initial values</li></ul><p>Zig standard library</p><ul><li>document this</li></ul><p>Primitive Values</p><ul><li>null, undefined</li><li>true, false</li></ul><p>Strings</p><ul><li>â€œString literals are constant single-item points to null-terminated byte arrays.â€</li><li>var name = â€œMarkâ€;</li><li>dereferencing converts to array of characters</li><li>default encoding is UTF-8</li><li>multi-line string literals precede each line with <code>\\</code></li><li>to iterate over the bytes in a string (characters if ASCII), for (name) |byte| { â€¦ }</li><li><ul><li>operator can be used to create a string by concatenating characters; var name = â€˜Mâ€™ + â€˜aâ€™ + â€˜râ€™ + â€˜kâ€™</li></ul></li></ul><p>Arrays</p><ul><li>to create an array from a literal, const numbers = [_]u32{ 19, 21, 7 }; // _ indicates not specifying size</li><li>to initialize all elements to same value, const numbers = [_]u32{0} ** 3; // array of 3 zero elements</li><li>use var instead of const to make them mutable</li><li>have a <code>len</code> field</li><li>to get an array element, numbers[1]</li><li>to mutate an array element, numbers[1] = 3;</li><li>++ operator concatenates arrays, returning a new array<ul><li>applies to strings; var name = â€œMaâ€ ++ â€œrkâ€;</li></ul></li><li>** operator multiplies arrays, returning a new array</li><li>multidimensional arrays are created by nesting arrays<ul><li>var matrix = [3][3]f64 {</li><li>[_]f64{ 1.0, 2.0, 3.0 },</li><li>[_]f64{ 4.0, 5.0, 6.0 },</li><li>[_]f64{ 7.0, 8.0, 9.0 }</li><li>};</li><li>access elements with matrix[row][column]</li><li>iterate over with nested for loops</li><li>for (matrix, 0..) |row, rowIndex| {</li><li>for (row, 0..) |value, columnIndex| {</li><li><pre><code>// use value, rowIndex, and columnIndex here
</code></pre></li><li>}</li><li>}</li></ul></li></ul><p>Slices</p><ul><li>â€œA slice is a pointer and a length. The difference between an array and a slice is that the array's length is part of the type and known at compile-time, whereas the slice's length is known at runtime.â€</li><li>like arrays, slices have a <code>len</code> field</li><li>to get a slice from an array, var mySlice = myArray[startIndex..endIndex]; // inclusive?</li><li>access and modify slice elements just like with array elements</li><li>do both perform bounds checking and generate a well-known error when outside?</li></ul><p>Vectors</p><ul><li>sets of primitive values or pointers</li><li>can operate on them in parallel using SIMD instructions if available using standard operators that return a new vector<ul><li>const v1 = @Vector(_, f32){ 1.2, 2.3, 3.4 }; // need to specify length instead of using _?</li><li>const v2 = @Vector(_, f32){ 9.8, 8.7, 7.6 };</li><li>const v3 = v1 + v2;</li></ul></li><li>vectors are compatible with fixed-length arrays with the same length or slices of arrays with the same length; can be assigned to each other</li></ul><p>Enumerations</p><ul><li>to define, const Color = enum { red, green, blue, };</li><li>to use, var color = Color.red;</li><li>to make tag values available, specify the tag type<ul><li>for example: const Color = enum(u8) { red, green, blue, }; // assigns 0, 1, and 2</li></ul></li><li>to define with specific values, const Color = enum(u8) { red = 10, green = 20, blue = 30, };</li></ul><p>Standard Library Data Structures</p><ul><li>ArrayList - â€œa contiguous, growable list of items in memoryâ€</li><li>AutoArrayHashMap</li><li>AutoArrayHashMapUnmanaged</li><li>StringArrayHashMap</li><li>StringArrayHashMapUnmanaged</li><li>ArrayHashMap</li><li>BufMap</li><li>BufSet - a set of strings</li><li>AutoHashMap</li><li>AutoHashMapUnmanaged</li><li>StringHashMap</li><li>StringHashMapUnmanaged</li><li></li><li>more?</li><li>Set?</li></ul><p>Variables</p><ul><li>can declare at file scope or in function scopes</li><li>variables must be initialized, but an initialize to <code>undefined</code>; ex. <code>var score: u32 = 0; const maxScore = 10;</code></li><li>declare immutable variables with const or mutable variables with var; prefer const when possible</li><li>does it support type inference?</li><li>variable names cannot shadow those in outer scopes</li><li>names must start with a letter and contain letters, numbers, and underscores</li><li>non-conforming names can be used with <code>@â€œsome nameâ€</code></li><li>variables declared outside any function are referred to as â€œcontainer-level variablesâ€<ul><li>includes variables declared inside struct, union, enum, and opaque (similar to a struct; used for interacting with C code that doesnâ€™t expose field details) definitions (only top-level ones?)</li></ul></li></ul><p>Optionals</p><ul><li>to allow a value to have a specific type or <code>null</code>, precede the type with <code>?</code></li><li>for example, const maybeNumber: ?i32 = null;</li><li>Zig prevents null references by using optional pointers whose usages are checked by the compiler</li><li>the <code>orelse</code> operator unwraps optional values and provides a value to use if it is null<ul><li>const ptr = optionalPtr orelse 0; // assumes optionalPtr is a pointer to an integer</li></ul></li></ul><p>Structs</p><ul><li>struct types are defined with <code>const SomeName = struct { f1: type1, f2: type2 ,};</code></li><li>struct instances are created with <code>var someInstance = SomeName { .f1 = v1, .f2 = v2, };</code></li><li>anonymous struct syntax alternative: <code>var someInstance: SomeName = .{ .f1 = v1, .f2 = v2 };</code></li><li>can any field value be <code>undefined</code>?</li><li>to define a method in a struct, add a <code>pub</code> function inside its definition</li><li>to define a constant in a struct, add <code>pub const NAME = value;</code></li><li>structs can be used to implement generic functions<ul><li>â€œA generic data structure is simply a function that returns a type.â€</li><li>this example from official docs returns an instance of a dynamically defined struct type for a linked list whose nodes hold values of a given type</li><li>Node is a nested type that is available through the returned type</li><li>fn LinkedList(comptime T: type) type {</li><li>return struct {</li><li><pre><code>// This just declares a type used for the struct fields below.
</code></pre></li><li><pre><code>pub const Node = struct {
</code></pre></li><li><pre><code>  prev: ?*Node, // optional value
</code></pre></li><li><pre><code>  next: ?*Node, // optional value
</code></pre></li><li><pre><code>  value: T
</code></pre></li><li><pre><code>};
</code></pre></li><li><pre><code>first: ?*Node,
</code></pre></li><li><pre><code>last: ?*Node,
</code></pre></li><li><pre><code>length: usize,
</code></pre></li><li>}</li><li>var numberList = LinkedList(i32) { .first = null, .last = null, .length = 0 };</li><li>const NumberList = LinkedList(i32);</li><li>var node = NumberList.Node { .prev = null, .next = null, .value = 19 };</li><li>var numberList = LinkedList(i32) { .first = @node, .last = &amp;node, .length = 1 };</li></ul></li></ul><p>Tuples</p><ul><li>defined by an anonymous struct with no field names</li><li>fields are given names that are integers starting from 0</li><li>access a field value with [index] syntax</li><li>const myTuple = { true, â€œhelloâ€, @as(u32, 19) };</li><li>myTuple[1] is â€œhelloâ€</li><li></li></ul><p>Unions</p><ul><li>defines a set of possible types for a value</li><li>const DataType = union { number: i32, truth: bool };</li><li>var data1 = DataType { .number = 19 };</li><li>var data2 = DataType { .truth = true };</li><li>anonymous union syntax alternative: <code>var data2: DataType = .{ .number = 19 };</code></li><li>tagged union types use an enum for their cases and can be used in switch expressions</li><li>const DataTypeTag = enum { number, truth };</li><li>const DataType = union(DataTagType) { number: i32, truth: bool };</li><li>can get the tag type of a union type with std.meta.Tag(DataType) which returns DataTypeTag</li></ul><p>Functions</p><ul><li>parameters are immutable; function bodies cannot modify them</li><li>primitive types are passed by value (copy)</li><li>Zig will decide whether to pass non-primitive types (structs, unions, and arrays) by value or reference based on which it determines is faster</li><li>to force pass by reference, pass a pointer<ul><li>to pass an argument by reference (a pointer), precede with &amp;</li><li>to accept a parameter as a pointer, precede type with *</li></ul></li><li>if there is no return value, the return type is void</li><li>if an error can be returned, precede the return type with !</li><li>to declare, fn someName(p1: type1, p2: type2) returnType { â€¦ }</li><li>to make available outside current source file and callable from C, precede with <code>export</code>; is this only for creating libraries?</li><li>to allow other source files to import the function, precede it with <code>pub</code></li><li>to define a type that is a pointer to a function and can be used as a argument type, const myFnType = *const fn (p1: type1, p2: type2) return type;</li><li>variable parameter types and reflection<ul><li>to allow any type of value to be passed as an argument, use <code>anytype</code> for the parameter type</li><li>inside the function, use the builtin function <code>@TypeOf(variableName)</code> to refer to the actual type</li><li>inside the function, use the builtin function <code>@typeInfo(variableName)</code> to get information about the actual type<ul><li>@typeInfo(@TypeOf) returns a std.builtin.Type object</li><li>what are the properties and methods on a Type object?</li></ul></li></ul></li><li>can use reflection to get details about the parameters and return type of a given function with <code>@typeInfo(@TypeOf(someFunction)).Fn</code> which gives an object with the fields <code>params</code> (an array of objects with <code>type</code> and <code>name</code>? fields?) and <code>return_type</code> (a type)</li></ul><p>Errors</p><ul><li>The <code>try</code> keyword provides error handling.</li><li>Possible errors cannot be ignored.</li><li>The catch keyword is used to provide a default value for an expression that results in an error. - const number = parseU64(str, 10) catch 0; - can compute value with a labeled block - catch blk: { // do things - break :blk 13; - }; -</li><li>If no <code>catch</code> block is included, the error is returned to the caller</li><li>error sets are similar to enums and describe the errors that can be thrown by functions</li><li>example from official docs<ul><li>const FileOpenError = error { AccessDenied, OutOfMemory, FileNotFound };</li><li>const String = [_]u8; // TODO: Is this the proper way to describe a string type?</li><li>fn processFile(filePath: *String) FileOpenError { â€¦ }</li></ul></li></ul><p>Type Coercion and Casting</p><ul><li>Add detail on this!</li></ul><p>Memory Management</p><ul><li>Zig does not provide any memory management and has no runtime.</li><li>In C, memory is managed with the functions malloc, free, and realloc. These use a provided memory allocator.</li><li>Zig allows selection of a memory allocation strategy and does not choose a default strategy.</li><li>It is also possible to implement a custom allocator.</li><li>All functions and data structures that allocate memory take an Allocator argument that specifies the strategy to use.</li><li>The C strategy is available as std.heap.c_allocator.</li><li>Other provided allocations include:<ul><li>std.heap.FixedBufferAllocator</li><li>std.heap.ThreadSafeFixedBufferAllocator</li><li>std.heap.ArenaAllocator</li><li>std.testing.Allocator</li><li>std.testing.FailingAllocator</li><li>DESCRIBE EACH OF THESE</li><li>ARE THERE MORE PREDEFINED ALLOCATORS?</li></ul></li></ul><p>A function return type can be a switch expression that determines the actual type returned.</p></article>