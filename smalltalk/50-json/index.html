<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>JSON</h2><aside></aside><article><p>The <code>JSON</code> package defines the classes <code>Json</code>, <code>JsonObject</code>, and <code>JsonError</code>. It also adds the method <code>jsonWriteOn:</code> to many classes including <code>Array2D</code>, <code>Association</code>, <code>CharacterSequence</code>, <code>Collection</code>, <code>Dictionary</code>, <code>False</code>, <code>Integer</code>, <code>Number</code>, <code>Text</code>, <code>True</code>, and <code>UndefinedObject</code>.</p><p>To install the <code>JSON</code> package, enter <code>Feature require: #JSON</code> in a Workspace and &quot;Do it&quot;.</p><p>Custom classes whose instances need to be serialized to JSON should implement the instance method <code>jsonWriteOn:</code>. This method describes the instance variables that should be included. Here's how it could be implemented for a <code>Dog</code> class with instance variables <code>id</code>, <code>name</code>, and <code>breed</code>.</p><pre class="language-smalltalk"><code class="language-smalltalk">jsonWriteOn<span class="token punctuation">:</span> aWriteStream<br>    <span class="token punctuation">{</span><br>        <span class="token symbol">#id</span><span class="token operator">-</span><span class="token operator">></span>id<span class="token punctuation">.</span><br>        <span class="token symbol">#name</span><span class="token operator">-</span><span class="token operator">></span>name<span class="token punctuation">.</span><br>        <span class="token symbol">#breed</span><span class="token operator">-</span><span class="token operator">></span>breed<br>    <span class="token punctuation">}</span> asDictionary jsonWriteOn<span class="token punctuation">:</span> aWriteStream</code></pre><p>Here's how we can get a JSON string for a <code>Dog</code> object.</p><pre class="language-smalltalk"><code class="language-smalltalk">json <span class="token operator">:=</span> Json render<span class="token punctuation">:</span> dog</code></pre><p>Custom classes that need to deserialize JSON to a new instance should implement the class method <code>fromJson:</code> (suggested name) that takes a stream of JSON data and returns a new object created from it. Here's an example that uses the <code>Dog</code> class method <code>id:name:breed:</code> to create a new instance.</p><pre class="language-smalltalk"><code class="language-smalltalk">fromJson<span class="token punctuation">:</span> aStream<br>    <span class="token temporary-variables"><span class="token punctuation">|</span> <span class="token variable">jsonObject</span> <span class="token punctuation">|</span></span><br>    jsonObject <span class="token operator">:=</span> Json readFrom<span class="token punctuation">:</span> aStream<span class="token punctuation">.</span><br>    <span class="token operator">^</span>Dog<br>        id<span class="token punctuation">:</span> <span class="token punctuation">(</span>jsonObject at<span class="token punctuation">:</span> <span class="token symbol">#id</span><span class="token punctuation">)</span><br>        name<span class="token punctuation">:</span> <span class="token punctuation">(</span>jsonObject at<span class="token punctuation">:</span> <span class="token symbol">#name</span><span class="token punctuation">)</span><br>        breed<span class="token punctuation">:</span> <span class="token punctuation">(</span>jsonObject at<span class="token punctuation">:</span> <span class="token symbol">#breed</span><span class="token punctuation">)</span></code></pre><p>Here's how we can parse a JSON string to get a <code>Dog</code> object.</p><pre class="language-smalltalk"><code class="language-smalltalk">newDog <span class="token operator">:=</span> Dog fromJson<span class="token punctuation">:</span> json readStream</code></pre></article>