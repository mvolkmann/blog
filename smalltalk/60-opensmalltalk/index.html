<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>OpenSmalltalk</h2><aside><nav class="toc"><ol><li><a href="#obtaining-a-vm">Obtaining a VM</a></li><li><a href="#building-a-vm">Building a VM</a></li><li><a href="#downloading-an-image">Downloading an Image</a><ol><li><a href="#squeak">Squeak</a></li></ol></li><li><a href="#running-an-image">Running an Image</a></li></ol></nav></aside><article><p><a href="https://opensmalltalk.org" target="_blank">OpenSmalltalk</a> is a &quot;cross-platform virtual machine for Squeak, Pharo, Cuis, and Newspeak&quot;. It has many contributors. The person with the most commits is <a href="http://www.mirandabanda.org/cogblog/microbio/" target="_blank">Eliot Miranda</a>.</p><p>Many variants of the VM can be built with options such as:</p><ul><li><p>with or without just-in-time (JIT) compilation</p></li><li><p>green threads (&quot;light-weight processes above a single-threaded VM) or multi-threaded VM (&quot;shares the VM betwwen any number of native threads&quot;)</p></li><li><p>with or without Spur</p><p>Spur provides &quot;a partial read barrier for efficient support of live object-oriented programming.&quot; It is currently used by Squeak, Pharo, and Cuis.</p></li><li><p>with or without Sista</p><p>Sista &quot;adds support for adaptive optimization that does speculative inlining&quot;. As of October 2024 it was still in development.</p></li></ul><h2 id="obtaining-a-vm" tabindex="-1">Obtaining a VM</h2><p>To obtain an OpenSmalltalk VM:</p><ul><li><p>Clone the repository by entering <code>git clone https://github.com/OpenSmalltalk/opensmalltalk-vm.git</code></p><p>The only branch present on 11/28/2024 was &quot;Cog&quot;.</p></li><li><p>Perform source file substitutions by entering <code>./scripts/updateSCCSVersions</code></p></li><li><p>Choose between the Stack, Cog, and Sista VMs.</p><p>Currently it seems that Cog is preferred.</p></li><li><p>Choose between the v3 and Spur VMs.</p><p>Currently it seems that Spur is preferred.</p></li><li><p>For ARM-based Macs</p><ul><li>cd to the <code>building/macos64ARMv8/squeak.cog.spur</code> directory.</li><li>Copy the file <code>Squeak.app</code> to the <code>Applications</code> directory.</li></ul></li></ul><h2 id="building-a-vm" tabindex="-1">Building a VM</h2><p>To install everything needed to build an OpenSmalltalk VM for macOS:</p><ul><li>If Xcode.app is not installed, install it.</li><li>If the Xcode Command Line Tools are not installed, install them by entering <code>xcode-select --install</code>.</li><li>If Homebrew is not installed, install it.</li><li>If the <code>cmake</code> command is not installed,i install it by entering <code>brew install cmake</code>.</li></ul><p>To build the VM:</p><ul><li><p>cd to the <code>building/macos64ARMv8/squeak.cog.spur</code> directory.</p></li><li><p>Enter 'xcodebuild -runFirstLaunch` (not sure about this step)</p></li><li><p>Enter './makespur` (not sure about this step)</p><p>This will run for a long time (~10 minutes) and produces a large amount of output. There will be many warnings about issues such as unused variables. I got 39 warnings and 1 error. The error was &quot;call to undeclared function 'literalBeforeInlineCacheTagAt'&quot;. Where is the generated VM placed?</p></li></ul><p>For more detail, see <a href="https://github.com/OpenSmalltalk/opensmalltalk-vm/blob/Cog/building/macos64ARMv8/HowToBuild" target="_blank">HowToBuild</a>.</p><h2 id="downloading-an-image" tabindex="-1">Downloading an Image</h2><h3 id="squeak" tabindex="-1">Squeak</h3><p>To download the base image for Squeak, browse <a href="https://squeak.org/downloads/" target="_blank">Squeak Downloads</a>.</p><p>For the latest non-stable image:</p><ul><li>Click the link under &quot;Current Trunk Image&quot;.</li><li>Scroll to the bottom of the list to see the most recent image.</li><li>Click the link for the desired image.</li><li>Select the appropriate file for your platform which will be a <code>.dmg</code>, <code>.tar.gz</code>, or <code>.zip</code> file.</li><li>Double-click the downloaded file to install/uncompress it.</li></ul><p>For the latest stable image:</p><ul><li>Click a &quot;Release&quot; link under &quot;Images and Changes&quot;.</li><li>Click the &quot;Sources&quot; link under &quot;History&quot; to download the file <code>SqueakV60.sources</code> which must be placed in the same directory as each Squeak <code>.image</code> file.</li></ul><h2 id="running-an-image" tabindex="-1">Running an Image</h2><p>To run an image, double-click <code>Squeak.app</code>. That will open a dialog that prompts for a <code>.image</code> file. Select one and click the &quot;Open&quot; button.</p><p>Alternatively, double-click a Squeak <code>.image</code> file.</p></article>