<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Editor Customization</h2><aside></aside><article><p>I would like to implement a subset of the Vim keybindings for editing code in System Browsers. Here is what I have tried so far.</p><ul><li><p>Create a subclass of the <code>SmalltalkEditor</code> class called <code>VimEditor</code>.</p></li><li><p>Add the instance variable <code>mode</code> that will hold the string &quot;normal&quot; or &quot;insert&quot;.</p></li><li><p>Initialize <code>mode</code> to <code>'insert'</code> by adding the following instance method:</p><pre class="language-smalltalk"><code class="language-smalltalk">initialize<br>    mode <span class="token operator">:=</span> <span class="token string">'insert'</span><span class="token punctuation">.</span></code></pre></li><li><p>Implement the class method <code>initializeShortcuts</code> as follows:</p><pre class="language-smalltalk"><code class="language-smalltalk">initializeShortcuts<br>    <span class="token keyword">super</span> initializeShortcuts<span class="token punctuation">.</span><br>    shortcuts<br>        at<span class="token punctuation">:</span> <span class="token number">27</span> <span class="token operator">+</span> <span class="token number">1</span><br>        put<span class="token punctuation">:</span> <span class="token symbol">#switchToCommandMode</span><span class="token punctuation">:</span><span class="token punctuation">.</span><br>    <span class="token comment">"escape key - when in insert mode, switch to command mode"</span><br>    shortcuts<br>        at<span class="token punctuation">:</span> <span class="token number">105</span> <span class="token operator">+</span> <span class="token number">1</span><br>        put<span class="token punctuation">:</span> <span class="token symbol">#xKey</span><span class="token punctuation">:</span><span class="token punctuation">.</span><br>    <span class="token comment">"i key - when in command mode, switch to insert mode"</span><br>    shortcuts<br>        at<span class="token punctuation">:</span> <span class="token number">120</span> <span class="token operator">+</span> <span class="token number">1</span><br>        put<span class="token punctuation">:</span> <span class="token symbol">#xKey</span><span class="token punctuation">:</span><span class="token punctuation">.</span><br>    <span class="token comment">"x key - when in command mode, delete character under cursor"</span></code></pre></li><li><p>Implement the following instance methods:</p><pre class="language-smalltalk"><code class="language-smalltalk">escapeKey<span class="token punctuation">:</span> aKeyboardEvent<br>    <span class="token temporary-variables"><span class="token punctuation">|</span> <span class="token variable">inCommandMode</span> <span class="token punctuation">|</span></span><br>    inCommandMode <span class="token operator">:=</span> mode <span class="token operator">=</span> <span class="token string">'command'</span><span class="token punctuation">.</span><br>    inCommandMode ifFalse<span class="token punctuation">:</span> <span class="token punctuation">[</span> mode <span class="token operator">:=</span> <span class="token string">'command'</span> <span class="token punctuation">]</span><span class="token punctuation">.</span><br>    <span class="token comment">"Hopefully returning false means that a superclass can process the event."</span><br>    <span class="token operator">^</span> inCommandMode not<span class="token punctuation">.</span><br><br>iKey<span class="token punctuation">:</span> aKeyboardEvent<br>    <span class="token temporary-variables"><span class="token punctuation">|</span> <span class="token variable">inCommandMode</span> <span class="token punctuation">|</span></span><br>    inCommandMode <span class="token operator">:=</span> mode <span class="token operator">=</span> <span class="token string">'command'</span><span class="token punctuation">.</span><br>    inCommandMode ifTrue<span class="token punctuation">:</span> <span class="token punctuation">[</span> mode <span class="token operator">:=</span> <span class="token string">'insert'</span> <span class="token punctuation">]</span><span class="token punctuation">.</span><br>    <span class="token comment">"Hopefully returning false means that a superclass can process the event."</span><br>    <span class="token operator">^</span> inCommandMode<span class="token punctuation">.</span><br><br>xKey<span class="token punctuation">:</span> aKeyboardEvent<br>    <span class="token temporary-variables"><span class="token punctuation">|</span> <span class="token variable">inCommandMode</span> <span class="token punctuation">|</span></span><br>    inCommandMode <span class="token operator">:=</span> mode <span class="token operator">=</span> <span class="token string">'command'</span><span class="token punctuation">.</span><br>    inCommandMode ifTrue<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'delete character under cursor'</span> print <span class="token punctuation">]</span><span class="token punctuation">.</span><br>    <span class="token comment">"Hopefully returning false means that a superclass can process the event."</span><br>    <span class="token operator">^</span> inCommandMode<span class="token punctuation">.</span></code></pre></li><li><p>TODO: Determine how to modify the System Browser to use <code>VimEditor</code> instead of <code>SmalltalkEditor</code> in its bottom pane.</p></li><li><p>TODO: Determine how to modify the <code>xKey:</code> method to really delete a character.</p></li></ul><p>Changes will likely have no effect until the image is saved and restarted.</p></article>