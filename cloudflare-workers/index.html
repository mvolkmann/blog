<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Cloudflare Workers</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#projects-on-web">Projects on Web</a></li><li><a href="#wrangler">Wrangler</a></li><li><a href="#local-projects">Local Projects</a></li><li><a href="#using-hono">Using Hono</a><ol><li><a href="#src%2Findex.ts">src/index.ts</a></li><li><a href="#src%2Fdog-router.ts">src/dog-router.ts</a></li><li><a href="#static%2Fstyles.css">static/styles.css</a></li></ol></li><li><a href="#viewing-workers">Viewing Workers</a></li><li><a href="#kv-stores">KV Stores</a></li><li><a href="#htmx">htmx</a></li><li><a href="#astro">Astro</a></li></ol></nav></aside><article><style>img {
    border: 1px solid gray;
  }</style><p><img alt="Cloudflare Workers logo" style="border: none; width: 30%" src="/blog/assets/cloudflare-workers-logo.svg?v=1.1.1" title="Hono logo"></p><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://workers.cloudflare.com?v=1.1.1" rel="noopener" target="_blank">Cloudflare Workers</a> host edge functions.</p><p>Features provided include:</p><ul><li><p>automatic scaling</p><p>There is no need to configure auto-scaling or load balancers.</p></li><li><p>high performance global network</p><p>Cloudflare workers run in a network of data centers that use V8 isolates that have very low latency (approximately 25ms in my testing).</p></li><li><p>ability write in a variety of programming languages, including JavaScript, TypeScript, Rust, C, and C++.</p></li><li><p>run instantly without cold starts</p><p>This may not be true when using the free tier.</p></li><li><p>affordable</p><p>The first 100,000 requests each day are free. After that the cost is $5 USD per 10 million requests.</p></li><li><p>no servers to maintain</p></li><li><p>provides edge storage of static assets using &quot;Workers KV&quot;</p></li><li><p>can generate assets at runtime, including images, SVGs, PDFs, and more</p></li></ul><h2 id="projects-on-web" tabindex="-1">Projects on Web</h2><p>A Cloudflare Worker can be created, edited, tested, and deployed directly from the website without downloading any code.</p><ul><li><p>Browse <a href="https://www.cloudflare.com?v=1.1.1" rel="noopener" target="_blank">cloudflare.com</a>.</p></li><li><p>If you do not yet have an account, click the &quot;Sign up&quot; button.</p></li><li><p>If you do have an account, click the &quot;Log in&quot; button.</p></li><li><p>Click &quot;Workers &amp; Pages&quot; in the left nav.</p></li><li><p>Click the &quot;Create application&quot; button.</p></li><li><p>Click the &quot;Create Worker&quot; button.</p></li><li><p>Change the name of the worker.</p></li><li><p>Click the &quot;Deploy&quot; button. This must be done before the code can be edited.</p></li><li><p>Click the &quot;Edit code&quot; button. For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><br>  <span class="token keyword">async</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> env<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token string">'&lt;h1>Hello, Mark!&lt;/h1>'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></li><li><p>Edit the contents of the file &quot;worker.js&quot; directly in the browser.</p></li><li><p>Click the &quot;HTTP&quot; tab.</p></li><li><p>Click the &quot;Send&quot; button to see the response in the right pane.</p></li><li><p>To save changes, click the &quot;Save and deploy&quot; button.</p><p>A confirmation dialog will appear. Click the &quot;Save and deploy&quot; button inside the dialog.</p></li><li><p>To view deployed app in a new browser tab, click the &quot;workers.dev&quot; link.</p></li></ul><h2 id="wrangler" tabindex="-1">Wrangler</h2><p>The Wrangler command-line interface (CLI) supports creating, testing, and deploying Cloudflare Worker apps locally.</p><p>To install it globally, enter <code>npm install -g wrangler</code>.</p><p>To authenticate Wrangler with your Cloudflare account, enter <code>wrangler login</code>. This opens a browser window that prompts &quot;Allow Wrangler to make changes to your Cloudflare account?&quot; Click the &quot;Allow&quot; button. When the message &quot;You have granted authorization to Wrangler!&quot; appears, close the browser window.</p><p>To continue development of a worker created in the Web UI, enter <code>npm create cloudflare@2 {worker-name} -- --type pre-existing --existing-script {worker-name}</code> This will ask &quot;Do you want to use git for version control?&quot; It will then download the project and install the dependencies.</p><p>To start a local server for the app, cd to the new project directory and enter <code>npm run dev</code>.</p><p>To test the app, browse localhost:8787.</p><h2 id="local-projects" tabindex="-1">Local Projects</h2><p>To create a new Cloudflare Worker project from the command-line, enter <code>npm create cloudflare -- {app-name}</code>. This will prompt for:</p><ul><li><p>Need to install the following packages: ... Ok to proceed?</p></li><li><p>In which directory do you want to create you application?</p></li><li><p>What type of application do you want to execute?</p><ul><li>&quot;Hello World&quot; Worker</li><li>Website or web app</li><li>Example router &amp; proxy Worker</li><li>Scheduled Worker (Cron Trigger)</li><li>Queue consumer &amp; producer Worker</li><li>ChatGPT plugin</li><li>OpenAPI 3.1</li></ul></li><li><p>Do you want to use TypeScript?</p></li><li><p>Do you want to use git for version control?</p></li><li><p>Do you want to deploy your application?</p><p>This will open a browser window where you can sign up for an account or log in if you already have an account. You will also be prompted in a browser window to allow &quot;wrangler&quot; to make changes in your account.</p></li></ul><p>If you chose to deploy the application, it will be opened in a new browser window.</p><p>When it finishes, the target directory will be created and will contain the following files:</p><ul><li><code>node_modules</code> directory</li><li><code>package.json</code></li><li><code>package-lock.json</code></li><li><code>src/index.ts</code></li><li><code>tsconfig.json</code></li><li><code>wrangler.toml</code></li></ul><p>To start a local server for the app, cd to the new project directory and enter <code>npm run dev</code>.</p><p>To test the app, browse localhost:8787.</p><p>The local server provides hot reloading of only itself, not the web browser.</p><p>To deploy app again after making local changes, enter <code>npm run deploy</code>.</p><p>An alternative to creating a project with <code>npm create cloudflare -- {app-name}</code> is to use <code>npm create hono@latest</code> and select the &quot;cloudflare-workers&quot; template. TODO: How does this approach differ?</p><h2 id="using-hono" tabindex="-1">Using Hono</h2><p>This section walks through creating a Cloudflare Worker project that uses <a href="https://hono.dev/?v=1.1.1" rel="noopener" target="_blank">Hono</a> for request routing.</p><ul><li><p>Create a new project named &quot;hono-dogs&quot; as described above.</p></li><li><p>Install Hono dependencies by entering the following commands:</p><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hono<br><span class="token function">npm</span> <span class="token function">install</span> @hono/zod-validator</code></pre></li><li><p>Make the following modifications in <code>tsconfig.json</code>:</p><pre class="language-json"><code class="language-json"><span class="token property">"jsx"</span><span class="token operator">:</span> <span class="token string">"react-jsx"</span><span class="token punctuation">,</span><br><span class="token property">"jsxImportSource"</span><span class="token operator">:</span> <span class="token string">"hono/jsx"</span><span class="token punctuation">,</span></code></pre></li><li><p>Add the following in <code>wrangler.toml</code> to support serving static files from the <code>public</code> directory:</p><pre class="language-toml"><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">site</span><span class="token punctuation">]</span><br><span class="token key property">bucket</span> <span class="token punctuation">=</span> <span class="token string">"./public"</span></code></pre></li><li><p>Create the three files described below.</p></li><li><p>Test the site locally.</p><p>Start a local server by entering <code>npm run dev</code>. Browse localhost:8787/dog to see the following:</p><p><img alt="Cloudflare Workers Hono dogs" style="width: 60%" src="/blog/assets/cloudflare-workers-hono-dogs.png?v=1.1.1" title="Cloudflare Workers Hono dogs"></p></li><li><p>Deploy the app by entering <code>npm run deploy</code>.</p><p>The URL will be output after the line that begins with &quot;Published&quot;.</p></li></ul><h3 id="src%2Findex.ts" tabindex="-1">src/index.ts</h3><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>Hono<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>serveStatic<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/cloudflare-workers'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> dogRouter <span class="token keyword">from</span> <span class="token string">'./dog-router'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This serves static files from the</span><br><span class="token comment">// [site] bucket directory specified in wrangler.toml.</span><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/*'</span><span class="token punctuation">,</span> <span class="token function">serveStatic</span><span class="token punctuation">(</span><span class="token punctuation">{</span>root<span class="token operator">:</span> <span class="token string">'./'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> c <span class="token operator">=></span> c<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/dog'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">'/dog'</span><span class="token punctuation">,</span> dogRouter<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> app<span class="token punctuation">;</span></code></pre><h3 id="src%2Fdog-router.ts" tabindex="-1">src/dog-router.ts</h3><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>Hono<span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">Context</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>z<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zod'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>zValidator<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@hono/zod-validator'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">interface</span> <span class="token class-name">NewDog</span> <span class="token punctuation">{</span><br>  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">interface</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">NewDog</span> <span class="token punctuation">{</span><br>  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">let</span> lastId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br><br><span class="token comment">// The dogs are maintained in memory.</span><br><span class="token keyword">const</span> dogMap<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> Dog<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token operator">++</span>lastId<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">}</span><span class="token punctuation">;</span><br>  dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> dog<span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token string">'Whippet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This gets all the dogs as either JSON or HTML.</span><br><span class="token keyword">const</span> getAllRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This gets one dog by its id as JSON.</span><br><span class="token keyword">const</span> idSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  id<span class="token operator">:</span> z<span class="token punctuation">.</span>coerce<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">positive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> idValidator <span class="token operator">=</span> <span class="token function">zValidator</span><span class="token punctuation">(</span><span class="token string">'param'</span><span class="token punctuation">,</span> idSchema<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> getOneRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> idValidator<span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This creates a new dog.</span><br><span class="token keyword">const</span> dogSchema <span class="token operator">=</span> z<br>  <span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>    id<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">positive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    breed<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">strict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no extra properties allowed</span><br><span class="token keyword">const</span> dogValidator <span class="token operator">=</span> <span class="token function">zValidator</span><span class="token punctuation">(</span><span class="token string">'json'</span><span class="token punctuation">,</span> dogSchema<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> createRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> dogValidator<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> NewDog<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token function">addDog</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>name<span class="token punctuation">,</span> data<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This updates the dog with a given id.</span><br><span class="token keyword">const</span> updateRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><br>  <span class="token string">'/:id'</span><span class="token punctuation">,</span><br>  idValidator<span class="token punctuation">,</span><br>  dogValidator<span class="token punctuation">,</span><br>  <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> NewDog<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      dog<span class="token punctuation">.</span>name <span class="token operator">=</span> data<span class="token punctuation">.</span>name<span class="token punctuation">;</span><br>      dog<span class="token punctuation">.</span>breed <span class="token operator">=</span> data<span class="token punctuation">.</span>breed<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This deletes the dog with a given id.</span><br><span class="token keyword">const</span> deleteRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> idValidator<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token keyword">delete</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">CreateType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> createRoute<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">DeleteType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> deleteRoute<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">GetAllType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> getAllRoute<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">GetOneType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> getOneRoute<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UpdateType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> updateRoute<span class="token punctuation">;</span></code></pre><h3 id="static%2Fstyles.css" tabindex="-1">static/styles.css</h3><pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span><br>  <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">li</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> purple<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="viewing-workers" tabindex="-1">Viewing Workers</h2><p>To view your workers, browse <a href="https://cloudflare.com">https://cloudflare.com</a>.</p><p>Login to see the dashboard page.</p><p>Click &quot;Workers &amp; Pages&quot; in the left nav to display a list of the deployed workers.</p><p>For each worker, the number of requests sent to it and the number of errors logged will be displayed.</p><p>Click a worker to see detail about it, including its deployed URL.</p><h2 id="kv-stores" tabindex="-1">KV Stores</h2><p>&quot;<a href="https://developers.cloudflare.com/kv/get-started/?v=1.1.1" rel="noopener" target="_blank">Workers KV</a> provides low-latency, high-throughput global storage to your Cloudflare Workers applications. Workers KV is ideal for storing user configuration data, routing data, A/B testing configurations, authentication tokens, and is well suited for read-heavy workloads.&quot;</p><p>To enable use of KV in a worker:</p><ul><li><p>Browse the <a href="https://dash.cloudflare.com/?v=1.1.1" rel="noopener" target="_blank">Cloudflare Dashboard</a> and log in if not already logged in.</p></li><li><p>Click &quot;Workers &amp; Pages&quot; in the left nav.</p></li><li><p>Click the subcategory &quot;Plans&quot; in the left nav.</p><p>The free plan offers up to 100,000 read operations per day and up to 1,000 write, delete, list operations per day. For more, click the &quot;Purchase Workers Paid&quot; button.</p></li><li><p>Create a KV namespace.</p><p>Enter <code>wrangler kv:namespace create {namespace}</code>. This will output lines to be added to <code>wrangler.toml</code>.</p></li><li><p>Add the lines output by previous command in <code>wrangler.toml</code>.</p></li></ul><p>TODO: Document the remaining instructions.</p><p>TODO: Can you store the map of dogs for your demo in a KV store?</p><h2 id="htmx" tabindex="-1">htmx</h2><p>A complete web app developed with htmx can be deployed to a Cloudflare Worker! TODO: Try this!</p><h2 id="astro" tabindex="-1">Astro</h2><p>To deploy an Astro app to Cloudflare, see <a href="https://docs.astro.build/en/guides/integrations-guide/cloudflare/?v=1.1.1" rel="noopener" target="_blank">@astrojs/cloudflare</a>.</p></article>