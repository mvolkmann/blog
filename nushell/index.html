<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Nushell</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#installing">Installing</a></li><li><a href="#getting-started">Getting Started</a></li><li><a href="#configuration">Configuration</a></li><li><a href="#environment-variables">Environment Variables</a></li><li><a href="#common-commands">Common Commands</a></li></ol></nav></aside><article><h2 id="overview">Overview</h2><p><a href="https://www.nushell.sh?v=1.0.10" rel="noopener" target="_blank">Nushell</a> is &quot;a new type of shell&quot;. It was created by Jonathan Turner, Yehuda Katz, and Andres Robalino. It is implemented in Rust.</p><p>Unlike most shells where only strings are used for command input and output, Nushell supports many primitive and structured data types. Primitive types include boolean, number, decimal, string, date, file size, and path. Structured data types include list, table (object), binary data, and block. Details about these data types can be found at <a href="https://www.nushell.sh/book/types_of_data.html?v=1.0.10" rel="noopener" target="_blank">Types of data</a>.</p><h2 id="installing">Installing</h2><p>There are many options for installing the Nushell. If you have Rust installed, enter <code>cargo install nu</code>. This takes a long time to complete. If you are on macOS and have Homebrew installed, enter <code>brew install nushell</code>. Note that Homebrew may install a version that is several versions behind the latest. Prebuilt binaries for Linux, macOS, and Windows can also be downloaded. For more information on installation options, click the Nushell link above.</p><h2 id="getting-started">Getting Started</h2><p>To start the shell, enter <code>nu</code>.</p><p>For help, enter <code>help</code>. For a list of supported commands, enter <code>help commands</code>. In version 0.28.0 there are 105 commands. For help on a specific command, enter <code>help {command-name}</code>.</p><p>For detailed documentation, see the <a href="https://www.nushell.sh/book/?v=1.0.10" rel="noopener" target="_blank">Book</a> link in the top nav of the website.</p><p>Nushell has great command recall and completion like the Fish and zsh shells.</p><h2 id="configuration">Configuration</h2><p>The configuration for Nushell is stored in a TOML file whose path can be obtained by entering <code>config path</code>. To edit this file with Vim, enter <code>vim $(config path)</code>.</p><p>The color used to output data of each type can be customized by adding a <code>[color_config]</code> section to the config file. For example:</p><pre class="language-toml"><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">color_config</span><span class="token punctuation">]</span><br><span class="token key property">primitive_filesize</span> <span class="token punctuation">=</span> <span class="token string">"ub"</span><br><span class="token key property">primitive_path</span> <span class="token punctuation">=</span> <span class="token string">"yb"</span></code></pre><p>The command <code>config set path $nu.path</code> writes the value of <code>$nu.path</code> into the <code>config.toml</code> file. TODO: Why is that useful? Similarly, the command <code>config set env $nu.env</code> writes all the current environment variables into the <code>config.toml</code> file. TODO: Why is that useful?</p><p>To specify commands to run each time a new Nushell session is started, add a <code>startup</code> list in the config file where the commands are inside square brackets, delimited by quotes, and separated by commas. For example:</p><pre class="language-toml"><code class="language-toml"><span class="token key property">startup</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><br>  <span class="token string">"alias cdjs = cd $nu.env.JS_DIR"</span><span class="token punctuation">,</span><br>  <span class="token string">"alias cdrust = cd $nu.env.RUST_DIR"</span><br><span class="token punctuation">]</span></code></pre><p>To output the value of each key in the config file, enter <code>config</code>. To output the value of a specific key in the config file, enter <code>config | get {key}</code>.</p><h2 id="environment-variables">Environment Variables</h2><p>To set the value of an environment variable, enter <code>let-env NAME = value</code>. To get the value of an environment variable, use <code>$nu.env.NAME</code> which can be passed to the <code>echo</code> command to print the value.</p><h2 id="common-commands">Common Commands</h2><p>The list of directories in the path of the external shell are automatically used by the nu shell.</p><p>To see a nicely formatted list of directories in your path, enter <code>echo $nu.path</code> or <code>config | get path</code>.</p><p>To see a nicely formatted list of environment variables, enter <code>echo $nu.env | pivot</code> or <code>config | get env | pivot</code>.</p><p>To get the value of a single environment variable, enter <code>config | get env.{name}</code>.</p><p>To clear the screen, enter <code>clear</code>.</p><p>The nu shell displays most data in tables. Commands that produce tables include <code>ls</code>, <code>ps</code>, and <code>sys</code>. When a column displays <code>[table n rows]</code>, use the <code>get</code> filter to display those rows (examples below). SQL-like filters like <code>where</code>, <code>sort-by</code>, and <code>reverse</code> can be used to modify the output. For example:</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># List files and directories in the current directory</span><br><span class="token comment"># sorted on size from largest to smallest.</span><br><span class="token function">ls</span> <span class="token operator">|</span> sort-by size <span class="token operator">|</span> reverse<br><br><span class="token comment"># List directories in the current directory,</span><br><span class="token comment"># sorted on size from largest to smallest,</span><br><span class="token comment"># excluding the type column since all will be "Dir".</span><br><span class="token function">ls</span> <span class="token operator">|</span> where <span class="token builtin class-name">type</span> <span class="token operator">==</span> Dir <span class="token operator">|</span> sort-by size <span class="token operator">|</span> reverse <span class="token operator">|</span> reject <span class="token builtin class-name">type</span><br><br><span class="token comment"># Output processes using more than 5% of a CPU</span><br><span class="token comment"># sorted on the usage in reverse order.</span><br><span class="token function">ps</span> <span class="token operator">|</span> where cpu <span class="token operator">></span> <span class="token number">5</span> <span class="token operator">|</span> sort-by cpu <span class="token operator">|</span> reverse<br><br><span class="token comment"># Output information about the current machine</span><br><span class="token comment"># including OS version, host name, and uptime.</span><br>sys <span class="token operator">|</span> get <span class="token function">host</span><br><br><span class="token comment"># Output the temperature of the CPUs, GPU, and battery (tested on macOS).</span><br>sys <span class="token operator">|</span> get temp</code></pre><p>To define a function, enter <code>def {name} [params] { commands }</code>.</p><p>For example, this command has no parameters.</p><pre class="language-bash"><code class="language-bash">def <span class="token function">top</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token function">ps</span> <span class="token operator">|</span> where cpu <span class="token operator">></span> <span class="token number">5</span> <span class="token operator">|</span> sort-by cpu <span class="token operator">|</span> reverse <span class="token punctuation">}</span></code></pre><p>Here is a version that has a CPU percentage parameter:</p><pre class="language-bash"><code class="language-bash">def topn <span class="token punctuation">[</span>pct:int<span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token function">ps</span> <span class="token operator">|</span> where cpu <span class="token operator">></span> <span class="token variable">$pct</span> <span class="token operator">|</span> sort-by cpu <span class="token operator">|</span> reverse <span class="token punctuation">}</span></code></pre><p>To create an alias for a command, enter <code>alias {name} [{params}] { {command} }</code>. TODO: How do aliases differ from functions?</p><p>To drop n columns from the end of a table, add <code>| drop n</code>. Omitting the number drops one column.</p><p>TODO: Is it possible to change the nu shell prompt?</p><p>There is a VS Code extension for Nushell that provides syntax highlighting. See <a href="https://marketplace.visualstudio.com/items?itemName=TheNuProjectContributors.vscode-nushell-lang?v=1.0.10" rel="noopener" target="_blank">vscode-nushell-lang</a>.</p><p>To set a variable, enter <code>let name = value</code>.</p><p>To set a variable to the result of a command, enter <code>let name = $(command)</code>.</p><p>To concatenate two string variables, enter <code>let v3 = echo [$v1 $v2] | str collect</code>.</p><p>To iterate over a range of integers, use <code>seq start end | each { ... }</code>.</p></article>