<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Python functools module</h2><aside><nav class="toc"><ol><li><a href="#cache">cache</a></li><li><a href="#lru_cache">lru_cache</a></li><li><a href="#partial">partial</a></li><li><a href="#partial_method">partial_method</a></li><li><a href="#reduce">reduce</a></li><li><a href="#singledispatch">singledispatch</a></li><li><a href="#singledispatchmethod">singledispatchmethod</a></li><li><a href="#total_ordering">total_ordering</a></li></ol></nav></aside><article><p>The <a href="https://docs.python.org/3/library/functools.html?v=1.0.12" rel="noopener" target="_blank"><code>functools</code></a> module in the Python standard library provides &quot;higher-order&quot; functions which are functions that accept or return other functions. The most commonly used of these functions are demonstrated below.</p><p>In each of the code snippets that follow, the following import is needed:</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> <span class="token punctuation">{</span>function<span class="token operator">-</span>name<span class="token punctuation">}</span></code></pre><h2 id="cache"><code>cache</code></h2><p>This is a decorator that memoizes a function, which causes it to cache return values so repeated calls with the same arguments return the cached value rather that execute the function again. For example:</p><pre class="language-python"><code class="language-python"><span class="token decorator annotation punctuation">@cache</span><br><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">:</span><br>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'computing </span><span class="token interpolation"><span class="token punctuation">{</span>n1<span class="token punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token punctuation">{</span>n2<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><br>  <span class="token keyword">return</span> n1 <span class="token operator">+</span> n2<br><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="lru_cache"><code>lru_cache</code></h2><p>This is a decorator that is similar to <code>@cache</code>, but only caches results for the <code>maxsize</code> most recent argument lists. When the cache becomes full, the least recently used cached value is evicted. The <code>maxsize</code> argument defaults to 128. For example:</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> functools <span class="token keyword">import</span> lru_cache<br><br><span class="token decorator annotation punctuation">@lru_cache</span><span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><br><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'computing </span><span class="token interpolation"><span class="token punctuation">{</span>n1<span class="token punctuation">}</span></span><span class="token string"> + </span><span class="token interpolation"><span class="token punctuation">{</span>n2<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><br>    <span class="token keyword">return</span> n1 <span class="token operator">+</span> n2<br><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># computes</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># uses cache</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># computes</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># uses cache</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># computes</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># uses cache</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># computes</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># uses cache</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># computes because previously cached value was evicted</span><br><br><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">.</span>cache_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token comment"># CacheInfo(hits=4, misses=5, maxsize=3, currsize=3)</span></code></pre><h2 id="partial"><code>partial</code></h2><p>This creates a <code>partial</code> object that is callable like a function and calls a given function with provided initial arguments. For example:</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> functools <span class="token keyword">import</span> partial<br><br><span class="token keyword">def</span> <span class="token function">relationship</span><span class="token punctuation">(</span>feeling<span class="token punctuation">,</span> name1<span class="token punctuation">,</span> name2<span class="token punctuation">)</span><span class="token punctuation">:</span><br>  <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>name1<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>feeling<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>name2<span class="token punctuation">}</span></span><span class="token string">.'</span></span><br><br><span class="token keyword">print</span><span class="token punctuation">(</span>relationship<span class="token punctuation">(</span><span class="token string">'loves'</span><span class="token punctuation">,</span> <span class="token string">'Joanie'</span><span class="token punctuation">,</span> <span class="token string">'Chachi'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment"># Provide one initial argument.</span><br>loves <span class="token operator">=</span> partial<span class="token punctuation">(</span>relationship<span class="token punctuation">,</span> <span class="token string">'loves'</span><span class="token punctuation">)</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>loves<span class="token punctuation">(</span><span class="token string">'Joanie'</span><span class="token punctuation">,</span> <span class="token string">'Chachi'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>loves<span class="token punctuation">(</span><span class="token string">'Mark'</span><span class="token punctuation">,</span> <span class="token string">'Tami'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment"># Provide two initial arguments.</span><br>grinch_hates <span class="token operator">=</span> partial<span class="token punctuation">(</span>relationship<span class="token punctuation">,</span> <span class="token string">'hates'</span><span class="token punctuation">,</span> <span class="token string">'The grinch'</span><span class="token punctuation">)</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>grinch_hates<span class="token punctuation">(</span><span class="token string">'Christmas'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>grinch_hates<span class="token punctuation">(</span><span class="token string">'noise'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="partial_method"><code>partial_method</code></h2><p>This is similar to <code>partial</code>, but it creates a new class method based on an existing class method.</p><h2 id="reduce"><code>reduce</code></h2><p>This reduces a sequence of values to a single value. The result can be any kind of value including a primitive, object, or sequence. For example:</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span><br><span class="token keyword">import</span> math<br><br><span class="token comment"># This is a simple example, but</span><br><span class="token comment"># the built-in function "sum" and the "math.prod" function</span><br><span class="token comment"># can be used instead.</span><br>numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span><br>my_sum <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><br>my_product <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> a <span class="token operator">*</span> b<span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>my_sum<span class="token punctuation">,</span> my_product<span class="token punctuation">)</span> <span class="token comment"># 42, 1911</span><br><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span>prod<span class="token punctuation">(</span>numbers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 42, 1911</span><br><br><span class="token comment"># This is an example where results are accumulated in a dict.</span><br>items <span class="token operator">=</span> <span class="token punctuation">[</span><br>    <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'apples'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">3.00</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'bananas'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">2.50</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'grapes'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">5.99</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'oranges'</span><span class="token punctuation">,</span> <span class="token string">'price'</span><span class="token punctuation">:</span> <span class="token number">4.50</span><span class="token punctuation">}</span><br><span class="token punctuation">]</span><br><br><span class="token keyword">def</span> <span class="token function">find_extremes</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    price <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><br>    lowest <span class="token operator">=</span> acc<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'lowest'</span><span class="token punctuation">)</span><br>    highest <span class="token operator">=</span> acc<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'highest'</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> <span class="token keyword">not</span> lowest <span class="token keyword">or</span> price <span class="token operator">&lt;</span> lowest<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>        acc<span class="token punctuation">[</span><span class="token string">'lowest'</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<br>    <span class="token keyword">if</span> <span class="token keyword">not</span> highest <span class="token keyword">or</span> price <span class="token operator">></span> highest<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>        acc<span class="token punctuation">[</span><span class="token string">'highest'</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<br>    <span class="token keyword">return</span> acc<br><br>results <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span>find_extremes<span class="token punctuation">,</span> items<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><br><span class="token comment"># {</span><br><span class="token comment">#     'lowest': {'name': 'bananas', 'price': 2.5},</span><br><span class="token comment">#     'highest': {'name': 'grapes', 'price': 5.99}</span><br><span class="token comment"># }</span></code></pre><h2 id="singledispatch"><code>singledispatch</code></h2><p>This is a decorator that enables implementing multiple version of a function that differ based on the type of the first argument. For example:</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> functools <span class="token keyword">import</span> singledispatch<br><br><span class="token keyword">class</span> <span class="token class-name">MyClass</span><span class="token punctuation">:</span><br>    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        <span class="token keyword">return</span> <span class="token string">'MyClass object'</span><br><br><span class="token decorator annotation punctuation">@singledispatch</span><br><span class="token keyword">def</span> <span class="token function">log_me</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'unsupported type'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'boolean'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'float'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token builtin">tuple</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'tuple'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token builtin">set</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'set'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dict'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br><span class="token decorator annotation punctuation">@log_me<span class="token punctuation">.</span>register</span><br><span class="token keyword">def</span> <span class="token function">_</span><span class="token punctuation">(</span>arg<span class="token punctuation">:</span> MyClass<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'MyClass'</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><br><br>log_me<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># boolean True</span><br>log_me<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># int 1</span><br>log_me<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">)</span> <span class="token comment"># float 1.2</span><br>log_me<span class="token punctuation">(</span><span class="token string">'text'</span><span class="token punctuation">)</span> <span class="token comment"># str text</span><br>log_me<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># list [1, 2, 3]</span><br>log_me<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># tuple (1, 2, 3)</span><br>log_me<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># set {1, 2, 3}</span><br>log_me<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'alpha'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'beta'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># dict {'alpha': 1, 'beta': 2}</span><br>obj <span class="token operator">=</span> MyClass<span class="token punctuation">(</span><span class="token punctuation">)</span><br>log_me<span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment"># MyClass MyClass object</span><br>log_me<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token comment"># unsupported type &lt;class 'NoneType'></span><br>log_me<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># unsupported type &lt;class 'range'></span></code></pre><h2 id="singledispatchmethod"><code>singledispatchmethod</code></h2><p>This is a decorator that is similar to the <code>singledispatch</code> decorator, but it enables implementing multiple version of a method in a class.</p><h2 id="total_ordering"><code>total_ordering</code></h2><p>This adds comparison methods to a class based on an existing <code>eq</code> method and at least one of the comparison methods <code>le</code>, <code>lt</code>, <code>gt</code>, or <code>ge</code>. For example:</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> enum <span class="token keyword">import</span> Enum<br><span class="token keyword">from</span> functools <span class="token keyword">import</span> total_ordering<br><span class="token keyword">import</span> math<br><br>M_TO_KM <span class="token operator">=</span> <span class="token number">1.60934</span><br><br><span class="token keyword">class</span> <span class="token class-name">DUnit</span><span class="token punctuation">(</span>Enum<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    KM <span class="token operator">=</span> <span class="token number">1</span><br>    MILE <span class="token operator">=</span> <span class="token number">2</span><br><br><span class="token keyword">def</span> <span class="token function">km</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token keyword">return</span> d<span class="token punctuation">.</span>mag <span class="token keyword">if</span> d<span class="token punctuation">.</span>unit <span class="token operator">==</span> DUnit<span class="token punctuation">.</span>KM <span class="token keyword">else</span> d<span class="token punctuation">.</span>mag <span class="token operator">*</span> M_TO_KM<br><br><span class="token decorator annotation punctuation">@total_ordering</span><br><span class="token keyword">class</span> <span class="token class-name">Distance</span><span class="token punctuation">:</span><br>    <span class="token comment"># unit must be a DUnit.</span><br>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> mag<span class="token punctuation">,</span> unit<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        self<span class="token punctuation">.</span>mag <span class="token operator">=</span> mag<br>        self<span class="token punctuation">.</span>unit <span class="token operator">=</span> unit<br><br>    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        <span class="token keyword">return</span> math<span class="token punctuation">.</span>isclose<span class="token punctuation">(</span>km<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">,</span> km<span class="token punctuation">(</span>other<span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>    <span class="token keyword">def</span> <span class="token function">__lt__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        <span class="token keyword">return</span> km<span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">&lt;</span> km<span class="token punctuation">(</span>other<span class="token punctuation">)</span><br><br>    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><br>        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>mag<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">'km'</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>unit <span class="token operator">==</span> DUnit<span class="token punctuation">.</span>KM <span class="token keyword">else</span> <span class="token string">' mile'</span><span class="token punctuation">)</span><br><br>k5 <span class="token operator">=</span> Distance<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> DUnit<span class="token punctuation">.</span>KM<span class="token punctuation">)</span> <span class="token comment"># ~ 3.1 miles</span><br>k10 <span class="token operator">=</span> Distance<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> DUnit<span class="token punctuation">.</span>KM<span class="token punctuation">)</span> <span class="token comment"># ~ 6.2 miles</span><br>m3 <span class="token operator">=</span> Distance<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> DUnit<span class="token punctuation">.</span>MILE<span class="token punctuation">)</span><br>m10 <span class="token operator">=</span> Distance<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> DUnit<span class="token punctuation">.</span>MILE<span class="token punctuation">)</span><br><br>races <span class="token operator">=</span> <span class="token punctuation">[</span>m10<span class="token punctuation">,</span> k5<span class="token punctuation">,</span> m3<span class="token punctuation">,</span> k10<span class="token punctuation">]</span><br>races<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span><br><br><span class="token keyword">for</span> race <span class="token keyword">in</span> races<span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span>race<span class="token punctuation">)</span><br><br><span class="token keyword">assert</span> races<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> m3<br><span class="token keyword">assert</span> races<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> m10<br><span class="token keyword">assert</span> m3 <span class="token operator">&lt;</span> k5<br><span class="token keyword">assert</span> m3 <span class="token operator">&lt;=</span> k5<br><span class="token keyword">assert</span> k5 <span class="token operator">></span> m3<br><span class="token keyword">assert</span> k5 <span class="token operator">>=</span> m3<br><span class="token keyword">assert</span> m3 <span class="token operator">!=</span> k5</code></pre></article>