<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>SvelteKit</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#getting-started">Getting Started</a></li><li><a href="#file-based-page-routing">File-based Page Routing</a></li><li><a href="#file-based-endpoints-(rest-services)">File-based Endpoints (REST services)</a></li><li><a href="#layouts">Layouts</a></li><li><a href="#error-page">Error Page</a></li><li><a href="#code-splitting">Code Splitting</a></li><li><a href="#hot-module-reloading">Hot Module Reloading</a></li><li><a href="#static-pages-and-sites">Static Pages and Sites</a></li><li><a href="#tool-setup">Tool Setup</a></li><li><a href="#path-aliases">Path Aliases</a></li><li><a href="#provided-modules">Provided Modules</a><ol><li><a href="#%24app%2Fenv">$app/env</a></li><li><a href="#%24app%2Fnavigation">$app/navigation</a></li><li><a href="#%24app%2Fpaths">$app/paths</a></li><li><a href="#%24app%2Fstores">$app/stores</a></li><li><a href="#%24service-worker">$service-worker</a></li></ol></li><li><a href="#adapters">Adapters</a><ol><li><a href="#netlify-example">Netlify Example</a></li></ol></li></ol></nav></aside><article><h2 id="overview">Overview</h2><p>SvelteKit is a framework that leverages Svelte an is a replacement for previous framework Sapper. It is similar to Next for React and Nuxt for Vue.</p><p>The main features of SvelteKit are:</p><ul><li>file-based page routing</li><li>file-based endpoints (REST services)</li><li>layouts (ex. common page header, footer, and nav)</li><li>error page</li><li>code splitting for JS and CSS</li><li>page visits only load the JS and CSS they need</li><li>hot reloading (provided by Vite; very fast!)</li><li>static sites and individual static pages</li><li>CLI tool that provides:<ul><li>setup of TypeScript</li><li>setup of Sass or Less CSS preprocessors</li><li>setup of ESLint</li><li>setup of Prettier</li></ul></li><li>adapters for specific deployment targets</li></ul><h2 id="getting-started">Getting Started</h2><p>To create a new SvelteKit project:</p><ol><li><p>Install Node.js</p></li><li><p>Enter <code>npm init svelte@next [project-name]</code><br>Omit the project name to create a SvelteKit project in the current directory.</p></li><li><p>Answer the following question:</p><ul><li>Use TypeScript in components? defaults to no</li><li>What do you want to use for writing Styles in Svelte components? CSS (default), Less, or SCSS</li><li>Add ESLint for code listing? defaults to no</li><li>Add Prettier for code formatting? defaults to no</li></ul></li><li><p>Following instructions for next steps that are output.</p><ul><li>Enter <code>cd project-name</code></li><li>Enter <code>npm install</code></li></ul></li></ol><p>To run a SvelteKit project:</p><ol><li><p><code>cd</code> to the project root directory.</p></li><li><p>To run in development mode, enter <code>npm run dev</code><br>This provides watch and live reload. Optionally add options after <code>--</code>. The <code>--open</code> or <code>-o</code> option opens the app in the default web browser.<br>The <code>--port</code> or <code>-p</code> option specifies a port listen on which defaults to 3000.</p></li><li><p>To run the ESlint linter, enter <code>npm run lint</code></p></li><li><p>To run the Prettier code formatter, enter <code>npm run format</code></p></li></ol><h2 id="file-based-page-routing">File-based Page Routing</h2><p>TODO: Finish this</p><h2 id="file-based-endpoints-(rest-services)">File-based Endpoints (REST services)</h2><p>TODO: Finish this</p><h2 id="layouts">Layouts</h2><p>TODO: Finish this</p><h2 id="error-page">Error Page</h2><p>TODO: Finish this</p><h2 id="code-splitting">Code Splitting</h2><p>TODO: Finish this</p><h2 id="hot-module-reloading">Hot Module Reloading</h2><p>TODO: Finish this</p><h2 id="static-pages-and-sites">Static Pages and Sites</h2><p>TODO: Finish this</p><h2 id="tool-setup">Tool Setup</h2><p>Creation of a new SvelteKit project prompts for desired features. It asks the following questions:</p><p>&quot;Use TypeScript in components?&quot; This defaults to no.</p><p>&quot;What do you want to use for writing Styles in Svelte components?&quot; The options are CSS (default), Less, and SCSS.</p><p>&quot;Add ESLint for code listing?&quot; This defaults to no.</p><p>&quot;Add Prettier for code formatting?&quot; This defaults to no.</p><h2 id="path-aliases">Path Aliases</h2><p>SvelteKit provides directory aliases. These can only be used in import path strings. They are not variables.</p><p><code>$app</code> is used to import various modules described below.</p><p><code>$lib</code> is an alias to the <code>src/lib</code> directory. It is used to import your own source files without using relative paths.</p><h2 id="provided-modules">Provided Modules</h2><h3 id="%24app%2Fenv"><code>$app/env</code></h3><p>To use this module, import the desired items as follows:</p><p><code>import { amp, browser, dev } from '$app/env';</code></p><p><code>amp</code> is a boolean that indicates whether the app uses <a href="https://developers.google.com/amp?v=1.0.18" rel="noopener" target="_blank">Accelerated Mobile Pages (AMP)</a> created by Google.</p><p><code>browser</code> is a boolean that indicates whether the code is running in the browser. When the value is <code>false</code>, the code is running on the server.</p><p><code>dev</code> is a boolean that indicates whether the code is running in development mode. When the value is <code>false</code>, the code is running in production mode.</p><h3 id="%24app%2Fnavigation"><code>$app/navigation</code></h3><p>To use this module, import the desired items as follows:</p><p><code>import { goto, prefetch, prefetchRoutes } from '$app/navigation';</code></p><p><code>goto</code> is a function that programmatically navigates to a new route. This is preferred over setting <code>location.href</code>.</p><p><code>prefetch</code> is a function that programmatically prefetches the page at a given route. It can be called before calling <code>goto</code> to improve performance. This is appropriate when it can be anticipated that the user will want to go to the page soon. It is the same functionality that is triggered by hovering over a link that uses the <code>sveltekit:prefetch</code> attribute.</p><p><code>prefetchRoutes</code> is a function that programmatically prefetches a set of pages at given routes or all pages.</p><h3 id="%24app%2Fpaths"><code>$app/paths</code></h3><p>To use this module, import the desired items as follows:</p><p><code>import { base, assets } from '$app/paths';</code></p><p>These are directory paths that are relative to the root project directory. The default to that directory, but can be modified in <code>svelte.config.cjs</code> at the property paths <code>kit.paths.assets</code> and <code>kit.paths.base</code>. Changing these doesn't seem very useful.</p><h3 id="%24app%2Fstores"><code>$app/stores</code></h3><p>To use this module, import the desired items as follows:</p><p><code>import { getStores, navigating, page, session } from '$app/stores';</code></p><p><code>getStores</code> is a function that returns an object containing the other three values. This doesn't seem useful.</p><p><code>navigating</code> is a readable store whose value is <code>null</code> when not navigating and an object with <code>from</code> and <code>to</code> properties when navigating. TODO: Why does this seem to always be null?</p><p><code>page</code> is a readable store that holds the data passed to page <code>load</code> functions, including <code>host</code>, <code>path</code>, <code>params</code>, and <code>query</code> for getting information about a request.</p><p><code>session</code> is a writable store that holds session data. However, setting it doesn't not cause data to be persisted on the server. If desired, that must be implemented.</p><h3 id="%24service-worker"><code>$service-worker</code></h3><p>To use this module, import the desired items as follows:</p><p><code>import { build, files, timestamp } from '$service-worker';</code></p><p><code>build</code> is an array of URLs for the files generated by Vite. These files can be cached by calling <code>cache.addAll(build)</code>.</p><p><code>files</code> is an array of URLs for the files in directory specified by <code>kit.files.assets</code> in the <code>svelte.config.cjs</code> file which defaults to <code>static</code>.</p><p><code>timestamp</code> is the value of <code>Date.now()</code> (milliseconds) at build time. It can be used generate a unique cache name which enables invalidating the caches of subsequent deploys.</p><h2 id="adapters"><a name="adapter">Adapters</a></h2><p>The provided adapter targets currently include Node.js, static, Begin, Netlify, and Vercel. New SvelteKit projects default to using the Node adapter. To change the adapter, modify the <code>svelte.config.cjs</code> file.</p><h3 id="netlify-example">Netlify Example</h3><ul><li><p>cd to the root directory of a SvelteKit project.</p></li><li><p>Install the Netlify SvelteKit adapter with <code>npm install -D @sveltejs/adapter-netlify@next</code></p><p>This deploys SvelteKit endpoints as serverless functions in AWS without requiring an AWS account.</p></li><li><p>Edit <code>svelte.config.cjs</code></p><ul><li>Change the first line to the following:</li></ul><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> adapter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@sveltejs/adapter-netlify'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><ul><li><p>Change the &quot;adapter&quot; line to the following:</p><pre class="language-js"><code class="language-js">adapter<span class="token operator">:</span> <span class="token function">adapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></code></pre></li></ul></li><li><p>Create the file <code>netlify.toml</code> in the project root directory containing the following:</p><pre class="language-toml"><code class="language-toml"><span class="token punctuation">[</span><span class="token table class-name">build</span><span class="token punctuation">]</span><br><span class="token key property">command</span> <span class="token punctuation">=</span> <span class="token string">"npm run build"</span><br><span class="token key property">functions</span><span class="token punctuation">=</span><span class="token string">"functions/"</span><br><span class="token key property">publish</span><span class="token punctuation">=</span><span class="token string">"build/"</span></code></pre></li><li><p>Create a GitHub repository to hold the project files, add all the files, and push.</p></li><li><p>Create a Netlify account if you don't already have one.</p><p>Browse <a href="https://www.netlify.com">https://www.netlify.com</a> and click &quot;Sign up&quot;.</p></li><li><p>Login to your Netlify account.</p></li><li><p>Press the &quot;New site from Git&quot; button.</p></li><li><p>Press the &quot;GitHub&quot; button.</p></li><li><p>Select the repository created above.</p><p>If you configured your account to only provide access to selected repositories, click the &quot;Configure the Netlify app on GitHub&quot; link, click &quot;Configure&quot;, scroll down to &quot;Repository access&quot;, click the &quot;Select repositories&quot; drop down, search for the repository, select it, and press the &quot;Save&quot; button.</p></li><li><p>Verify the settings displayed (defaults should be fine) and press the &quot;Deploy site&quot; button.</p></li><li><p>Wait for deployment to complete and note its URL.</p></li><li><p>Browse the URL to run the app.</p></li></ul><p>Note: I was expecting each SvelteKit endpoint to show up as a separate Netlify function. But instead I see just one Netlify function named &quot;render&quot;. I know it's working because if I add a <code>console.log</code> in the code of each of my endpoints, push the changes, wait for it to be redeployed to Netlify, run the new version of app to trigger calls to the endpoints, and then click that &quot;render&quot; function in Netlify, I do see the expected output from the <code>console.log</code> calls. It seems odd that all the endpoints are bundled into one Netlify function.</p></article>