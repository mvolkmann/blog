<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Hono</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#projects">Projects</a></li><li><a href="#routes">Routes</a></li><li><a href="#context">Context</a></li><li><a href="#jsx">JSX</a></li><li><a href="#routers">Routers</a></li><li><a href="#crud-example">CRUD Example</a><ol><li><a href="#src%2Findex.ts">src/index.ts</a></li><li><a href="#public%2Fstyles.css">public/styles.css</a></li><li><a href="#src%2Fdog-router.tsx">src/dog-router.tsx</a></li><li><a href="#src%2Findex.test.ts">src/index.test.ts</a></li></ol></li><li><a href="#file-based-routing">File-based Routing</a></li><li><a href="#validation">Validation</a><ol><li><a href="#src%2Fdog-router.tsx-improved">src/dog-router.tsx Improved</a></li></ol></li><li><a href="#rpc">RPC</a></li><li><a href="#tests">Tests</a></li><li><a href="#performance">Performance</a></li></ol></nav></aside><article><style>img {
    border: 1px solid gray;
  }</style><p><img alt="Hono logo" style="border: none; width: 20%" src="/blog/assets/hono-logo.png?v=1.1.1" title="Hono logo"></p><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://hono.dev/?v=1.1.1" rel="noopener" target="_blank">Hono</a> is a JavaScript HTTP server library that runs in any JavaScript runtime. This includes AWS Lambda, Bun, Cloudflare Pages, Cloudflare Workers, Deno, Fastly, Lagon, Netlify, NextJS, Node.js, and Vercel.</p><p>&quot;Hon≈ç&quot; is the Japanese word for &quot;flame&quot; or &quot;blaze&quot; which explains its logo.</p><p>Hono is significantly faster than <a href="https://expressjs.com?v=1.1.1" rel="noopener" target="_blank">Express</a> which is the most popular HTTP library for Node.js.</p><p><a href="https://elysiajs.com?v=1.1.1" rel="noopener" target="_blank">Elysia</a> is a competitor to Hono. It has slightly better performance than Hono, but only runs in Bun.</p><h2 id="projects" tabindex="-1">Projects</h2><p>To create a new project that uses Hono, enter <code>npm create hono@latest</code> or <code>bunx create-hono</code>. This will prompt for:</p><ul><li>Target directory</li><li>Which template do you want to use?</li></ul><p>It will then run for almost a minute. Why so long? When it finishes, the target directory will be created and will contain the following files:</p><ul><li><code>README.md</code></li><li><code>package.json</code></li><li><code>src/index.ts</code></li><li><code>tsconfig.json</code></li></ul><p>Install the dependencies by entering <code>npm install</code> or <code>bun install</code>.</p><p>Run the project by entering <code>npm run dev</code> or <code>bun dev</code>.</p><p>By default, the server listens on port 3000. It also provides hot reloading.</p><h2 id="routes" tabindex="-1">Routes</h2><p>To define routes, create a <code>Hono</code> object and call the methods <code>get</code>, <code>post</code>, <code>put</code>, <code>patch</code>, <code>delete</code>, and <code>all</code> on it. Each of these methods take a URL path and a function that is passed a <code>Context</code> object.</p><p>For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/some/path'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">c</span><span class="token operator">:</span> Context</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token operator">...</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Path parameters are described in URL path strings as a name preceded by a colon. Optional parameters are followed by <code>?</code>. For example: <code>'/population/:state/:year?'</code>.</p><p>Path parameter names can also include a regular expression. For example: <code>'/population/:state{[0-9]*}'</code> TODO: When is this useful?</p><p>The callback functions passed to routes must return a <code>Response</code> object. This is typically done by returning the result of a call to <code>c.text</code>, <code>c.json</code>, or <code>c.html</code>.</p><p>It is also possible to override the route methods to simplify the code. For example instead of having the callback functions return a <code>Response</code> object, they could return a string (which could automatically use <code>c.text</code>), JSX (which could automatically use <code>c.html</code>), or any other kind of value (which could automatically use <code>c.json</code>). This idea is implemented in code found in the issue <a href="https://github.com/honojs/hono/issues/2037#issuecomment-1910957072?v=1.1.1" rel="noopener" target="_blank">endpoints returning raw values</a>.</p><h2 id="context" tabindex="-1">Context</h2><p>The <code>Context</code> object that is passed to routes has many properties and methods. The most useful properties are <code>req</code> (a <code>HonoRequest</code> object) and <code>res</code> (a <code>Response</code> object defined by the Fetch API).</p><p>The most useful methods on the <code>c.req</code> object are described in the following table.</p><table><thead><tr><th>Action</th><th>Code</th></tr></thead><tbody><tr><td>get value of request header</td><td><code>c.req.header('Some-Name')</code></td></tr><tr><td>get value of path parameter</td><td><code>c.req.param('some-name')</code></td></tr><tr><td>get value of query parameter</td><td><code>c.req.query('some-name')</code></td></tr><tr><td>get value of text body</td><td><code>const text = await c.req.text();</code></td></tr><tr><td>get <code>FormData</code> from body</td><td><code>const formData = await c.req.formData();</code></td></tr><tr><td>get property from <code>formData</code></td><td><code>const value = (formData.get('property') as string) || '';</code></td></tr><tr><td>get value of JSON body</td><td><code>const object = await c.req.json();</code></td></tr></tbody></table><p>The most useful methods on the <code>Context</code> object are described in the following table.</p><table><thead><tr><th>Action</th><th>Code</th></tr></thead><tbody><tr><td>set value of response header</td><td><code>c.header('Some-Name', 'some value');</code></td></tr><tr><td>set status code</td><td><code>c.status(someCode);</code></td></tr><tr><td>return text response</td><td><code>return c.text('some text');</code></td></tr><tr><td>return JSON response</td><td><code>return c.json(someObject);</code></td></tr><tr><td>return HTML response</td><td><code>return c.html(someHTML);</code></td></tr><tr><td>return &quot;Not Found&quot; error</td><td><code>return c.notFound();</code></td></tr><tr><td>redirect to another URL</td><td><code>return c.redirect('someURL');</code></td></tr></tbody></table><p>In the <code>c.html</code> method, <code>someHTML</code> is a string of HTML or JSX.</p><p>See the <a href="https://github.com/honojs/hono/issues/2037?v=1.1.1" rel="noopener" target="_blank">endpoints returning raw values</a> proposal.</p><p>To share values between routes, set them in one route with <code>c.set('someName', 'some value');</code> and get them other routes with <code>c.get('someName')</code>.</p><h2 id="jsx" tabindex="-1">JSX</h2><p>Hono supports using JSX to generate HTML responses. This is useful in conjunction with <a href="https://htmx.org?v=1.1.1" rel="noopener" target="_blank">htmx</a>.</p><p>IMPORTANT: Source files that use JSX must have a file extension of <code>.tsx</code>.</p><p>Verify that the following <code>compilerOptions</code> properties are present in <code>tsconfig.json</code>. They are by default in new Hono projects.</p><pre class="language-json"><code class="language-json"><span class="token property">"jsx"</span><span class="token operator">:</span> <span class="token string">"react-jsx"</span><span class="token punctuation">,</span><br><span class="token property">"jsxImportSource"</span><span class="token operator">:</span> <span class="token string">"hono/jsx"</span></code></pre><p>Remove the <code>jsxFragmentFactory</code> property if it is present.</p><h2 id="routers" tabindex="-1">Routers</h2><p>Hono includes <a href="https://hono.dev/concepts/routers?v=1.1.1" rel="noopener" target="_blank">five routers</a>. Typically the default router is fine and this information can be ignored.</p><p>The provided routers are:</p><ul><li><p><code>RegExpRouter</code></p><p>This performs regular expression matching for all routes. It is typically the fastest of the routers, but performance will be degrade if there are a large number defined routes.</p></li><li><p><code>TrieRouter</code></p><p>This router is much faster than Express, but not quite as fast as <code>RegExpRouter</code>. It supports some route path patterns that <code>RegExpRouter</code> does not support.</p></li><li><p><code>SmartRouter</code></p><p>This router selects between other routers at startup based on what it thinks will be the fastest for the configured routes.</p></li><li><p><code>LinearRouter</code></p><p>This router is best for environments such as edge functions where the application is initialized for every request because it performs route registration faster than <code>RegExpRouter</code>.</p></li><li><p><code>PatternRouter</code></p><p>This router is best for memory constrained environments.</p></li></ul><p>The default router is <code>SmartRouter</code> configured to select between <code>RegExpRouter</code> and <code>TrieRouter</code>.</p><p>To use a different router, pass one to the <code>Hono</code> constructor. For example:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>Hono<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>LinearRouter<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/router/linear-router'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">{</span>router<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">LinearRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Hono provides presets for selecting a router based on how <code>Hono</code> is imported. For example, <code>import {Hono} from '{somewhere}';</code></p><table><thead><tr><th>Import Hono From</th><th>Router Used</th></tr></thead><tbody><tr><td><code>'hono'</code></td><td><code>SmartRouter</code> selecting <code>RegExpRouter</code> or <code>TrieRouter</code></td></tr><tr><td><code>'hono/quick'</code></td><td><code>SmartRouter</code> selecting <code>LinearRouter</code> or <code>TrieRouter</code></td></tr><tr><td><code>'hono/tiny'</code></td><td><code>PatternRouter</code></td></tr></tbody></table><h2 id="crud-example" tabindex="-1">CRUD Example</h2><p>This example demonstrates implementing endpoints for CRUD operations on a collection of dogs. This code does not require any additional packages to be installed.</p><p><img alt="Hono dog app" style="width: 50%" src="/blog/assets/hono-dog-app.png?v=1.1.1"></p><h3 id="src%2Findex.ts" tabindex="-1">src/index.ts</h3><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>Hono<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>serveStatic<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/bun'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>logger<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/logger'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> dogRouter <span class="token keyword">from</span> <span class="token string">'./dog-router'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This logs all HTTP requests to the terminal where the server is running.</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/*'</span><span class="token punctuation">,</span> <span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This serves static files from the public directory.</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/*'</span><span class="token punctuation">,</span> <span class="token function">serveStatic</span><span class="token punctuation">(</span><span class="token punctuation">{</span>root<span class="token operator">:</span> <span class="token string">'./public'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">'/dog'</span><span class="token punctuation">,</span> dogRouter<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> app<span class="token punctuation">;</span></code></pre><p>The port on which the server listens defaults to 3000. To listen on a different port, say 1234, change the last line to the following.</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>port<span class="token operator">:</span> <span class="token number">1234</span><span class="token punctuation">,</span> fetch<span class="token operator">:</span> app<span class="token punctuation">.</span>fetch<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3 id="public%2Fstyles.css" tabindex="-1">public/styles.css</h3><pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span><br>  <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h3 id="src%2Fdog-router.tsx" tabindex="-1">src/dog-router.tsx</h3><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>Context<span class="token punctuation">,</span> Hono<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span><span class="token constant">FC</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/jsx'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">interface</span> <span class="token class-name">NewDog</span> <span class="token punctuation">{</span><br>  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">interface</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">NewDog</span> <span class="token punctuation">{</span><br>  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">let</span> lastId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br><br><span class="token comment">// The dogs are maintained in memory.</span><br><span class="token keyword">const</span> dogMap<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> Dog<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token operator">++</span>lastId<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">}</span><span class="token punctuation">;</span><br>  dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> dog<span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token string">'Whippet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This provides HTML boilerplate for any page.</span><br><span class="token keyword">const</span> Layout<span class="token operator">:</span> <span class="token function-variable function">FC</span> <span class="token operator">=</span> props <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>html<span class="token operator">></span><br>      <span class="token operator">&lt;</span>head<span class="token operator">></span><br>        <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"/styles.css"</span> <span class="token operator">/</span><span class="token operator">></span><br>        <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><br>      <span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// This returns JSX for a page that</span><br><span class="token comment">// list the dogs passed in a prop.</span><br><span class="token keyword">const</span> DogPage<span class="token operator">:</span> <span class="token function-variable function">FC</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>dogs<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token string">'Dogs I Know'</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>Layout title<span class="token operator">=</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><br>      <span class="token operator">&lt;</span>ul<span class="token operator">></span><br>        <span class="token punctuation">{</span>dogs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dog<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>          <span class="token operator">&lt;</span>li<span class="token operator">></span><br>            <span class="token punctuation">{</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">}</span> <span class="token keyword">is</span> a <span class="token punctuation">{</span>dog<span class="token punctuation">.</span>breed<span class="token punctuation">}</span><span class="token punctuation">.</span><br>          <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><br>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>Layout<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// This gets all the dogs as either JSON or HTML.</span><br>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> accept <span class="token operator">=</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Accept'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>accept <span class="token operator">&amp;&amp;</span> accept<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'application/json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">const</span> dogs <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span><br>    a<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>DogPage dogs<span class="token operator">=</span><span class="token punctuation">{</span>dogs<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This gets one dog by its id as JSON.</span><br>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This creates a new dog.</span><br>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> NewDog<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token function">addDog</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>name<span class="token punctuation">,</span> data<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This updates the dog with a given id.</span><br>router<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> NewDog<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    dog<span class="token punctuation">.</span>name <span class="token operator">=</span> data<span class="token punctuation">.</span>name<span class="token punctuation">;</span><br>    dog<span class="token punctuation">.</span>breed <span class="token operator">=</span> data<span class="token punctuation">.</span>breed<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This deletes the dog with a given id.</span><br>router<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token keyword">delete</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></code></pre><h3 id="src%2Findex.test.ts" tabindex="-1">src/index.test.ts</h3><p>This tests all the CRUD functionality. To run all the tests, enter <code>bun test</code>.</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>describe<span class="token punctuation">,</span> expect<span class="token punctuation">,</span> it<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'bun:test'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> app <span class="token keyword">from</span> <span class="token string">'.'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> comet <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'Comet'</span><span class="token punctuation">,</span> breed<span class="token operator">:</span> <span class="token string">'Whippet'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token constant">URL_PREFIX</span> <span class="token operator">=</span> <span class="token string">'http://localhost:3000/dog'</span><span class="token punctuation">;</span><br><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Accept'</span><span class="token punctuation">,</span> <span class="token string">'application/json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getDogById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">URL_PREFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span> <span class="token operator">?</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'dog endpoints'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should get all dogs'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>dogs<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>dogs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>comet<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should get one dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span> <span class="token operator">+</span> <span class="token string">'/1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>comet<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should create a dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span><br>      name<span class="token operator">:</span> <span class="token string">'Ramsay'</span><span class="token punctuation">,</span><br>      breed<span class="token operator">:</span> <span class="token string">'Native American Indian Dog'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span><br>      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">,</span><br>      headers<span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> newDog <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Verify that the dog was added.</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> foundDog <span class="token operator">=</span> dogs<span class="token punctuation">[</span>newDog<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>newDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>foundDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>newDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>foundDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should update a dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span><br>      name<span class="token operator">:</span> <span class="token string">'Fireball'</span><span class="token punctuation">,</span><br>      breed<span class="token operator">:</span> <span class="token string">'Greyhound'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span> <span class="token operator">+</span> <span class="token string">'/1'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      method<span class="token operator">:</span> <span class="token string">'PUT'</span><span class="token punctuation">,</span><br>      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">,</span><br>      headers<span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> updatedDog <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Verify that the dog was updated.</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> foundDog <span class="token operator">=</span> dogs<span class="token punctuation">[</span>updatedDog<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>foundDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>foundDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should delete a dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">URL_PREFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      method<span class="token operator">:</span> <span class="token string">'DELETE'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Verify that the dog was deleted.</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getDogById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>dogs<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="file-based-routing" tabindex="-1">File-based Routing</h2><p>Hono does not support file-based routing, but the addon package <a href="https://github.com/honojs/honox?v=1.1.1" rel="noopener" target="_blank">honox</a> does.</p><p>The following steps demonstrate using file-based routing with honox.</p><ol><li><p>Create a new project by entering <code>bun create hono@latest</code>.</p><p>For the template type, choose &quot;bun&quot;.</p></li><li><p>cd to the new project directory.</p></li><li><p>Enter <code>bun install</code>.</p></li><li><p>Enter <code>bun add honox</code>.</p></li><li><p>Enter <code>bun add -d vite</code>.</p></li><li><p>Create the file <code>vite.config.ts</code> containing the following:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> honox <span class="token keyword">from</span> <span class="token string">'honox/vite'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>defineConfig<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">honox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li><p>Rename the <code>src</code> directory to <code>app</code>.</p></li><li><p>Renamed <code>app/index.ts</code> to <code>app/server.ts</code>.</p></li><li><p>Replace the contents of <code>app/server.ts</code> with the following:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>showRoutes<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/dev'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>createApp<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'honox/server'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">showRoutes</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">default</span> app<span class="token punctuation">;</span></code></pre></li><li><p>Edit <code>package.json</code>.</p><p>Change <code>src/index.ts</code> to <code>app/server.ts</code> in the &quot;dev&quot; script.</p><p>TODO: Maybe this needs to use the <code>vite</code> command.</p></li><li><p>Create the directory <code>src/routes</code>.</p></li><li><p>Inside the new directory, create the files <code>_404.tsx</code>, <code>_error.tsx</code>, <code>_renderer.tsx</code>, and <code>index.tsx</code>.</p></li><li><p>Add the following in <code>src/routes/_404.tsx</code>:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>NotFoundHandler<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> handler<span class="token operator">:</span> <span class="token function-variable function">NotFoundHandler</span> <span class="token operator">=</span> c <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>h1<span class="token operator">></span>Sorry<span class="token punctuation">,</span> Not Found<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> handler<span class="token punctuation">;</span></code></pre></li><li><p>Add the following in <code>src/routes/_error.tsx</code>:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>ErrorHandler<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> handler<span class="token operator">:</span> <span class="token function-variable function">ErrorHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>h1<span class="token operator">></span>Error<span class="token operator">!</span> <span class="token punctuation">{</span>e<span class="token punctuation">.</span>message<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> handler<span class="token punctuation">;</span></code></pre></li><li><p>Add the following in <code>src/routes/_renderer.tsx</code>:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>jsxRenderer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/jsx-renderer'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">jsxRenderer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span>head<span class="token operator">></span><br>        <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">/</span><span class="token operator">></span><br>        <span class="token operator">&lt;</span>meta<br>          name<span class="token operator">=</span><span class="token string">"viewport"</span><br>          content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><br>        <span class="token operator">/</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><br>      <span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li><p>Add the following in <code>src/routes/index.tsx</code>:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Home</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Welcome<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Start the server by entering <code>bun dev</code>.</p><p>This gives me the error described in this <a href="https://github.com/honojs/honox/issues/38?v=1.1.1" rel="noopener" target="_blank">issue</a>.</p></li><li><p>Browse localhost:3000.</p></li></ol><h2 id="validation" tabindex="-1">Validation</h2><p>Hono supports validating the following kinds of request data passed to endpoints:</p><ul><li><code>cookie</code> to validate cookies</li><li><code>form</code> to validate form submissions</li><li><code>header</code> to validate request headers</li><li><code>json</code> to validate JSON in request bodies</li><li><code>param</code> to validate path parameters</li><li><code>query</code> to validate query parameter</li></ul><p>When validation fails, the response status code will be 400, indicating a bad request, and the response body will be a JSON object similar to the following that describes the validation error:</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"success"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>  <span class="token property">"error"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"issues"</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>      <span class="token punctuation">{</span><br>        <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"{description-of-error}"</span><span class="token punctuation">,</span><br>        <span class="token property">"path"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"{name-of-invalid-property}"</span><span class="token punctuation">]</span><br>        ... more properties describing the error ...<br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ZodError"</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The support for specifying validation criteria is quite basic. However, integration with <a href="/blog/topics/#/blog/zod" target="_blank">Zod</a>, can be installed for much better support.</p><p>To install a library that integrates Zod validation with Hono, enter <code>npm install @hono/zod-validator</code> or <code>bun add @hono/zod-validator</code>.</p><p>To make this library available in code, add the following imports:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>z<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zod'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>zValidator<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@hono/zod-validator'</span><span class="token punctuation">;</span></code></pre><p>To add validation to a route, add any number of calls to <code>zValidator</code> as additional arguments after the route path and before the handler function. Each call can validate a different kind of request data. For example, one can be for validating path parameters and another can be for validating the JSON request body.</p><p>The following code adds Zod validation to the dog endpoints that were defined earlier. Look for lines that contain &quot;Schema&quot; or &quot;Validator&quot;.</p><p>This code also captures the route objects and exports their types so they can be used in client code to call the endpoints using the RPC approach described in the next section.</p><h3 id="src%2Fdog-router.tsx-improved" tabindex="-1">src/dog-router.tsx Improved</h3><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>Context<span class="token punctuation">,</span> Hono<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span><span class="token constant">FC</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/jsx'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>z<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'zod'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>zValidator<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@hono/zod-validator'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">interface</span> <span class="token class-name">NewDog</span> <span class="token punctuation">{</span><br>  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">interface</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">NewDog</span> <span class="token punctuation">{</span><br>  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">let</span> lastId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br><br><span class="token comment">// The dogs are maintained in memory.</span><br><span class="token keyword">const</span> dogMap<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> Dog<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token operator">++</span>lastId<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">}</span><span class="token punctuation">;</span><br>  dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> dog<span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token string">'Whippet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This provides HTML boilerplate for any page.</span><br><span class="token keyword">const</span> Layout<span class="token operator">:</span> <span class="token function-variable function">FC</span> <span class="token operator">=</span> props <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>html<span class="token operator">></span><br>      <span class="token operator">&lt;</span>head<span class="token operator">></span><br>        <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"/styles.css"</span> <span class="token operator">/</span><span class="token operator">></span><br>        <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><br>      <span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// This returns JSX for a page that</span><br><span class="token comment">// list the dogs passed in a prop.</span><br><span class="token keyword">const</span> DogPage<span class="token operator">:</span> <span class="token function-variable function">FC</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>dogs<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token string">'Dogs I Know'</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>Layout title<span class="token operator">=</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><br>      <span class="token operator">&lt;</span>ul<span class="token operator">></span><br>        <span class="token punctuation">{</span>dogs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dog<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>          <span class="token operator">&lt;</span>li<span class="token operator">></span><br>            <span class="token punctuation">{</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">}</span> <span class="token keyword">is</span> a <span class="token punctuation">{</span>dog<span class="token punctuation">.</span>breed<span class="token punctuation">}</span><span class="token punctuation">.</span><br>          <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><br>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>Layout<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// This gets all the dogs as either JSON or HTML.</span><br><span class="token keyword">const</span> getAllRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> accept <span class="token operator">=</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Accept'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>accept <span class="token operator">&amp;&amp;</span> accept<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'application/json'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">const</span> dogs <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span><br>    a<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>DogPage dogs<span class="token operator">=</span><span class="token punctuation">{</span>dogs<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This gets one dog by its id as JSON.</span><br><span class="token keyword">const</span> idSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  id<span class="token operator">:</span> z<span class="token punctuation">.</span>coerce<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">positive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> idValidator <span class="token operator">=</span> <span class="token function">zValidator</span><span class="token punctuation">(</span><span class="token string">'param'</span><span class="token punctuation">,</span> idSchema<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> getOneRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> idValidator<span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This creates a new dog.</span><br><span class="token keyword">const</span> dogSchema <span class="token operator">=</span> z<br>  <span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>    id<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">positive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    breed<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">strict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no extra properties allowed</span><br><span class="token keyword">const</span> dogValidator <span class="token operator">=</span> <span class="token function">zValidator</span><span class="token punctuation">(</span><span class="token string">'json'</span><span class="token punctuation">,</span> dogSchema<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> createRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> dogValidator<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> NewDog<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token function">addDog</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>name<span class="token punctuation">,</span> data<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This updates the dog with a given id.</span><br><span class="token keyword">const</span> updateRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><br>  <span class="token string">'/:id'</span><span class="token punctuation">,</span><br>  idValidator<span class="token punctuation">,</span><br>  dogValidator<span class="token punctuation">,</span><br>  <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> NewDog<span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      dog<span class="token punctuation">.</span>name <span class="token operator">=</span> data<span class="token punctuation">.</span>name<span class="token punctuation">;</span><br>      dog<span class="token punctuation">.</span>breed <span class="token operator">=</span> data<span class="token punctuation">.</span>breed<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This deletes the dog with a given id.</span><br><span class="token keyword">const</span> deleteRoute <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">,</span> idValidator<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token keyword">delete</span> dogMap<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>dog <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">CreateType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> createRoute<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">DeleteType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> deleteRoute<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">GetAllType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> getAllRoute<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">GetOneType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> getOneRoute<span class="token punctuation">;</span><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UpdateType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> updateRoute<span class="token punctuation">;</span></code></pre><h2 id="rpc" tabindex="-1">RPC</h2><p>Hono can export the type definitions for routes that are based on the specified validators. These definitions can be used in client code to add type checking to endpoint calls that are made using the Hono client.</p><p>Route types were exported in the code in the previous section.</p><p>The following is an example of client code that uses the Hono client.</p><p>TODO: Why don't I get any type information in VS Code when using these routes?</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>CreateType<span class="token punctuation">,</span> DeleteType<span class="token punctuation">,</span> GetAllType<span class="token punctuation">,</span> UpdateType<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dog-router'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>hc<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/client'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token constant">URL_PREFIX</span> <span class="token operator">=</span> <span class="token string">'http://localhost:3000/'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> createClient <span class="token operator">=</span> <span class="token generic-function"><span class="token function">hc</span><span class="token generic class-name"><span class="token operator">&lt;</span>CreateType<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> deleteClient <span class="token operator">=</span> <span class="token generic-function"><span class="token function">hc</span><span class="token generic class-name"><span class="token operator">&lt;</span>DeleteType<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> getAllClient <span class="token operator">=</span> <span class="token generic-function"><span class="token function">hc</span><span class="token generic class-name"><span class="token operator">&lt;</span>GetAllType<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> updateClient <span class="token operator">=</span> <span class="token generic-function"><span class="token function">hc</span><span class="token generic class-name"><span class="token operator">&lt;</span>UpdateType<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Create a dog.</span><br>  <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> createClient<span class="token punctuation">.</span>dog<span class="token punctuation">.</span><span class="token function">$post</span><span class="token punctuation">(</span><br>    <span class="token punctuation">{</span><br>      json<span class="token operator">:</span> <span class="token punctuation">{</span><br>        name<span class="token operator">:</span> <span class="token string">'Ramsay'</span><span class="token punctuation">,</span><br>        breed<span class="token operator">:</span> <span class="token string">'Native American Indian Dog'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      headers<span class="token operator">:</span> <span class="token punctuation">{</span><br>        Accept<span class="token operator">:</span> <span class="token string">'application/json'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// Update a dog.</span><br>  res <span class="token operator">=</span> <span class="token keyword">await</span> updateClient<span class="token punctuation">.</span>dog<span class="token punctuation">[</span><span class="token string">':id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">$put</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>    param<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    json<span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token comment">// id: 1,</span><br>      name<span class="token operator">:</span> <span class="token string">'Fireball'</span><span class="token punctuation">,</span><br>      breed<span class="token operator">:</span> <span class="token string">'Greyhound'</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// Delete a dog.</span><br>  res <span class="token operator">=</span> <span class="token keyword">await</span> deleteClient<span class="token punctuation">.</span>dog<span class="token punctuation">[</span><span class="token string">':id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>$<span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token punctuation">{</span>param<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// Get all the dogs.</span><br>  res <span class="token operator">=</span> <span class="token keyword">await</span> getAllClient<span class="token punctuation">.</span>dog<span class="token punctuation">.</span><span class="token function">$get</span><span class="token punctuation">(</span><br>    <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      headers<span class="token operator">:</span> <span class="token punctuation">{</span><br>        Accept<span class="token operator">:</span> <span class="token string">'application/json'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dogs ='</span><span class="token punctuation">,</span> dogs<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The output from the code above is:</p><pre class="language-text"><code class="language-text">dogs = {<br>  "1": {<br>    id: 1,<br>    name: "Fireball",<br>    breed: "Greyhound",<br>  },<br>  "3": {<br>    id: 3,<br>    name: "Ramsay",<br>    breed: "Native American Indian Dog",<br>  },<br>}</code></pre><p>For more detail, see <a href="https://hono.dev/guides/rpc#rpc-client?v=1.1.1" rel="noopener" target="_blank">RPC/Client</a>.</p><h2 id="tests" tabindex="-1">Tests</h2><p>The following code in the file <code>src/index.test.ts</code> tests all the routes defined above. To run it, enter <code>bun test</code>.</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>describe<span class="token punctuation">,</span> expect<span class="token punctuation">,</span> it<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'bun:test'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> app <span class="token keyword">from</span> <span class="token string">'.'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> comet <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'Comet'</span><span class="token punctuation">,</span> breed<span class="token operator">:</span> <span class="token string">'Whippet'</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token constant">URL_PREFIX</span> <span class="token operator">=</span> <span class="token string">'http://localhost:3000/dog'</span><span class="token punctuation">;</span><br><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Accept'</span><span class="token punctuation">,</span> <span class="token string">'application/json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getDogById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">URL_PREFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span> <span class="token operator">?</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'dog endpoints'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should get all dogs'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>dogs<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>dogs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>comet<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should get one dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span> <span class="token operator">+</span> <span class="token string">'/1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>comet<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should create a dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span><br>      name<span class="token operator">:</span> <span class="token string">'Ramsay'</span><span class="token punctuation">,</span><br>      breed<span class="token operator">:</span> <span class="token string">'Native American Indian Dog'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span><br>      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">,</span><br>      headers<span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> newDog <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Verify that the dog was added.</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> foundDog <span class="token operator">=</span> dogs<span class="token punctuation">[</span>newDog<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>newDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>foundDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>newDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>foundDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should update a dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span><br>      name<span class="token operator">:</span> <span class="token string">'Fireball'</span><span class="token punctuation">,</span><br>      breed<span class="token operator">:</span> <span class="token string">'Greyhound'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token constant">URL_PREFIX</span> <span class="token operator">+</span> <span class="token string">'/1'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      method<span class="token operator">:</span> <span class="token string">'PUT'</span><span class="token punctuation">,</span><br>      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">,</span><br>      headers<span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> updatedDog <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Verify that the dog was updated.</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> foundDog <span class="token operator">=</span> dogs<span class="token punctuation">[</span>updatedDog<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>foundDog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>updatedDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>foundDog<span class="token punctuation">.</span>breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should delete a dog'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">URL_PREFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      method<span class="token operator">:</span> <span class="token string">'DELETE'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Verify that the dog was deleted.</span><br>    <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getDogById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAllDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">expect</span><span class="token punctuation">(</span>dogs<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="performance" tabindex="-1">Performance</h2><p>The following sites provide relevant benchmarks:</p><ul><li><p><a href="https://medium.com/deno-the-complete-reference/deno-express-vs-fastify-vs-oak-vs-hono-whos-runs-fastest-0657d791c17a?v=1.1.1" rel="noopener" target="_blank">Deno ‚Äî Express vs Fastify vs Oak vs Hono: Who‚Äôs runs fastest?</a></p><p>This shows Hono to be significantly faster than Fastify, Oak, and Express.</p></li><li><p><a href="https://medium.com/deno-the-complete-reference/bun-elysia-js-vs-hono-hello-world-b655a20f1f2b?v=1.1.1" rel="noopener" target="_blank">Bun: Elysia.js vs Hono</a></p><p>This concludes that &quot;Elysia is marginally faster than Hono, but the winning margin is negligible.&quot;</p></li><li><p><a href="https://github.com/delvedor/find-my-way?v=1.1.1" rel="noopener" target="_blank">find-my-way</a> is another HTTP library to consider. Some benchmarks show this to be considerably faster than Elysia and Hono.</p></li></ul></article>