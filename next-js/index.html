<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Next.js</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#getting-started">Getting Started</a></li><li><a href="#vs-code-tips">VS Code Tips</a></li><li><a href="#tailwind">Tailwind</a></li><li><a href="#import-aliases">Import Aliases</a></li><li><a href="#modifying-app">Modifying App</a></li><li><a href="#page-components">Page Components</a></li><li><a href="#non-page-components">Non-page Components</a></li><li><a href="#static-resources">Static Resources</a></li><li><a href="#client-vs.-server-components">Client vs. Server Components</a></li><li><a href="#css">CSS</a></li><li><a href="#event-handling">Event Handling</a></li><li><a href="#google-fonts">Google Fonts</a></li><li><a href="#fontawesome-icons">Fontawesome Icons</a></li><li><a href="#layouts">Layouts</a></li><li><a href="#page-generation">Page Generation</a></li><li><a href="#data-fetching">Data Fetching</a></li><li><a href="#react-suspense">React Suspense</a></li><li><a href="#data-caching">Data Caching</a></li><li><a href="#loading-pages">Loading Pages</a></li><li><a href="#error-pages">Error Pages</a></li><li><a href="#page-metadata">Page Metadata</a></li><li><a href="#links">Links</a></li><li><a href="#images">Images</a></li><li><a href="#router">Router</a></li><li><a href="#dynamic-routes">Dynamic Routes</a></li><li><a href="#not-found-pages">Not Found Pages</a></li><li><a href="#custom-types">Custom Types</a></li><li><a href="#generating-static-pages">Generating Static Pages</a></li><li><a href="#context-api-in-next.js">Context API in Next.js</a></li><li><a href="#route-handlers">Route Handlers</a></li><li><a href="#authentication">Authentication</a></li><li><a href="#environment-variables">Environment Variables</a></li><li><a href="#middleware">Middleware</a></li><li><a href="#rate-limiting">Rate Limiting</a></li><li><a href="#sitemaps">Sitemaps</a></li><li><a href="#example-app">Example App</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://nextjs.org?v=1.1.1" rel="noopener" target="_blank">Next.js</a> is a full-stack web framework built on React.</p><p>Next.js uses <a href="https://turbo.build/pack?v=1.1.1" rel="noopener" target="_blank">Turbopack</a> rather than Vite as its module bundler. Turbopack bills itself as the &quot;Rust-powered successor to Webpack&quot;. It claims to be 10 times faster than Vite and 700 times faster than Webpack.</p><p>Next.js supports the following features:</p><ul><li><p>server-side rendering (SSR)</p><p>This improves first render efficiency and search engine optimization (SEO). JavaScript is hydrated in the client.</p></li><li><p>static site generation (SSG) at build time and on request</p></li><li><p>code splitting</p></li><li><p>prefetching</p><p>In dev mode this occurs when hovering over a link. In prod mode this occurs for all links on a page when the page is loaded. To run in prod mode, enter <code>npm run build</code> and <code>npm run start</code>. The output of <code>npm run build</code> will indicate which pages are static, SSR, or SSG.</p></li><li><p>serverless functions</p></li></ul><p>Next.js requires Node.js 16.8 or later.</p><h2 id="getting-started" tabindex="-1">Getting Started</h2><p>To create a new Next.js project, enter <code>npx create-next-app@latest</code>. This will ask a series of questions and produce output similar to what is shown below.</p><pre class="language-text"><code class="language-text">npx create-next-app@latest<br>Need to install the following packages:<br>  create-next-app@13.4.13<br>Ok to proceed? (y)<br>✔ What is your project named? … todo<br>✔ Would you like to use TypeScript? … No / Yes<br>✔ Would you like to use ESLint? … No / Yes<br>✔ Would you like to use Tailwind CSS? … No / Yes<br>✔ Would you like to use `src/` directory? … No / Yes<br>✔ Would you like to use App Router? (recommended) … No / Yes<br>✔ Would you like to customize the default import alias? … No / Yes<br>Creating a new Next.js app in /Users/volkmannm/todo.<br><br>Using npm.<br><br>Initializing project with template: app-tw<br><br>Installing dependencies:<br>- react<br>- react-dom<br>- next<br>- typescript<br>- @types/react<br>- @types/node<br>- @types/react-dom<br>- tailwindcss<br>- postcss<br>- autoprefixer<br>- eslint<br>- eslint-config-next</code></pre><p>Cd to the new project directory. It will contain a <code>package.json</code> file that defines the following scripts:</p><pre class="language-json"><code class="language-json">    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"next dev"</span><span class="token punctuation">,</span><br>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"next build"</span><span class="token punctuation">,</span><br>    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"next start"</span><span class="token punctuation">,</span><br>    <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"next lint"</span></code></pre><p>To start a local web server for running the app, enter <code>npm run dev</code>. Then browse <code>localhost:3000</code>.</p><p>See the provided <code>README.md</code> file in each project for more detail.</p><h2 id="vs-code-tips" tabindex="-1">VS Code Tips</h2><p>The extension &quot;ES7+ React/Redux/React-Native snippets&quot; is quite useful. For example, the snippet &quot;tsrfc&quot; inserts the boilerplate code for a TypeScript React Functional Component which is the following when the filename is <code>Foo.tsx</code>:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><br><br>type Props <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">:</span> Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span>Foo<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>When using Tailwind, consider installing the extensions &quot;Tailwind CSS IntelliSense&quot; and &quot;Tailwind Fold&quot;.</p><h2 id="tailwind" tabindex="-1">Tailwind</h2><p>To configure the use of Tailwind in a Next.js project, see <a href="https://tailwindcss.com/docs/guides/nextjs?v=1.1.1" rel="noopener" target="_blank">Install Tailwind CSS with Next.js</a>. These steps should not be necessary if you opted into use of Tailwind when the project was created.</p><h2 id="import-aliases" tabindex="-1">Import Aliases</h2><p>Import statements can use paths that begin with the character <code>@</code> to specify a path that begins at the root of the project rather than being relative to the current directory. See <a href="https://nextjs.org/docs/app/building-your-application/configuring/absolute-imports-and-module-aliases#module-aliases?v=1.1.1" rel="noopener" target="_blank">Module Aliases</a>.</p><p>By default the file <code>tsconfig.json</code> contains the following:</p><pre class="language-json"><code class="language-json">    <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token property">"@/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./src/*"</span><span class="token punctuation">]</span><br>    <span class="token punctuation">}</span></code></pre><p>This enables imports from paths like <code>@app/api/some-name</code>. To remove the need for including a slash after <code>@</code>, modify the key in the <code>paths</code> object above to be <code>&quot;@*&quot;</code>. All imports on this page assume this has been done.</p><h2 id="modifying-app" tabindex="-1">Modifying App</h2><p>Begin by modifying <code>app/page.tsx</code> which is used to render the page at the <code>/</code> URL path.</p><h2 id="page-components" tabindex="-1">Page Components</h2><p>The &quot;app&quot; directory holds source files that define page components. The directory structure maps directly to the URLs used to access the pages.</p><p>To add a new page, create a directory in <code>app</code> whose name is the route name and create the file <code>page.tsx</code> inside that directory.</p><p>The file <code>app/page.tsx</code> defines the home page that is rendered for the <code>/</code> URL path.</p><p>While the file must have the name &quot;page&quot;, the name of the function that defines the page component should reflect the route name. For example, &quot;TodoPage&quot;. Adding the name suffix &quot;Page&quot; is often useful when TypeScript is being used because there will likely be a custom type named &quot;Page.</p><p>In React, unlike in Svelte, the JSX returned by a component can be split into related pieces by writing functions that return snippets of JSX. Often this makes the code easier to read and understand.</p><h2 id="non-page-components" tabindex="-1">Non-page Components</h2><p>Components used by page components can be defined in two places. Page-specific components can be defined in the same directory as the page that uses them. Components that can potentially be reused across multiple pages should be placed in a top-level directory named &quot;components&quot;.</p><h2 id="static-resources" tabindex="-1">Static Resources</h2><p>Static resources like images are typically placed in a top-level &quot;public&quot; directory. This directory can have subdirectories such as &quot;images&quot;.</p><h2 id="client-vs.-server-components" tabindex="-1">Client vs. Server Components</h2><p>In Next.js, React components are either server or client components. Server components are rendered on the server. Client components are pre-rendered on the server and hydrated on the client. Components are server components by default and become client components when they begin with <code>'use client';</code>.</p><p>Server components have faster initial load times and are better for search engine optimization (SEO).</p><p>Server components can:</p><ul><li>be async</li><li>fetch data using HTTP requests</li><li>access sensitive information such as non-public environment variables</li><li>use Node.js packages</li></ul><p>Client components can:</p><ul><li>handle DOM events (<code>onClick</code>, <code>onChange</code>, ...)</li><li>use provided hooks (<code>useEffect</code>, <code>useState</code>, <code>useContext</code>, ...)</li><li>use custom hooks that use the provided hooks</li><li>use browser-only APIs (such as accessing the <code>window</code> object)</li></ul><p>The functions that define client components cannot be <code>async</code>.</p><p>When a component needs to play both roles, it must be split into server and client components. Typically server component render client components, but the opposite is also supported.</p><p>For more detail, see <a href="https://nextjs.org/docs/getting-started/react-essentials?v=1.1.1" rel="noopener" target="_blank">React Essentials</a>.</p><h2 id="css" tabindex="-1">CSS</h2><p>The file <code>app/global.css</code> defines CSS rules that affect elements on all pages. This should be imported in <code>app/layout.tsx</code>.</p><p>One way to use vanilla CSS is to create a <code>.css</code> file for each component source file. For example, <code>Foo.tsx</code> can have a corresponding <code>Foo.css</code> file.</p><p>To attempt to scope CSS rules to the component:</p><ol><li><p>Add a <code>className</code> to the component root element that matches its name, but in lowercase. For example, <code>foo</code>.</p></li><li><p>Begin the selector of all rules in the <code>.css</code> file with that class name. For example:</p><pre class="language-css"><code class="language-css"><span class="token selector">.foo button</span> <span class="token punctuation">{</span><br>  <span class="token property">border-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span><br>  <span class="token property">border-width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">.foo span</span> <span class="token punctuation">{</span><br>  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li></ol><p>Newer browser versions can use <a href="https://caniuse.com/css-nesting?v=1.1.1" rel="noopener" target="_blank">CSS Nesting</a> to avoid having to repeat the root element CSS class name. For example:</p><pre class="language-css"><code class="language-css"><span class="token selector">.dog-component</span> <span class="token punctuation">{</span><br>  <span class="token selector">> button</span> <span class="token punctuation">{</span><br>    <span class="token property">border-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span><br>    <span class="token property">border-width</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  <span class="token selector">> span</span> <span class="token punctuation">{</span><br>    <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>To enable using CSS Nesting in conjunction with Tailwind:</p><ol><li>Enter <code>npm install -D postcss-nesting</code></li><li>Edit <code>postcss.config.js</code></li><li>Add the following line in the <code>plugins</code> object:</li></ol><pre class="language-js"><code class="language-js"><span class="token string-property property">'tailwindcss/nesting'</span><span class="token operator">:</span> <span class="token string">'postcss-nesting'</span><span class="token punctuation">,</span></code></pre><h2 id="event-handling" tabindex="-1">Event Handling</h2><p>To determine the TypeScript type of an event that is passed to an event handling function in VSCode, temporarily change the value of the event handling prop to be an anonymous function whose parameter is <code>e</code> and hover over it. The type will be displayed in a popup and can be copied.</p><p>For example, temporarily change <code>&lt;button onClick={handleClick}</code> to <code>&lt;button onClick={e =&gt; handleClick(e)}</code>.</p><h2 id="google-fonts" tabindex="-1">Google Fonts</h2><p>To use a Google Font, import it as follows:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>Borel<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/font/google'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> font <span class="token operator">=</span> <span class="token function">Borel</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token comment">// This allows a fallback font to be used until the</span><br>  <span class="token comment">// requested font has been loaded and can be swapped in.</span><br>  <span class="token literal-property property">display</span><span class="token operator">:</span> <span class="token string">'swap'</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">subsets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'latin'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>  <span class="token comment">// "Variable fonts" do not need to specify weights.</span><br>  <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token string">'400'</span> <span class="token comment">// can be an array of weight strings</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Specify the font on the element that should use it with <code>className={font.className}</code>.</p><h2 id="fontawesome-icons" tabindex="-1">Fontawesome Icons</h2><p>To use Fontawesome Icons:</p><ol><li>Install with <code>npm install react-icons</code></li><li>Import specific icons. For example, <code>import { FaYouTube, FaLaptop } from 'react-icons/fa';</code></li><li>Use as React components. For example, <code>&lt;FaLaptop /&gt;</code></li></ol><h2 id="layouts" tabindex="-1">Layouts</h2><p>The file <code>app/layout.tsx</code> defines the layout for all pages in the app. This renders the topmost HTML elements like <code>html</code>, <code>head</code>, and <code>body</code>. It is a good place to render a header, footer, and nav that should present on every page of the app. Site-wide fonts can also be configured here.</p><p>Additional <code>layout.tsx</code> files in page route directories define the layout for all pages at specific URL routes. These are nested inside the main layout.</p><h2 id="page-generation" tabindex="-1">Page Generation</h2><p>Next.js supports four kinds of page generation.</p><ul><li><p><a href="https://nextjs.org/docs/pages/building-your-application/rendering/client-side-rendering?v=1.1.1" rel="noopener" target="_blank">Client-side Rendering</a></p><p>CSR pages are generated on the client. These pages can perform data fetching in a <code>useEffect</code> hook or using the <code>useSWR</code> hook (&quot;stale-while-revalidate&quot;). Another way to indicate that a page should be rendered on the client is to begin the source file with <code>'use client';</code>.</p><p>This option is the least desirable for search engine optimization (SEO).</p></li><li><p><a href="https://nextjs.org/docs/pages/building-your-application/rendering/server-side-rendering?v=1.1.1" rel="noopener" target="_blank">Server Side Rendering (SSR)</a></p><p>SSR pages are dynamically generated on the server on <strong>every</strong> request. SSR is used for pages that export the function <code>getServerSideProps</code>. This function should return an object with the property <code>props</code> which provides data to the function that defines the component.</p><p>For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getServerSideProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Can fetch data here.</span><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> some<span class="token operator">-</span>data <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">MySSRPage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">props</span><span class="token operator">:</span> Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    some<span class="token operator">-</span><span class="token constant">JSX</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p><a href="https://nextjs.org/docs/pages/building-your-application/data-fetching/incremental-static-regeneration?v=1.1.1" rel="noopener" target="_blank">Incremental Static Regeneration (ISR)</a></p><p>ISR pages are statically generated when each page is requested instead of at build time. ISR is used for pages that export the function <code>getStaticProps</code>. This function should return an object with the property <code>props</code> which provides data to the function that defines the component. The object can optionally include a <code>revalidate</code> prop that specifies the number of seconds that the page can be cached before it will be recreated.</p><p>For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getStaticProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Can fetch data here.</span><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> some<span class="token operator">-</span>data <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">revalidate</span><span class="token operator">:</span> <span class="token number">60</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">MyISRPage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">props</span><span class="token operator">:</span> Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    some<span class="token operator">-</span><span class="token constant">JSX</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p><a href="https://nextjs.org/docs/pages/building-your-application/rendering/static-site-generation?v=1.1.1" rel="noopener" target="_blank">Static Site Generation (SSG)</a></p><p>SSG pages do not render any dynamic data and are generated at build time. This is preferred when possible and is the default when the criteria for the options above are not present.</p></li></ul><h2 id="data-fetching" tabindex="-1">Data Fetching</h2><p>Components can use the fetch API to send API requests. These can fetch data that is then presented in a page.</p><p>The following code is an example of a function that fetches data:</p><pre class="language-js"><code class="language-js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>Todo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'https://jsonplaceholder.typicode.com/todosx'</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// Throwing an error triggers the error boundary</span><br>  <span class="token comment">// defined in error.ts.</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Failed to fetch todos.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The <code>fetch</code> function can be passed a second argument that specifies options such as the HTTP method, request headers, and caching details. For example, passing <code>{ cache: 'no-store' }</code> disables caching of the response.</p><p>Functions like the one above can be defined in the source files of components that use them. They can also be defined in separate source files, often in the top-level &quot;lib&quot; directory, and imported where needed.</p><p>A server component can call a data fetching function as follows:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token literal-property property">todos</span><span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>To fetch data from multiple sources in parallel, call each of the data fetching functions without the <code>await</code> keyword so <code>Promise</code> objects are obtained. Then call <code>await Promise.all(promises)</code> where <code>promises</code> is an array of the promises.</p><h2 id="react-suspense" tabindex="-1">React Suspense</h2><p>To allow data from the first fetch call to render before data from the next fetch call is available, use React Suspense. For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> promise2 <span class="token operator">=</span> <span class="token function">getData2</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> data1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getData1</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">return</span> <span class="token punctuation">(</span><br>  <span class="token operator">&lt;</span><span class="token operator">></span><br>    <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span>data1<span class="token punctuation">.</span>someProperty<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><br>    <span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>p<span class="token operator">></span>loading data2<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">}</span><span class="token operator">></span><br>      <span class="token punctuation">{</span><span class="token comment">/* The Data2 component will render in place of the fallback content<br>          when promise2 resolves. */</span><span class="token punctuation">}</span><br>      <span class="token operator">&lt;</span>Data2 promise<span class="token operator">=</span><span class="token punctuation">{</span>promise2<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">></span><br>  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span><br><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="data-caching" tabindex="-1">Data Caching</h2><p>Sometimes it is convenient to call a data fetching function in multiple places. This will not result in duplicate fetches. Next.js will automatically cache the result of the first call and use it for the result of subsequent calls.</p><p>To cause cached results to expire after a given number of seconds, add an option to the <code>fetch</code> call. For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">next</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">revalidate</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>To cause all <code>fetch</code> calls made from a given page to expire after a given number of seconds, add the following:</p><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> revalidate <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span></code></pre><p>To manually control caching, use React's <code>cache</code> function. See <a href="https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#fetching-data-on-the-server-with-third-party-libraries?v=1.1.1" rel="noopener" target="_blank">Fetching data on the Server with third-party libraries</a>. This is especially useful when data is fetched in a way that does not use the <code>fetch</code> function.</p><h2 id="loading-pages" tabindex="-1">Loading Pages</h2><p>Page route directories that contain a <code>loading.tsx</code> file will render that while data is being loaded. This can be any content including only a spinner.</p><p>Page routes that have a <code>loading.tsx</code> file automatically use React Suspense to allow other content to render while waiting for a Promise to resolve.</p><p>For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">TodoLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>section<span class="token operator">></span><br>      <span class="token operator">&lt;</span>h2<span class="token operator">></span>The Todos page is loading<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>When testing loading functionality, it is useful to simulate long-running requests. The following function simplifies this. Just call <code>await sleep(1000);</code> before sending a fetch request.</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">ms</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=></span><br>  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="error-pages" tabindex="-1">Error Pages</h2><p>Error pages are rendered when an error is thrown from a page component. A common example is errors that occur when fetching data.</p><p>Error pages wrap the page in a &quot;React Error Boundary&quot; and must be written in a specific way that differs from normal components. See <a href="https://nextjs.org/docs/app/building-your-application/routing/error-handling?v=1.1.1" rel="noopener" target="_blank">Error Handling</a>.</p><p>Source files for error pages must begin with <code>'use client';</code>.</p><h2 id="page-metadata" tabindex="-1">Page Metadata</h2><p>To add static metadata such as title and description to a page:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> type <span class="token punctuation">{</span>Metadata<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token literal-property property">metadata</span><span class="token operator">:</span> Metadata <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'some title'</span><span class="token punctuation">,</span> <span class="token comment">// results in &lt;title> in &lt;head></span><br>  <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">'some description'</span> <span class="token comment">// results in &lt;meta> in &lt;head></span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Older versions of Next.js used <code>head.tsx</code> files to specify these. These define a component that renders a fragment containing elements to add as children of the <code>&lt;head&gt;</code> element.</p><p>To add dynamic metadata, export the function <code>generateMetadata</code>. For example:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">generateMetadata</span><span class="token punctuation">(</span><span class="token punctuation">{</span>params<span class="token punctuation">,</span> searchParams<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// getData is an API function you must write and import.</span><br>  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span><br>    title<span class="token operator">:</span> data<span class="token punctuation">.</span>title<br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="links" tabindex="-1">Links</h2><p>To add hyperlinks to a page:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'next/link'</span><span class="token punctuation">;</span><br><br><span class="token operator">&lt;</span>Link href<span class="token operator">=</span><span class="token string">"some-url"</span><span class="token operator">></span>link text<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span><span class="token punctuation">;</span></code></pre><p>To add query parameters to a URL, consider using <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams?v=1.1.1" rel="noopener" target="_blank">URLSearchParams</a>.</p><p>To prevent prefetching of the <code>Link</code> target, add <code>prefetch={false}</code>.</p><h2 id="images" tabindex="-1">Images</h2><p>Next.js provides an <a href="https://nextjs.org/docs/app/building-your-application/optimizing/images?v=1.1.1" rel="noopener" target="_blank">Image</a> component that optimizes images. This should be used in place of the HTML <code>img</code> element. For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Image <span class="token keyword">from</span> <span class="token string">'next/image'</span><span class="token punctuation">;</span><br><span class="token operator">...</span><br><span class="token operator">&lt;</span>Image src<span class="token operator">=</span><span class="token punctuation">{</span>someImageURL<span class="token punctuation">}</span> alt<span class="token operator">=</span><span class="token string">"some description"</span> <span class="token operator">/</span><span class="token operator">></span></code></pre><p>For other supported props, see <a href="https://nextjs.org/docs/app/api-reference/components/image?v=1.1.1" rel="noopener" target="_blank"><image></image></a>.</p><p>The npm package <a href="https://www.npmjs.com/package/sharp?v=1.1.1" rel="noopener" target="_blank">sharp</a> is used to &quot;convert large images in common formats to smaller, web-friendly JPEG, PNG, WebP, GIF and AVIF images of varying dimensions.&quot; TODO: Should this be used in conjunction with the <code>Image</code> component?</p><p>To use this, install it with <code>npm install sharp</code> and import it with <code>import sharp;</code>.</p><h2 id="router" tabindex="-1">Router</h2><p>The <code>useRouter</code> hook creates a router object. Call the <code>push</code> method on the router, passing it a URL, for for programmatic navigation. This can only be used in client components.</p><p>For example:</p><pre class="language-js"><code class="language-js"><span class="token string">'use client'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>useRouter<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/navigation'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">BlogButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">function</span> <span class="token function">goToBlog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'https://mvolkmann.github.io/blog/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"button"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>goToBlog<span class="token punctuation">}</span><span class="token operator">></span><br>      My Blog<br>    <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The router object also has the methods <code>back</code>, <code>forward</code>, <code>prefetch</code>, <code>refresh</code>, and <code>replace</code>.</p><h2 id="dynamic-routes" tabindex="-1">Dynamic Routes</h2><p>Dynamic routes are pages whose URLs contain path parameters that are used to render the page. For example, the path parameter can be the ID of an object whose data should be rendered.</p><p>Path parameters are represented in the directory structure below the <code>app</code> directory with directories whose names begin with <code>[</code> and end with <code>]</code>. The name between the square brackets is the parameter name.</p><p>For example, suppose we want to render the todo with a given id using the URL <code>/todo/{id}</code>. We would create the directory <code>app/todo/[id]</code> and create the file <code>page.tsx</code> inside it. The follow code could be in this file:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'next/link'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>getTodos<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@lib/apis'</span><span class="token punctuation">;</span><br><br>type Props <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">id</span><span class="token operator">:</span> number<br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">TodoPage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token literal-property property">todos</span><span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// The param properties are always strings.</span><br>  <span class="token keyword">const</span> number <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> todo <span class="token operator">=</span> todos<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=></span> t<span class="token punctuation">.</span>id <span class="token operator">===</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>section<span class="token operator">></span><br>      <span class="token operator">&lt;</span>h1<span class="token operator">></span>Todo<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><br>      <span class="token operator">&lt;</span>p<span class="token operator">></span>Id<span class="token operator">:</span> <span class="token punctuation">{</span>todo<span class="token punctuation">.</span>id<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><br>      <span class="token operator">&lt;</span>p<span class="token operator">></span>Title<span class="token operator">:</span> <span class="token punctuation">{</span>todo<span class="token operator">?.</span>title <span class="token operator">??</span> <span class="token string">'missing title'</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><br>      <span class="token operator">&lt;</span>p<span class="token operator">></span>Completed<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token function">String</span><span class="token punctuation">(</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><br>      <span class="token operator">&lt;</span>Link href<span class="token operator">=</span><span class="token string">"/todos"</span><span class="token operator">></span>Back<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="not-found-pages" tabindex="-1">Not Found Pages</h2><p>The return value of the <code>notFound</code> function can be returned from a component when data it needs is not found. This provides a default 404 page that just says &quot;404 | This page could not be found.&quot; For example, suppose we can't find a todo item with a specific id. We could handle that as follows:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> notFound <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/navigation'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> getTodos <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@lib/apis'</span><span class="token punctuation">;</span><br><br>type Props <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">id</span><span class="token operator">:</span> number<br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">TodoPage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token operator">:</span> Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// params properties are always strings.</span><br>  <span class="token keyword">const</span> number <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token literal-property property">todos</span><span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> todo <span class="token operator">=</span> todos<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=></span> t<span class="token punctuation">.</span>id <span class="token operator">===</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>todo<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">notFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">...</span> content when found <span class="token operator">...</span><br>  <span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>To provide a custom 404 page, create the file <code>not-found.tsx</code>. This supports having a different 404 page for each route. For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">'next/link'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>div<span class="token operator">></span><br>      <span class="token operator">&lt;</span>h2<span class="token operator">></span>Out <span class="token keyword">of</span> luck today<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">></span><br>      <span class="token operator">&lt;</span>Link href<span class="token operator">=</span><span class="token string">"/todos"</span><span class="token operator">></span><br>        <span class="token operator">&lt;</span>span className<span class="token operator">=</span><span class="token string">"button"</span><span class="token operator">></span>Back to List<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="custom-types" tabindex="-1">Custom Types</h2><p>Custom TypeScript types can be defined in many places. One option is to create the top-level file <code>types.d.ts</code> and define all custom types used by a project there.</p><p>The file <code>tsconfig.json</code> specifies files that should be automatically imported in the <code>&quot;include&quot;</code> option. By default this includes <code>**/*.ts</code>, but this can be modified for each project. With the default setting, <code>types.d.ts</code> is automatically imported. Any source file in the project can use the types defined there without importing them. However, code editors may not recognized the types as being defined unless they are imported.</p><h2 id="generating-static-pages" tabindex="-1">Generating Static Pages</h2><p>To generate static pages (SSG) that use path parameters at build time, define and export the <a href="https://nextjs.org/docs/app/api-reference/functions/generate-static-params?v=1.1.1" rel="noopener" target="_blank">generateStaticParams</a> function. This only works if the <code>dynamicParams</code> configuration option is set to <code>true</code>, which it is by default.</p><p>The <code>generateStaticParams</code> function should return an array of objects that are the props required by the page component. A static page will be generated corresponding to each of the objects.</p><p>The generated pages can still be generated again at runtime using the <code>revalidate</code> option described in the &quot;Data Fetching&quot; section.</p><h2 id="context-api-in-next.js" tabindex="-1">Context API in Next.js</h2><p>The React Context API is a great option for sharing data across multiple React components. While it isn't particularly easy to configure, it requires far less code than using other React state management approaches such as Redux.</p><p>The first step in using the Context API in a Next.js application is to create a source file that creates and exports two things.</p><p>The first export is a component that takes a <code>children</code> prop and renders it inside a custom context provider.</p><p>The second export is a function that calls <code>useContext</code>, passing it a custom context. This second export is not strictly necessary, but it simplifies the code in components that need access to the context data.</p><p>React hooks can only be used in client components. That includes the <code>useContext</code> hook.</p><p>The following is an example of a file described above, named <code>dog-context.tsx</code>. It is recommended to create a <code>context</code> directory inside the <code>app</code> directory and store this file there.</p><pre class="language-text"><code class="language-text">'use client';<br><br>import {createContext, ReactNode, useContext, useState} from 'react';<br><br>interface DogData {<br>  breed: string;<br>  name: string;<br>  setBreed: (breed: string) => void;<br>  setName: (name: string) => void;<br>}<br><br>const DogContext = createContext<dogdata>({<br>  breed: '',<br>  name: '',<br>  setBreed: string => {},<br>  setName: string => {}<br>});<br><br>interface Props {<br>  children: ReactNode;<br>}<br><br>export const DogContextProvider = ({children}: Props) => {<br>  const [breed, setBreed] = useState('Whippet');<br>  const [name, setName] = useState('Comet');<br><br>  return (<br>    &lt;DogContext.Provider value={{breed, name, setBreed, setName}}&gt;<br>      {children}<br>    &lt;/DogContext.Provider&gt;<br>  );<br>};<br><br>export const useDogContext = () => useContext(DogContext);</dogdata></code></pre><p>The second step is to use the custom provider in some client component at a location in the component hierarchy such that no components above it need the context data and all components below it have the option to use the context data. A good choice is to select one of the <code>layout.tsx</code> files. Choosing the topmost <code>layout.tsx</code> makes the context data available throughout the app.</p><p>The following code from the top-level <code>layout.tsx</code> demonstrates configuring a custom provider:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">'./globals.css'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>DogContextProvider<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/context/dog-context'</span><span class="token punctuation">;</span><br><br>type Props <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">children</span><span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode<span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">RootLayout</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">:</span> Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span>body<span class="token operator">></span><br>        <span class="token operator">&lt;</span>DogContextProvider<span class="token operator">></span><br>          <span class="token operator">&lt;</span>h1<span class="token operator">></span>My App Title<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><br>          <span class="token punctuation">{</span>children<span class="token punctuation">}</span><br>        <span class="token operator">&lt;</span><span class="token operator">/</span>DogContextProvider<span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>The third step is to use the context function in every component that needs to access the data.</p><p>Here is an example of a component the only reads the data: It could of course render additional JSX.</p><pre class="language-js"><code class="language-js"><span class="token string">'use client'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>useDogContext<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/context/dog-context'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span>breed<span class="token punctuation">,</span> name<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useDogContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>section<span class="token operator">></span><br>      <span class="token operator">&lt;</span>p<span class="token operator">></span><br>        Dog <span class="token punctuation">{</span>name<span class="token punctuation">}</span> is a <span class="token punctuation">{</span>breed<span class="token punctuation">}</span><span class="token punctuation">.</span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Here is an example of a component the modifies the data. It could of course render additional JSX.</p><pre class="language-js"><code class="language-js"><span class="token string">'use client'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>useDogContext<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/context/dog-context'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">DogManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span>setBreed<span class="token punctuation">,</span> setName<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useDogContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token function">setBreed</span><span class="token punctuation">(</span><span class="token string">'Beagle'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">'Snoopy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token operator">&lt;</span>section<span class="token operator">></span><br>      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span>Change Dog<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="route-handlers" tabindex="-1">Route Handlers</h2><p>REST APIs can be implemented by defining <a href="https://nextjs.org/docs/app/building-your-application/routing/route-handlers?v=1.1.1" rel="noopener" target="_blank">route handlers</a>. These can export any of the following functions: <code>DELETE</code>, <code>GET</code>, <code>HEAD</code>, <code>OPTIONS</code>, <code>PATCH</code>, <code>POST</code>, and <code>PUT</code>.</p><p>Like page routes, the directory structure defines the URL paths that will be used to send HTTP requests.</p><p>For each server route, create a directory under <code>app/api</code> and create a source file named <code>route.ts</code> in the directory.</p><p>Since the code in these files runs on the server, they can import and use Node.js packages. For example, the <code>fs</code> package can be used to read and write to the file system.</p><p>Directory names beginning with <code>[</code> and ending with <code>]</code> can be used to capture path parameters.</p><p>For example, the code below is in the directory <code>app/api/dogs</code> which has the subdirectory <code>[name]</code>. The file <code>dog.ts</code> maintains the collection of dogs and exports functions to perform all the CRUD operations. The file <code>route.ts</code> defines handlers for getting all the dogs, adding a new dog, and updating an existing dog. The file <code>[name]/route.ts</code> defines handlers for getting a specific dog and deleting a specific dog.</p><p>To get all the dogs, send a GET request to <code>http://localhost:3000/api/dogs</code>.</p><p>To get the dog with a given name, send a GET request to <code>http://localhost:3000/api/dogs/Comet</code> where Comet is a dog name.</p><p>To add a dog, send a POST request to <code>http://localhost:3000/api/dogs</code> with a JSON body like <code>{ &quot;name&quot;: &quot;Snoopy&quot;, &quot;breed&quot;: &quot;Beagle&quot; }</code>.</p><p>To update an existing dog, send a PUT request to <code>http://localhost:3000/api/dogs</code> with a JSON body like <code>{ &quot;name&quot;: &quot;Snoopy&quot;, &quot;breed&quot;: &quot;Great Dane&quot; }</code>.</p><p>To delete an existing dog, send a DELETE request to <code>http://localhost:3000/api/dogs/Snoopy</code> where &quot;Snoopy&quot; is the name of the dog to delete.</p><pre class="language-js"><code class="language-js"><span class="token comment">// app/api/dogs/dogs.ts</span><br><span class="token keyword">export</span> type Dog <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">,</span><br>  <span class="token literal-property property">breed</span><span class="token operator">:</span> string<br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">let</span> <span class="token literal-property property">dogs</span><span class="token operator">:</span> Dog<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token literal-property property">breed</span><span class="token operator">:</span> <span class="token string">'whippet'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Maisey'</span><span class="token punctuation">,</span> <span class="token literal-property property">breed</span><span class="token operator">:</span> <span class="token string">'Treeing Walker Coonhound'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token literal-property property">breed</span><span class="token operator">:</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Ramsay'</span><span class="token punctuation">,</span> <span class="token literal-property property">breed</span><span class="token operator">:</span> <span class="token string">'Native American Indian Dog'</span><span class="token punctuation">}</span><br><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dog</span><span class="token operator">:</span> Dog</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  dogs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deleteDog</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">name</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogs<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=></span> d<span class="token punctuation">.</span>name <span class="token operator">===</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> dogs <span class="token operator">=</span> dogs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=></span> d<span class="token punctuation">.</span>name <span class="token operator">!==</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getDogs</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> dogs<span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getDog</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">name</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> dogs<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=></span> d<span class="token punctuation">.</span>name <span class="token operator">===</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">updateDog</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dog</span><span class="token operator">:</span> Dog</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span>breed<span class="token punctuation">,</span> name<span class="token punctuation">}</span> <span class="token operator">=</span> dog<span class="token punctuation">;</span><br>  <span class="token keyword">const</span> existingDog <span class="token operator">=</span> dogs<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=></span> d<span class="token punctuation">.</span>name <span class="token operator">===</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>existingDog<span class="token punctuation">)</span> existingDog<span class="token punctuation">.</span>breed <span class="token operator">=</span> breed<span class="token punctuation">;</span><br>  <span class="token keyword">return</span> existingDog<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// app/api/dogs/route.ts</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>addDog<span class="token punctuation">,</span> getDogs<span class="token punctuation">,</span> updateDog<span class="token punctuation">,</span> type Dog<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dogs'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">request</span><span class="token operator">:</span> Request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token function">getDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dogs<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">POST</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">request</span><span class="token operator">:</span> Request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token literal-property property">dog</span><span class="token operator">:</span> Dog <span class="token operator">=</span> <span class="token keyword">await</span> request<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token function">addDog</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">PUT</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">request</span><span class="token operator">:</span> Request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token literal-property property">dog</span><span class="token operator">:</span> Dog <span class="token operator">=</span> <span class="token keyword">await</span> request<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">updateDog</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// app/api/dogs/[name]/route.ts</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>deleteDog<span class="token punctuation">,</span> getDog<span class="token punctuation">,</span> type Dog<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../dogs'</span><span class="token punctuation">;</span><br><br>type Props <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">DELETE</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">request</span><span class="token operator">:</span> Request<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">deleteDog</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> status <span class="token operator">=</span> result <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">request</span><span class="token operator">:</span> Request<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token function">getDog</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>For API routes that use query parameters, they can be obtained as follows:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span>searchParams<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> name <span class="token operator">=</span> searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="authentication" tabindex="-1">Authentication</h2><p>The <a href="https://next-auth.js.org?v=1.1.1" rel="noopener" target="_blank">NextAuth.js</a> library makes it very easy to add authentication using any of the following OAuth providers: Apple, Facebook, Google. Password-less email authentication is also supported.</p><p>To install this, enter <code>npm install next-auth</code>.</p><p>To configure the providers to be used, create the file <code>app/api/auth/[...nextauth].js</code> containing code like the following:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> NextAuth <span class="token keyword">from</span> <span class="token string">'next-auth'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> GithubProvider <span class="token keyword">from</span> <span class="token string">'next-auth/providers/github'</span><span class="token punctuation">;</span><br><span class="token comment">// Import additional providers here.</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>getProviders<span class="token punctuation">,</span> signIn<span class="token punctuation">,</span> signOut<span class="token punctuation">,</span> useSession<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next-auth/react'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">const</span> authOptions <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">providers</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>    <span class="token function">GithubProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>      <span class="token literal-property property">clientId</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GITHUB_ID</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">clientSecret</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GITHUB_SECRET</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>    <span class="token comment">// Configure additional providers here.</span><br>  <span class="token punctuation">]</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">NextAuth</span><span class="token punctuation">(</span>authOptions<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>To render the UI for sign in, create a component with code like the following:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>providers<span class="token punctuation">,</span> setProviders<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">setProviders</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getProviders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token function">setProviders</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token function">setProviders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token operator">...</span><br><br><span class="token punctuation">{</span>providers <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>providers<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">provider</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>  <span class="token operator">&lt;</span>button<br>    key<span class="token operator">=</span><span class="token punctuation">{</span>provider<span class="token punctuation">.</span>name<span class="token punctuation">}</span><br>    onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">signIn</span><span class="token punctuation">(</span>provider<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span><br>    type<span class="token operator">=</span><span class="token string">"button"</span><br>  <span class="token operator">></span><br>    Sign In<br>  <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><br><span class="token punctuation">)</span><span class="token punctuation">}</span></code></pre><h2 id="environment-variables" tabindex="-1">Environment Variables</h2><p>To provide environment variables to a Next.js app, define them in the file <code>.env.local</code> in the root project directory. See <a href="https://nextjs.org/docs/app/building-your-application/configuring/environment-variables?v=1.1.1" rel="noopener" target="_blank">Environment Variables</a>.</p><p>The default <code>.gitignore</code> file in Next.js apps includes this file, so it will not be committed.</p><p>Environment variables whose names that begin with &quot;NEXT_PUBLIC_&quot; are available in both client and server code. Other variables are only available in server code.</p><p>For example, suppose the following is in <code>.env.local</code>:</p><pre class="language-text"><code class="language-text">DB_HOST=somehost<br>DB_USER=someuser<br>DB_PASS=somepswd<br>NEXT_PUBLIC_DOG=Comet</code></pre><p>Suppose the following code is in a <code>page.tsx</code> file:</p><pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DB_PASS ='</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">DB_PASS</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DOG ='</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NEXT_PUBLIC_DOG</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>When this code runs on the server, both values will print. When this code runs on the client, <code>DB_PASS</code> will be undefined, but <code>NEXT_PUBLIC_DOG</code> will print.</p><p>It is safe to use this for API keys and other secrets as long as names do not begin with <code>NEXT_PUBLIC_</code>.</p><h2 id="middleware" tabindex="-1">Middleware</h2><p>Next.js supports defining <a href="https://nextjs.org/docs/app/building-your-application/routing/middleware?v=1.1.1" rel="noopener" target="_blank">middleware</a> that runs before API calls are processed.</p><p>Each Next.js app can include one <code>middleware.ts</code> file in the project root directory which is typically the <code>src</code> directory.</p><p>The middleware can do many things including:</p><ul><li>access and set cookies</li><li>add request headers</li><li>return a response and bypass the intended URL</li><li>redirect to a different URL</li></ul><p>The middleware runs on every request including requests for static assets (like images), requests for client-side files, and API requests. To configure the middleware to only run on certain request paths, export a <code>config</code> object. The example below configures it to only run for API requests.</p><p>By default, all API routes only accept requests from the same origin as the Next.js app due to CORS restrictions. The example below configures CORS so domains other than the one where the app is deployed can send API requests. The allowed origins can differ based on whether we are running in production or development mode.</p><pre class="language-js"><code class="language-js"><span class="token comment">// src/middleware.ts</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>type NextRequest<span class="token punctuation">,</span> NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> allowedOrigins <span class="token operator">=</span><br>  process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><br>    <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token string">'http://www.mysite.com'</span><span class="token punctuation">,</span> <span class="token string">'https://mysite.com'</span><span class="token punctuation">]</span><br>    <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span> <span class="token string">'https://www.google.com'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// for testing CORS</span><br><br><span class="token comment">// This function can optionally be async.</span><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">middleware</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">request</span><span class="token operator">:</span> NextRequest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span>headers<span class="token punctuation">,</span> method<span class="token punctuation">,</span> nextUrl<span class="token punctuation">,</span> url<span class="token punctuation">}</span> <span class="token operator">=</span> request<span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> origin <span class="token operator">=</span> headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'origin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// method is GET, POST, PUT, or DELETE.</span><br>  <span class="token comment">// url is a string like "http://localhost:3000/api/dogs".</span><br>  <span class="token comment">// origin can be null or a string like "http://localhost:3000".</span><br>  <span class="token comment">// nextURL is a URL object w/ many properties.</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'middleware:'</span><span class="token punctuation">,</span> method<span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token string">'from'</span><span class="token punctuation">,</span> origin<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token comment">// This enforces CORS restrictions.</span><br>  <span class="token comment">// In production mode you may want to add "|| !origin"</span><br>  <span class="token comment">// to block access from tools like Postman or Thunder Client.</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>origin <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>allowedOrigins<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NextResponse</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">statusText</span><span class="token operator">:</span> <span class="token string">'Bad Request'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// Proceed to intended URL.</span><br>  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// Only run the middleware for API requests.</span><br><span class="token keyword">export</span> <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Can specify an array of paths.</span><br>  <span class="token comment">// Each path can be a regular expression.</span><br>  <span class="token literal-property property">matcher</span><span class="token operator">:</span> <span class="token string">'/api/:path*'</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Create the following file which exports a function that simplifies creating responses that include the headers required to support CORS:</p><pre class="language-js"><code class="language-js"><span class="token comment">// src/api/cors.ts</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">jsonCorsResponse</span><span class="token punctuation">(</span><br>  <span class="token parameter"><span class="token literal-property property">request</span><span class="token operator">:</span> Request<span class="token punctuation">,</span><br>  <span class="token literal-property property">object</span><span class="token operator">:</span> Object <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">status</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">200</span></span><br><span class="token punctuation">)</span><span class="token operator">:</span> NextResponse <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> origin <span class="token operator">=</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'origin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> body <span class="token operator">=</span> object <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NextResponse</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token comment">// '*' allows tools like Postman and Thunder Client to send requests.</span><br>      <span class="token string-property property">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> origin <span class="token operator">||</span> <span class="token string">'*'</span><span class="token punctuation">,</span><br>      <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    status<br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Change all router handler functions that return a response to use the function above. For example, in the handler that retrieves an array of all dogs, change</p><pre class="language-js"><code class="language-js"><span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dogs<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>to</p><pre class="language-js"><code class="language-js"><span class="token keyword">return</span> <span class="token function">jsonCorsResponse</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> dogs<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>For testing purposes, we can send requests from the <a href="http://google.com">google.com</a> domain when running in development mode. To do this, browse <a href="http://google.com">google.com</a>, open the DevTools console, and enter the following:</p><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3000/api/dogs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="rate-limiting" tabindex="-1">Rate Limiting</h2><p>We can configure routes to perform rate limiting which limits the number of requests that can be sent to a given API endpoint or set of them over a given period of time.</p><p>First, install the NPM package <code>limiter&quot; by entering</code>npm install limiter`.</p><p>Second, create the following file which defines the limits to enforce and exports a function that simplifies checking for requests that exceed the limit. Routes can call this function and test whether <code>null</code> or a <code>NextResponse</code> object is returned. If <code>null</code> is returned, the limit has not been exceeded. If a <code>NextResponse</code> object is returned, the limit has been exceeded and the route should return that response.</p><pre class="language-js"><code class="language-js"><span class="token comment">// src/app/api/limiter.ts</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>RateLimiter<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'limiter'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> limiter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RateLimiter</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  <span class="token literal-property property">fireImmediately</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">interval</span><span class="token operator">:</span> <span class="token string">'min'</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">tokensPerInterval</span><span class="token operator">:</span> <span class="token number">8</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getLimitedResponse</span><span class="token punctuation">(</span><br>  <span class="token parameter"><span class="token literal-property property">request</span><span class="token operator">:</span> Request</span><br><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>NextResponse <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> remaining <span class="token operator">=</span> <span class="token keyword">await</span> limiter<span class="token punctuation">.</span><span class="token function">removeTokens</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'limiter.ts: remaining ='</span><span class="token punctuation">,</span> remaining<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>remaining <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// allow request</span><br><br>  <span class="token comment">// Reject request.</span><br>  <span class="token keyword">const</span> origin <span class="token operator">=</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'origin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NextResponse</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">429</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">statusText</span><span class="token operator">:</span> <span class="token string">'Too Many Requests'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token comment">// '*' allows tools like Postman and Thunder Client to send requests.</span><br>      <span class="token string-property property">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> origin <span class="token operator">||</span> <span class="token string">'*'</span><span class="token punctuation">,</span><br>      <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Each route that wishes to enforce the limit should include the following code:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>getLimitedResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@app/api/limiter'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getLimitedResponse</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token keyword">return</span> response<span class="token punctuation">;</span></code></pre><p>This cannot be done in <code>middleware.ts</code> and I don't know why. When I tried that I got &quot;error Cannot read properties of undefined (reading 'now')&quot; when <code>limiter.ts</code> tries to create a <code>RateLimiter</code> object.</p><h2 id="sitemaps" tabindex="-1">Sitemaps</h2><p>From <a href="https://developers.google.com/search/docs/crawling-indexing/sitemaps/overview?v=1.1.1" rel="noopener" target="_blank">Learn about sitemaps</a>:</p><blockquote><p>A sitemap is a file where you provide information about the pages, videos, and other files on your site, and the relationships between them. Search engines like Google read this file to crawl your site more efficiently. A sitemap tells Google which pages and files you think are important in your site, and also provides valuable information about these files. For example, when the page was last updated and any alternate language versions of the page.</p></blockquote><p>To generate a sitemap for a Next.js application:</p><ol><li><p>Enter <code>npm install next-sitemap</code></p></li><li><p>Create the file <code>next-sitemap.config.js</code> in the root project directory.</p></li><li><p>Add the following in that file:</p><pre class="language-js"><code class="language-js"><span class="token comment">/** @type { import('next-sitemap').IConfig } */</span><br>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Set this environment variable in ".env.local".</span><br>  <span class="token literal-property property">siteUrl</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SITE_URL</span> <span class="token operator">||</span> <span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">generateRobotsTxt</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">generateIndexSitemap</span><span class="token operator">:</span> <span class="token boolean">false</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></li><li><p>Add the following script in <code>package.json</code>:</p><pre class="language-json"><code class="language-json"><span class="token property">"postbuild"</span><span class="token operator">:</span> <span class="token string">"next-sitemap"</span></code></pre></li><li><p>Enter <code>npm run build</code>. This generates the files <code>public/robots.txt</code> and <code>public/sitemap.xml</code>.</p></li></ol><h2 id="example-app" tabindex="-1">Example App</h2><p>Let's create a Next.js web app for managing a collection of dogs.</p><p><img alt="Dog CRUD app" style="width: 50%" src="/blog/assets/htmx-dog-crud.png?v=1.1.1"></p><p>All the code can be found in the GitHub repository at <a href="https://github.com/mvolkmann/nextjs-dogs-crud" target="_blank">nextjs-dogs-crud</a>.</p><p>The following steps create this app from scratch.</p><ol><li><p><code>npx create-next-app@latest</code></p><p>I chose the name &quot;dogs-crud&quot; and accepted all the defaults except using Tailwind.</p></li><li><p><code>cd dogs-crud</code></p></li><li><p><code>npm run dev</code></p></li><li><p><code>npm install uuid</code> and <code>npm i --save-dev @types/uuid</code></p><p>This package will be used to generate unique ids for dogs.</p></li><li><p>Delete the following files that will not be used:</p><ul><li><code>public/next.svg</code></li><li><code>public/vercel.svg</code></li><li><code>src/app/page.module.css</code></li></ul></li><li><p>Replace the contents of <code>src/app/global.css</code> with the following:</p><pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> cornflowerblue<span class="token punctuation">;</span><br>  <span class="token property">font-family</span><span class="token punctuation">:</span> sans-serif<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">button</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> lightgreen<span class="token punctuation">;</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span><br>  <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br><br>  <span class="token selector">&amp;:disabled</span> <span class="token punctuation">{</span><br>    <span class="token property">background-color</span><span class="token punctuation">:</span> gray<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.buttons</span> <span class="token punctuation">{</span><br>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><br>  <span class="token property">gap</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span><br><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">h1</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">input</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span><br>  <span class="token property">border-radius</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span><br>  <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">label</span> <span class="token punctuation">{</span><br>  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span><br>  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span><br>  <span class="token property">margin-right</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br>  <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span><br>  <span class="token property">width</span><span class="token punctuation">:</span> 3rem<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.show-on-hover</span> <span class="token punctuation">{</span><br>  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>2.5<span class="token punctuation">)</span> <span class="token function">translate</span><span class="token punctuation">(</span>0.2rem<span class="token punctuation">,</span> 0.2rem<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token property">visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">.on-hover:hover .show-on-hover</span> <span class="token punctuation">{</span><br>  <span class="token property">visibility</span><span class="token punctuation">:</span> visible<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">table</span> <span class="token punctuation">{</span><br>  <span class="token property">border-collapse</span><span class="token punctuation">:</span> collapse<span class="token punctuation">;</span><br>  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">td,<br>th</span> <span class="token punctuation">{</span><br>  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid cornflowerblue<span class="token punctuation">;</span><br>  <span class="token property">padding</span><span class="token punctuation">:</span> 0.5rem<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token selector">td</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br><br>  <span class="token selector">&amp; button</span> <span class="token punctuation">{</span><br>    <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span><br>    <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token selector">th</span> <span class="token punctuation">{</span><br>  <span class="token property">background-color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Edit <code>src/app/layout.tsx</code>.</p><ul><li>Delete the two lines that refer to the &quot;Inter&quot; font.</li><li>Change the title from &quot;Create Next App&quot; to &quot;Dogs CRUD&quot;.</li><li>Remove the <code>className</code> attribute from the <code>body</code> element.</li></ul></li><li><p>Create the file <code>src/app/api/dogs/dogs.ts</code> containing the following code that manages a collection of dogs in memory:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>v4 <span class="token keyword">as</span> uuidv4<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'uuid'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token punctuation">{</span><br>  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> dogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Dog<span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Comet'</span><span class="token punctuation">,</span> <span class="token string">'Whippet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token function">addDog</span><span class="token punctuation">(</span><span class="token string">'Oscar'</span><span class="token punctuation">,</span> <span class="token string">'German Shorthaired Pointer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">}</span><span class="token punctuation">;</span><br>  dogMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deleteDog</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> dogMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Dog<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dogs<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">:</span> Dog<span class="token punctuation">,</span> b<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token operator">=></span> a<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">localeCompare</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">updateDog</span><span class="token punctuation">(</span><br>  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><br>  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><br>  breed<span class="token operator">:</span> <span class="token builtin">string</span><br><span class="token punctuation">)</span><span class="token operator">:</span> Dog <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> dogMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>dog<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    dog<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span><br>    dog<span class="token punctuation">.</span>breed <span class="token operator">=</span> breed<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  <span class="token keyword">return</span> dog<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Create the file <code>src/app/api/dogs/dogs.ts</code> containing the following code that manages a collection of dogs in memory:</p></li><li><p>Create the file <code>src/app/api/dogs/route.ts</code> containing the following code that handles GET and POST requests:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>addDog<span class="token punctuation">,</span> getDogs<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dogs'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span>_<span class="token operator">:</span> Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token function">getDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">POST</span><span class="token punctuation">(</span>req<span class="token operator">:</span> Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">try</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span><span class="token function">formData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> breed <span class="token operator">=</span> <span class="token punctuation">(</span>formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'breed'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> newDog <span class="token operator">=</span> <span class="token function">addDog</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>newDog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>error<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Create the file <code>src/app/api/dogs/[id]/route.ts</code> containing the following code that handles PUT and DELETE requests:</p><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span>NextResponse<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'next/server'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>deleteDog<span class="token punctuation">,</span> updateDog<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../dogs'</span><span class="token punctuation">;</span><br><br><span class="token keyword">type</span> <span class="token class-name">Props</span> <span class="token operator">=</span> <span class="token punctuation">{</span><br>  params<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">DELETE</span><span class="token punctuation">(</span>req<span class="token operator">:</span> Request<span class="token punctuation">,</span> <span class="token punctuation">{</span>params<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> Props<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> existed <span class="token operator">=</span> <span class="token function">deleteDog</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><br>    <span class="token punctuation">{</span>error<span class="token operator">:</span> <span class="token string">'dog not found'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span>status<span class="token operator">:</span> existed <span class="token operator">?</span> <span class="token number">200</span> <span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">}</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">PUT</span><span class="token punctuation">(</span>req<span class="token operator">:</span> Request<span class="token punctuation">,</span> <span class="token punctuation">{</span>params<span class="token operator">:</span> <span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> Props<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">await</span> req<span class="token punctuation">.</span><span class="token function">formData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> name <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> breed <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'breed'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token function">updateDog</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> breed<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> dog<br>    <span class="token operator">?</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><br>    <span class="token operator">:</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>error<span class="token operator">:</span> <span class="token string">'dog not found'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Replace the contents of <code>src/app/page.tsx</code> with the following:</p><pre class="language-tsx"><code class="language-tsx"><span class="token string">'use client'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>useEffect<span class="token punctuation">,</span> useState<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><br><br><span class="token keyword">type</span> <span class="token class-name">Dog</span> <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>dogMap<span class="token punctuation">,</span> setDogMap<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Dog<span class="token operator">>></span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>selectedDog<span class="token punctuation">,</span> setSelectedDog<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Dog <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token function">loadDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">function</span> <span class="token function">addDog</span><span class="token punctuation">(</span>dog<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> newDogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    newDogMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>id<span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">setDogMap</span><span class="token punctuation">(</span>newDogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">function</span> <span class="token function">deleteDog</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> newDogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    newDogMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">setDogMap</span><span class="token punctuation">(</span>newDogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleDelete</span><span class="token punctuation">(</span>event<span class="token operator">:</span> React<span class="token punctuation">.</span>MouseEvent<span class="token operator">&lt;</span>HTMLButtonElement<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'Are you sure?'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> tr <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tr<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'tr not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/dogs/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tr<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>        method<span class="token operator">:</span> <span class="token string">'DELETE'</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'DELETE failed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token function">deleteDog</span><span class="token punctuation">(</span>tr<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error deleting dog:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">function</span> <span class="token function">handleEdit</span><span class="token punctuation">(</span>event<span class="token operator">:</span> React<span class="token punctuation">.</span>MouseEvent<span class="token operator">&lt;</span>HTMLButtonElement<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> tr <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span><span class="token function">closest</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tr<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'tr not found'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">setSelectedDog</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tr<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleSubmit</span><span class="token punctuation">(</span>event<span class="token operator">:</span> React<span class="token punctuation">.</span>FormEvent<span class="token operator">&lt;</span>HTMLFormElement<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> form <span class="token operator">=</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> url <span class="token operator">=</span> selectedDog <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/dogs/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>selectedDog<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">'/api/dogs'</span><span class="token punctuation">;</span><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>        method<span class="token operator">:</span> selectedDog <span class="token operator">?</span> <span class="token string">'PUT'</span> <span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span><br>        body<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'POST failed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      form<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">const</span> newDog <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token function">addDog</span><span class="token punctuation">(</span>newDog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token function">setSelectedDog</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Error submitting dog:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadDogs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/dogs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dogArray <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> dogMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Dog<span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> dog <span class="token keyword">of</span> dogArray<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      dogMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>dog<span class="token punctuation">.</span>id<span class="token punctuation">,</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token function">setDogMap</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Dogs</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Name</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><br>            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><br>            <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><br>            <span class="token attr-name">required</span><br>            <span class="token attr-name">size</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">30</span><span class="token punctuation">}</span></span><br>            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><br>            <span class="token attr-name">defaultValue</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selectedDog <span class="token operator">?</span> selectedDog<span class="token punctuation">.</span>name <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span></span><br>          <span class="token punctuation">/></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">htmlFor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>breed<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Breed</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><br>            <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>breed<span class="token punctuation">"</span></span><br>            <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>breed<span class="token punctuation">"</span></span><br>            <span class="token attr-name">required</span><br>            <span class="token attr-name">size</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">30</span><span class="token punctuation">}</span></span><br>            <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><br>            <span class="token attr-name">defaultValue</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selectedDog <span class="token operator">?</span> selectedDog<span class="token punctuation">.</span>breed <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span></span><br>          <span class="token punctuation">/></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>buttons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit-btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>selectedDog <span class="token operator">?</span> <span class="token string">'Update'</span> <span class="token operator">:</span> <span class="token string">'Add'</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token punctuation">{</span>selectedDog <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><br>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setSelectedDog</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>              Cancel<br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br>          <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span><span class="token plain-text"><br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token plain-text">Name</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><span class="token plain-text"><br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span><span class="token plain-text">Breed</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token punctuation">{</span><span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>dogMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>dog <span class="token operator">=></span> <span class="token punctuation">(</span><br>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>on-hover<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token plain-text"><br>              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>dog<span class="token punctuation">.</span>breed<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token plain-text"><br>              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>buttons<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>                  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>show-on-hover<span class="token punctuation">"</span></span><br>                  <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleDelete<span class="token punctuation">}</span></span><br>                  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><br>                <span class="token punctuation">></span></span><span class="token plain-text"><br>                  ✕<br>                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>                </span><span class="token punctuation">{</span><span class="token comment">/* This selects the dog which triggers a selection-change event<br>             which causes the form to update. */</span><span class="token punctuation">}</span><span class="token plain-text"><br>                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>                  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>show-on-hover<span class="token punctuation">"</span></span><br>                  <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleEdit<span class="token punctuation">}</span></span><br>                  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><br>                <span class="token punctuation">></span></span><span class="token plain-text"><br>                  ✎<br>                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token plain-text"><br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><br>          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> Home<span class="token punctuation">;</span></code></pre></li><li><p>Browse localhost:3000.</p></li><li><p>Add a dog.</p><p>Enter a name and breed in the form at the top. Click the &quot;Add&quot; button to add a new dog.</p></li><li><p>Edit a dog.</p><p>Hover over one of the dog rows and click the pencil icon that appears. Modify the name and/or breed in the form at the top. Click the &quot;Update&quot; button to submit the changes.</p></li><li><p>Delete a dog.</p><p>Hover over one of the dog rows and click the &quot;X&quot; icon that appears. Click the &quot;OK&quot; button in the confirmation dialog.</p></li></ol></article>