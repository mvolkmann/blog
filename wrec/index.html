<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>wrec</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#getting-started">Getting Started</a></li><li><a href="#properties">Properties</a></li><li><a href="#javascript-expressions">JavaScript Expressions</a></li><li><a href="#two-way-data-binding">Two-way Data Binding</a></li><li><a href="#dynamic-css">Dynamic CSS</a></li><li><a href="#nested-web-components">Nested Web Components</a></li><li><a href="#kicking-it-up-a-notch">Kicking it up a Notch</a></li></ol></nav></aside><article><script src="/blog/js/basic-wrec.js" type="module"></script><script src="/blog/js/color-demo.js" type="module"></script><script src="/blog/js/color-picker.js" type="module"></script><script src="/blog/js/counter-wrec.js" type="module"></script><script src="/blog/js/data-binding.js" type="module"></script><script src="/blog/js/hello-world.js" type="module"></script><script src="/blog/js/radio-group.js" type="module"></script><script src="/blog/js/select-list.js" type="module"></script><script src="/blog/js/number-slider.js" type="module"></script><style>img {
    border: 1px solid gray;
  }</style><figure style="width: 30%"><img alt="wrec logo" style="border: 0" src="/blog/assets/wrec-logo.png?v=1.1.1"></figure><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://www.npmjs.com/package/wrec?v=1.1.1" rel="noopener" target="_blank">wrec</a> is a small, zero dependency library that greatly simplifies building web components. Its main features are that it automates wiring event listeners and implementing reactivity.</p><p>To install it in one of your projects, enter <code>npm install wrec</code>.</p><h2 id="getting-started" tabindex="-1">Getting Started</h2><p>To define a web component using wrec:</p><ol><li>Define a class that extends the <code>Wrec</code> class.</li><li>Optionally define a static property named <code>css</code> whose value is a string containing CSS rules.</li><li>Define a static property named <code>html</code> whose value is a string containing the HTML to render.</li><li>Register the class as a custom element definition by calling the <code>register</code> method.</li></ol><p>For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">BasicWrec</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    span {<br>      font-family: fantasy;<br>      font-size: 2rem;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span>Hello, World!&lt;/span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>BasicWrec<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The <code>css</code> and <code>html</code> properties above use tagged template literals. This allows the text to span multiple lines. The tags <code>css</code> and <code>html</code> are optional. They trigger the VS Code extension Prettier to format the code and the es6-string-html extension to add syntax highlighting.</p><p>The <code>register</code> method registers a custom HTML element whose name is the kebab-case version of the class name. For <code>BasicWrec</code>, the element name is <code>basic-wrec</code>.</p><p>To use this in a web page or Markdown file, include the following:</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>some-path/basic-wrec.js<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>basic-wrec</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>basic-wrec</span><span class="token punctuation">></span></span></code></pre><p>Here it is in action.</p><p><basic-wrec></basic-wrec></p><h2 id="properties" tabindex="-1">Properties</h2><p>Web components defined with wrec can define and use properties. Properties are automatically mapped to attributes in the custom element. Here's a simple example that enables specifying a name.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'World'</span><span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div>Hello, &lt;span>this.name&lt;/span>!&lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>HelloWorld<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>We can use this custom element as follows:</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hello-world</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hello-world</span><span class="token punctuation">></span></span><br><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hello-world</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrec<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hello-world</span><span class="token punctuation">></span></span></code></pre><p>This will render the following:</p><p><hello-world></hello-world><hello-world name="wrec"></hello-world></p><p>Use your browser DevTools to inspect the last instance of the <code>hello-world</code> custom element. Double-click the value of the <code>name</code> attribute and change it to your name. Press the return key or tab key, or click away from the value to commit the change. Note how the page updates to greet you.</p><h2 id="javascript-expressions" tabindex="-1">JavaScript Expressions</h2><p>The attributes and text content of the HTML to be rendered can contain raw JavaScript expressions. By &quot;raw&quot; we mean that the expressions are not surrounded by noisy syntax like <code>${...}</code>.</p><p>If the expressions contain references to properties in the form <code>this.propertyName</code>, wrec automatically watches them for changes. When changes are detected, wrec automatically reevaluates the expressions and replaces the attribute values or text contents with new values.</p><p>Here's an example of a counter component that takes advantage of this feature:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">CounterWrec</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: block;<br>    }<br>    button {<br>      background-color: lightgreen;<br>    }<br>    button:disabled {<br>      background-color: gray;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;button disabled="this.count === 0" onClick="this.count--" type="button"><br>      -<br>    &lt;/button><br>    &lt;span>this.count&lt;/span><br>    &lt;button onClick="this.count++" type="button">+&lt;/button><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>CounterWrec<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><p><counter-wrec></counter-wrec></p><p>Click the &quot;+&quot; and &quot;-&quot; buttons to try it.</p><p>It is highly unlikely that an attribute value or element text content will ever need to render the word &quot;this&quot;, followed by a period, followed by a valid JavaScript identifier. But if that need arises, just escape the period by using two. Wrec will render only a single period.</p><p>To follow the word &quot;this&quot; with an ellipsis, include a space before it as in &quot;this ... and that&quot;.</p><h2 id="two-way-data-binding" tabindex="-1">Two-way Data Binding</h2><p>Wrec provides two-way data binding for HTML <code>input</code>, <code>textarea</code>, and <code>select</code> elements. When the user changes their value, an associated property is automatically updated. When code changes the value of an associated property, the element is automatically updated.</p><p>The following web component demonstrates this. Ignore the CSS variable <code>--label-width</code> for now. We will discuss how that works in the &quot;Dynamic CSS&quot; section below.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">NumberSlider</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">labelWidth</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: flex;<br>      align-items: center;<br>      gap: 0.5rem;<br>    }<br><br>    input[type='number'] {<br>      width: 6rem;<br>    }<br><br>    label {<br>      --label-width: this.labelWidth;<br>      font-weight: bold;<br>      text-align: right;<br>      width: var(--label-width);<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;label>this.label&lt;/label><br>    &lt;input type="range" min="this.min" max="this.max" value="this.value" /><br>    &lt;span>this.value&lt;/span><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>NumberSlider<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><p><number-slider label="Rating" max="10"></number-slider></p><p>Drag the slider thumb to change the value.</p><h2 id="dynamic-css" tabindex="-1">Dynamic CSS</h2><p>Wrec also supports JavaScript expressions in CSS, but there's a wrinkle. When the browsers built-in HTML parser sees a JavaScript expression in an attribute or the text content of an element, it is ignored. This allows wrec to process the expressions. But when the browsers built-in CSS parser sees a JavaScript expression in a property value, it sees it as invalid and strips it out. This prevents wrec from processing the expressions.</p><p>A workaround is to use CSS properties (a.k.a. CSS variables).</p><p>The following color picker component demonstrates this. It also defines a computed property whose value can be any valid JavaScript expression.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">ColorPicker</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">labelWidth</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'3rem'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">red</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">green</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">blue</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span><br>      <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token string">'`rgb(${this.red}, ${this.green}, ${this.blue})`'</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: flex;<br>      gap: 0.5rem;<br>    }<br><br>    #sliders {<br>      display: flex;<br>      flex-direction: column;<br>      justify-content: space-between;<br>    }<br><br>    #swatch {<br>      --color: this.color;<br>      background-color: var(--color);<br>      height: 5rem;<br>      width: 5rem;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;div id="swatch">&lt;/div><br>    &lt;div id="sliders"><br>      &lt;!-- Prettier formatted these lines poorly. --><br>      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeSlider</span><span class="token punctuation">(</span><span class="token string">'Red'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeSlider</span><span class="token punctuation">(</span><span class="token string">'Green'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeSlider</span><span class="token punctuation">(</span><br>        <span class="token string">'Blue'</span><br>      <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>    &lt;/div><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> <span class="token function">makeSlider</span><span class="token punctuation">(</span><span class="token parameter">label</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>      &lt;number-slider<br>        label=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>label<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>        label-width="this.labelWidth"<br>        max="255"<br>        value="this.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>label<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"<br>      >&lt;/number-slider><br>    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>ColorPicker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><p><color-picker></color-picker></p><p>Drag the sliders to change the color of the swatch on the left.</p><h2 id="nested-web-components" tabindex="-1">Nested Web Components</h2><p>Let's define a web component that uses <code>color-picker</code> to change the color of some text. It also uses a <code>number-slider</code> to change the size of the text.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">ColorDemo</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      --color: this.color;<br>      display: flex;<br>      flex-direction: column;<br>      gap: 0.5rem;<br>      font-family: sans-serif;<br>    }<br>    p {<br>      --size: this.size;<br>      color: var(--color);<br>      font-size: calc(var(--size) * 1px);<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;color-picker color="this.color">&lt;/color-picker><br>    &lt;number-slider<br>      label="Size"<br>      max="48"<br>      min="12"<br>      value="this.size"<br>    >&lt;/number-slider><br>    &lt;p>This is a test.&lt;/p><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>ColorDemo<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><p><color-demo></color-demo></p><h2 id="kicking-it-up-a-notch" tabindex="-1">Kicking it up a Notch</h2><p>For this demo we need to define three more custom elements which are:</p><ul><li><code>radio-group</code>: renders a set of radio buttons which are <code>input</code> elements with <code>type=&quot;radio&quot;</code></li><li><code>select-list</code>: renders a <code>select</code> element with <code>option</code> children</li><li><code>data-binding</code>: renders elements that tie everything together</li></ul><p>We will also use <code>number-slider</code> which was defined above.</p><p>Here is the class that defines the <code>radio-group</code> custom element:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">RadioGroup</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> formAssociated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">labels</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">values</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host > div {<br>      display: flex;<br>      gap: 0.5rem;<br><br>      > div {<br>        display: flex;<br>        align-items: center;<br>      }<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;div><br>      this.values.split(",").map((value, index) => this.makeRadio(value, index,<br>      this.labels )).join("")<br>    &lt;/div><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#fixValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">attrName<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span>attrName<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>attrName <span class="token operator">===</span> <span class="token string">'value'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// Update the checked state of the radio buttons.</span><br>      <span class="token keyword">const</span> inputs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shadowRoot<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> input <span class="token keyword">of</span> inputs<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        input<span class="token punctuation">.</span>checked <span class="token operator">=</span> input<span class="token punctuation">.</span>value <span class="token operator">===</span> newValue<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>attrName <span class="token operator">===</span> <span class="token string">'values'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#fixValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// This handles the case when the specified value</span><br>  <span class="token comment">// is not in the list of values.</span><br>  <span class="token function">#fixValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">makeRadio</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> label <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>labels<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>label<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>      &lt;div><br>        &lt;input<br>          type="radio"<br>          id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"<br>          name="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"<br>          onchange="handleChange"<br>          value="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"<br>          </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">?</span> <span class="token string">'checked'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>        /><br>        &lt;label for="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>label<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/label><br>      &lt;/div><br>    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>RadioGroup<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here is the class that defines the <code>select-list</code> custom element:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">SelectList</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> formAssociated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">labels</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">values</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;select name="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" value="this.value"><br>      this.values.split(",").map((value, index) => this.makeOption(value, index,<br>      this.labels)).join("")<br>    &lt;/select><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Wait for the DOM to update.</span><br>    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">makeOption</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> label <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>labels<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>label<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span><br>    value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;option value="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>label<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/option></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>SelectList<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here is the class that defines the <code>data-binding</code> custom element.</p><p>The <code>label</code> property is a computed property that calls a method in the class to obtain its value. Since the method uses properties that don't appear in the expression, we need to let wrec know which properties the function uses. The <code>uses</code> property value is a comma-separated list of properties names. When the value of any of those properties changes, the expression is reevaluated and a new value is assigned to the computed property.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">capitalize</span> <span class="token operator">=</span> <span class="token parameter">str</span> <span class="token operator">=></span><br>  str <span class="token operator">?</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> str<span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">DataBinding</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">colors</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">labels</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span><br>      <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token string">'this.getLabels()'</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">uses</span><span class="token operator">:</span> <span class="token string">'colors'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: flex;<br>      flex-direction: column;<br>      gap: 0.5rem;<br>      font-family: sans-serif;<br>    }<br>    p {<br>      --color: this.color;<br>      --size: this.size;<br>      color: var(--color);<br>      font-size: calc(var(--size) * 1px);<br>      margin: 6px 0;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;div><br>      &lt;label>Color Options (comma-separated):&lt;/label><br>      &lt;input value="this.colors" /><br>    &lt;/div><br>    &lt;radio-group<br>      name="color1"<br>      labels="this.labels"<br>      value="this.color"<br>      values="this.colors"<br>    >&lt;/radio-group><br>    &lt;select-list<br>      name="color2"<br>      labels="this.labels"<br>      value="this.color"<br>      values="this.colors"<br>    >&lt;/select-list><br>    &lt;number-slider<br>      label="Size"<br>      max="48"<br>      min="12"<br>      value="this.size"<br>    >&lt;/number-slider><br>    &lt;p>You selected the color &lt;span id="selected-color">this.color&lt;/span>.&lt;/p><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token function">getLabels</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colors<br>      <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">color</span> <span class="token operator">=></span> <span class="token function">capitalize</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>DataBinding<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Finally, here it is in action.</p><p><data-binding color="blue" colors="red,green,blue"></data-binding></p><p>Select one of the radio buttons and note how the color of the text at the bottom updates. Also, the corresponding <code>option</code> is selected in the <code>select</code> element.</p><p>Select a different color in the <code>select-list</code> and note how the color of the text at the bottom updates. Also, the corresponding radio button is selected.</p><p>Drag the &quot;Size&quot; slider to change the size of the text at the bottom.</p><p>For the most amazing part, change the comma-separated list of colors in the input at the top. Notice how the radio buttons and the select options update. The first color in the list is selected by default. Selecting other colors via the radio buttons or the <code>select</code> works as before.</p><p>Take a moment to review the code above that implements these web components. Consider how much code would be required to reproduce this using another library or framework and how much more complicated that code would be!</p></article>