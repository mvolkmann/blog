<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>wrec</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#getting-started">Getting Started</a></li><li><a href="#properties">Properties</a></li><li><a href="#event-listeners">Event Listeners</a></li><li><a href="#javascript-expressions">JavaScript Expressions</a></li><li><a href="#unchanging-expressions">Unchanging Expressions</a></li><li><a href="#conditional-and-iterative-html-generation">Conditional and Iterative HTML Generation</a></li><li><a href="#form-elements">Form Elements</a></li><li><a href="#computed-properties">Computed Properties</a></li><li><a href="#reactive-css">Reactive CSS</a></li><li><a href="#nested-web-components">Nested Web Components</a></li><li><a href="#kicking-it-up-a-notch">Kicking it up a Notch</a></li><li><a href="#non-primitive-properties">Non-primitive Properties</a></li><li><a href="#property-change-events">Property Change Events</a></li><li><a href="#form-submissions">Form Submissions</a></li><li><a href="#error-checking">Error Checking</a></li><li><a href="#security">Security</a></li><li><a href="#more-examples">More Examples</a></li><li><a href="#tests">Tests</a></li></ol></nav></aside><article><script src="/blog/js/basic-wrec.js" type="module"></script><script src="/blog/js/color-demo.js" type="module"></script><script src="/blog/js/color-picker.js" type="module"></script><script src="/blog/js/counter-wrec.js" type="module"></script><script src="/blog/js/data-binding.js" type="module"></script><script src="/blog/js/hello-world.js" type="module"></script><script src="/blog/js/number-slider.js" type="module"></script><script src="/blog/js/radio-group.js" type="module"></script><script src="/blog/js/rectangle-area.js" type="module"></script><script src="/blog/js/select-list.js" type="module"></script><script src="/blog/js/table-plus.js" type="module"></script><script src="/blog/js/temperature-eval.js" type="module"></script><script src="/blog/js/toggle-switch.js" type="module"></script><script>window.onload = () => {
    const tablePlus = document.querySelector('table-plus');
      // The property "properties" must be set before the property "headings"
      // because changing headings triggers the buildTh method
      // which uses properties to determine the data to sort.k
      tablePlus.properties = ['name', 'age', 'occupation'];
      tablePlus.headings = ['Name', 'Age', 'Occupation'];
      tablePlus.data = [
        {name: 'Alice', age: 30, occupation: 'Engineer'},
        {name: 'Bob', age: 25, occupation: 'Designer'},
        {name: 'Charlie', age: 35, occupation: 'Teacher'}
      ];
  };</script><style>img {
    border: 1px solid gray;
  }</style><figure style="width: 30%"><img alt="wrec logo" style="border: 0" src="/blog/assets/wrec-logo.png?v=1.1.1"></figure><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://www.npmjs.com/package/wrec?v=1.1.1" rel="noopener" target="_blank">wrec</a> is a small, zero dependency library that greatly simplifies building web components. Its main features are that it automates wiring event listeners and implementing reactivity.</p><p>If you're new to web components, see my slides from a one-hour talk on web components at <a href="https://github.com/mvolkmann/talks/blob/master/web-components.key.pdf?v=1.1.1" rel="noopener" target="_blank">Web Components</a>. A video of the talk is at <a href="https://drive.google.com/file/d/16rGM2L8psBGlQ-Zhu6EBXN1GMO30YdRF/view" target="_blank">OCI Tech Lunch - July 2025</a>. Also see my series of <a href="https://www.youtube.com/playlist?list=PLGhglgQb4jVk3-_wc8srORlGalSRFMEpR" target="_blank">YouTube videos</a> on web components and the wrec library.</p><p>Wrec was inspired by <a href="https://lit.dev?v=1.1.1" rel="noopener" target="_blank">Lit</a>. It has the following advantages over Lit:</p><ul><li>Wrec is simpler ... just a single class to extend (Wrec).</li><li>Wrec is smaller ... 8K (<code>wrec.min.js</code>) versus 16K (lit-core.min.js`) minified.</li><li>Wrec has a cleaner syntax ... no need to surround JS expressions with <code>${...}</code>.</li><li>Wrec provides automatic 2-way data binding ... no need to dispatch custom events and listen for them.</li><li>Wrec performs direct DOM manipulation, which is more efficient than the virtual DOM approach used in Lit</li><li>Wrec doesn't require a special syntax for Boolean attributes.</li><li>Wrec enables specifying the content of a <code>textarea</code> element with a JavaScript expression in its text content.</li></ul><p>Wrec components have many of the features provided by Alpine.js.</p><p>To install wrec in one of your projects, enter <code>npm install wrec</code>.</p><h2 id="getting-started" tabindex="-1">Getting Started</h2><p>To define a web component using wrec:</p><ol><li>Copy the file <code>wrec.min.js</code> from the wrec <a href="https://github.com/mvolkmann/wrec/tree/main/dist">GitHub</a> repository. (Alternatively, install wrec using npm and use a bundler like Vite.)</li><li>Define a class that extends the <code>Wrec</code> class.</li><li>Optionally define a static property named <code>css</code> whose value is a string containing CSS rules.</li><li>Define a static property named <code>html</code> whose value is a string containing the HTML to render.</li><li>Register the class as a custom element definition by calling the <code>register</code> method.</li></ol><p>For example:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">BasicWrec</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    span {<br>      font-family: fantasy;<br>      font-size: 2rem;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;span>Hello, World!&lt;/span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>BasicWrec<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The <code>css</code> and <code>html</code> properties above use tagged template literals. This allows the text to span multiple lines. The tags <code>css</code> and <code>html</code> are optional. They trigger the VS Code extension Prettier to format the code and the es6-string-html extension to add syntax highlighting.</p><p>The <code>register</code> method registers a custom HTML element whose name is the kebab-case version of the class name. For <code>BasicWrec</code>, the element name is <code>basic-wrec</code>.</p><p>To use this in a web page or Markdown file, include the following:</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>some-path/basic-wrec.js<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>basic-wrec</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>basic-wrec</span><span class="token punctuation">></span></span></code></pre><p>Here it is in action.</p><p><basic-wrec></basic-wrec></p><h2 id="properties" tabindex="-1">Properties</h2><p>Web components defined with wrec can define and use properties. Properties are automatically mapped to attributes in the custom element. Here's a simple example that enables specifying a name.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'World'</span><span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div>Hello, &lt;span>this.name&lt;/span>!&lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>HelloWorld<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>We can use this custom element as follows:</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hello-world</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hello-world</span><span class="token punctuation">></span></span><br><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hello-world</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrec<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hello-world</span><span class="token punctuation">></span></span></code></pre><p>This will render the following:</p><p><hello-world></hello-world><hello-world name="wrec"></hello-world></p><p>Use your browser DevTools to inspect the last instance of the <code>hello-world</code> custom element. Double-click the value of the <code>name</code> attribute and change it to your name. Press the return key or tab key, or click away from the value to commit the change. Note how the page updates to greet you.</p><h2 id="event-listeners" tabindex="-1">Event Listeners</h2><p>To wire event listeners, Wrec looks for attributes whose name begins with &quot;on&quot;. It assumes the remainder of the attribute name is an event name. It also assumes that the value of the attribute is either a method name that should be called or code that should be executed when that event is dispatched. For example, with the attribute <code>onclick=&quot;increment&quot;</code>, if <code>increment</code> is a method in the component, wrec will add an event listener to the element containing the attribute for &quot;click&quot; events and call <code>this.increment(event)</code>. Alternatively, the attribute <code>onclick=&quot;this.count++&quot;</code> adds an event listener that increments <code>this.count</code> when the element is clicked.</p><p>The case of the event name within the attribute name does not matter because Wrec lowercases the name. So the attributes in the previous examples can be replaced by <code>onClick=&quot;increment&quot;</code>.</p><h2 id="javascript-expressions" tabindex="-1">JavaScript Expressions</h2><p>The attributes and text content of the HTML to be rendered can contain raw JavaScript expressions. By &quot;raw&quot; we mean that the expressions are not surrounded by noisy syntax like <code>${...}</code>.</p><p>If the expressions contain references to properties in the form <code>this.propertyName</code>, wrec automatically watches them for changes. In this context, <code>this</code> always refers to the parent web component. When changes are detected, wrec automatically reevaluates the expressions and replaces the attribute values or text contents with new values. Wrec does not rerender the entire web component.</p><p>Here's an example of a counter component that takes advantage of this feature:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">CounterWrec</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: block;<br>    }<br>    button {<br>      background-color: lightgreen;<br>    }<br>    button:disabled {<br>      opacity: 0.8;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;label>this.label&lt;/label><br>    &lt;button onClick="this.count--" type="button" disabled="this.count === 0"><br>      -<br>    &lt;/button><br>    &lt;span>this.count&lt;/span><br>    &lt;button onClick="this.count++" type="button">+&lt;/button><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>CounterWrec<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>When the value of an attribute is a Boolean, wrec adds the attribute to the element with no value or removes the attribute from the element. This is commonly used for attributes like <code>disabled</code>.</p><p>Here it is in action.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>counter-wrec</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Score<span class="token punctuation">"</span></span> <span class="token attr-name">count</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>counter-wrec</span><span class="token punctuation">></span></span></code></pre><p><counter-wrec label="Score" count="0"></counter-wrec></p><p>Click the &quot;+&quot; and &quot;-&quot; buttons to try it.</p><p>It is highly unlikely that an attribute value or element text content will ever need to render the word &quot;this&quot;, followed by a period, followed by a valid JavaScript identifier. But if that need arises, just escape the period by using two. Wrec will render only a single period.</p><p>To follow the word &quot;this&quot; with an ellipsis, include a space before it as in &quot;this ... and that&quot;.</p><h2 id="unchanging-expressions" tabindex="-1">Unchanging Expressions</h2><p>In insert the value of an expression that does not use properties of the web component, into an HTML template string, surround the expression with the syntax <code>${...}</code>. For example, assuming <code>DAYS</code> is a variable whose value is an array of month names:</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>The month is ${DAYS[new Date().getDay()]}.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre><h2 id="conditional-and-iterative-html-generation" tabindex="-1">Conditional and Iterative HTML Generation</h2><p>Wrec supports conditional and iterative generation of HTML.</p><p>The following web component demonstrates conditional generation using the ternary operator.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">TemperatureEval</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">temperature</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;p>this.temperature &lt; 32 ? "freezing" : "not freezing"&lt;/p><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>TemperatureEval<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>temperature-eval</span> <span class="token attr-name">temperature</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>temperature-eval</span><span class="token punctuation">></span></span></code></pre><p><temperature-eval temperature="100"></temperature-eval></p><p>Use your browser DevTools to inspect the instance of the <code>temperature-eval</code> custom element. Double-click the value of the <code>temperature</code> attribute and change it &quot;20&quot;. Note how the rendered output changes from &quot;not freezing&quot; to &quot;freezing&quot;.</p><p>For an example of a web component that iterates over values in a comma-delimited attribute value to determine what to render, see the <code>RadioGroup</code> and <code>SelectList</code> classes in the &quot;Kicking it up a Notch&quot; section below.</p><h2 id="form-elements" tabindex="-1">Form Elements</h2><p>Wrec supports two-way data binding for HTML form elements.</p><ul><li><code>input</code> and <code>select</code> elements can have a <code>value</code> attribute whose value is &quot;this.somePropertyName&quot;. An event listener for &quot;change&quot; events will be added. To instead listen for &quot;input&quot; events, use the attribute &quot;value:input&quot;.</li><li><code>textarea</code> elements can have text content that is &quot;this.somePropertyName&quot;. An event listener for &quot;change&quot; events will be added.</li></ul><p>When the user changes the value of these form elements, the associated property is automatically updated. When code changes the value of an associated property, the form element is automatically updated.</p><p>The following web component demonstrates this. Ignore the CSS variable <code>--label-width</code> for now. We will discuss how that works in the &quot;Reactive CSS&quot; section below.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">NumberSlider</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">labelWidth</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: flex;<br>      align-items: center;<br>      gap: 0.5rem;<br>    }<br><br>    input[type='number'] {<br>      width: 6rem;<br>    }<br><br>    label {<br>      --label-width: this.labelWidth;<br>      font-weight: bold;<br>      text-align: right;<br>      width: var(--label-width);<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;label>this.label&lt;/label><br>    &lt;input<br>      type="range"<br>      min="this.min"<br>      max="this.max"<br>      value:input="this.value"<br>    /><br>    &lt;span>this.value&lt;/span><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>NumberSlider<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number-slider</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Rating<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>number-slider</span><span class="token punctuation">></span></span></code></pre><p><number-slider label="Rating" max="10"></number-slider></p><p>Drag the slider thumb to change the value.</p><p>Data binding in Lit is not two-way like in wrec. A Lit component cannot simply pass one of its properties to a child Lit component and have the child can update the property. The child must dispatch custom events that the parent listens for so it can update its own state. For an example of this, see <a href="https://github.com/mvolkmann/lit-examples/blob/main/wrec-compare/binding-demo.ts">wrec-compare</a>.</p><h2 id="computed-properties" tabindex="-1">Computed Properties</h2><p>The value of a property can be computed using the values of other properties. To do this, add the <code>computed</code> attribute to the description of the property.</p><p>The example component below has a computed property that compute the area of a rectangle. It shows three ways to accomplish this, with the first two commented out.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">RectangleArea</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token comment">/*<br>    area: {<br>      type: Number,<br>      computed: "this.width * this.height",<br>    },<br>    area: {<br>      type: Number,<br>      computed: "this.rectangleArea(this.width, this.height)",<br>    },<br>    */</span><br>    <span class="token literal-property property">area</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span><br>      <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token string">'this.rectangleArea()'</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">uses</span><span class="token operator">:</span> <span class="token string">'width,height'</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    .area {<br>      font-weight: bold;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;number-slider label="Width" value="this.width">&lt;/number-slider><br>    &lt;number-slider label="Height" value="this.height">&lt;/number-slider><br>    &lt;div class="area">Area: &lt;span>this.area&lt;/span>&lt;/div><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token comment">/*<br>  rectangleArea(width, height) {<br>    return width * height;<br>  }<br>  */</span><br>  <span class="token function">rectangleArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>RectangleArea<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Since the <code>rectangleArea</code> method uses properties that don't appear in the expression, we need to let wrec know which properties the method uses. The <code>uses</code> property value is a comma-separated list of properties names. When the value of any of those properties changes, the expression is reevaluated and a new value is assigned to the computed property.</p><p>Here it is in action:</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rectangle-area</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rectangle-area</span><span class="token punctuation">></span></span></code></pre><p><rectangle-area></rectangle-area></p><p>Drag the &quot;Width&quot; and &quot;Height&quot; sliders. Note how the &quot;Area&quot; is automatically updated.</p><h2 id="reactive-css" tabindex="-1">Reactive CSS</h2><p>Wrec also supports JavaScript expressions in CSS, but there's a wrinkle. When the browsers built-in HTML parser sees a JavaScript expression in an attribute or the text content of an element, it is ignored. This allows wrec to process the expressions. But when the browsers built-in CSS parser sees a JavaScript expression in a property value, it sees it as invalid and strips it out. This prevents wrec from processing the expressions.</p><p>A workaround is to use CSS properties (a.k.a. CSS variables).</p><p>The following color picker component demonstrates this. It also defines a computed property whose value can be any valid JavaScript expression.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">ColorPicker</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">labelWidth</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'3rem'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">red</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">green</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">blue</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span><br>      <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token string">'`rgb(${this.red}, ${this.green}, ${this.blue})`'</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: flex;<br>      gap: 0.5rem;<br>    }<br><br>    #sliders {<br>      display: flex;<br>      flex-direction: column;<br>      justify-content: space-between;<br>    }<br><br>    #swatch {<br>      --color: this.color;<br>      background-color: var(--color);<br>      height: 5rem;<br>      width: 5rem;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;div id="swatch">&lt;/div><br>    &lt;div id="sliders"><br>      &lt;!-- prettier-ignore --><br>      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeSlider</span><span class="token punctuation">(</span><span class="token string">'Red'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeSlider</span><span class="token punctuation">(</span><span class="token string">'Green'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">makeSlider</span><span class="token punctuation">(</span><span class="token string">'Blue'</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>    &lt;/div><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> <span class="token function">makeSlider</span><span class="token punctuation">(</span><span class="token parameter">label</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>      &lt;number-slider<br>        label=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>label<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>        label-width="this.labelWidth"<br>        max="255"<br>        value="this.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>label<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"<br>      >&lt;/number-slider><br>    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>ColorPicker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>color-picker</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>color-picker</span><span class="token punctuation">></span></span></code></pre><p><color-picker></color-picker></p><p>Drag the sliders to change the color of the swatch on the left.</p><h2 id="nested-web-components" tabindex="-1">Nested Web Components</h2><p>Let's define a web component that uses <code>color-picker</code> to change the color of some text. It also uses a <code>number-slider</code> to change the size of the text.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">ColorDemo</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: flex;<br>      flex-direction: column;<br>      gap: 0.5rem;<br>      font-family: sans-serif;<br>    }<br>    p {<br>      --color: this.color;<br>      --size: this.size;<br>      color: var(--color);<br>      font-size: calc(var(--size) * 1px);<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;color-picker color="this.color">&lt;/color-picker><br>    &lt;number-slider<br>      label="Size"<br>      max="48"<br>      min="12"<br>      value="this.size"<br>    >&lt;/number-slider><br>    &lt;p>This is a test.&lt;/p><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>ColorDemo<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>color-demo</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>color-demo</span><span class="token punctuation">></span></span></code></pre><p><color-demo></color-demo></p><p>CSS variable values can be any valid JavaScript expression. The example above can be changed to double the size as follows:</p><pre class="language-css"><code class="language-css"><span class="token property">--size</span><span class="token punctuation">:</span> this.size * 2<span class="token punctuation">;</span></code></pre><h2 id="kicking-it-up-a-notch" tabindex="-1">Kicking it up a Notch</h2><p>For this demo we need to define three more custom elements which are:</p><ul><li><code>radio-group</code>: renders a set of radio buttons which are <code>input</code> elements with <code>type=&quot;radio&quot;</code></li><li><code>select-list</code>: renders a <code>select</code> element with <code>option</code> children</li><li><code>data-binding</code>: renders elements that tie everything together</li></ul><p>We will also use <code>number-slider</code> which was defined above.</p><p>Here is the class that defines the <code>radio-group</code> custom element. Note how properties that are mapped to required attributes, such as <code>name</code> and <code>values</code> below, specify that with <code>required: true</code>.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">RadioGroup</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> formAssociated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">labels</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">values</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host > div {<br>      display: flex;<br>      gap: 0.5rem;<br><br>      > div {<br>        display: flex;<br>        align-items: center;<br>      }<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;div><br>      &lt;!-- prettier-ignore --><br>      this.values<br>        .split(",")<br>        .map(this.makeRadio.bind(this))<br>        .join("")<br>    &lt;/div><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  #labelArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br>  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#fixValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">attrName<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span>attrName<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>attrName <span class="token operator">===</span> <span class="token string">'value'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// Update the checked state of the radio buttons.</span><br>      <span class="token keyword">const</span> inputs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shadowRoot<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> input <span class="token keyword">of</span> inputs<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        input<span class="token punctuation">.</span>checked <span class="token operator">=</span> input<span class="token punctuation">.</span>value <span class="token operator">===</span> newValue<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>attrName <span class="token operator">===</span> <span class="token string">'labels'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>#labelArray <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>labels<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>attrName <span class="token operator">===</span> <span class="token string">'values'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#fixValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// This handles the case when the specified value</span><br>  <span class="token comment">// is not in the list of values.</span><br>  <span class="token function">#fixValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// This method cannot be private because it is called when</span><br>  <span class="token comment">// a change event is dispatched from a radio button.</span><br>  <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// This method cannot be private because it is</span><br>  <span class="token comment">// called from the expression in the html method.</span><br>  <span class="token function">makeRadio</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>      &lt;div><br>        &lt;input<br>          type="radio"<br>          id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"<br>          name="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"<br>          onchange="handleChange"<br>          value="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"<br>          </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">?</span> <span class="token string">'checked'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>        /><br>        &lt;label for="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>#labelArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/label><br>      &lt;/div><br>    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>RadioGroup<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here is the class that defines the <code>select-list</code> custom element:</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">SelectList</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> formAssociated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">labels</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">values</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;select name="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">" value="this.value"><br>      &lt;!-- prettier-ignore --><br>      this.values<br>        .split(",")<br>        .map(this.makeOption.bind(this))<br>        .join("")<br>    &lt;/select><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  #labelArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br>  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">#fixValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">attrName<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span>attrName<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>attrName <span class="token operator">===</span> <span class="token string">'labels'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>#labelArray <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>labels<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// This handles the case when the specified value</span><br>  <span class="token comment">// is not in the list of values.</span><br>  <span class="token function">#fixValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>values<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token comment">// This method cannot be private because it is</span><br>  <span class="token comment">// called from the expression in the html method.</span><br>  <span class="token function">makeOption</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>      &lt;option value="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>#labelArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/option><br>    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>SelectList<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here is the class that defines the <code>data-binding</code> custom element.</p><p>The <code>label</code> property is a computed property that calls a method in the class to obtain its value.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">capitalize</span> <span class="token operator">=</span> <span class="token parameter">str</span> <span class="token operator">=></span><br>  str <span class="token operator">?</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> str<span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">DataBinding</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">colors</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">labels</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span><br>      <span class="token comment">//computed: "this.colors.split(',').map(color => this.capitalize(color)).join(',')",</span><br>      <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token string">'this.getLabels()'</span><span class="token punctuation">,</span><br>      <span class="token literal-property property">uses</span><span class="token operator">:</span> <span class="token string">'colors'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      display: flex;<br>      flex-direction: column;<br>      gap: 0.5rem;<br>      font-family: sans-serif;<br>    }<br>    p {<br>      --color: this.color;<br>      --size: this.size;<br>      color: var(--color);<br>      font-size: calc(var(--size) * 1px);<br>      margin: 6px 0;<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;div><br>      &lt;label>Color Options (comma-separated):&lt;/label><br>      &lt;input value="this.colors" /><br>    &lt;/div><br>    &lt;radio-group<br>      name="color1"<br>      labels="this.labels"<br>      value="this.color"<br>      values="this.colors"<br>    >&lt;/radio-group><br>    &lt;select-list<br>      name="color2"<br>      labels="this.labels"<br>      value="this.color"<br>      values="this.colors"<br>    >&lt;/select-list><br>    &lt;number-slider<br>      label="Size"<br>      max="48"<br>      min="12"<br>      value="this.size"<br>    >&lt;/number-slider><br>    &lt;p>You selected the color &lt;span id="selected-color">this.color&lt;/span>.&lt;/p><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token function">getLabels</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>capitalize<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>DataBinding<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Finally, here it is in action.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data-binding</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>blue<span class="token punctuation">"</span></span> <span class="token attr-name">colors</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>red,green,blue<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data-binding</span><span class="token punctuation">></span></span></code></pre><p><data-binding color="blue" colors="red,green,blue"></data-binding></p><p>Select one of the radio buttons and note how the color of the text at the bottom updates. Also, the corresponding <code>option</code> is selected in the <code>select</code> element.</p><p>Select a different color in the <code>select-list</code> and note how the color of the text at the bottom updates. Also, the corresponding radio button is selected.</p><p>Drag the &quot;Size&quot; slider to change the size of the text at the bottom.</p><p>For the most amazing part, change the comma-separated list of colors in the input at the top and press the return key to commit the change. Notice how the radio buttons and the select options update. The first color in the list is selected by default. Selecting other colors via the radio buttons or the <code>select</code> works as before.</p><p>Take a moment to review the code above that implements these web components. Consider how much code would be required to reproduce this using another library or framework and how much more complicated that code would be!</p><h2 id="non-primitive-properties" tabindex="-1">Non-primitive Properties</h2><p>Wrec automatically keeps primitive web component properties (Boolean, Number, or String) in sync with corresponding attributes. Non-primitive web component properties (objects, including arrays) are not reflected in attributes because they are not valid attribute values.</p><p>Non-primitive web component properties are useful in scenarios where JavaScript code will find instances of the web component and directly set the properties.</p><p>For an example of this, see <code>src/table-plus.ts</code> and the corresponding file <code>src/table-plus.html</code>. This implements an HTML table that supports sorting the rows by clicking a column heading. The sort begins in ascending order. Clicking the heading currently used for sorting reverses the sort order.</p><p>The <code>table-plus</code> component also provides an example of implementing reactivity through the <code>propertyChangedCallback</code> method rather than through JavaScript expressions embedded in HTML.</p><p>Here it is in action.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table-plus</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table-plus</span><span class="token punctuation">></span></span></code></pre><p>The properties of the <code>table-plus</code> component are set with the following code:</p><pre class="language-js"><code class="language-js">window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> tablePlus <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'table-plus'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// The property "properties" must be set before the property "headings"</span><br>  <span class="token comment">// because changing "headings" triggers the "buildTh" method</span><br>  <span class="token comment">// which uses properties to determine the data to sort.</span><br>  tablePlus<span class="token punctuation">.</span>properties <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'occupation'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>  tablePlus<span class="token punctuation">.</span>headings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">,</span> <span class="token string">'Occupation'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>  tablePlus<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><br>    <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token literal-property property">occupation</span><span class="token operator">:</span> <span class="token string">'Engineer'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token literal-property property">occupation</span><span class="token operator">:</span> <span class="token string">'Designer'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Charlie'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token literal-property property">occupation</span><span class="token operator">:</span> <span class="token string">'Teacher'</span><span class="token punctuation">}</span><br>  <span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><table-plus></table-plus></p><p>Try these steps to experiment with the reactivity of the table.</p><ol><li>Click the table headings to sort the rows.</li><li>Right-click the table and select &quot;Inspect&quot;.</li><li>In the DevTools Elements tab, click the <code>&lt;table-plus&gt;</code> element.</li><li>Click the &quot;Console&quot; tab.</li><li>Enter <code>$0.properties = ['occupation', 'name']</code> The headings look incorrect now, but we'll fix that in the next step.</li><li>Enter <code>$0.headings = ['Job', 'Call Me']</code></li><li>Enter <code>$0.data = [{name: 'Mark', age: 64, occupation: 'retired'}, {name: 'Tami', age: 63, occupation: 'receptionist'}]</code></li></ol><h2 id="property-change-events" tabindex="-1">Property Change Events</h2><p>Wrec components will dispatch &quot;change&quot; events whenever a property configured with <code>dispatch: true</code> changes. For an example of this, see the <code>checked</code> property in <code>src/toggle-switch.js</code>. The component defined in <code>src/binding-demo.js</code> listens for that event, as does the <code>script</code> in <code>src/index.html</code>.</p><p>The following web component implements a toggle switch. The code was generated by ChatGPT using the &quot;o3 pro&quot; model, and then modified.</p><p>A &quot;change&quot; event is dispatched each time the value of the <code>checked</code> property changes.</p><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> Wrec<span class="token punctuation">,</span> <span class="token punctuation">{</span>css<span class="token punctuation">,</span> html<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./wrec.min.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">class</span> <span class="token class-name">ToggleSwitch</span> <span class="token keyword">extends</span> <span class="token class-name">Wrec</span> <span class="token punctuation">{</span><br>  <span class="token keyword">static</span> properties <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">checked</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span> <span class="token literal-property property">dispatch</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">static</span> css <span class="token operator">=</span> css<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    :host {<br>      --padding: 2px;<br>      --thumb-size: 22px;<br>      --height: calc(var(--thumb-size) + var(--padding) * 2);<br>      --checked-x: calc(var(--thumb-size) - var(--padding) * 2);<br>    }<br><br>    div {<br>      cursor: pointer;<br>      display: inline-block;<br>      position: relative;<br>      width: calc(var(--thumb-size) * 2);<br>      height: var(--height);<br>      outline: none;<br>    }<br><br>    .track {<br>      position: absolute;<br>      inset: 0;<br>      background: #ccc;<br>      border-radius: calc(var(--height) / 2);<br>      transition: background 160ms;<br>    }<br><br>    .thumb {<br>      position: absolute;<br>      top: var(--padding);<br>      left: var(--padding);<br>      width: var(--thumb-size);<br>      height: var(--thumb-size);<br>      background: #fff;<br>      border-radius: 50%;<br>      box-shadow: 0 0 2px rgb(0 0 0 / 0.4);<br>      transition: transform 160ms;<br>    }<br><br>    .checked .track {<br>      background: #4caf50;<br>    }<br><br>    /* thumb slides with a CSS transition */<br>    .checked .thumb {<br>      transform: translateX(var(--checked-x));<br>    }<br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token comment">// The tabindex attribute is required to make the div focusable.</span><br>  <span class="token keyword">static</span> html <span class="token operator">=</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>    &lt;div<br>      aria-checked="this.checked"<br>      class="this.checked ? 'checked' : ''"<br>      onClick="toggle"<br>      onKeyDown="handleKey"<br>      role="switch"<br>      tabindex="0"<br>    ><br>      &lt;span class="track">&lt;/span><br>      &lt;span class="thumb">&lt;/span><br>    &lt;/div><br>  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>  <span class="token function">handleKey</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'Space'</span> <span class="token operator">||</span> e<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'Enter'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>checked <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>checked<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>ToggleSwitch<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here it is in action.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>toggle-switch</span> <span class="token attr-name">checked</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>toggle-switch</span><span class="token punctuation">></span></span></code></pre><p><toggle-switch checked="checked"></toggle-switch></p><h2 id="form-submissions" tabindex="-1">Form Submissions</h2><p>Web components that extend <code>Wrec</code> can contribute values to form submissions by adding the following line to their class definition. Wrec looks for this automatically does the rest of the work.</p><pre class="language-js"><code class="language-js"><span class="token keyword">static</span> formAssociated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code></pre><h2 id="error-checking" tabindex="-1">Error Checking</h2><p>Wrec checks for many kinds of errors and throws an <code>Error</code> when they are found. Look for messages in the DevTools console. The kinds of errors that are detected include:</p><ul><li>attribute names in web component instances with no matching property declaration</li><li>attribute values with a type that differs from the declared property type</li><li>event handling function names that don't match any method name in the web component</li><li>expressions in attribute values or element text content that reference undeclared web component properties</li><li>expressions in element text content that do not evaluate to a string or number</li></ul><h2 id="security" tabindex="-1">Security</h2><p>Wrec uses the JavaScript <code>eval</code> function to evaluate JavaScript expressions that are placed in attribute values and the text content of elements. This has security implications if those expressions can come from untrusted sources, so it is best avoid creating web components that use untrusted content in those ways.</p><p>Perhaps the most dangerous thing the use of <code>eval</code> allows is sending HTTP requests to other servers. Such requests could contain data scraped from your web app in order to share it with unscrupulous sites.</p><p>The easiest way to prevent this is to add a Content Security Policy (CSP) to your web app. Simply adding the following element as a child of the <code>head</code> element in each page blocks sending HTTP requests to any domain except that of your web app:</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>connect-src 'self'<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><h2 id="more-examples" tabindex="-1">More Examples</h2><p>Check out the <code>src</code> directory in the <a href="https://github.com/mvolkmann/wrec">wrec GitHub repository</a>. This contains many example web components that are defined using wrec.</p><p>Compare the files <code>counter-vanilla.js</code> and <code>counter-wrec.js</code> to get a feel for how much using wrec simplifies the code required to define a web component.</p><p>To try the examples, clone the repository, cd to that directory, enter <code>npm install</code>, enter <code>npm run dev</code>, and browse localhost:5173. Also try browsing other <code>.html</code> files besides <code>index.html</code>.</p><h2 id="tests" tabindex="-1">Tests</h2><p>wrec has an extensive set of Playwright tests. To run them:</p><ol><li>Clone the wrec repository.</li><li>cd to the <code>src</code> directory.</li><li>Enter <code>npm install</code>.</li><li>Enter <code>npm run testui</code>.</li><li>Click the right pointing triangle.</li></ol><p>If there is no &quot;Action&quot; tab which displays a browser view of the running tests, reset the Playwright UI settings by entering one of these commands:</p><pre class="language-bash"><code class="language-bash"><span class="token comment"># macOS</span><br><span class="token function">rm</span> <span class="token parameter variable">-rf</span> ~/Library/Caches/ms-playwright/.settings<br><br><span class="token comment"># Windows</span><br>del %LOCALAPPDATA%<span class="token punctuation">\</span>ms-playwright<span class="token punctuation">\</span>.settings /s /q</code></pre></article>