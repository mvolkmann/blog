<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Lua</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#used-by">Used By</a></li><li><a href="#resources">Resources</a></li><li><a href="#cheat-sheets">Cheat Sheets</a></li><li><a href="#installing">Installing</a></li><li><a href="#vs-code-setup">VS Code Setup</a></li><li><a href="#source-files">Source Files</a></li><li><a href="#running-code">Running Code</a></li><li><a href="#keywords">Keywords</a></li><li><a href="#comments">Comments</a></li><li><a href="#types">Types</a></li><li><a href="#input%2Foutput">Input/Output</a></li><li><a href="#variables">Variables</a></li><li><a href="#operators">Operators</a></li><li><a href="#conditional-logic">Conditional Logic</a></li><li><a href="#iteration">Iteration</a></li><li><a href="#functions">Functions</a></li><li><a href="#utility-functions">Utility Functions</a></li><li><a href="#data-structures">Data Structures</a><ol><li><a href="#tables">Tables</a></li></ol></li><li><a href="#lua-functional-(luafun)">Lua Functional (luafun)</a></li><li><a href="#standard-library">Standard Library</a></li><li><a href="#math-module">math module</a></li><li><a href="#file-i%2Fo">File I/O</a></li><li><a href="#modules">Modules</a></li><li><a href="#multitasking">Multitasking</a></li><li><a href="#unorganized-content">Unorganized Content</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://www.lua.org/?v=1.0.20" rel="noopener" target="_blank">Lua</a> is a dynamically typed scripting language created in 1993 by a team at <a href="http://www.puc-rio.br?v=1.0.20" rel="noopener" target="_blank">Pontifical Catholic University of Rio de Janeiro</a> in Brazil.</p><p>The Lua programming language was named after the Moon.</p><p>Lua has an interpreter and a virtual machine. The interpreter is written in C and produces bytecode that runs in the virtual machine. Compiling to bytecode can be done at runtime or ahead of time (although I haven't found a recommended way to do it).</p><p>Lua has a relatively small standard library, but has a large collection of packages that can be installed using the <a href="https://luarocks.org?v=1.0.20" rel="noopener" target="_blank">LuaRocks</a> package manager.</p><p>Pros of Lua include:</p><ul><li>considered to be the fastest scripting language</li><li>free and open sources under the MIT license</li><li>simple syntax with only 21 keywords</li><li>uses dynamic variables that do not require specifying types</li><li>functions are first class and are closures</li><li>implements tail call optimization</li><li>easy to run C code from Lua and run Lua code from C</li><li>easy to embed in C/C++ applications (interpreter is only 182K)</li><li>highly portable (runs on all major OSes and most microcontrollers)</li><li>native support for multitasking with coroutines</li><li>provides automatic, incremental garbage collection</li></ul><p>Cons of Lua include:</p><ul><li><p>limited Unicode support</p><p>Strings can contain unicode characters, but indexing into such strings does not account for their size. See <a href="http://lua-users.org/wiki/LuaUnicode?v=1.0.20" rel="noopener" target="_blank">Lua Unicode</a>.</p></li><li><p>variables and functions are global by default</p></li><li><p>lack of type checking</p></li><li><p>lack of support for object oriented programming (OOP), although it can be simulated with metatables and functions</p></li><li><p>limited support for error handling</p></li><li><p>limited support for regular expressions</p></li></ul><p>TODO: Get more from <a href="http://notebook.kulchenko.com/programming/lua-good-different-bad-and-ugly-parts">http://notebook.kulchenko.com/programming/lua-good-different-bad-and-ugly-parts</a>.</p><h2 id="used-by" tabindex="-1">Used By</h2><p>Notable uses of Lua include:</p><ul><li><a href="https://www.minecraft.net/?v=1.0.20" rel="noopener" target="_blank">Minecraft</a> game</li><li><a href="https://www.roblox.com?v=1.0.20" rel="noopener" target="_blank">Roblox</a> game</li><li><a href="http://www.legoengineering.com/platform/nxt/?v=1.0.20" rel="noopener" target="_blank">Lego Mindstorms NXT</a></li><li><a href="https://neovim.io?v=1.0.20" rel="noopener" target="_blank">Neovim</a> text editor</li><li><a href="https://redis.io?v=1.0.20" rel="noopener" target="_blank">Redis</a> database</li></ul><p>Roblox uses a variant of Lua called Luau. TODO: How does that differ?</p><p>For an extensive, see the <a href="https://en.wikipedia.org/wiki/List_of_applications_using_Lua?v=1.0.20" rel="noopener" target="_blank">List of applications using Lua</a> Wikipedia page.</p><h2 id="resources" tabindex="-1">Resources</h2><ul><li><a href="https://www.lua.org/manual/?v=1.0.20" rel="noopener" target="_blank">Lua Reference Manual</a></li><li><a href="https://www.amazon.com/exec/obidos/ASIN/8590379868/lua-pilindex-20?v=1.0.20" rel="noopener" target="_blank">Programming in Lua</a> book</li></ul><h2 id="cheat-sheets" tabindex="-1">Cheat Sheets</h2><ul><li><a href="https://www.codecademy.com/learn/learn-lua/modules/learn-lua-introduction/cheatsheet?v=1.0.20" rel="noopener" target="_blank">codecademy</a></li><li><a href="https://devhints.io/lua?v=1.0.20" rel="noopener" target="_blank">DevHints.io</a></li><li><a href="https://cheatography.com/srgmc/cheat-sheets/lua-scripting-5-1/?v=1.0.20" rel="noopener" target="_blank">Cheatography</a></li></ul><h2 id="installing" tabindex="-1">Installing</h2><p>Lua can be installed in macOS using Homebrew. Enter <code>brew install lua</code> to install it. Enter <code>lua -v</code> to verify that it worked and see the version.</p><p>For installing in other operating systems, see <a href="http://www.lua.org/start.html?v=1.0.20" rel="noopener" target="_blank">Getting Started</a>.</p><p>To experiment with Lua on the web without installing anything, see <a href="http://www.lua.org/demo.html?v=1.0.20" rel="noopener" target="_blank">Lua Demo</a>.</p><p>For faster performance, use <a href="https://luajit.org/?v=1.0.20" rel="noopener" target="_blank">LuaJIT</a>. To install this:</p><ul><li>Download the source from <a href="?v=1.0.20" rel="noopener" target="_blank"></a> by entering <code>git clone https://luajit.org/git/luajit.git</code>.</li><li>Enter <code>cd luajit</code></li><li>In macOS enter <code>export MACOSX_DEPLOYMENT_TARGET={version}</code> where <code>version</code> is a value like <code>13.2</code>.</li><li>Enter <code>make &amp;&amp; sudo make install</code></li><li>The previous command will ask you to create a symlink with a command like <code>ln -sf luajit-2.1.0-beta3 /usr/local/bin/luajit</code>. Enter that command.</li></ul><p>To compile a Lua program to bytecode and save it, enter a command like <code>luajit -b demo.lua demo.out</code> To execute the saved bytecode, enter a command like <code>luajit demo.out</code>. This will start faster than entering <code>luajit demo.lua</code>.</p><h2 id="vs-code-setup" tabindex="-1">VS Code Setup</h2><p>VS Code has great support for Lua.</p><p>The <a href="https://github.com/LuaLS/lua-language-server?v=1.0.20" rel="noopener" target="_blank">Lua</a> extension from sumneko is a Lua language server. It provides code annotations, syntax checking, dynamic type checking, code formatting, spell checking, and more.</p><p>To disable specific diagnostics, open Settings, filter on &quot;Lua&quot;, scroll down to &quot;Lua &gt; Diagnostics: Disable&quot;, click the &quot;Add Item&quot; button, select a diagnostic name from the dropdown, and click the &quot;OK&quot; button. For example, you may wish to disable &quot;lowercase-global&quot;.</p><p>The <a href="https://github.com/Koihik/vscode-lua-format?v=1.0.20" rel="noopener" target="_blank">vscode-lua-format</a> extension from Koihik is a popular Lua code formatting extension. To configure this, open Settings, filter on &quot;Lua&quot;, and enter the path to a configuration file in &quot;Vscode-lua-format: Config Path&quot; such as <code>/Users/{your-user}/Documents/dev/lang/lua/style.config</code>. Then create the file <code>style.config</code> in that location containing something like the following:</p><pre class="language-text"><code class="language-text"># See all the Lua code formatting options at<br># https://github.com/Koihik/LuaFormatter/blob/master/docs/Style-Config.md<br><br>column_limit: 80<br>continuation_indent_width: 2<br>indent_width: 2<br>keep_simple_control_block_one_line: true<br>keep_simple_function_one_line: true<br>single_quote_to_double_quote: true<br>use_tab: false</code></pre><p>The <a href="https://marketplace.visualstudio.com/items?itemName=actboy168.lua-debug?v=1.0.20" rel="noopener" target="_blank">Lua Debug</a> VS Code extension supports debugging Lua code with breakpoints and watches.</p><h2 id="source-files" tabindex="-1">Source Files</h2><p>Source files have a <code>.lua</code> extension. To execute a source file, enter <code>lua filename.lua</code>.</p><p>A source file can use the variables and functions defined in another source file by using the <code>require</code> function. For example:</p><pre class="language-lua"><code class="language-lua">require <span class="token string">"other"</span></code></pre><h2 id="running-code" tabindex="-1">Running Code</h2><p>To start a Lua REPL, enter <code>lua</code> and then enter Lua statements. To exit the REPL, press ctrl-c or ctrl-d.</p><p>To run a Lua program, enter <code>lua {filename}.lua</code> or <code>luajit {filename}.lua</code>. This runs the source file through the Lua interpreter to produce bytecode and uses the Lua virtual machine to execute the bytecode.</p><p>There are several tools that claim to produce executable files from Lua programs. But none seem to be popular or actively maintained.</p><h2 id="keywords" tabindex="-1">Keywords</h2><p>Lua only defines 21 keywords. Some of the keywords such as <code>end</code>, <code>and</code>, <code>or</code>, and <code>then</code> make the syntax similar to the Ruby programming language.</p><p>Boolean literal values:</p><ul><li>true</li><li>false</li></ul><p>Conditional Logic:</p><ul><li>if</li><li>then</li><li>elseif</li><li>else</li></ul><p>Functions:</p><ul><li>function</li><li>return</li></ul><p>Iteration:</p><ul><li>for: loop over numbers or pairs</li><li>in: specifies what to loop over</li><li>while: top-tested loop</li><li>repeat and until: bottom-tested loop</li><li>break: exit loop early</li></ul><p>Logical Operators:</p><ul><li>and</li><li>or</li><li>not</li></ul><p>Variables:</p><ul><li>local</li></ul><p>Other:</p><ul><li>do: begins a new lexical block</li><li>end: marks the end of a lexical block</li><li>nil: represents having no value</li></ul><h2 id="comments" tabindex="-1">Comments</h2><p>Single-line comments begin with two dashes. Multiline comments begin with <code>--[[</code> and end with <code>--]]</code> or just <code>]]</code>.</p><h2 id="types" tabindex="-1">Types</h2><p>Lua uses dynamic types. The types of variables and function parameters are never specified and are always inferred.</p><p>To convert a boolean or number value to a string, pass it to the <code>tostring</code> function.</p><p>To convert a string value to a number, pass it to the <code>tonumber</code> function.</p><p>To convert a string value to a boolean, pass it to the <code>toboolean</code> function.</p><p>There are no builtin functions for converting a boolean to a number or a number to a boolean.</p><h2 id="input%2Foutput" tabindex="-1">Input/Output</h2><p>To write to stdout, use the <code>print</code> function or the<code>io.write</code> function. Both take any number of arguments.</p><p>The <code>print</code> function adds a tab character between each value and a newline at the end of its output</p><p>The <code>io.write</code> function does not add any characters between values and does not add a newline at the end. Boolean values must be converted to strings before being passed to <code>io.write</code>.</p><p>For example:</p><pre class="language-lua"><code class="language-lua"><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment">-- Hello   true    7</span><br>io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token function">tostring</span><span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment">-- Hellotrue7</span></code></pre><p>To read from stdin, use the <code>io.read</code> function.</p><p>The following code prompts for two numbers and prints their sum.</p><pre class="language-lua"><code class="language-lua">io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'First Number: '</span><span class="token punctuation">)</span><br>s1 <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>n1 <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token comment">-- returns nil if not a number</span><br><br>io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'Second Number: '</span><span class="token punctuation">)</span><br>s2 <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>n2 <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><br><br><span class="token keyword">if</span> n1 <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span><br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'The first value "'</span> <span class="token operator">..</span> s1 <span class="token operator">..</span> <span class="token string">'" is not a number.'</span><span class="token punctuation">)</span><br><span class="token keyword">elseif</span> n2 <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span><br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'The second value "'</span> <span class="token operator">..</span> s2 <span class="token operator">..</span> <span class="token string">'" is not a number.'</span><span class="token punctuation">)</span><br><span class="token keyword">else</span><br>  sum <span class="token operator">=</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span><br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'Sum: '</span> <span class="token operator">..</span> sum<span class="token punctuation">)</span><br><span class="token keyword">end</span></code></pre><h2 id="variables" tabindex="-1">Variables</h2><p>Variable names can contain letters, digits, and underscores, but cannot start with a digit. Hyphens are not allowed. In multi-word names the words can be separated by underscores (preferred) or written in camel-case. For example, <code>one_long_name</code> or <code>oneLongName</code>.</p><p>To assign a value to a variable, use the <code>=</code> operator.</p><p>Variables are global by default. Use the <code>local</code> keyword to make them only exist in their scope.</p><p>For example:</p><pre class="language-lua"><code class="language-lua">a <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- global, even if assigned inside a function</span><br><span class="token keyword">local</span> b <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">-- local to the current scope</span></code></pre><p>TODO: What does <code>_G.name = value</code> do?</p><p>Variables with no assigned value have the value <code>nil</code>.</p><p>New values of any type can be assigned to a variable at any time.</p><p>The <code>type(someVar)</code> function returns a string containing the type name of the variable value. This can be <code>nil</code>, <code>boolean</code>, <code>number</code>, <code>string</code>, <code>table</code>, <code>function</code>, or <code>thread</code>.</p><p>Multi-variable assignment is supported. For example:</p><pre class="language-lua"><code class="language-lua">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><br>a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token comment">-- swaps values</span><br><br><span class="token operator">#</span><span class="token operator">#</span> Booleans<br><br>Boolean literal values are `<span class="token keyword">true</span>` <span class="token keyword">and</span> `<span class="token keyword">false</span>`<span class="token punctuation">.</span><br>In conditions the only values treated as <span class="token keyword">false</span> are `<span class="token keyword">false</span>` <span class="token keyword">and</span> `<span class="token keyword">nil</span>`<span class="token punctuation">.</span><br>The number zero<span class="token punctuation">,</span> an empty string<span class="token punctuation">,</span> <span class="token keyword">and</span> an empty table are all treated as <span class="token keyword">true</span><span class="token punctuation">.</span><br><br><span class="token operator">#</span><span class="token operator">#</span> Numbers<br><br>TODO<span class="token punctuation">:</span> Are all numbers represented by double<span class="token operator">-</span>precision floating point?<br><br><span class="token operator">#</span><span class="token operator">#</span> Strings<br><br>Strings can be delimited with either single <span class="token keyword">or</span> double quotes<span class="token punctuation">.</span><br>For example<span class="token punctuation">,</span> `<span class="token string">'Hello World!'</span>` <span class="token keyword">or</span> `<span class="token string">"Hello World!"</span>`<span class="token punctuation">.</span><br><br>Multiline strings are delimiting with `<span class="token string">[[` and `]]</span>`<span class="token punctuation">.</span><br>For example<span class="token punctuation">:</span><br><br>```lua<br>haiku <span class="token operator">=</span> <span class="token string">[[<br>Out of memory.<br>We wish to hold the sky.<br>But we never will.<br>]]</span></code></pre><p>Strings are indexed starting from 1 instead of 0.</p><p>Use the <code>..</code> operator to concatenate strings. For example, <code>fullName = firstName .. ' ' .. lastName</code>.</p><p>String operations include:</p><ul><li>length: <code>string.len(var)</code> or <code>#var</code></li><li>substring: <code>string.sub(source, startIndex, endIndex)</code> or <code>source:sub(startIndex, endIndex)</code></li><li>global substitute: <code>string.gsub(source, oldValue, newValue)</code></li><li>find start and end index: <code>string.find(source, target)</code> or <code>source:find(target)</code></li><li>uppercase: <code>string.upper(var)</code> or <code>var:upper()</code></li><li>lowercase: <code>string.lower(var)</code> or <code>var:lower()</code></li><li>regular expression matches: <code>string.match(someString, 'regular-expression')</code> returns a table of matches?</li></ul><p>Lua does not support string interpolation. The closest Lua feature to this is the <code>string.format</code> function. For example:</p><pre class="language-lua"><code class="language-lua">name <span class="token operator">=</span> <span class="token string">"Mark"</span><br>color <span class="token operator">=</span> <span class="token string">"yellow"</span><br>sentence <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s's favorite color is %s."</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> color<span class="token punctuation">)</span></code></pre><h2 id="operators" tabindex="-1">Operators</h2><p>Lua supports the following mathematical operators:</p><ul><li><code>+</code> addition</li><li><code>-</code> subtraction or negation</li><li><code>*</code> multiplication</li><li><code>/</code> division</li><li><code>%</code> modulo</li><li><code>^</code> exponentiation</li></ul><p>The <code>++</code> and <code>--</code> operators found in many other programming languages are not supported.</p><p>Lua supports the following relational operators:</p><ul><li><code>==</code> equal</li><li><code>~=</code> not equal (differs from other languages that use <code>!=</code>)</li><li><code>&lt;</code> less than</li><li><code>&gt;</code> greater than</li><li><code>&lt;=</code> less than or equal to</li><li><code>&gt;=</code> greater than or equal to</li></ul><p>Lua supports the following logical operators:</p><ul><li><code>and</code></li><li><code>or</code></li><li><code>not</code></li></ul><p>Lua only supports one assignment operator which is <code>=</code>. It does not support shorthand assignment operators like <code>+=</code>. Adding a number to a variable must be done with <code>myVar = myVar + n</code>.</p><p>The operator <code>..</code> is used to concatenate strings.</p><p>Lua operators have the following precedence from highest to lowest:</p><ul><li><code>^</code></li><li><code>not</code> and unary <code>-</code></li><li><code>+</code> and binary <code>-</code></li><li><code>..</code></li><li><code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, and <code>~=</code></li><li><code>and</code></li><li><code>or</code></li></ul><p>All operators are left associative except for <code>^</code> and <code>..</code> which are right associative. For example, <code>2 ^ 2 ^ 3</code> is the same as <code>2 ^ 8</code> and not <code>4 ^ 3</code>.</p><h2 id="conditional-logic" tabindex="-1">Conditional Logic</h2><p>Parentheses are not required around conditions.</p><p>In an <code>if</code> statement, the <code>elseif</code> and <code>else</code> blocks shown below are optional.</p><p>All the parts of the <code>if</code> statement can be written on a single line if desired.</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">if</span> condition <span class="token keyword">then</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">elseif</span> condition <span class="token keyword">then</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">else</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span></code></pre><p>Lua does not have a <code>switch</code> statement or an equivalent.</p><p>Lua does not have a ternary operator, but the same functionality can be achieved with the following:</p><pre class="language-lua"><code class="language-lua">let result <span class="token operator">=</span> condition <span class="token keyword">and</span> trueValue <span class="token keyword">or</span> falseValue</code></pre><h2 id="iteration" tabindex="-1">Iteration</h2><pre class="language-lua"><code class="language-lua"><span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">do</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span><br><br><span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>mytable<span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span><br><br><span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>mytable<span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span><br><br><span class="token keyword">while</span> condition <span class="token keyword">do</span> — top<span class="token operator">-</span>tested<br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span><br><br><br><span class="token keyword">repeat</span> — bottom<span class="token operator">-</span>tested<br>  <span class="token punctuation">...</span><br><span class="token keyword">until</span> condition</code></pre><p>Loops can use the <code>break</code> keyword, but the <code>continue</code> keyword is not supported.</p><h2 id="functions" tabindex="-1">Functions</h2><p>Functions are defined with the <code>function</code> keyword.</p><p>For example:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><br>  <span class="token keyword">return</span> n1 <span class="token operator">+</span> n2<br><span class="token keyword">end</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 5</span></code></pre><p>Functions in Lua are first-class. This means they can take other functions as arguments and can return functions.</p><p>Functions can return multiple values. For example:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">function</span> <span class="token function">getStooges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token keyword">return</span> <span class="token string">"Moe"</span><span class="token punctuation">,</span> <span class="token string">"Larry"</span><span class="token punctuation">,</span> <span class="token string">"Curly"</span><br><span class="token keyword">end</span><br><br>s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s3 <span class="token operator">=</span> <span class="token function">getStooges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s3<span class="token punctuation">)</span> <span class="token comment">-- Moe Larry Curly</span><br>```<br><br>Functions can take a variable number of arguments<span class="token punctuation">.</span><br>For example<span class="token punctuation">:</span><br><br>```lua<br><span class="token keyword">function</span> <span class="token function">myFn</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span><br>  <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token keyword">do</span><br>    <span class="token punctuation">...</span><br>  <span class="token keyword">end</span><br><span class="token keyword">end</span></code></pre><p>Anonymous functions (unnamed) are closures and can be stored in variables. For example:</p><pre class="language-lua"><code class="language-lua">product <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><br>  <span class="token keyword">return</span> n1 <span class="token operator">*</span> n2<br><span class="token keyword">end</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 6</span></code></pre><p>There are two ways to call functions defined in a module/library.</p><pre class="language-lua"><code class="language-lua"><span class="token comment">-- Approach #1</span><br>library_name<span class="token punctuation">.</span><span class="token function">function_name</span><span class="token punctuation">(</span>target_value<span class="token punctuation">,</span> arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span><br><br><span class="token comment">-- Approach #2</span><br><span class="token comment">-- This implicitly passes `target_value` as the first argument.</span><br><span class="token comment">-- Does this only work when the type of `target_value`</span><br><span class="token comment">-- matches `library_name`?</span><br>target_value<span class="token punctuation">:</span><span class="token function">function_name</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span></code></pre><h2 id="utility-functions" tabindex="-1">Utility Functions</h2><p>The following functions are helpful for debugging. They can be defined in a file like <code>utility.lua</code> and required where needed.</p><pre class="language-lua"><code class="language-lua"><span class="token comment">-- Returns a string description of the keys and values in a table.</span><br><span class="token comment">-- Values can be nested tables.</span><br><span class="token keyword">function</span> <span class="token function">dump</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><br>  <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">"table"</span> <span class="token keyword">then</span><br>    <span class="token keyword">return</span> <span class="token function">tostring</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><br>  <span class="token keyword">end</span><br><br>  <span class="token keyword">local</span> s <span class="token operator">=</span> <span class="token string">"{ "</span><br>  <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token keyword">do</span><br>    <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">"number"</span> <span class="token keyword">then</span><br>      k <span class="token operator">=</span> <span class="token string">"\""</span> <span class="token operator">..</span> k <span class="token operator">..</span> <span class="token string">"\""</span><br>    <span class="token keyword">end</span><br>    s <span class="token operator">=</span> s <span class="token operator">..</span> k <span class="token operator">..</span> <span class="token string">"="</span> <span class="token operator">..</span> <span class="token function">dump</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">", "</span> <span class="token comment">-- recursive</span><br>  <span class="token keyword">end</span><br>  <span class="token keyword">return</span> s <span class="token operator">..</span> <span class="token string">"} "</span><br><span class="token keyword">end</span><br><br><span class="token comment">-- Returns a string containing all the values in a table,</span><br><span class="token comment">-- each separated by a comma and a space.</span><br><span class="token comment">-- Values cannot be nested tables.</span><br><span class="token keyword">function</span> <span class="token function">valuesString</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><br>  <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">"table"</span> <span class="token keyword">then</span><br>    <span class="token keyword">return</span> <span class="token string">""</span><br>  <span class="token keyword">end</span><br><br>  s <span class="token operator">=</span> <span class="token string">""</span><br>  <span class="token keyword">for</span> index<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token keyword">do</span><br>    s <span class="token operator">=</span> s <span class="token operator">..</span> v <span class="token operator">..</span> <span class="token string">", "</span><br>  <span class="token keyword">end</span><br>  <span class="token keyword">return</span> s<span class="token punctuation">:</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><br><span class="token keyword">end</span></code></pre><h2 id="data-structures" tabindex="-1">Data Structures</h2><p>Lua only provides one data structure called a &quot;table&quot;. It is used to represent arrays, dictionaries, trees, and graphs.</p><p>Lua does not support defining classes. Instead it uses a combination of tables and functions for everything.</p><h3 id="tables" tabindex="-1">Tables</h3><p>A Lua table is an associative array.</p><p>To create a table, surround key/value pairs in curly braces. Each key and value are separated by <code>=</code>. Non-string keys must be encloses in square brackets.</p><p>For example:</p><pre class="language-lua"><code class="language-lua">fill_later <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">-- creates an empty table</span><br><br>scores <span class="token operator">=</span> <span class="token punctuation">{</span>Mark <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> Tami <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">}</span> <span class="token comment">-- uses string keys</span><br><br><span class="token comment">-- For string keys that include special characters such as spaces,</span><br><span class="token comment">-- enclose them in square brackets and quotes.</span><br>full_scores <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">"Mark Volkmann"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> Tami <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">}</span> <span class="token comment">-- uses string keys</span><br><br>days_in_month <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">}</span> <span class="token comment">-- uses number keys</span><br><br><span class="token comment">-- This has the same result as the previous line,</span><br><span class="token comment">-- but values are specified without keys.</span><br><span class="token comment">-- Number keys are provided starting from 1.</span><br>days_in_month <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">}</span><br><br>words <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token keyword">true</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"yes"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">false</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"no"</span><span class="token punctuation">}</span> <span class="token comment">-- uses boolean keys</span></code></pre><p>To get the value corresponding to a table key, use square brackets as follows:</p><pre class="language-lua"><code class="language-lua"><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Tami's score is "</span> <span class="token operator">..</span> scores<span class="token punctuation">[</span><span class="token string">"Tami"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">-- 9</span><br><br><span class="token comment">-- When a key is not found, the value returned is `nil`.</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Mary's score is "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">"Mary"</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token string">"unknown"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- unknown</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"April has "</span> <span class="token operator">..</span> days_in_month<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">..</span> <span class="token string">" days."</span><span class="token punctuation">)</span> <span class="token comment">-- 30</span></code></pre><p>To iterate over keys and values, use a <code>for</code> loop with the <code>pairs</code> or <code>ipairs</code> function. For example:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">for</span> name<span class="token punctuation">,</span> score <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token function">print</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token comment">-- Mark 7 and Tami 9 in random order</span><br><span class="token keyword">end</span><br><br><span class="token keyword">for</span> index<span class="token punctuation">,</span> score <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token function">print</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token comment">-- 1 7 and 2 9</span><br><span class="token keyword">end</span></code></pre><p>To add a key/value pair to a table:</p><p>To insert a key/value pair into a table that uses consecutive integer keys starting from one so the keys past the insertion point move up by one:</p><pre class="language-lua"><code class="language-lua">names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Mark"</span><span class="token punctuation">,</span> <span class="token string">"Tami"</span><span class="token punctuation">}</span><br>table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"Comet"</span><span class="token punctuation">)</span><br>table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">)</span> <span class="token comment">-- pushes onto end</span><br><span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">end</span> <span class="token comment">-- Mark Comet Tami Bob</span></code></pre><p>To remove a key/value pair from a table:</p><pre class="language-lua"><code class="language-lua"><span class="token comment">-- For tables with consecutive integer keys starting from one</span><br><span class="token comment">-- where you want the remaining pairs to move down ...</span><br>table<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>my_table<span class="token punctuation">,</span> index<span class="token punctuation">)</span><br>last_value <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>my_table<span class="token punctuation">)</span> <span class="token comment">-- pops the last value and returns it</span><br><br><span class="token comment">-- For all other cases ...</span><br>scores<span class="token punctuation">[</span><span class="token string">"Mark"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span></code></pre><p>To create a string from a table by concatenating all of its values using a given delimiter, use the <code>concat</code> function. This only works for tables that have consecutive integer keys starting from one and values that are strings or numbers. For example:</p><pre class="language-lua"><code class="language-lua">t <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Mark"</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">"Tami"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><br><span class="token function">print</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- "Mark, 7, Tami, 9"</span></code></pre><p>Tables do not store the number of key/value pairs that they contain. To get the count it is necessary to iterate over the table and count the pairs. In tables that contain consecutive integer keys starting from one, <code>#table_var</code> returns the length. The &quot;Lua Functional&quot; library described later defines a <code>length</code> function for computing the size of a table, but it has O(n) complexity.</p><p>Table values can be other tables. This supports creating the equivalent of multi-dimensional arrays. For example:</p><pre class="language-lua"><code class="language-lua">my2d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>my2d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>my2D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"some-value"</span><br><span class="token function">print</span><span class="token punctuation">(</span>my2D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">-- "some-value"</span></code></pre><h2 id="lua-functional-(luafun)" tabindex="-1">Lua Functional (luafun)</h2><p>The <a href="https://www.lua.org/manual/5.4/manual.html#6.6" target="_blank">table</a> library does not include functions such as <code>map</code>, <code>filter</code>, and <code>reduce</code>. These can be found in the <a href="https://luafun.github.io/?v=1.0.20" rel="noopener" target="_blank">Lua Functional Library</a>.</p><p>This library is distributed in the single file <code>fun.lua</code>. To download the file, enter <code>wget https://raw.github.com/luafun/luafun/master/fun.lua</code>.</p><p>The following code demonstrates basic use of this library:</p><pre class="language-lua"><code class="language-lua">fun <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fun"</span><span class="token punctuation">)</span><br><br>scores <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">}</span><br><br><span class="token comment">-- The `map` and `filter` methods returns an iterator.</span><br><span class="token comment">-- Calling `:totable()` on an iterator returns a table.</span><br><br><span class="token comment">-- Using `map` to double numbers in a table.</span><br><span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token number">2</span> <span class="token keyword">end</span><br>doubled_iter <span class="token operator">=</span> fun<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>double<span class="token punctuation">,</span> scores<span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Doubled Scores"</span><span class="token punctuation">)</span><br>fun<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>print<span class="token punctuation">,</span> doubled_iter<span class="token punctuation">)</span> <span class="token comment">-- 14 8 26</span><br><br><span class="token comment">-- Using `filter` to get odd numbers from a table.</span><br><span class="token keyword">function</span> <span class="token function">odd</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">end</span><br>odd_iter <span class="token operator">=</span> fun<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>odd<span class="token punctuation">,</span> scores<span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Odd Scores"</span><span class="token punctuation">)</span><br>fun<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>print<span class="token punctuation">,</span> odd_iter<span class="token punctuation">)</span> <span class="token comment">-- 7 3</span><br><br><span class="token comment">-- Using `reduce` to sum numbers in a table.</span><br><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token keyword">end</span><br>total <span class="token operator">=</span> fun<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> scores<span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Total is "</span> <span class="token operator">..</span> total<span class="token punctuation">)</span> <span class="token comment">-- 24</span><br><br><span class="token comment">-- Doing the same with the `sum` function.</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Total is "</span> <span class="token operator">..</span> fun<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 24</span><br><br><span class="token comment">-- There are MANY more functions in the luafun library!</span><br><br><span class="token comment">-- Can you use a for loop to iterate over values in an interator?</span><br><span class="token comment">-- for k, v in pairs(doubled_scores) do</span><br><span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> doubled_iter<span class="token punctuation">:</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token function">print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token comment">-- 14 8 26</span><br><span class="token keyword">end</span></code></pre><h2 id="standard-library" tabindex="-1">Standard Library</h2><ul><li><a href="https://www.lua.org/manual/5.4/manual.html#6.1" target="_blank">basic</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.2" target="_blank">coroutine</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.10" target="_blank">debug</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.8" target="_blank">io</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.7" target="_blank">math</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.3" target="_blank">modules/package</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.9" target="_blank">os</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.4" target="_blank">string</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.6" target="_blank">table</a></li><li><a href="https://www.lua.org/manual/5.4/manual.html#6.5" target="_blank">utf8</a></li></ul><h2 id="math-module" tabindex="-1">math module</h2><p>Random numbers:</p><ul><li><code>math.randomseed(os.time())</code> seeds the random number generator</li><li><code>math.random()</code> returns a number in the range [0, 1)</li><li><code>math.random(10)</code> returns a number in the range [0, 10)</li><li><code>math.random(5, 10)</code> returns a nubmer in the range [5, 10)</li><li><code>print(string.format('pi is %.2f', math.pi)</code> outputs <code>pi is 3.14</code></li></ul><p>Trigonometry functions:</p><ul><li><p><code>math.sin(angle)</code></p></li><li><p><code>math.cos(angle)</code></p></li><li><p><code>math.tan(angle)</code></p></li><li><p>TODO: Add more!</p></li></ul><h2 id="file-i%2Fo" tabindex="-1">File I/O</h2><p>Files can be opened in one of the following modes where the columns indicate the capabilities of each mode:</p><table><thead><tr><th>Mode</th><th>New</th><th>Overwrite</th><th>Read</th><th>Write</th><th>Append</th></tr></thead><tbody><tr><td><code>r</code></td><td></td><td></td><td>X</td><td></td><td></td></tr><tr><td><code>w</code></td><td>X</td><td>X</td><td></td><td>X</td><td></td></tr><tr><td><code>a</code></td><td>X</td><td></td><td></td><td></td><td>X</td></tr><tr><td><code>r+</code></td><td></td><td></td><td>X</td><td>X</td><td></td></tr><tr><td><code>w+</code></td><td>X</td><td>X</td><td>X</td><td>X</td><td></td></tr><tr><td><code>a+</code></td><td>X</td><td></td><td>X</td><td></td><td>X</td></tr></tbody></table><p>To open a file:</p><pre class="language-lua"><code class="language-lua">file <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> mode<span class="token punctuation">)</span> <span class="token comment">-- mode defaults to "r"</span></code></pre><p>To write to a file:</p><pre class="language-lua"><code class="language-lua">file<span class="token punctuation">:</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre><p>To read the entire contents of a file:</p><pre class="language-lua"><code class="language-lua">data <span class="token operator">=</span> file<span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"*a"</span><span class="token punctuation">)</span></code></pre><p>To seek to a specific byte offset:</p><pre class="language-lua"><code class="language-lua">file<span class="token punctuation">:</span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token string">"set"</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span></code></pre><p>TODO: How do you read a given number of bytes from the current offset?</p><p>To close a file:</p><pre class="language-lua"><code class="language-lua">file<span class="token punctuation">:</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="modules" tabindex="-1">Modules</h2><p>A module is a collection of variables and functions.</p><p>To define a module named <code>my_module</code>, create a file named <code>my_module.lua</code> containing code like the following:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> my_module <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">-- a table</span><br><br>my_module<span class="token punctuation">.</span>some_variable <span class="token operator">=</span> <span class="token string">"some value"</span><br><br><span class="token keyword">function</span> my_module<span class="token punctuation">.</span><span class="token function">some_function</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"some_function was passed "</span> <span class="token operator">..</span> p1 <span class="token operator">..</span> <span class="token string">" and "</span> <span class="token operator">..</span> p2<span class="token punctuation">)</span><br><span class="token keyword">end</span><br><br><span class="token keyword">return</span> my_module</code></pre><p>To use this module:</p><pre class="language-lua"><code class="language-lua">mm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"my_module"</span><span class="token punctuation">)</span><br>mm<span class="token punctuation">.</span><span class="token function">some_function</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span>mm<span class="token punctuation">.</span>some_variable<span class="token punctuation">)</span></code></pre><h2 id="multitasking" tabindex="-1">Multitasking</h2><p>Lua supports collaborative multitasking with coroutines. Coroutines are like threads, but they do not run in parallel.</p><pre class="language-lua"><code class="language-lua"><span class="token comment">-- TODO: Can this function have parameters?</span><br>co <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">...</span><br>  coroutine<span class="token punctuation">.</span><span class="token function">yield</span><span class="token punctuation">(</span><span class="token string">"value #1"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">...</span><br>  coroutine<span class="token punctuation">.</span><span class="token function">yield</span><span class="token punctuation">(</span><span class="token string">"value #1"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">...</span><br>  <span class="token keyword">return</span> <span class="token string">"value #3"</span><br><span class="token keyword">end</span><span class="token punctuation">)</span><br><br>v1 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span> <span class="token comment">-- "value #1"</span><br><span class="token function">print</span><span class="token punctuation">(</span>coroutine<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- "running"</span><br>v2 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span> <span class="token comment">-- "value #2"</span><br>v3 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span> <span class="token comment">-- "value #3"</span><br>v4 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span> — error<br><span class="token function">print</span><span class="token punctuation">(</span>coroutine<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- "suspended"</span></code></pre><h2 id="unorganized-content" tabindex="-1">Unorganized Content</h2><p>when calling functions of a module, can you separate the module name from the function name with either a period or a colon?</p><p>are there linters in code formatters for Lua?</p><p>learn about metamethods and metatables.</p><p>The tonumber function takes a string and returns nil if the string cannot be converted to a number. is there a toboolean function? summarize the constants and functions in the math library and all The Standard, Libraries in markdown tables. how does the math random function know whether you want a floating point or an integer value? can a function that takes an arbitrary number of arguments specify names for the initial arguments? do the math library trigonometry functions expect degrees or radians? there is no character type, only a string tape. multiline strings include the indentations specified. it’s a shame that Lua didn’t choose an abbreviation for the function keyword. can you tell the print function to separate values by a space instead of a tab? Cover using\is to escape characters inside a string literal. \n and \t and \” and \’ and \ does the: syntax for calling a function only work when the variable has a type that maps to a Standard Library like String and number and table and function? what are all the formatting types that string.format supports? Like %s, %i, and %f. string.find returns the start and end indexes inclusive The local keyword can define multiple variables on a single line. ex. local a, b, c = 1, 2, 3 string.gsub returns a new string, and the number of occurrences that were replaced. nil is treated the same as false in a condition. all other values are treated as true. which operators have higher precedence, comparison or logical? This affects whether parentheses are needed in complex conditions. Add a table of Lua operators that list them in precedence order from highest to lowest. can you set a variable to a condition to get a Boolean value? The variable assigned in a for loop is local to the loop. while variable and function names can use camel case, the Lua community seems to prefer using underscores. Is {“a”, “b”, “c”} the same as {1 = “a”, 2 = “b”, 3 = “c”} ? 3 #table_var gives its length. Do tables support methods like push, pop, shift, and shift?</p></article>