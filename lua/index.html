<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2></h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#used-by">Used By</a></li><li><a href="#resources">Resources</a></li><li><a href="#cheat-sheets">Cheat Sheets</a></li><li><a href="#installing">Installing</a></li><li><a href="#compiling">Compiling</a><ol><li><a href="#luac">luac</a></li><li><a href="#luajit">LuaJIT</a></li></ol></li><li><a href="#vs-code-setup">VS Code Setup</a></li><li><a href="#source-files">Source Files</a></li><li><a href="#running-code">Running Code</a></li><li><a href="#keywords">Keywords</a></li><li><a href="#comments">Comments</a></li><li><a href="#types">Types</a></li><li><a href="#input%2Foutput">Input/Output</a></li><li><a href="#variables">Variables</a></li><li><a href="#booleans">Booleans</a></li><li><a href="#numbers">Numbers</a></li><li><a href="#strings">Strings</a></li><li><a href="#operators">Operators</a></li><li><a href="#conditional-logic">Conditional Logic</a></li><li><a href="#iteration">Iteration</a></li><li><a href="#functions">Functions</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://www.lua.org/?v=1.0.20" rel="noopener" target="_blank">Lua</a> is a dynamically typed scripting language created in 1993 by a team at <a href="http://www.puc-rio.br?v=1.0.20" rel="noopener" target="_blank">Pontifical Catholic University of Rio de Janeiro</a> in Brazil.</p><p>The Lua programming language was named after the Moon.</p><p>Lua has an interpreter and a virtual machine. The interpreter is written in C and produces bytecode that runs in the virtual machine. Compiling to bytecode can be done at runtime or ahead of time (although I haven't found a recommended way to do it).</p><p>Lua has a relatively small standard library, but has a large collection of packages that can be installed using the <a href="https://luarocks.org?v=1.0.20" rel="noopener" target="_blank">LuaRocks</a> package manager.</p><p>Pros of Lua include:</p><ul><li>considered to be the fastest scripting language</li><li>free and open sources under the MIT license</li><li>simple syntax with only 21 keywords</li><li>uses dynamic variables that do not require specifying types</li><li>functions are first class and are closures</li><li>implements tail call optimization</li><li>easy to run C code from Lua and run Lua code from C</li><li>easy to embed in C/C++ applications (interpreter is only 182K)</li><li>highly portable (runs on all major OSes and most microcontrollers)</li><li>native support for multitasking with coroutines</li><li>provides automatic, incremental garbage collection</li></ul><p>Cons of Lua include:</p><ul><li><p>limited Unicode support</p><p>Strings can contain unicode characters, but indexing into such strings does not account for their size. See <a href="http://lua-users.org/wiki/LuaUnicode?v=1.0.20" rel="noopener" target="_blank">Lua Unicode</a>.</p></li><li><p>variables and functions are global by default</p></li><li><p>lack of type checking</p></li><li><p>lack of support for object oriented programming (OOP), although it can be simulated with metatables and functions</p></li><li><p>limited support for error handling (see the <code>error</code> and <code>pcall</code> functions)</p></li><li><p>limited support for regular expressions</p></li></ul><p>TODO: Get more from <a href="http://notebook.kulchenko.com/programming/lua-good-different-bad-and-ugly-parts">http://notebook.kulchenko.com/programming/lua-good-different-bad-and-ugly-parts</a>.</p><h2 id="used-by" tabindex="-1">Used By</h2><p>Notable uses of Lua include:</p><ul><li><a href="http://www.legoengineering.com/platform/nxt/?v=1.0.20" rel="noopener" target="_blank">Lego Mindstorms NXT</a></li><li><a href="https://www.minecraft.net/?v=1.0.20" rel="noopener" target="_blank">Minecraft</a> game</li><li><a href="https://neovim.io?v=1.0.20" rel="noopener" target="_blank">Neovim</a> text editor</li><li><a href="https://redis.io?v=1.0.20" rel="noopener" target="_blank">Redis</a> database</li><li><a href="https://www.roblox.com?v=1.0.20" rel="noopener" target="_blank">Roblox</a> game</li><li><a href="https://worldofwarcraft.blizzard.com/?v=1.0.20" rel="noopener" target="_blank">World of Warcraft</a></li></ul><p>Roblox uses a variant of Lua called Luau. TODO: How does that differ?</p><p>For an extensive, see the <a href="https://en.wikipedia.org/wiki/List_of_applications_using_Lua?v=1.0.20" rel="noopener" target="_blank">List of applications using Lua</a> Wikipedia page.</p><h2 id="resources" tabindex="-1">Resources</h2><ul><li><a href="https://www.lua.org/manual/?v=1.0.20" rel="noopener" target="_blank">Lua Reference Manual</a></li><li><a href="https://www.amazon.com/exec/obidos/ASIN/8590379868/lua-pilindex-20?v=1.0.20" rel="noopener" target="_blank">Programming in Lua</a> book</li></ul><h2 id="cheat-sheets" tabindex="-1">Cheat Sheets</h2><ul><li><a href="https://www.codecademy.com/learn/learn-lua/modules/learn-lua-introduction/cheatsheet?v=1.0.20" rel="noopener" target="_blank">codecademy</a></li><li><a href="https://devhints.io/lua?v=1.0.20" rel="noopener" target="_blank">DevHints.io</a></li><li><a href="https://cheatography.com/srgmc/cheat-sheets/lua-scripting-5-1/?v=1.0.20" rel="noopener" target="_blank">Cheatography</a></li></ul><h2 id="installing" tabindex="-1">Installing</h2><p>Lua can be installed in macOS using Homebrew. Enter <code>brew install lua</code> to install it. Enter <code>lua -v</code> to verify that it worked and see the version.</p><p>For installing in other operating systems, see <a href="http://www.lua.org/start.html?v=1.0.20" rel="noopener" target="_blank">Getting Started</a>.</p><p>To experiment with Lua on the web without installing anything, see <a href="http://www.lua.org/demo.html?v=1.0.20" rel="noopener" target="_blank">Lua Demo</a>.</p><h2 id="compiling" tabindex="-1">Compiling</h2><p>Lua programs can be compiled to bytecode before runtime. This enables faster program startup because runtime bytecode generation is no longer needed.</p><p>There are multiple ways to produce and execute Lua bytecode.</p><h3 id="luac" tabindex="-1">luac</h3><p><a href="https://www.lua.org/manual/5.1/luac.html?v=1.0.20" rel="noopener" target="_blank">luac</a> is the standard Lua compiler.</p><p>By default <code>luac</code> creates the file <code>luac.out</code> Use the <code>-o</code> option to change this.</p><p>To generate a bytecode file, enter a command like <code>luac demo.lua -o demo.luac</code>.</p><p>To execute a bytecode file, enter a command like <code>lua demo.luac</code>.</p><h3 id="luajit" tabindex="-1">LuaJIT</h3><p><a href="https://luajit.org/?v=1.0.20" rel="noopener" target="_blank">LuaJIT</a> is an alternative to <code>luac</code> that produces smaller bytecode files. LuaJIT also executes bytecode files and provides runtime optimizations that typically result in better performance.</p><p>From <a href="https://api7.ai/learning-center/openresty/luajit-vs-lua?v=1.0.20" rel="noopener" target="_blank">api7.ai</a>:</p><blockquote><p>The LuaJIT runtime environment ... has a JIT compiler that can generate machine code directly. The LuaJIT interpreter records some runtime statistics while executing the bytecode, such as the actual number of times each Lua function call entry is run and the actual number of times each Lua loop is executed. When these counts exceed a random threshold, the corresponding Lua function entry or Lua loop is considered hot enough to trigger the JIT compiler to start working. The JIT compiler tries to compile the corresponding Lua code path, starting from the hot function's entry or the hot loop's location. The compilation process converts the LuaJIT bytecode into LuaJIT's own defined Intermediate Representation (IR) and then generates machine code for the target architecture.</p></blockquote><p>To install LuaJIT:</p><ul><li>Download the source from <a href="?v=1.0.20" rel="noopener" target="_blank"></a> by entering <code>git clone https://luajit.org/git/luajit.git</code>.</li><li>Enter <code>cd luajit</code></li><li>In macOS, enter <code>export MACOSX_DEPLOYMENT_TARGET={version}</code> where <code>version</code> is a value like <code>13.2</code>.</li><li>Enter <code>make &amp;&amp; sudo make install</code></li><li>The previous command will ask you to create a symlink with a command like <code>ln -sf luajit-2.1.0-beta3 /usr/local/bin/luajit</code>. Enter that command.</li></ul><p>To generate a bytecode file from a Lua program, enter a command like <code>luajit -b demo.lua demo.out</code> To execute a bytecode file, enter a command like <code>luajit demo.out</code>. This will start faster than entering <code>luajit demo.lua</code>.</p><h2 id="vs-code-setup" tabindex="-1">VS Code Setup</h2><p>VS Code has great support for Lua.</p><p>The <a href="https://github.com/LuaLS/lua-language-server?v=1.0.20" rel="noopener" target="_blank">Lua</a> extension from sumneko is a Lua language server. It provides code annotations, syntax checking, dynamic type checking, code formatting, spell checking, and more.</p><p>To disable specific diagnostics, open Settings, filter on &quot;Lua&quot;, scroll down to &quot;Lua &gt; Diagnostics: Disable&quot;, click the &quot;Add Item&quot; button, select a diagnostic name from the dropdown, and click the &quot;OK&quot; button. For example, you may wish to disable &quot;lowercase-global&quot;.</p><p>The <a href="https://github.com/Koihik/vscode-lua-format?v=1.0.20" rel="noopener" target="_blank">vscode-lua-format</a> extension from Koihik is a popular Lua code formatting extension. To configure this, open Settings, filter on &quot;Lua&quot;, and enter the path to a configuration file in &quot;Vscode-lua-format: Config Path&quot; such as <code>/Users/{your-user}/Documents/dev/lang/lua/style.config</code>. Then create the file <code>style.config</code> in that location containing something like the following:</p><pre class="language-text"><code class="language-text"># See all the Lua code formatting options at<br># https://github.com/Koihik/LuaFormatter/blob/master/docs/Style-Config.md<br><br>column_limit: 80<br>continuation_indent_width: 2<br>indent_width: 2<br>keep_simple_control_block_one_line: true<br>keep_simple_function_one_line: true<br>single_quote_to_double_quote: true<br>use_tab: false</code></pre><p>The <a href="https://marketplace.visualstudio.com/items?itemName=actboy168.lua-debug?v=1.0.20" rel="noopener" target="_blank">Lua Debug</a> VS Code extension supports debugging Lua code with breakpoints and watches.</p><h2 id="source-files" tabindex="-1">Source Files</h2><p>Source files have a <code>.lua</code> extension. To execute a source file, enter <code>lua filename.lua</code>.</p><p>A source file can use the variables and functions defined in another source file by using the <code>require</code> function. For example:</p><pre class="language-lua"><code class="language-lua">require <span class="token string">"other"</span></code></pre><h2 id="running-code" tabindex="-1">Running Code</h2><p>To start a Lua REPL, enter <code>lua</code> and then enter Lua statements. To exit the REPL, press ctrl-c or ctrl-d.</p><p>To run a Lua program, enter <code>lua {filename}.lua</code> or <code>luajit {filename}.lua</code>. This runs the source file through the Lua interpreter to produce bytecode and uses the Lua virtual machine to execute the bytecode.</p><p>There are several tools that claim to produce executable files from Lua programs. But none seem to be popular or actively maintained.</p><h2 id="keywords" tabindex="-1">Keywords</h2><p>Lua only defines 21 keywords. Some of the keywords such as <code>end</code>, <code>and</code>, <code>or</code>, and <code>then</code> make the syntax similar to the Ruby programming language.</p><p>Boolean literal values:</p><ul><li>true</li><li>false</li></ul><p>Conditional Logic:</p><ul><li>if</li><li>then</li><li>elseif</li><li>else</li></ul><p>Functions:</p><ul><li>function</li><li>return</li></ul><p>Iteration:</p><ul><li>for: loop over numbers or pairs</li><li>in: specifies what to loop over</li><li>while: top-tested loop</li><li>repeat and until: bottom-tested loop</li><li>break: exit loop early</li></ul><p>Logical Operators:</p><ul><li>and</li><li>or</li><li>not</li></ul><p>Variables:</p><ul><li>local</li></ul><p>Other:</p><ul><li>do: begins a new lexical block</li><li>end: marks the end of a lexical block</li><li>nil: represents having no value</li></ul><h2 id="comments" tabindex="-1">Comments</h2><p>Single-line comments begin with two dashes. Multiline comments begin with <code>--[[</code> and end with <code>--]]</code> or just <code>]]</code>.</p><h2 id="types" tabindex="-1">Types</h2><p>Lua uses dynamic types. The types of variables and function parameters are never specified and are always inferred.</p><p>Primitive type conversions are supported by the <code>tonumber</code> and <code>tostring</code> functions. There are no builtin functions for converting a boolean to a number, a number to a boolean, or a string to a boolean.</p><p>The following table shows how to convert each primitive type to the other primitive types.</p><table><thead><tr><th>From</th><th>To Boolean</th><th>To Number</th><th>To String</th></tr></thead><tbody><tr><td>boolean <code>b</code></td><td>not needed</td><td><code>b and 1 or 0</code></td><td><code>tostring(b)</code></td></tr><tr><td>number <code>n</code></td><td><code>n == 0</code></td><td>not needed</td><td><code>tostring(n)</code></td></tr><tr><td>string <code>s</code></td><td><code>s == &quot;true&quot;</code></td><td><code>tonumber(s)</code></td><td>not needed</td></tr></tbody></table><p>The conversion from a number to a boolean above assumes that all numbers except zero should be treated as false.</p><p>The <code>tonumber</code> function returns <code>nil</code> if the conversion is not possible.</p><h2 id="input%2Foutput" tabindex="-1">Input/Output</h2><p>To write to stdout, use the <code>print</code> function or the<code>io.write</code> function. Both take any number of arguments.</p><p>The <code>print</code> function adds a tab character between each value and a newline at the end of its output. It can be called with no arguments to only write a newline character.</p><p>The <code>io.write</code> function does not add any characters between values and does not add a newline at the end. Boolean values must be converted to strings before being passed to <code>io.write</code>.</p><p>For example:</p><pre class="language-lua"><code class="language-lua"><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment">-- Hello   true    7</span><br>io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token function">tostring</span><span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment">-- Hellotrue7</span></code></pre><p>To read from stdin, use the <code>io.read</code> function.</p><p>The following code prompts for two numbers and prints their sum.</p><pre class="language-lua"><code class="language-lua">io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"First Number: "</span><span class="token punctuation">)</span><br><span class="token comment">-- This form of `io.read` returns a number or nil if a non-number is entered.</span><br>n1 <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"*number"</span><span class="token punctuation">)</span><br><br>io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"Second Number: "</span><span class="token punctuation">)</span><br>n2 <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"*number"</span><span class="token punctuation">)</span><br><br><span class="token keyword">if</span> n1 <span class="token keyword">and</span> n2 <span class="token keyword">then</span><br>  sum <span class="token operator">=</span> n1 <span class="token operator">+</span> n2<br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Sum: "</span> <span class="token operator">..</span> sum<span class="token punctuation">)</span><br><span class="token keyword">else</span><br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"An invalid number was entered."</span><span class="token punctuation">)</span><br><span class="token keyword">end</span></code></pre><h2 id="variables" tabindex="-1">Variables</h2><p>Variable names can contain letters, digits, and underscores, but cannot start with a digit. Hyphens are not allowed. In multi-word names the words can be separated by underscores (preferred) or written in camel-case. For example, <code>one_long_name</code> or <code>oneLongName</code>.</p><p>To assign a value to a variable, use the <code>=</code> operator.</p><p>Variables are global by default. Use the <code>local</code> keyword to make them only exist in their scope.</p><p>For example:</p><pre class="language-lua"><code class="language-lua">a <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- global, even if assigned inside a function</span><br><span class="token keyword">local</span> b <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">-- local to the current scope</span></code></pre><p>TODO: What does <code>_G.name = value</code> do?</p><p>Variables with no assigned value have the value <code>nil</code>.</p><p>New values of any type can be assigned to a variable at any time.</p><p>The <code>type(someVar)</code> function returns a string containing the type name of the variable value. This can be <code>nil</code>, <code>boolean</code>, <code>number</code>, <code>string</code>, <code>table</code>, <code>function</code>, or <code>thread</code>.</p><p>Multi-variable assignment is supported. For example:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><br>a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token comment">-- swaps values</span></code></pre><h2 id="booleans" tabindex="-1">Booleans</h2><p>Boolean literal values are <code>true</code> and <code>false</code>.</p><p>In conditions the only values treated as false are <code>false</code> and <code>nil</code>. The number zero, an empty string, and an empty table are all treated as true.</p><p>Variables can be set to a condition to get a boolean value. For example, <code>is_bigger = my_score &gt; your_score</code> sets <code>is_bigger</code> to <code>true</code> or <code>false</code>.</p><h2 id="numbers" tabindex="-1">Numbers</h2><p>TODO: Are all numbers represented by double-precision floating point?</p><h2 id="strings" tabindex="-1">Strings</h2><p>The string type is used single and multiple character text. Lua does not have a dedicated type for single characters.</p><p>Strings can be delimited with either single or double quotes. For example, <code>'Hello World!'</code> or <code>&quot;Hello World!&quot;</code>.</p><p>Escaping certain characters by preceding them with a backslash changes how they are interpreted. For example, <code>\n</code> produces a newline character, <code>\t</code> produces a tab character, <code>\&quot;</code> produces a double quote inside a string delimited by double quotes, and <code>\'</code> produces a single quote inside a string delimited by single quotes, and <code>\\</code> produces a backslash character.</p><p>Multiline strings are delimiting with <code>[[</code> and <code>]]</code>. For example:</p><pre class="language-lua"><code class="language-lua">haiku <span class="token operator">=</span> <span class="token string">[[<br>Out of memory.<br>We wish to hold the sky.<br>But we never will.<br>]]</span></code></pre><p>Newlines and indentation inside the square brackets are retained.</p><p>Strings are indexed starting from 1 instead of 0.</p><p>Use the <code>..</code> operator to concatenate strings. For example, <code>fullName = firstName .. ' ' .. lastName</code>.</p><p>String operations include:</p><ul><li><p>length: <code>string.len(var)</code> or <code>#var</code></p></li><li><p>substring: <code>string.sub(source, startIndex, endIndex)</code> or <code>source:sub(startIndex, endIndex)</code></p></li><li><p>global substitute: <code>string.gsub(source, oldValue, newValue)</code></p><p>This returns a new string and the number of occurrences that were replaced.</p></li><li><p>find start and end index inclusive: <code>string.find(source, target)</code> or <code>source:find(target)</code></p></li><li><p>uppercase: <code>string.upper(var)</code> or <code>var:upper()</code></p></li><li><p>lowercase: <code>string.lower(var)</code> or <code>var:lower()</code></p></li><li><p>regular expression matches: <code>string.match(someString, 'regular-expression')</code> returns a table of matches?</p></li></ul><p>Lua does not support string interpolation. The closest Lua feature to this is the <code>string.format</code> function. It takes a format string as its first argument. This can contain literal text to be output and formatting directives that begin with a percent sign. The supported formatting directives are:</p><ul><li><code>%o</code> for octal numbers</li><li><code>%x</code> for hexadecimal numbers</li><li><code>%d</code> for decimal numbers</li><li><code>%f</code> for floating point numbers</li><li><code>%s</code> for strings</li></ul><p>The <code>%f</code> directive can specify the number of decimal places to output. For example, to output two decimal places use <code>%.2f</code>.</p><p>For example:</p><pre class="language-lua"><code class="language-lua">name <span class="token operator">=</span> <span class="token string">"Mark"</span><br>color <span class="token operator">=</span> <span class="token string">"yellow"</span><br>sentence <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s's favorite color is %s."</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> color<span class="token punctuation">)</span></code></pre><h2 id="operators" tabindex="-1">Operators</h2><p>Lua supports the following mathematical operators:</p><ul><li><code>+</code> addition</li><li><code>-</code> subtraction or negation</li><li><code>*</code> multiplication</li><li><code>/</code> division</li><li><code>%</code> modulo</li><li><code>^</code> exponentiation</li></ul><p>The <code>++</code> and <code>--</code> operators found in many other programming languages are not supported.</p><p>Lua supports the following relational operators:</p><ul><li><code>==</code> equal</li><li><code>~=</code> not equal (differs from other languages that use <code>!=</code>)</li><li><code>&lt;</code> less than</li><li><code>&gt;</code> greater than</li><li><code>&lt;=</code> less than or equal to</li><li><code>&gt;=</code> greater than or equal to</li></ul><p>Lua supports the following logical operators:</p><ul><li><code>and</code></li><li><code>or</code></li><li><code>not</code></li></ul><p>Lua only supports one assignment operator which is <code>=</code>. It does not support shorthand assignment operators like <code>+=</code>. Adding a number to a variable must be done with <code>myVar = myVar + n</code>.</p><p>The operator <code>..</code> is used to concatenate strings.</p><p>Lua operators have the following precedence from highest to lowest:</p><ul><li><code>^</code></li><li><code>not</code> and unary <code>-</code></li><li><code>+</code> and binary <code>-</code></li><li><code>..</code></li><li><code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, and <code>~=</code></li><li><code>and</code></li><li><code>or</code></li></ul><p>Parentheses can be used to change the evaluation order of parts of a long expression. For example, <code>(a + b) / (c - d)</code> is evaluated differently than <code>a + b / c - d</code>.</p><p>All operators are left associative except for <code>^</code> and <code>..</code> which are right associative. For example, <code>2 ^ 2 ^ 3</code> is the same as <code>2 ^ 8</code> and not <code>4 ^ 3</code>.</p><h2 id="conditional-logic" tabindex="-1">Conditional Logic</h2><p>Parentheses are not required around conditions.</p><p>In an <code>if</code> statement, the <code>elseif</code> and <code>else</code> blocks shown below are optional.</p><p>All the parts of the <code>if</code> statement can be written on a single line if desired.</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">if</span> condition <span class="token keyword">then</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">elseif</span> condition <span class="token keyword">then</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">else</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span></code></pre><p>Lua does not have a <code>switch</code> statement or an equivalent.</p><p>Lua does not have a ternary operator, but the same functionality can be achieved with the following:</p><pre class="language-lua"><code class="language-lua">let result <span class="token operator">=</span> condition <span class="token keyword">and</span> trueValue <span class="token keyword">or</span> falseValue</code></pre><h2 id="iteration" tabindex="-1">Iteration</h2><pre class="language-lua"><code class="language-lua"><span class="token comment">-- Use a `for` loop to iterate over a range of numbers with a given step size.</span><br><span class="token comment">-- The loop variable, `i` in this case, is local to the loop</span><br><span class="token comment">-- and cannot be accessed outside it.</span><br><span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">do</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span><br><br><span class="token comment">-- Use a `for` loop to iterate over the key/value pairs in a table.</span><br><span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>mytable<span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span><br><br><span class="token comment">-- Use a `for` loop to iterate over the indexes and values pairs</span><br><span class="token comment">-- in a table whose keys are consecutive integers starting at 1.</span><br><span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>mytable<span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span><br><br><span class="token comment">-- Use a `while` loop for a top-tested loop</span><br><span class="token comment">-- that stops when a given condition is no longer true.</span><br><span class="token keyword">while</span> condition <span class="token keyword">do</span><br>  <span class="token punctuation">...</span><br><span class="token keyword">end</span><br><br><span class="token comment">-- Use a `repeat`/`until` loop for a bottom-tested loop</span><br><span class="token comment">-- that stops when a given condition becomes true.</span><br><span class="token comment">-- The body is guaranteed to run at least once.</span><br><span class="token keyword">repeat</span> â€” bottom<span class="token operator">-</span>tested<br>  <span class="token punctuation">...</span><br><span class="token keyword">until</span> condition</code></pre><p>Loops can use the <code>break</code> keyword to exit, but the <code>continue</code> keyword for advancing to the next iteration is not supported.</p><h2 id="functions" tabindex="-1">Functions</h2><p>Functions are defined with the <code>function</code> keyword. This is longest keyword in Lua. It's too bad the designers didn't choose a shorter keyword like <code>func</code>, <code>fun</code>, or <code>fn</code>.</p><p>For example:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><br>  <span class="token keyword">return</span> n1 <span class="token operator">+</span> n2<br><span class="token keyword">end</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 5</span></code></pre><p>Functions in Lua are first-class. This means they can take other functions as arguments and can return functions.</p><p>Functions can return multiple values. For example:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">function</span> <span class="token function">getStooges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token keyword">return</span> <span class="token string">"Moe"</span><span class="token punctuation">,</span> <span class="token string">"Larry"</span><span class="token punctuation">,</span> <span class="token string">"Curly"</span><br><span class="token keyword">end</span><br><br>s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s3 <span class="token operator">=</span> <span class="token function">getStooges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s3<span class="token punctuation">)</span> <span class="token comment">-- Moe Larry Curly</span><br>```<br><br>Functions can take a variable number of arguments<span class="token punctuation">.</span><br>For example<span class="token punctuation">:</span><br><br>```lua<br><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span><br>  <span class="token keyword">local</span> sum <span class="token operator">=</span> <span class="token number">0</span><br>  <span class="token keyword">local</span> args <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token punctuation">}</span> <span class="token comment">-- creates a table containing the arguments</span><br>  <span class="token keyword">for</span> _<span class="token punctuation">,</span> n <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token keyword">do</span><br>    sum <span class="token operator">=</span> sum <span class="token operator">+</span> n<br>  <span class="token keyword">end</span><br>  <span class="token keyword">return</span> sum<br><span class="token keyword">end</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"The sum is "</span> <span class="token operator">..</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">"."</span><span class="token punctuation">)</span> <span class="token comment">-- 6</span><br><br><span class="token keyword">function</span> <span class="token function">report</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span><br>  <span class="token keyword">local</span> count <span class="token operator">=</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token string">"#"</span><span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span><br>  <span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">"%s is %d years old and likes %d things.\nThey are"</span><br>  <span class="token keyword">local</span> s <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> count<span class="token punctuation">)</span><br>  <span class="token keyword">local</span> things <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token punctuation">}</span><br>  <span class="token keyword">for</span> index<span class="token punctuation">,</span> thing <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>things<span class="token punctuation">)</span> <span class="token keyword">do</span><br>    <span class="token keyword">local</span> prefix <span class="token operator">=</span> <span class="token string">" "</span><br>    <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">then</span><br>      prefix <span class="token operator">=</span> <span class="token string">" "</span><br>    <span class="token keyword">elseif</span> index <span class="token operator">></span> <span class="token number">1</span> <span class="token keyword">and</span> index <span class="token operator">&lt;</span> count <span class="token keyword">then</span><br>      prefix <span class="token operator">=</span> <span class="token string">", "</span><br>    <span class="token keyword">else</span><br>      prefix <span class="token operator">=</span> <span class="token string">", and "</span><br>    <span class="token keyword">end</span><br>    s <span class="token operator">=</span> s <span class="token operator">..</span> prefix <span class="token operator">..</span> thing<br>  <span class="token keyword">end</span><br>  <span class="token keyword">return</span> s <span class="token operator">..</span> <span class="token string">"."</span><br><span class="token keyword">end</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token string">"Mark"</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token string">"running"</span><span class="token punctuation">,</span> <span class="token string">"biking"</span><span class="token punctuation">,</span> <span class="token string">"programming"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token comment">-- Mark is 61 years old and likes 3 things.</span><br><span class="token comment">-- They are running, biking, and programming.</span><br>```<br><br>Anonymous <span class="token function">functions</span> <span class="token punctuation">(</span>unnamed<span class="token punctuation">)</span> are closures <span class="token keyword">and</span> can be stored <span class="token keyword">in</span> variables<span class="token punctuation">.</span><br>For example<span class="token punctuation">:</span><br><br>```lua<br>product <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><br>  <span class="token keyword">return</span> n1 <span class="token operator">*</span> n2<br><span class="token keyword">end</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">product</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 6</span><br>```<br><br>There are two ways to call functions defined <span class="token keyword">in</span> a module<span class="token operator">/</span>library<span class="token punctuation">.</span><br><br>```lua<br><span class="token comment">-- Approach #1</span><br>library_name<span class="token punctuation">.</span><span class="token function">function_name</span><span class="token punctuation">(</span>target_value<span class="token punctuation">,</span> arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span><br><br><span class="token comment">-- Approach #2</span><br><span class="token comment">-- This implicitly passes `target_value` as the first argument.</span><br><span class="token comment">-- Does this only work when the type of `target_value`</span><br><span class="token comment">-- matches `library_name`?</span><br>target_value<span class="token punctuation">:</span><span class="token function">function_name</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span><br>```<br><br><span class="token operator">#</span><span class="token operator">#</span> Utility Functions<br><br>The following functions are helpful <span class="token keyword">for</span> debugging<span class="token punctuation">.</span><br>They can be defined <span class="token keyword">in</span> a file like `utility<span class="token punctuation">.</span>lua`<br><span class="token keyword">and</span> required where needed<span class="token punctuation">.</span><br><br>```lua<br><span class="token comment">-- Returns a string description of the keys and values in a table.</span><br><span class="token comment">-- Values can be nested tables.</span><br><span class="token keyword">function</span> <span class="token function">dump</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><br>  <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">"table"</span> <span class="token keyword">then</span><br>    <span class="token keyword">return</span> <span class="token function">tostring</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><br>  <span class="token keyword">end</span><br><br>  <span class="token keyword">local</span> s <span class="token operator">=</span> <span class="token string">"{ "</span><br>  <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token keyword">do</span><br>    <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">"number"</span> <span class="token keyword">then</span><br>      k <span class="token operator">=</span> <span class="token string">"\""</span> <span class="token operator">..</span> k <span class="token operator">..</span> <span class="token string">"\""</span><br>    <span class="token keyword">end</span><br>    s <span class="token operator">=</span> s <span class="token operator">..</span> k <span class="token operator">..</span> <span class="token string">"="</span> <span class="token operator">..</span> <span class="token function">dump</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">", "</span> <span class="token comment">-- recursive</span><br>  <span class="token keyword">end</span><br>  <span class="token keyword">return</span> s <span class="token operator">..</span> <span class="token string">"} "</span><br><span class="token keyword">end</span><br><br><span class="token comment">-- Returns a string containing all the values in a table,</span><br><span class="token comment">-- each separated by a comma and a space.</span><br><span class="token comment">-- Values cannot be nested tables.</span><br><span class="token keyword">function</span> <span class="token function">valuesString</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><br>  <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">"table"</span> <span class="token keyword">then</span><br>    <span class="token keyword">return</span> <span class="token string">""</span><br>  <span class="token keyword">end</span><br><br>  s <span class="token operator">=</span> <span class="token string">""</span><br>  <span class="token keyword">for</span> index<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token keyword">do</span><br>    s <span class="token operator">=</span> s <span class="token operator">..</span> v <span class="token operator">..</span> <span class="token string">", "</span><br>  <span class="token keyword">end</span><br>  <span class="token keyword">return</span> s<span class="token punctuation">:</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><br><span class="token keyword">end</span><br>```<br><br><span class="token operator">#</span><span class="token operator">#</span> Data Structures<br><br>Lua only provides one data structure called a <span class="token string">"table"</span><span class="token punctuation">.</span><br>It is used to represent arrays<span class="token punctuation">,</span> dictionaries<span class="token punctuation">,</span> trees<span class="token punctuation">,</span> <span class="token keyword">and</span> graphs<span class="token punctuation">.</span><br><br>Lua does <span class="token keyword">not</span> support defining classes<span class="token punctuation">.</span><br>Instead it uses a combination of tables <span class="token keyword">and</span> functions <span class="token keyword">for</span> everything<span class="token punctuation">.</span><br><br><span class="token operator">#</span><span class="token operator">#</span><span class="token operator">#</span> Tables<br><br>A Lua table is an associative array<span class="token punctuation">.</span><br><br>To create a table<span class="token punctuation">,</span> surround key<span class="token operator">/</span>value pairs <span class="token keyword">in</span> curly braces<span class="token punctuation">.</span><br>Each key <span class="token keyword">and</span> value are separated by `<span class="token operator">=</span>`<span class="token punctuation">.</span><br>Non<span class="token operator">-</span>string keys must be encloses <span class="token keyword">in</span> square brackets<span class="token punctuation">.</span><br><br>For example<span class="token punctuation">:</span><br><br>```lua<br>fill_later <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">-- creates an empty table</span><br><br>scores <span class="token operator">=</span> <span class="token punctuation">{</span>Mark <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> Tami <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">}</span> <span class="token comment">-- uses string keys</span><br><br><span class="token comment">-- For string keys that include special characters such as spaces,</span><br><span class="token comment">-- enclose them in square brackets and quotes.</span><br>full_scores <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">"Mark Volkmann"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> Tami <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">}</span> <span class="token comment">-- uses string keys</span><br><br>days_in_month <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">}</span> <span class="token comment">-- uses number keys</span><br><br><span class="token comment">-- This has the same result as the previous line,</span><br><span class="token comment">-- but values are specified without keys.</span><br><span class="token comment">-- Number keys are provided starting from 1.</span><br>days_in_month <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">}</span><br><br>words <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token keyword">true</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"yes"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">false</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"no"</span><span class="token punctuation">}</span> <span class="token comment">-- uses boolean keys</span><br>```<br><br>To get the value corresponding to a table key<span class="token punctuation">,</span> use square brackets<br>as follows<span class="token punctuation">:</span><br><br>```lua<br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Tami's score is "</span> <span class="token operator">..</span> scores<span class="token punctuation">[</span><span class="token string">"Tami"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">-- 9</span><br><br><span class="token comment">-- When a key is not found, the value returned is `nil`.</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Mary's score is "</span> <span class="token operator">..</span> <span class="token punctuation">(</span>scores<span class="token punctuation">[</span><span class="token string">"Mary"</span><span class="token punctuation">]</span> <span class="token keyword">or</span> <span class="token string">"unknown"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- unknown</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"April has "</span> <span class="token operator">..</span> days_in_month<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">..</span> <span class="token string">" days."</span><span class="token punctuation">)</span> <span class="token comment">-- 30</span><br>```<br><br>To iterate over keys <span class="token keyword">and</span> values<span class="token punctuation">,</span> use a `<span class="token keyword">for</span>` loop<br>with the `pairs` <span class="token keyword">or</span> `ipairs` <span class="token keyword">function</span><span class="token punctuation">.</span><br>For example<span class="token punctuation">:</span><br><br>```lua<br><span class="token keyword">for</span> name<span class="token punctuation">,</span> score <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token function">print</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token comment">-- Mark 7 and Tami 9 in random order</span><br><span class="token keyword">end</span><br><br><span class="token keyword">for</span> index<span class="token punctuation">,</span> score <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token function">print</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> score<span class="token punctuation">)</span> <span class="token comment">-- 1 7 and 2 9</span><br><span class="token keyword">end</span><br>```<br><br>To add a key<span class="token operator">/</span>value pair to a table<span class="token punctuation">:</span><br><br>To insert a key<span class="token operator">/</span>value pair into a table that uses<br>consecutive integer keys starting from one<br>so the keys past the insertion point move up by one<span class="token punctuation">:</span><br><br>```lua<br>names <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Mark"</span><span class="token punctuation">,</span> <span class="token string">"Tami"</span><span class="token punctuation">}</span><br>table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"Comet"</span><span class="token punctuation">)</span> <span class="token comment">-- expensive for large tables</span><br>table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">)</span> <span class="token comment">-- pushes onto end</span><br><span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">end</span> <span class="token comment">-- Mark Comet Tami Bob</span><br>```<br><br>To remove a key<span class="token operator">/</span>value pair from a table<span class="token punctuation">:</span><br><br>```lua<br><span class="token comment">-- For tables with consecutive integer keys starting from one</span><br><span class="token comment">-- where you want the remaining pairs to move down ...</span><br>table<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>my_table<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token comment">-- expensive for large tables</span><br>last_value <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>my_table<span class="token punctuation">)</span> <span class="token comment">-- pops the last value and returns it</span><br><br><span class="token comment">-- For all other cases ...</span><br>scores<span class="token punctuation">[</span><span class="token string">"Mark"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span><br>```<br><br>To create a string from a table by concatenating all of its values<br>using a given delimiter<span class="token punctuation">,</span> use the `concat` <span class="token keyword">function</span><span class="token punctuation">.</span><br>This only works <span class="token keyword">for</span> tables that have consecutive integer keys starting from one<br><span class="token keyword">and</span> values that are strings <span class="token keyword">or</span> numbers<span class="token punctuation">.</span><br>For example<span class="token punctuation">:</span><br><br>```lua<br>t <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Mark"</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">"Tami"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><br><span class="token function">print</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- "Mark, 7, Tami, 9"</span><br>```<br><br>Tables <span class="token keyword">do</span> <span class="token keyword">not</span> store the number of key<span class="token operator">/</span>value pairs that they contain<span class="token punctuation">.</span><br>To get the count it is necessary to iterate over the table <span class="token keyword">and</span> count the pairs<span class="token punctuation">.</span><br>In tables that contain consecutive integer keys starting from one<span class="token punctuation">,</span><br>`<span class="token operator">#</span>table_var` returns the length<span class="token punctuation">.</span><br>The <span class="token string">"Lua Functional"</span> library described later defines a `length` <span class="token keyword">function</span><br><span class="token keyword">for</span> computing the size of a table<span class="token punctuation">,</span> but it has <span class="token function">O</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> complexity<span class="token punctuation">.</span><br><br>Table values can be other tables<span class="token punctuation">.</span><br>This supports creating the equivalent of multi<span class="token operator">-</span>dimensional arrays<span class="token punctuation">.</span><br>For example<span class="token punctuation">:</span><br><br>```lua<br>my2d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>my2d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>my2D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"some-value"</span><br><span class="token function">print</span><span class="token punctuation">(</span>my2D<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">-- "some-value"</span><br>```<br><br><span class="token operator">#</span><span class="token operator">#</span> Lua <span class="token function">Functional</span> <span class="token punctuation">(</span>luafun<span class="token punctuation">)</span><br><br>The <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.6"</span><br>target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>table<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span> library does <span class="token keyword">not</span> include<br>functions such as `map`<span class="token punctuation">,</span> `filter`<span class="token punctuation">,</span> <span class="token keyword">and</span> `reduce`<span class="token punctuation">.</span><br>These can be found <span class="token keyword">in</span> the <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://luafun.github.io/?v=1.0.20"</span> rel<span class="token operator">=</span><span class="token string">"noopener"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>Lua Functional Library<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token punctuation">.</span><br><br>This library is distributed <span class="token keyword">in</span> the single file `fun<span class="token punctuation">.</span>lua`<span class="token punctuation">.</span><br>To download the file<span class="token punctuation">,</span> enter<br>`wget https<span class="token punctuation">:</span><span class="token operator">//</span>raw<span class="token punctuation">.</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>luafun<span class="token operator">/</span>luafun<span class="token operator">/</span>master<span class="token operator">/</span>fun<span class="token punctuation">.</span>lua`<span class="token punctuation">.</span><br><br>The following code demonstrates basic use of this library<span class="token punctuation">:</span><br><br>```lua<br>fun <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fun"</span><span class="token punctuation">)</span><br><br>scores <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">}</span><br><br><span class="token comment">-- The `map` and `filter` methods returns an iterator.</span><br><span class="token comment">-- Calling `:totable()` on an iterator returns a table.</span><br><br><span class="token comment">-- Using `map` to double numbers in a table.</span><br><span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token number">2</span> <span class="token keyword">end</span><br>doubled_iter <span class="token operator">=</span> fun<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>double<span class="token punctuation">,</span> scores<span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Doubled Scores"</span><span class="token punctuation">)</span><br>fun<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>print<span class="token punctuation">,</span> doubled_iter<span class="token punctuation">)</span> <span class="token comment">-- 14 8 26</span><br><br><span class="token comment">-- Using `filter` to get odd numbers from a table.</span><br><span class="token keyword">function</span> <span class="token function">odd</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">end</span><br>odd_iter <span class="token operator">=</span> fun<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>odd<span class="token punctuation">,</span> scores<span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Odd Scores"</span><span class="token punctuation">)</span><br>fun<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>print<span class="token punctuation">,</span> odd_iter<span class="token punctuation">)</span> <span class="token comment">-- 7 3</span><br><br><span class="token comment">-- Using `reduce` to sum numbers in a table.</span><br><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token keyword">end</span><br>total <span class="token operator">=</span> fun<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> scores<span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Total is "</span> <span class="token operator">..</span> total<span class="token punctuation">)</span> <span class="token comment">-- 24</span><br><br><span class="token comment">-- Doing the same with the `sum` function.</span><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Total is "</span> <span class="token operator">..</span> fun<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 24</span><br><br><span class="token comment">-- There are MANY more functions in the luafun library!</span><br><br><span class="token comment">-- Can you use a for loop to iterate over values in an interator?</span><br><span class="token comment">-- for k, v in pairs(doubled_scores) do</span><br><span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> doubled_iter<span class="token punctuation">:</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">do</span><br>  <span class="token function">print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token comment">-- 14 8 26</span><br><span class="token keyword">end</span><br>```<br><br><span class="token operator">#</span><span class="token operator">#</span> Standard Library<br><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.1"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>basic<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.2"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>coroutine<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.10"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>debug<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.8"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>io<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.7"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>math<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.3"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>modules<span class="token operator">/</span>package<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.9"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>os<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.4"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>string<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.6"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>table<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><span class="token operator">-</span> <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://www.lua.org/manual/5.4/manual.html#6.5"</span> target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>utf8<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><br><br><span class="token operator">#</span><span class="token operator">#</span><span class="token operator">#</span> math module<br><br>Constants defined by this library include<span class="token punctuation">:</span><br><br><span class="token operator">-</span> `math<span class="token punctuation">.</span>huge` <span class="token operator">-</span> floating point value greater than any other number<br><span class="token operator">-</span> `math<span class="token punctuation">.</span>maxinteger` <span class="token operator">-</span> maximum integer value<br><span class="token operator">-</span> `math<span class="token punctuation">.</span>mininteger` <span class="token operator">-</span> minimum integer value<br><span class="token operator">-</span> `math<span class="token punctuation">.</span>pi` <span class="token operator">-</span> value of Ï€<br><br>Trigonometry functions defined by this library include<br>`sin`<span class="token punctuation">,</span> `cos`<span class="token punctuation">,</span> `tan`<span class="token punctuation">,</span> `asin`<span class="token punctuation">,</span> `acos`<span class="token punctuation">,</span> <span class="token keyword">and</span> `atan`<span class="token punctuation">.</span><br>All of these take <span class="token keyword">and</span> <span class="token keyword">return</span> angles <span class="token keyword">in</span> radians<span class="token punctuation">.</span><br>To convert an angle from degrees to radians<span class="token punctuation">,</span> use the `math<span class="token punctuation">.</span><span class="token function">rad</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` <span class="token keyword">function</span><span class="token punctuation">.</span><br>To convert an angle from radians to degrees<span class="token punctuation">,</span> use the `math<span class="token punctuation">.</span><span class="token function">deg</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` <span class="token keyword">function</span><span class="token punctuation">.</span><br><br>To generate random numbers<span class="token punctuation">,</span> use the<br>`math<span class="token punctuation">.</span>randomseed` <span class="token keyword">and</span> `math<span class="token punctuation">.</span>random` functions<span class="token punctuation">.</span><br><br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">randomseed</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>` seeds the random number generator<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>` returns a floating point number <span class="token keyword">in</span> the range <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>` returns an integer <span class="token keyword">in</span> the range <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>` returns an integer <span class="token keyword">in</span> the range <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><br><br>Other functions defined <span class="token keyword">in</span> this library include<span class="token punctuation">:</span><br><br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` <span class="token keyword">for</span> absolute value<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` <span class="token keyword">for</span> <span class="token function">ceiling</span> <span class="token punctuation">(</span>rounds up<span class="token punctuation">)</span><br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` <span class="token keyword">for</span> e raised to the x power<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` <span class="token keyword">for</span> <span class="token function">floor</span> <span class="token punctuation">(</span>rounds down<span class="token punctuation">)</span><br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">fmod</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>` <span class="token keyword">for</span> floating point remainder of x <span class="token operator">/</span> y<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token punctuation">[</span>base<span class="token punctuation">]</span><span class="token punctuation">)</span>` <span class="token keyword">for</span> logarithm of x with specified base <span class="token keyword">or</span> e<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span>` <span class="token keyword">for</span> maximum of a set of numbers<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span>` <span class="token keyword">for</span> minimum of a set of numbers<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">modf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` <span class="token keyword">for</span> integral <span class="token keyword">and</span> fractional parts of a floating point number<br><br>  For example<span class="token punctuation">,</span> `math<span class="token punctuation">.</span><span class="token function">modf</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">)</span>` returns `<span class="token number">3</span>` <span class="token keyword">and</span> `<span class="token number">0.14</span>`<br><br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` <span class="token keyword">for</span> square root<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">tointeger</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` returns an integer value <span class="token keyword">if</span> x<br>  can be converted to an integer<span class="token punctuation">;</span> otherwise `<span class="token keyword">nil</span>`<br><br>  The value passed can be a number <span class="token keyword">or</span> string<span class="token punctuation">.</span><br>  For example<span class="token punctuation">,</span> `math<span class="token punctuation">.</span><span class="token function">tointeger</span><span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">)</span>` <span class="token keyword">and</span> `math<span class="token punctuation">.</span><span class="token function">tointeger</span><span class="token punctuation">(</span><span class="token string">"3.0"</span><span class="token punctuation">)</span>` returns `<span class="token number">3</span>`<span class="token punctuation">,</span><br>  <span class="token keyword">and</span> `math<span class="token punctuation">.</span><span class="token function">tointeger</span><span class="token punctuation">(</span><span class="token number">3.1</span><span class="token punctuation">)</span>` returns `<span class="token keyword">nil</span>`<span class="token punctuation">.</span><br><br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>` returns `<span class="token string">"integer"</span>`<span class="token punctuation">,</span> `<span class="token string">"float"</span>`<span class="token punctuation">,</span> <span class="token keyword">or</span> `<span class="token keyword">nil</span>`<br><span class="token operator">-</span> `math<span class="token punctuation">.</span><span class="token function">ult</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span>` returns `<span class="token keyword">true</span>` <span class="token keyword">if</span> m <span class="token operator">&lt;</span> n when<br>  compared as unsigned integers<span class="token punctuation">;</span> otherwise `<span class="token keyword">false</span>`<br><br><span class="token operator">#</span><span class="token operator">#</span> File I<span class="token operator">/</span>O<br><br>Files can be opened <span class="token keyword">in</span> one of the following modes<br>where the columns indicate the capabilities of each mode<span class="token punctuation">:</span><br><br><span class="token operator">|</span> Mode <span class="token operator">|</span> New <span class="token operator">|</span> Overwrite <span class="token operator">|</span> Read <span class="token operator">|</span> Write <span class="token operator">|</span> Append <span class="token operator">|</span><br><span class="token operator">|</span> <span class="token comment">---- | --- | --------- | ---- | ----- | ------ |</span><br><span class="token operator">|</span> `r`  <span class="token operator">|</span>     <span class="token operator">|</span>           <span class="token operator">|</span> X    <span class="token operator">|</span>       <span class="token operator">|</span>        <span class="token operator">|</span><br><span class="token operator">|</span> `w`  <span class="token operator">|</span> X   <span class="token operator">|</span> X         <span class="token operator">|</span>      <span class="token operator">|</span> X     <span class="token operator">|</span>        <span class="token operator">|</span><br><span class="token operator">|</span> `a`  <span class="token operator">|</span> X   <span class="token operator">|</span>           <span class="token operator">|</span>      <span class="token operator">|</span>       <span class="token operator">|</span> X      <span class="token operator">|</span><br><span class="token operator">|</span> `r<span class="token operator">+</span>` <span class="token operator">|</span>     <span class="token operator">|</span>           <span class="token operator">|</span> X    <span class="token operator">|</span> X     <span class="token operator">|</span>        <span class="token operator">|</span><br><span class="token operator">|</span> `w<span class="token operator">+</span>` <span class="token operator">|</span> X   <span class="token operator">|</span> X         <span class="token operator">|</span> X    <span class="token operator">|</span> X     <span class="token operator">|</span>        <span class="token operator">|</span><br><span class="token operator">|</span> `a<span class="token operator">+</span>` <span class="token operator">|</span> X   <span class="token operator">|</span>           <span class="token operator">|</span> X    <span class="token operator">|</span>       <span class="token operator">|</span> X      <span class="token operator">|</span><br><br>To open a file<span class="token punctuation">:</span><br><br>```lua<br>file <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> mode<span class="token punctuation">)</span> <span class="token comment">-- mode defaults to "r"</span><br>```<br><br>To write to a file<span class="token punctuation">:</span><br><br>```lua<br>file<span class="token punctuation">:</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><br>```<br><br>To read from a file<span class="token punctuation">:</span><br><br>```lua<br>contents <span class="token operator">=</span> file<span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"*all"</span><span class="token punctuation">)</span> <span class="token comment">-- reads the entire contents</span><br>line <span class="token operator">=</span> file<span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"*line"</span><span class="token punctuation">)</span> <span class="token comment">-- reads the next line</span><br>number <span class="token operator">=</span> file<span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"*number"</span><span class="token punctuation">)</span> <span class="token comment">-- reads a number</span><br>n1<span class="token punctuation">,</span> n2 <span class="token operator">=</span> file<span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"*number"</span><span class="token punctuation">,</span> <span class="token string">"*number"</span><span class="token punctuation">)</span> <span class="token comment">-- reads two numbers</span><br>text <span class="token operator">=</span> file<span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment">-- reads a string of up to "n" characters</span><br>end_test <span class="token operator">=</span> file<span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">-- returns nil if at end of file; otherwise returns ""</span><br>```<br><br>To seek to a specific byte offset<span class="token punctuation">:</span><br><br>```lua<br>file<span class="token punctuation">:</span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token string">"set"</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><br>```<br><br>TODO<span class="token punctuation">:</span> How <span class="token keyword">do</span> you read a given number of bytes from the current offset?<br><br>To close a file<span class="token punctuation">:</span><br><br>```lua<br>file<span class="token punctuation">:</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>```<br><br><span class="token operator">#</span><span class="token operator">#</span> Modules<br><br>A module is a collection of variables <span class="token keyword">and</span> functions<span class="token punctuation">.</span><br><br>To define a module named `my_module`<span class="token punctuation">,</span> create a file<br>named `my_module<span class="token punctuation">.</span>lua` containing code like the following<span class="token punctuation">:</span><br><br>```lua<br><span class="token keyword">local</span> my_module <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">-- a table</span><br><br>my_module<span class="token punctuation">.</span>some_variable <span class="token operator">=</span> <span class="token string">"some value"</span><br><br><span class="token keyword">function</span> my_module<span class="token punctuation">.</span><span class="token function">some_function</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><br>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"some_function was passed "</span> <span class="token operator">..</span> p1 <span class="token operator">..</span> <span class="token string">" and "</span> <span class="token operator">..</span> p2<span class="token punctuation">)</span><br><span class="token keyword">end</span><br><br><span class="token keyword">return</span> my_module<br>```<br><br>To use this module<span class="token punctuation">:</span><br><br>```lua<br>mm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"my_module"</span><span class="token punctuation">)</span><br>mm<span class="token punctuation">.</span><span class="token function">some_function</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><br><span class="token function">print</span><span class="token punctuation">(</span>mm<span class="token punctuation">.</span>some_variable<span class="token punctuation">)</span><br>```<br><br><span class="token operator">#</span><span class="token operator">#</span> Multitasking<br><br>Lua supports collaborative multitasking with coroutines<span class="token punctuation">.</span><br>Coroutines are like threads<span class="token punctuation">,</span> but they <span class="token keyword">do</span> <span class="token keyword">not</span> run <span class="token keyword">in</span> parallel<span class="token punctuation">.</span><br><br>```lua<br><span class="token comment">-- TODO: Can this function have parameters?</span><br>co <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token punctuation">...</span><br>  coroutine<span class="token punctuation">.</span><span class="token function">yield</span><span class="token punctuation">(</span><span class="token string">"value #1"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">...</span><br>  coroutine<span class="token punctuation">.</span><span class="token function">yield</span><span class="token punctuation">(</span><span class="token string">"value #1"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">...</span><br>  <span class="token keyword">return</span> <span class="token string">"value #3"</span><br><span class="token keyword">end</span><span class="token punctuation">)</span><br><br>v1 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span> <span class="token comment">-- "value #1"</span><br><span class="token function">print</span><span class="token punctuation">(</span>coroutine<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- "running"</span><br>v2 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span> <span class="token comment">-- "value #2"</span><br>v3 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span> <span class="token comment">-- "value #3"</span><br>v4 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span> â€” error<br><span class="token function">print</span><span class="token punctuation">(</span>coroutine<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>co<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- "suspended"</span><br>```<br><br><span class="token operator">#</span><span class="token operator">#</span> Error Handling<br><br>Lua does <span class="token keyword">not</span> have a mechanism <span class="token keyword">for</span> throwing <span class="token keyword">and</span> catching exceptions<span class="token punctuation">.</span><br>In many cases errors result <span class="token keyword">in</span> a <span class="token keyword">function</span> returning the value `<span class="token keyword">nil</span>`<br><span class="token keyword">and</span> it left to developers to check <span class="token keyword">for</span> `<span class="token keyword">nil</span>` values<span class="token punctuation">.</span><br>Failing to <span class="token keyword">do</span> so often results <span class="token keyword">in</span> programs crashing<br><span class="token keyword">and</span> outputting a stack trace<span class="token punctuation">.</span><br><br>The only error handling mechanism Lua provides is the `pcall` <span class="token keyword">function</span><br><span class="token punctuation">(</span>short <span class="token keyword">for</span> <span class="token string">"protected call"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><br>This <span class="token keyword">function</span> is passed a <span class="token keyword">function</span> to execute <span class="token keyword">and</span><br>optionally arguments to be passed to it<span class="token punctuation">.</span><br>It returns a boolean indicating whether the call completed without error<br><span class="token keyword">and</span> an error message <span class="token keyword">if</span> one did occur<span class="token punctuation">.</span><br><br>The `error` <span class="token keyword">function</span> is the Lua equivalent of<br>a `throw` statement <span class="token keyword">in</span> many other programming languages<span class="token punctuation">.</span><br>It is passed a message <span class="token keyword">and</span> an optional integer error level<span class="token punctuation">.</span><br>The message can be any type<span class="token punctuation">,</span> but is typically a string <span class="token keyword">or</span> a table<span class="token punctuation">.</span><br><br>The following code demonstrates using the `pcall` <span class="token keyword">function</span><span class="token punctuation">.</span><br>It repeated prompts <span class="token keyword">for</span> a dividend <span class="token keyword">and</span> a divisor<br><span class="token keyword">and</span> displays their quotient<span class="token punctuation">.</span><br>When invalid values are entered<span class="token punctuation">,</span> error messages are output<span class="token punctuation">,</span><br>but the program does <span class="token keyword">not</span> crash<span class="token punctuation">.</span><br><br>```lua<br><span class="token keyword">function</span> <span class="token function">read_number</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><br>  io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>prompt <span class="token operator">..</span> <span class="token string">": "</span><span class="token punctuation">)</span><br>  <span class="token keyword">local</span> number <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">"*number"</span><span class="token punctuation">)</span><br>  <span class="token comment">-- The previous line does not consume the newline character.</span><br>  <span class="token comment">-- Unless that is done, the next attempt to read a number will return `nil`.</span><br>  <span class="token comment">-- The following line consumes the newline character.</span><br>  <span class="token keyword">local</span> _ <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token keyword">return</span> number<br><span class="token keyword">end</span><br><br><span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>  <span class="token keyword">local</span> dividend <span class="token operator">=</span> <span class="token function">read_number</span><span class="token punctuation">(</span><span class="token string">"Enter a dividend"</span><span class="token punctuation">)</span><br>  <span class="token keyword">if</span> <span class="token keyword">not</span> dividend <span class="token keyword">then</span><br>    <span class="token comment">-- Error messages here are tables containing a message and a code.</span><br>    <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">{</span>message <span class="token operator">=</span> <span class="token string">"dividend is invalid"</span><span class="token punctuation">,</span> code <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token keyword">end</span><br><br>  <span class="token keyword">local</span> divisor <span class="token operator">=</span> <span class="token function">read_number</span><span class="token punctuation">(</span><span class="token string">"Enter a divisor"</span><span class="token punctuation">)</span><br>  <span class="token keyword">if</span> <span class="token keyword">not</span> divisor <span class="token keyword">then</span><br>    <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">{</span>message <span class="token operator">=</span> <span class="token string">"divisor is invalid"</span><span class="token punctuation">,</span> code <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token keyword">end</span><br>  <span class="token keyword">if</span> divisor <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">then</span><br>    <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">{</span>message <span class="token operator">=</span> <span class="token string">"cannot divide by zero"</span><span class="token punctuation">,</span> code <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token keyword">end</span><br><br>  <span class="token keyword">local</span> quotient <span class="token operator">=</span> dividend <span class="token operator">/</span> divisor<br>  io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"The quotient is %.3f\n\n"</span><span class="token punctuation">,</span> quotient<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token keyword">end</span><br><br><span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span><br>  <span class="token keyword">local</span> success<span class="token punctuation">,</span> err <span class="token operator">=</span> <span class="token function">pcall</span><span class="token punctuation">(</span>process<span class="token punctuation">)</span><br>  <span class="token keyword">if</span> <span class="token keyword">not</span> success <span class="token keyword">then</span><br>    <span class="token keyword">if</span> err <span class="token keyword">then</span><br>      <span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s (code %d)"</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">,</span> err<span class="token punctuation">.</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token keyword">end</span><br>    <span class="token comment">-- print(debug.traceback()) -- prints a stack trace</span><br>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- extra newline</span><br>  <span class="token keyword">end</span><br><span class="token keyword">end</span><br>```<br><br><span class="token operator">#</span><span class="token operator">#</span> Unorganized Content<br><br>learn about metamethods <span class="token keyword">and</span> metatables<span class="token punctuation">.</span><br><br>summarize the constants <span class="token keyword">and</span> functions <span class="token keyword">in</span> all the standard libraries<br><br>can a <span class="token keyword">function</span> that takes an arbitrary number of arguments specify names <span class="token keyword">for</span> the initial arguments?<br><br>does the<span class="token punctuation">:</span> syntax <span class="token keyword">for</span> calling a <span class="token keyword">function</span> only work when the variable has a type that maps to a Standard Library like String <span class="token keyword">and</span> number <span class="token keyword">and</span> table <span class="token keyword">and</span> <span class="token keyword">function</span>?</code></pre></article>