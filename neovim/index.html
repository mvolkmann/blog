<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>neovim</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#installing">Installing</a></li><li><a href="#configuring">Configuring</a></li><li><a href="#creating-files-and-directories">Creating Files and Directories</a></li><li><a href="#sourcing-files">Sourcing Files</a></li><li><a href="#plugins">Plugins</a></li><li><a href="#plugin-manager">Plugin Manager</a></li><li><a href="#lsp-zero">LSP Zero</a><ol><li><a href="#key-bindings">Key Bindings</a></li></ol></li><li><a href="#telescope">Telescope</a></li><li><a href="#treesitter">Treesitter</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p><img alt="neovim logo" style="width: 40%" src="/blog/assets/neovim.png?v=1.0.20" title="neovim logo"></p><p><a href="https://neovim.io?v=1.0.20" rel="noopener" target="_blank">Neovim</a> is a modern rewrite of the Vim text editor.</p><h2 id="installing" tabindex="-1">Installing</h2><p>In macos, neovim can be installed using Homebrew. by entering <code>brew install neovim</code>.</p><p>If you are already in the habit of using Vim, it's a good idea to add an alias from &quot;vim&quot; to &quot;nvim&quot; in your shell configuration file. For zsh, edit <code>~/.zshrc</code> and add <code>alias vim=&quot;nvim&quot;</code>.</p><h2 id="configuring" tabindex="-1">Configuring</h2><p>Neovim is configured using Vimscript or the Lua programming language.</p><p>Create the file <code>~/.config/nvim/init.lua</code>.</p><p>Some suggested content for this file is the following: TODO: Copy more from your init.lua file!</p><pre class="language-lua"><code class="language-lua"><span class="token comment">-- TODO: Does this only look for "plugins.lua" in the "lua" subdirectory?</span><br><span class="token comment">-- TODO: Can "lua/plugins.lua" be moved to the same directory as this file?</span><br>require <span class="token string">"plugins"</span><br><br><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"I am in init.lua!"</span><span class="token punctuation">)</span><br><br><span class="token comment">-- TODO: Improve color of line numbers.</span><br><span class="token comment">-- TODO: Configure cmd-s to save.</span><br><br>vim<span class="token punctuation">.</span>g<span class="token punctuation">.</span>mapleader <span class="token operator">=</span> <span class="token string">" "</span> <span class="token comment">-- many people use comman instead of space</span><br><br><span class="token comment">-- This causes the yank(copy) and delete(cut) commands to copy to the</span><br><span class="token comment">-- system clipboard so the copied text can be pasted into another app.</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>clipboard <span class="token operator">=</span> <span class="token string">'unnamed'</span><br><br><span class="token keyword">local</span> indent <span class="token operator">=</span> <span class="token number">2</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>shiftwidth<span class="token operator">=</span>indent <span class="token comment">-- indent code with two spaces</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>softtabstop<span class="token operator">=</span>indent <span class="token comment">-- tabs take two spaces</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>tabstop<span class="token operator">=</span>indent <span class="token comment">-- tabs take two spaces</span><br><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>colorcolumn <span class="token operator">=</span> <span class="token string">"80"</span> <span class="token comment">-- displays a vertical strip at column 80 (not 81)</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>expandtab <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">-- replace tabs with spaces</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>hlsearch <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">-- highlights all search matches, not just first</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>incsearch <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">-- performs incremental searching.</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">-- shows line numbers</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>relativenumber<span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">-- shows relative line numbers</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>shiftround <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">--round indent to multiples of shiftwidth</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>smartindent <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">-- pressing tab key in insert mode insert spaces</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>smarttab <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">-- pressing tab key in insert mode insert spaces</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>termguicolors <span class="token operator">=</span> <span class="token keyword">true</span> <span class="token comment">-- uses 24-bit colors</span><br>vim<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>wrap <span class="token operator">=</span> <span class="token keyword">false</span> <span class="token comment">-- prevents line wrapping at end of window or pane</span><br><br><span class="token comment">-- Key mappings</span><br><span class="token comment">-- These are supposed to map cmd-s to save, but I can't get them to work.</span><br>vim<span class="token punctuation">.</span>keymap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'&lt;D-s>'</span><span class="token punctuation">,</span> <span class="token string">":w&lt;kEnter>"</span><span class="token punctuation">)</span><br>vim<span class="token punctuation">.</span>keymap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'&lt;D-s'</span><span class="token punctuation">,</span> <span class="token string">"&lt;Esc>:w&lt;kEnter>i"</span><span class="token punctuation">)</span><br><br><span class="token comment">-- This automatically runs the `:PackerCompile` command</span><br><span class="token comment">-- every time the `~/.config/nvim/lua/plugins.lua` file is updated.</span><br>vim<span class="token punctuation">.</span><span class="token function">cmd</span><span class="token punctuation">(</span><span class="token string">[[<br>  augroup packer_user_config<br>    autocmd!<br>    autocmd BufWritePost plugins.lua source &lt;afile> | PackerCompile<br>  augroup end<br>]]</span><span class="token punctuation">)</span></code></pre><p>To see the directories that neovim searches for packages, enter <code>:help rtp</code> or <code>:set packpath?</code>. One directory should be <code>~/.config/nvim</code> and another should be <code>!/.config/nvim/after</code>.</p><p>To check for configuration issues, enter <code>:checkhealth</code>.</p><h2 id="creating-files-and-directories" tabindex="-1">Creating Files and Directories</h2><p>Enter <code>%</code> to create a new file. You will be prompted for the name.</p><p>Enter <code>d</code> to create a new directory. You will be prompted for the name.</p><h2 id="sourcing-files" tabindex="-1">Sourcing Files</h2><p>When editing a configuration file, to execute it enter <code>:source</code> or <code>:so</code>. This is useful after making changes to configuration files so you don't need to exit and restart nvim in order for the changes to take effect.</p><h2 id="plugins" tabindex="-1">Plugins</h2><p>Some popular neovim plugins include:</p><ul><li><a href="https://github.com/dense-analysis/ale?v=1.0.20" rel="noopener" target="_blank">Asynchronous Lint Engine</a> (ALE)</li><li><a href="https://github.com/sindrets/diffview.nvim?v=1.0.20" rel="noopener" target="_blank">diffview.nvim</a> for cycling through git diffs</li><li><a href="https://github.com/tpope/vim-fugitive?v=1.0.20" rel="noopener" target="_blank">fugitive.vim</a> for Git integration</li><li><a href="https://github.com/phaazon/hop.nvim?v=1.0.20" rel="noopener" target="_blank">Hop</a> EasyMotion-like plugin for jumping to anywhere in a file with minimal keystrokes.</li><li><a href="https://github.com/VonHeikemen/lsp-zero.nvim?v=1.0.20" rel="noopener" target="_blank">LSP Zero</a></li><li><a href="https://github.com/nvim-lualine/lualine.nvim?v=1.0.20" rel="noopener" target="_blank">lualine.nvim</a> for configuring the neovim status line</li><li><a href="https://github.com/preservim/nerdcommenter?v=1.0.20" rel="noopener" target="_blank">NERD Commenter</a> to simplify entering code comments</li><li><a href="https://github.com/EdenEast/nightfox.nvim?v=1.0.20" rel="noopener" target="_blank">Nightfox</a> theme with support for LSP, Treesitter, and more</li><li><a href="https://github.com/nvim-tree/nvim-tree.lua?v=1.0.20" rel="noopener" target="_blank">nvim-tree.lua</a> file explorer for neovim</li><li><a href="https://github.com/rose-pine/neovim?v=1.0.20" rel="noopener" target="_blank">Ros√© Pine for Neovim</a> color theme</li><li><a href="https://github.com/nvim-telescope/telescope.nvim?v=1.0.20" rel="noopener" target="_blank">Telescope</a> fuzzy finder</li><li><a href="https://github.com/nvim-treesitter/nvim-treesitter?v=1.0.20" rel="noopener" target="_blank">nvim-treesitter</a> neovim interface to <a href="https://github.com/tree-sitter/tree-sitter?v=1.0.20" rel="noopener" target="_blank">Treesitter</a> which is a parser generator tool and an incremental parsing library.</li></ul><h2 id="plugin-manager" tabindex="-1">Plugin Manager</h2><p>The most popular plugin manager for neovim is <a href="https://github.com/wbthomason/packer.nvim?v=1.0.20" rel="noopener" target="_blank">packer</a>. To install this:</p><ul><li><p>Copy a <code>git clone</code> command from the link above.</p></li><li><p>Paste that command into a terminal window and execute it.</p></li><li><p>Create the directory <code>~/.config/nvim/lua</code>.</p></li><li><p>Create the file <code>plugins.lua</code> in that directory containing the following:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">return</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'packer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startup</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>use<span class="token punctuation">)</span><br>  <span class="token comment">-- Packer can manage itself</span><br>  use <span class="token string">'wbthomason/packer.nvim'</span><br><span class="token keyword">end</span><span class="token punctuation">)</span></code></pre></li><li><p>Edit <code>~/.config/nvim/init.lua</code>.</p><ul><li><p>Add <code>require &quot;plugins&quot;</code>.</p></li><li><p>Add the following to cause the <code>:PackerCompile</code> command to run automatically when <code>plugins.lua</code> is updated.</p><pre><code>vim.cmd([[
  augroup packer_user_config
    autocmd!
    autocmd BufWritePost plugins.lua source &lt;afile&gt; | PackerCompile
  augroup end
]])
</code></pre></li></ul></li><li><p>To manually update Packer, enter <code>:PackerSync</code>.</p></li></ul><h2 id="lsp-zero" tabindex="-1">LSP Zero</h2><p>The Language Server Protocol (LSP) was designed by Microsoft for use in VS Code. It can be used by other text editors such as neovim.</p><p><a href="https://github.com/VonHeikemen/lsp-zero.nvim?v=1.0.20" rel="noopener" target="_blank">LSP Zero</a> is a neovim plugin that bundles all the code require to get <a href="https://github.com/hrsh7th/nvim-cmp?v=1.0.20" rel="noopener" target="_blank">nvim-cmp</a> (a popular autocompletion plugin) and <a href="https://github.com/neovim/nvim-lspconfig?v=1.0.20" rel="noopener" target="_blank">nvim-lspconfig</a> (configuration for the Nvim LSP client that is bundled with neovim) to work together. It also uses <a href="https://github.com/williamboman/mason.nvim?v=1.0.20" rel="noopener" target="_blank">mason.nvim</a> (another package manager) to allow you to install language servers from inside neovim.</p><p>To install and configure LSP Zero:</p><ol><li><p>Add the following in <code>~/config/nvim/lua/plugins.lua</code>:</p><pre class="language-lua"><code class="language-lua"><span class="token function">use</span> <span class="token punctuation">{</span><br>  <span class="token string">'VonHeikemen/lsp-zero.nvim'</span><span class="token punctuation">,</span><br>  branch <span class="token operator">=</span> <span class="token string">'v2.x'</span><span class="token punctuation">,</span><br>  requires <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token comment">-- LSP Support</span><br>    <span class="token punctuation">{</span><span class="token string">'neovim/nvim-lspconfig'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>             <span class="token comment">-- Required</span><br>    <span class="token punctuation">{</span>                                      <span class="token comment">-- Optional</span><br>      <span class="token string">'williamboman/mason.nvim'</span><span class="token punctuation">,</span><br>      run <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token function">pcall</span><span class="token punctuation">(</span>vim<span class="token punctuation">.</span>cmd<span class="token punctuation">,</span> <span class="token string">'MasonUpdate'</span><span class="token punctuation">)</span><br>      <span class="token keyword">end</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><span class="token string">'williamboman/mason-lspconfig.nvim'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">-- Optional</span><br><br>    <span class="token comment">-- Autocompletion</span><br>    <span class="token punctuation">{</span><span class="token string">'hrsh7th/nvim-cmp'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>     <span class="token comment">-- Required</span><br>    <span class="token punctuation">{</span><span class="token string">'hrsh7th/cmp-nvim-lsp'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">-- Required</span><br>    <span class="token punctuation">{</span><span class="token string">'L3MON4D3/LuaSnip'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>     <span class="token comment">-- Required</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></li><li><p>Create the file <code>~/.config/nvim/after/plugin/lsp.lua</code> containing the following:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> lsp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lsp-zero'</span><span class="token punctuation">)</span><br><br>lsp<span class="token punctuation">.</span><span class="token function">preset</span><span class="token punctuation">(</span><span class="token string">"recommended"</span><span class="token punctuation">)</span><br><br>lsp<span class="token punctuation">.</span><span class="token function">on_attach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> bufnr<span class="token punctuation">)</span><br>   lsp<span class="token punctuation">.</span><span class="token function">default_keymaps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>buffer <span class="token operator">=</span> bufnr<span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token keyword">end</span><span class="token punctuation">)</span><br><br><span class="token comment">-- Configure the Lua language server for neovim.</span><br><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lspconfig'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lua_ls<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span>lsp<span class="token punctuation">.</span><span class="token function">nvim_lua_ls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>lsp<span class="token punctuation">.</span><span class="token function">ensure_installed</span> <span class="token punctuation">{</span><br>  <span class="token string">"eslint"</span><span class="token punctuation">,</span><br>  <span class="token string">"lua_ls"</span><span class="token punctuation">,</span><br>  <span class="token string">"tsserver"</span><br><span class="token punctuation">}</span><br><br>lsp<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></li><li><p>Enter <code>:so</code> to source the current file.</p></li><li><p>Enter <code>:PackerSync</code></p></li><li><p>Enter &quot;:Mason&quot; to open a window that displays a list of the installed language servers and a list of the available language servers that have not been installed.</p><p>By default, all known language servers are displayed regardless of their capabilities. To filter the lists based on capabilities, type a number from 1 to 5 where 1 shows All, 2 shows only LSPs, 3 shows only DAPs (Debug Adapter Protocol), 4 shows only Linters, and 5 shows only Formatters.</p><ul><li>To toggle between showing help and showing lists of language servers, enter &quot;g?&quot;.</li><li>To install a language server, move the cursor to its name and press &quot;i&quot;.</li><li>To uninstall a language server, move the cursor to its name and press &quot;X&quot;.</li><li>To close the Mason window, press esc.</li></ul></li></ol><p>To use LSP Zero, open any file whose file extension maps to an install language server. Completions will appear while typing. To accept the first suggestion, press ctrl-y. To accept another suggestion, press the down arrow key to move to it and press ctrl-y.</p><h3 id="key-bindings" tabindex="-1">Key Bindings</h3><p>LSP Zero defines the following key bindings that all being with the leader key:</p><ul><li><p>K: displays information about the symbol under the cursor in a floating window</p></li><li><p>gd: jumps to the definition of the symbol under the cursor</p></li><li><p>gD: jumps to the declaration of the symbol under the cursor (some servers don't implement this)</p></li><li><p>gi: lists all implementations for the symbol under the cursor in the quickfix window</p></li><li><p>go: jumps to the definition of the type of the symbol under the cursor</p></li><li><p>gr: lists all references to the symbol under the cursor in the quickfix window</p></li><li><p>gs: displays signature information about the symbol under the cursor in a floating window</p></li><li><p><f2>: renames all references to the symbol under the cursor</f2></p></li><li><p><f3>: format code in current buffer</f3></p></li><li><p><f4>: selects a code action available at the current cursor position</f4></p></li><li><p>gl: show diagnostics in a floating window</p></li><li><p>[d: moves to the previous diagnostic in the current buffer</p></li><li><p>]d: moves to the next diagnostic in the current buffer</p></li><li><p><ctrl-y>: confirms selection</ctrl-y></p></li><li><p><ctrl-e>: cancels completion</ctrl-e></p></li><li><p><down>: navigates to next suggested completion</down></p></li><li><p><up>: navigates to previous suggested completion</up></p></li><li><p><ctrl-n>: if completion menu is visible, go to next item; otherwise trigger completion menu</ctrl-n></p></li><li><p><ctrl-p>: if completion menu is visible, go to previous item; otherwise trigger completion menu</ctrl-p></p></li><li><p><ctrl-d>: scrolls downs the documentation window</ctrl-d></p></li><li><p><ctrl-u>: scrolls up the documentation window</ctrl-u></p></li></ul><p>From the docs, &quot;By default lsp-zero will not create a keybinding if it is taken. You can force lsp-zero's bindings by adding ...&quot;</p><pre class="language-lua"><code class="language-lua">lsp<span class="token punctuation">.</span><span class="token function">default_keymaps</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  buffer <span class="token operator">=</span> bufnr<span class="token punctuation">,</span><br>  preserve_mappings <span class="token operator">=</span> <span class="token keyword">false</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><h2 id="telescope" tabindex="-1">Telescope</h2><p><a href="https://github.com/nvim-telescope/telescope.nvim?v=1.0.20" rel="noopener" target="_blank">Telescope</a> is a fuzzy finder for neovim.</p><p>To install it:</p><ul><li>Add the following in <code>~/.config/nvim/lua/plugins.lua</code>:</li></ul><pre class="language-lua"><code class="language-lua"><span class="token function">use</span> <span class="token punctuation">{</span><br> <span class="token string">'nvim-telescope/telescope.nvim'</span><span class="token punctuation">,</span><br> requires <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token string">'nvim-lua/plenary.nvim'</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br></code></pre><ul><li><p>Enter <code>:PluginSync</code></p></li><li><p>Create the directory <code>~/.config/nvim/after/plugin</code>.</p></li><li><p>Create the file <code>telescope.lua</code> in that directory with the following content:</p><pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> builtin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'telescope.builtin'</span><span class="token punctuation">)</span><br>vim<span class="token punctuation">.</span>keymap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'&lt;leader>ff'</span><span class="token punctuation">,</span> builtin<span class="token punctuation">.</span>find_files<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>vim<span class="token punctuation">.</span>keymap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'&lt;leader>fg'</span><span class="token punctuation">,</span> builtin<span class="token punctuation">.</span>live_grep<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>vim<span class="token punctuation">.</span>keymap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'&lt;leader>fb'</span><span class="token punctuation">,</span> builtin<span class="token punctuation">.</span>buffers<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>vim<span class="token punctuation">.</span>keymap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token string">'&lt;leader>fh'</span><span class="token punctuation">,</span> builtin<span class="token punctuation">.</span>help_tags<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></li></ul><h2 id="treesitter" tabindex="-1">Treesitter</h2></article>