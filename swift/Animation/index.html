<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Animation</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a><ol><li><a href="#basic-examples">Basic Examples</a></li><li><a href="#transitions">Transitions</a></li><li><a href="#binding-change-animations">Binding Change Animations</a></li><li><a href="#matchedgeometryeffect">matchedGeometryEffect</a></li><li><a href="#marching-ants-border">Marching Ants Border</a></li></ol></li><li><a href="#phaseanimator">phaseAnimator</a></li><li><a href="#keyframeanimator">keyframeAnimator</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p>Many view properties can be animated. These include color, opacity, rotation, and scale. Note that font sizes cannot be animated, but views containing text can be scaled.</p><p>SwiftUI supports three ways of implementing animations.</p><ul><li>explicit: wraps code that changes a model or <code>@State</code> data with a call to <code>withAnimation</code></li><li>implicit: uses the <code>animation</code> view modifier</li><li>transition: triggers when a view is inserted or removed</li></ul><p>Explicit animations are the most commonly used because they are triggered by model/state changes which are typically made in response to user interactions. These can cause multiple views to animate concurrently. For example, the action of a <code>Button</code> can wrap calls to ViewModel intent functions in a closure passed to <code>withAnimation</code>. Most code that handles user events does this.</p><p>Key points to remember when implementing animations:</p><ol><li>Only changes to view modifier arguments and shapes are animated.</li><li>Only views that are already on the screen are affected by explicit and implicit animations.</li><li>The <code>animation</code> view modifier applies to all view modifiers chained before it, but not to those chained after it.</li><li>Explicit animations do not override or prevent implicit animations. Both can be applied concurrently.</li><li>Animations are automatically and smoothly interrupted by new animations.</li></ol><p>One way to achieve point #2 is to leave views on the screen permanently, but conditionally hide them by setting their opacity to zero. For example, <code>myView.opacity(show ? 1 : 0)</code>.</p><p>Animations can specify a duration (in seconds), delay, easing function, and number of times to repeat. Duration is the total time over which the animation takes place. Delay is the amount of time the animation waits to begin after being triggered. An easing function controls the speed at which an animation advances over its duration.</p><p>Provided easing functions include <code>linear</code>, <code>easeIn</code>, <code>easeOut</code>, <code>easeInOut</code> (default in iOS 16 and earlier), <code>spring</code> (default in iOS 17 and later), <code>interactiveSpring</code>, <code>interpolatingSpring</code>, <code>bouncy</code>, <code>smooth</code>, and <code>snappy</code>. These are static functions on the <code>Animation</code> struct. Most of them take a single, optional argument which is the <code>duration</code> in seconds. The <code>spring</code> function takes three optional arguments named <code>response</code>, <code>dampingFunction</code>, and <code>blendDuration</code>. For details, see the <a href="https://developer.apple.com/documentation/swiftui/animation/spring(response:dampingfraction:blendduration:)?v=1.0.21" rel="noopener" target="_blank">spring method</a>.</p><p>Custom easing functions can be defined with the <a href="https://developer.apple.com/documentation/swiftui/animation/timingcurve(_:_:_:_:duration:)?v=1.0.21" rel="noopener" target="_blank">timingCurve</a> function.</p><p>To begin an <a href="https://developer.apple.com/documentation/swiftui/animation?v=1.0.21" rel="noopener" target="_blank">Animation</a>, apply the <code>onAppear</code> view modifier to the view, passing it a closure that calls <code>withAnimation</code>. This is demonstrated in the <a href="#marching-ants-border">Marching Ants Border</a> section below.</p><p>To delay the start of an <a href="https://developer.apple.com/documentation/swiftui/animation?v=1.0.21" rel="noopener" target="_blank">Animation</a>, chain a call to its <a href="https://developer.apple.com/documentation/swiftui/animation/delay(_:)?v=1.0.21" rel="noopener" target="_blank">delay</a> method . For example:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">let</span> duration <span class="token operator">=</span> <span class="token number">1.5</span> <span class="token comment">// seconds</span><br><span class="token function">withAnimation</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">linear</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> duration<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token operator">...</span><br><span class="token punctuation">}</span></code></pre><h3 id="basic-examples" tabindex="-1">Basic Examples</h3><p>The following example provides form elements for experimenting with different kinds of animations.</p><p><img alt="SwiftUI Animation" style="width: 40%" src="/blog/assets/SwiftUI-Animation.png?v=1.0.21" title="SwiftUI Animation"></p><pre class="language-swift"><code class="language-swift"><span class="token keyword">enum</span> <span class="token class-name">EasingType</span><span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">CaseIterable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">case</span> forever<span class="token punctuation">,</span> linear<span class="token punctuation">,</span> easeIn<span class="token punctuation">,</span> easeOut<span class="token punctuation">,</span> easeInOut<span class="token punctuation">,</span> spring<br><span class="token punctuation">}</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> borderColor<span class="token punctuation">:</span> <span class="token class-name">Color</span> <span class="token operator">=</span> <span class="token punctuation">.</span>red<br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> color <span class="token operator">=</span> <span class="token boolean">false</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> easingType<span class="token punctuation">:</span> <span class="token class-name">EasingType</span> <span class="token operator">=</span> <span class="token punctuation">.</span>linear<br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> on <span class="token operator">=</span> <span class="token boolean">false</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> opacity <span class="token operator">=</span> <span class="token boolean">false</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> rotate <span class="token operator">=</span> <span class="token boolean">false</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> scale <span class="token operator">=</span> <span class="token boolean">false</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">var</span> easingFunction<span class="token punctuation">:</span> <span class="token class-name">Animation</span> <span class="token punctuation">{</span><br>        <span class="token keyword">switch</span> easingType <span class="token punctuation">{</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>linear<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token class-name">Animation</span><span class="token punctuation">.</span><span class="token function">linear</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>forever<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token class-name">Animation</span><br>            <span class="token punctuation">.</span><span class="token function">linear</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">repeatForever</span><span class="token punctuation">(</span>autoreverses<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>easeIn<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token class-name">Animation</span><span class="token punctuation">.</span><span class="token function">easeIn</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>easeOut<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token class-name">Animation</span><span class="token punctuation">.</span><span class="token function">easeOut</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>easeInOut<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token class-name">Animation</span><span class="token punctuation">.</span><span class="token function">easeInOut</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>spring<span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token class-name">Animation</span><br>            <span class="token punctuation">.</span><span class="token function">spring</span><span class="token punctuation">(</span>dampingFraction<span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">speed</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"First Line"</span></span><span class="token punctuation">)</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Second Line"</span></span><span class="token punctuation">)</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"ðŸŽ‰"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>largeTitle<span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>            <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">border</span><span class="token punctuation">(</span>borderColor<span class="token punctuation">,</span> width<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token operator">!</span>opacity <span class="token operator">||</span> on <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">scaleEffect</span><span class="token punctuation">(</span><span class="token operator">!</span>scale <span class="token operator">||</span> on <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">rotationEffect</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span><span class="token operator">!</span>rotate <span class="token operator">||</span> on <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> <span class="token number">360</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span>easingFunction<span class="token punctuation">,</span> value<span class="token punctuation">:</span> on <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// implicit animation</span><br><br>            <span class="token class-name">NavigationView</span> <span class="token punctuation">{</span> <span class="token comment">// Picker will be disabled without this.</span><br>                <span class="token class-name">Form</span> <span class="token punctuation">{</span><br>                    <span class="token class-name">Toggle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Animate Color?"</span></span><span class="token punctuation">,</span> isOn<span class="token punctuation">:</span> $color<span class="token punctuation">)</span><br>                    <span class="token class-name">Toggle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Animate Opacity?"</span></span><span class="token punctuation">,</span> isOn<span class="token punctuation">:</span> $opacity<span class="token punctuation">)</span><br>                    <span class="token class-name">Toggle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Animate Rotation?"</span></span><span class="token punctuation">,</span> isOn<span class="token punctuation">:</span> $rotate<span class="token punctuation">)</span><br>                    <span class="token class-name">Toggle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Animate Scale?"</span></span><span class="token punctuation">,</span> isOn<span class="token punctuation">:</span> $scale<span class="token punctuation">)</span><br>                    <span class="token class-name">Picker</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Easing Function"</span></span><span class="token punctuation">,</span> selection<span class="token punctuation">:</span> $easingType<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                        <span class="token class-name">ForEach</span><span class="token punctuation">(</span><span class="token class-name">EasingType</span><span class="token punctuation">.</span>allCases<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> easingType <span class="token keyword">in</span><br>                            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">easingType<span class="token punctuation">.</span>rawValue</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span>easingType<span class="token punctuation">)</span><br>                        <span class="token punctuation">}</span><br>                    <span class="token punctuation">}</span><br>                    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Toggle"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                        <span class="token keyword">if</span> color <span class="token punctuation">{</span><br>                            borderColor <span class="token operator">=</span><br>                                borderColor <span class="token operator">==</span> <span class="token punctuation">.</span>red <span class="token operator">?</span> <span class="token punctuation">.</span>blue <span class="token punctuation">:</span> <span class="token punctuation">.</span>red<br>                        <span class="token punctuation">}</span><br>                        on<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3 id="transitions" tabindex="-1">Transitions</h3><p>Transitions can be applied to any kind of view including container views. They are specified when a view is defined, but they are only applied when the view is inserted or removed. This is implemented by using an <code>if</code> or <code>switch</code> statement inside a parent view.</p><p>By default an <code>opacity</code> transition (fade) is used. This can be changed by applying the <code>transition</code> view modifier which is passed the kind of <a href="https://developer.apple.com/documentation/swiftui/anytransition?v=1.0.21" rel="noopener" target="_blank">AnyTransition</a> to perform.</p><p>Transitions are defined as static properties on the <code>AnyTransition</code> struct. These include <code>move</code>, <code>opacity</code>, <code>scale</code>, and <code>slide</code>. The <code>identity</code> constant is used to specify that no transition should occur. Custom transitions can also be implemented.</p><p>By default the transition is reversed when the view is removed. For example, <code>opacity</code> changes from 0 to 1 when the view is inserted, and from 1 to 0 when it is removed. This can be changed using the <code>asymmetric</code> transition function which allows specifying one transition for insertion and a different one for removal.</p><p>Most insertion transitions do not currently work in Preview, but they do work in the Simulator. However, the Simulator often displays odd rendering artifacts.</p><p>The following example demonstrates sliding a view in from the top when it is inserted and out to the right when it is removed.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> include <span class="token operator">=</span> <span class="token boolean">false</span><br><br>    <span class="token keyword">let</span> easeFn <span class="token operator">=</span> <span class="token class-name">Animation</span><span class="token punctuation">.</span><span class="token function">easeInOut</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>                <span class="token keyword">if</span> include <span class="token punctuation">{</span><br>                    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Conditionally Included"</span></span><span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>maxWidth<span class="token punctuation">:</span> <span class="token punctuation">.</span>infinity<span class="token punctuation">)</span> <span class="token comment">// use full screen width</span><br><br>                        <span class="token comment">// This slides in from left and out to right.</span><br>                        <span class="token comment">//.transition(.slide)</span><br><br>                        <span class="token comment">// The animation call here should apply the</span><br>                        <span class="token comment">// easing function when one is not specified</span><br>                        <span class="token comment">// in the call to withAnimation, but it doesn't work.</span><br>                        <span class="token comment">//.transition(.slide.animation(easeFn))</span><br><br>                        <span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">asymmetric</span><span class="token punctuation">(</span><br>                            insertion<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>edge<span class="token punctuation">:</span> <span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">,</span><br>                            removal<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>edge<span class="token punctuation">:</span> <span class="token punctuation">.</span>trailing<span class="token punctuation">)</span><br>                        <span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>                        <span class="token comment">// This changes scale from 0 to 1 for insertion</span><br>                        <span class="token comment">// and 1 to 0 for removal.</span><br>                        <span class="token comment">//.transition(.scale)</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>            <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>maxWidth<span class="token punctuation">:</span> <span class="token punctuation">.</span>infinity<span class="token punctuation">,</span> minHeight<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">// use full width</span><br>            <span class="token punctuation">.</span><span class="token function">border</span><span class="token punctuation">(</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span><br><br>            <span class="token class-name">NavigationView</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Form</span> <span class="token punctuation">{</span><br>                    <span class="token comment">// If a Toggle is used instead of a Button</span><br>                    <span class="token comment">// to toggle the value of "include",</span><br>                    <span class="token comment">// there is no opportunity to use "withAnimation".</span><br>                    <span class="token comment">//Toggle("Include Optional Text?", isOn: $include)</span><br><br>                    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Toggle Optional Text"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                        <span class="token function">withAnimation</span><span class="token punctuation">(</span>easeFn<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                            include<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                        <span class="token punctuation">}</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Transitions can be combined. For example, we can create a variable that holds a description of a combined transition as follows and pass it to the <code>transition</code> view modifier.</p><pre class="language-swift"><code class="language-swift">    <span class="token keyword">private</span> <span class="token keyword">let</span> transition<span class="token punctuation">:</span> <span class="token class-name">AnyTransition</span> <span class="token operator">=</span><br>        <span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>edge<span class="token punctuation">:</span> <span class="token punctuation">.</span>bottom<span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">combined</span><span class="token punctuation">(</span>with<span class="token punctuation">:</span> <span class="token punctuation">.</span>scale<span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">combined</span><span class="token punctuation">(</span>with<span class="token punctuation">:</span> <span class="token punctuation">.</span>opacity<span class="token punctuation">)</span></code></pre><h3 id="binding-change-animations" tabindex="-1">Binding Change Animations</h3><p>An animation can be attached to a binding so the animation occurs when views change as a result of the binding value. For example, a <code>Bool</code> binding can be used to determine whether a view should be shown or hidden. The following code demonstrates this:</p><p><img alt="SwiftUI Binding Animation" style="width: 50%" src="/blog/assets/SwiftUI-Binding-Animation.png?v=1.0.21" title="SwiftUI Binding Animation"></p><pre class="language-swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> isShowing <span class="token operator">=</span> <span class="token boolean">false</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> transitionName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"opacity"</span></span><br>    <span class="token keyword">private</span> <span class="token keyword">let</span> duration <span class="token operator">=</span> <span class="token number">0.5</span><br>    <span class="token keyword">private</span> <span class="token keyword">let</span> transitionNames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"move"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"opacity"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"scale"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"slide"</span></span><span class="token punctuation">]</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">var</span> transition<span class="token punctuation">:</span> <span class="token class-name">AnyTransition</span> <span class="token punctuation">{</span><br>        <span class="token keyword">switch</span> transitionName <span class="token punctuation">{</span><br>        <span class="token keyword">case</span> <span class="token string-literal"><span class="token string">"move"</span></span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>edge<span class="token punctuation">:</span> <span class="token punctuation">.</span>trailing<span class="token punctuation">)</span><br>        <span class="token keyword">case</span> <span class="token string-literal"><span class="token string">"scale"</span></span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token punctuation">.</span>scale<br>        <span class="token keyword">case</span> <span class="token string-literal"><span class="token string">"slide"</span></span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token punctuation">.</span>slide<br>        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token punctuation">.</span>opacity<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Toggle</span><span class="token punctuation">(</span><br>                <span class="token string-literal"><span class="token string">"Show Greeting?"</span></span><span class="token punctuation">,</span><br>                isOn<span class="token punctuation">:</span> $isShowing<span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">easeInOut</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">)</span><br><br>            <span class="token class-name">LabeledContent</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Transition"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Picker</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Transition"</span></span><span class="token punctuation">,</span> selection<span class="token punctuation">:</span> $transitionName<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                    <span class="token class-name">ForEach</span><span class="token punctuation">(</span>transitionNames<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> name <span class="token keyword">in</span><br>                        <span class="token class-name">Text</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>                <span class="token punctuation">.</span><span class="token function">pickerStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>segmented<span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br><br>            <span class="token keyword">if</span> isShowing <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Hello, Animation!"</span></span><span class="token punctuation">)</span><br>                    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>largeTitle<span class="token punctuation">)</span><br>                    <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>maxWidth<span class="token punctuation">:</span> <span class="token punctuation">.</span>infinity<span class="token punctuation">)</span><br>                    <span class="token punctuation">.</span><span class="token function">transition</span><span class="token punctuation">(</span>transition<span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br><br>            <span class="token comment">// This stops the Toggle above from bouncing when the</span><br>            <span class="token comment">// animation is applied, which may or may not be desirable.</span><br>            <span class="token class-name">Spacer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The line above what uses the <code>.easeInOut</code> transition could be replaced by one of these:</p><pre class="language-swift"><code class="language-swift">                <span class="token comment">// Default spring animation</span><br>                <span class="token comment">// (doesn't bounce at all with the default parameter values!)</span><br>                isOn<span class="token punctuation">:</span> $isShowing<span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">spring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>                <span class="token comment">// Customized spring animation using the spring method</span><br>                isOn<span class="token punctuation">:</span> $isShowing<span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span><br>                    <span class="token punctuation">.</span><span class="token function">spring</span><span class="token punctuation">(</span><br>                        response<span class="token punctuation">:</span> duration<span class="token punctuation">,</span> <span class="token comment">// defaults to 0.55</span><br>                        dampingFraction<span class="token punctuation">:</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token comment">// defaults to 0.825</span><br>                        blendDuration<span class="token punctuation">:</span> duration <span class="token comment">// defaults to 0</span><br>                    <span class="token punctuation">)</span><br>                <span class="token punctuation">)</span><br><br>                <span class="token comment">// Customized spring animation using the</span><br>                <span class="token comment">// interactiveSpring method which is the same as .spring(),</span><br>                <span class="token comment">// but whose parameters have different default values</span><br>                isOn<span class="token punctuation">:</span> $isShowing<span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span><br>                    <span class="token punctuation">.</span><span class="token function">interactiveSpring</span><span class="token punctuation">(</span><br>                        response<span class="token punctuation">:</span> duration<span class="token punctuation">,</span> <span class="token comment">// defaults to 0.15</span><br>                        dampingFraction<span class="token punctuation">:</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token comment">// defaults to 0.86</span><br>                        blendDuration<span class="token punctuation">:</span> duration <span class="token comment">// defaults to 0.25</span><br>                    <span class="token punctuation">)</span><br>                <span class="token punctuation">)</span><br><br>                <span class="token comment">// Customized spring animation using the</span><br>                <span class="token comment">// interpolatingSpring method which handles overlapping</span><br>                <span class="token comment">// animations better than .spring() and .interactiveSpring()</span><br>                isOn<span class="token punctuation">:</span> $isShowing<span class="token punctuation">.</span><span class="token function">animation</span><span class="token punctuation">(</span><br>                    <span class="token punctuation">.</span><span class="token function">interpolatingSpring</span><span class="token punctuation">(</span><br>                        <span class="token comment">// mass: 1, // defaults to 1</span><br>                        stiffness<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span><br>                        <span class="token comment">// required; lower values are more stiff</span><br>                        damping<span class="token punctuation">:</span> <span class="token number">3</span> <span class="token comment">// required; lower values bounce more</span><br>                        <span class="token comment">// initialVelocity: 0 // defaults to 0; must be in [0, 1]</span><br>                    <span class="token punctuation">)</span><br>                <span class="token punctuation">)</span></code></pre><h3 id="matchedgeometryeffect" tabindex="-1">matchedGeometryEffect</h3><p>The <a href="https://developer.apple.com/documentation/swiftui/view/matchedgeometryeffect(id:in:properties:anchor:issource:)?v=1.0.21" rel="noopener" target="_blank">matchedGeometryEffect</a> view modifier is used to smoothly move views between container views. For example, this can be used to move <code>Text</code> views that describe food items between lists of foods that available and those that have been selected. Each food item must have a unique id. When rendering the food items, <code>matchedGeometryEffect</code> is used to associate the <code>Text</code> view with a particular id in a given namespace.</p><p>The following code demonstrates this:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">Food</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span><br>    <span class="token keyword">var</span> selected<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token operator">=</span> <span class="token boolean">false</span><br>    <span class="token keyword">var</span> id<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@Namespace</span> <span class="token keyword">private</span> <span class="token keyword">var</span> foodNS<br><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> foods<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Food</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><br>        <span class="token class-name">Food</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Hamburger"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token class-name">Food</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Fries"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token class-name">Food</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"Shake"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">]</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">foodList</span><span class="token punctuation">(</span>selected<span class="token punctuation">:</span> <span class="token class-name">Bool</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">List</span><span class="token punctuation">(</span>foods<span class="token punctuation">)</span> <span class="token punctuation">{</span> food <span class="token keyword">in</span><br>            <span class="token keyword">if</span> food<span class="token punctuation">.</span>selected <span class="token operator">==</span> selected <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span>food<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br>                    <span class="token punctuation">.</span><span class="token function">matchedGeometryEffect</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> food<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> foodNS<span class="token punctuation">)</span><br>                    <span class="token punctuation">.</span>onTapGesture <span class="token punctuation">{</span><br>                        withAnimation <span class="token punctuation">{</span> <span class="token function">toggle</span><span class="token punctuation">(</span>food<span class="token punctuation">:</span> food<span class="token punctuation">)</span> <span class="token punctuation">}</span><br>                    <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">toggle</span><span class="token punctuation">(</span>food<span class="token punctuation">:</span> <span class="token class-name">Food</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> index <span class="token operator">=</span> foods<span class="token punctuation">.</span><span class="token function">firstIndex</span><span class="token punctuation">(</span><span class="token keyword">where</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token short-argument">$0</span><span class="token punctuation">.</span>id <span class="token operator">==</span> food<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">!</span><br>        foods<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>selected<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">HStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Available"</span></span><span class="token punctuation">)</span><br>                <span class="token function">foodList</span><span class="token punctuation">(</span>selected<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>            <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Selected"</span></span><span class="token punctuation">)</span><br>                <span class="token function">foodList</span><span class="token punctuation">(</span>selected<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>TODO: Why do the food names eventually disappear after being moved in both Preview and the Simulator?</p><h3 id="marching-ants-border" tabindex="-1">Marching Ants Border</h3><p>We can create an animated dashed border around any view that resembles marching ants. This was inspired by the Hacking With Swift post <a href="https://www.hackingwithswift.com/example-code/calayer/how-to-create-a-marching-ants-effect-using-linedashphase?v=1.0.21" rel="noopener" target="_blank">How to create a marching ants effect using lineDashPhase</a>.</p><p>The following code is the contents of the file <code>MarchingAnts.swift</code> which can be added to any project. It uses <a href="https://developer.apple.com/documentation/swiftui/preferencekey?v=1.0.21" rel="noopener" target="_blank">PreferenceKey</a> which &quot;automatically combines its values for a given preference into a single value visible to its ancestors.&quot; In this case the preference is the size of the content view. The size is set in a <code>@State</code> property of the custom <code>MarchingAnts</code> view modifier.</p><pre class="language-swift"><code class="language-swift"><span class="token comment">// MarchingAnts.swift</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token comment">// This is a custom view modifier that gets the size of its content.</span><br><span class="token comment">// TODO: Could you use sizeThatFits in place of this?</span><br><span class="token keyword">struct</span> <span class="token class-name">SizeReporter</span><span class="token punctuation">:</span> <span class="token class-name">ViewModifier</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@Binding</span> <span class="token keyword">var</span> size<span class="token punctuation">:</span> <span class="token class-name">CGSize</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">struct</span> <span class="token class-name">SizePreferenceKey</span><span class="token punctuation">:</span> <span class="token class-name">PreferenceKey</span> <span class="token punctuation">{</span><br>        <span class="token keyword">static</span> <span class="token keyword">let</span> defaultValue<span class="token punctuation">:</span> <span class="token class-name">CGSize</span> <span class="token operator">=</span> <span class="token punctuation">.</span>zero<br>        <span class="token comment">// inout allows passing by reference so a copy is not made.</span><br>        <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">reduce</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">inout</span> <span class="token class-name">CGSize</span><span class="token punctuation">,</span> nextValue<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">CGSize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            value <span class="token operator">=</span> <span class="token function">nextValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">body</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> <span class="token class-name">Content</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        content<br>            <span class="token comment">// This is a tricky approach to get the content size</span><br>            <span class="token comment">// using an invisible background.</span><br>            <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span><span class="token class-name">GeometryReader</span> <span class="token punctuation">{</span> geometry <span class="token keyword">in</span><br>                <span class="token class-name">Color</span><span class="token punctuation">.</span>clear<br>                    <span class="token punctuation">.</span><span class="token function">preference</span><span class="token punctuation">(</span><br>                        key<span class="token punctuation">:</span> <span class="token class-name">SizePreferenceKey</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span><br>                        value<span class="token punctuation">:</span> geometry<span class="token punctuation">.</span>size<br>                    <span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">onPreferenceChange</span><span class="token punctuation">(</span><span class="token class-name">SizePreferenceKey</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> value <span class="token keyword">in</span><br>                size <span class="token operator">=</span> value<br>            <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// This is a custom view modifier that draws an animated dashed border</span><br><span class="token comment">// around its content.</span><br><span class="token keyword">struct</span> <span class="token class-name">MarchingAnts</span><span class="token punctuation">:</span> <span class="token class-name">ViewModifier</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> phase<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span> <span class="token operator">=</span> <span class="token number">0</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> size<span class="token punctuation">:</span> <span class="token class-name">CGSize</span> <span class="token operator">=</span> <span class="token punctuation">.</span>zero<br><br>    <span class="token keyword">let</span> clockwise<span class="token punctuation">:</span> <span class="token class-name">Bool</span><br>    <span class="token keyword">let</span> dashLength<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span><br>    <span class="token keyword">let</span> dashWidth<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">body</span><span class="token punctuation">(</span>content<span class="token punctuation">:</span> <span class="token class-name">Content</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">ZStack</span> <span class="token punctuation">{</span><br>            content<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span>$size<span class="token punctuation">)</span><br>            <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">strokeBorder</span><span class="token punctuation">(</span>style<span class="token punctuation">:</span> <span class="token class-name">StrokeStyle</span><span class="token punctuation">(</span><br>                    lineWidth<span class="token punctuation">:</span> dashWidth<span class="token punctuation">,</span><br>                    dash<span class="token punctuation">:</span> <span class="token punctuation">[</span>dashLength<span class="token punctuation">]</span><span class="token punctuation">,</span><br>                    dashPhase<span class="token punctuation">:</span> phase<br>                <span class="token punctuation">)</span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span>onAppear <span class="token punctuation">{</span><br>                    <span class="token function">withAnimation</span><span class="token punctuation">(</span><br>                        <span class="token punctuation">.</span>linear<br>                            <span class="token punctuation">.</span><span class="token function">repeatForever</span><span class="token punctuation">(</span>autoreverses<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><br>                    <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                        <span class="token comment">// Adding goes counter-clockwise</span><br>                        <span class="token comment">// and subtracting goes clockwise.</span><br>                        phase <span class="token operator">=</span> dashLength <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>clockwise <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>                <span class="token comment">// .frame(width: 250, height: 200)</span><br>                <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> size<span class="token punctuation">.</span>width<span class="token punctuation">,</span> height<span class="token punctuation">:</span> size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// This extension simplifies using the custom view modifiers defined above.</span><br><span class="token keyword">extension</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">getSize</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> size<span class="token punctuation">:</span> <span class="token class-name">Binding</span><span class="token operator">&lt;</span><span class="token class-name">CGSize</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token function">modifier</span><span class="token punctuation">(</span><span class="token class-name">SizeReporter</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> size<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">marchingAnts</span><span class="token punctuation">(</span><br>        clockwise<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>        dashLength<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span><br>        dashWidth<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span> <span class="token operator">=</span> <span class="token number">3</span><br>    <span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token function">modifier</span><span class="token punctuation">(</span><span class="token class-name">MarchingAnts</span><span class="token punctuation">(</span><br>            clockwise<span class="token punctuation">:</span> clockwise<span class="token punctuation">,</span><br>            dashLength<span class="token punctuation">:</span> dashLength<span class="token punctuation">,</span><br>            dashWidth<span class="token punctuation">:</span> dashWidth<br>        <span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The following code demonstrates using the <code>marchingAnts</code> view modifier defined above.</p><p><img alt="SwiftUI Marching Ants" style="width: 40%" src="/blog/assets/SwiftUI-Marching-Ants.png?v=1.0.21" title="SwiftUI Marching Ants"></p><pre class="language-swift"><code class="language-swift"><span class="token comment">// Content.swift</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"See them march!"</span></span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">marchingAnts</span><span class="token punctuation">(</span><br>                    <span class="token comment">// clockwise: false,</span><br>                    <span class="token comment">// dashLength: 20,</span><br>                    <span class="token comment">// dashWidth: 10</span><br>                <span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="phaseanimator" tabindex="-1">phaseAnimator</h2><p>Phases define discrete states that are provided to a view one at a time. Animation is performed on the changes between the states. All properties specified for a phase are animated concurrently.</p><p>When all the animations for a phase complete, animations for the next phase begins. By default this continues indefinitely. A trigger can be used to only run through the phases one time each time the trigger value changes.</p><p>This demonstrates basic use of phaseAnimator. The first argument specifies an array of values to be used as the values of the closure phase argument.</p><pre class="language-swift"><code class="language-swift"><span class="token comment">// The phases here are false and true.</span><br><span class="token punctuation">.</span><span class="token function">phaseAnimator</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> content<span class="token punctuation">,</span> phase <span class="token keyword">in</span><br>     <span class="token comment">// This cycles the opacity between two values.</span><br>     content<br>         <span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span>phase <span class="token operator">?</span> <span class="token number">1.0</span> <span class="token punctuation">:</span> <span class="token number">0.2</span><span class="token punctuation">)</span><br>         <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>phase <span class="token operator">?</span> <span class="token punctuation">.</span>red <span class="token punctuation">:</span> <span class="token punctuation">.</span>primary<span class="token punctuation">)</span><br> <span class="token punctuation">}</span> animation<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span><br>     <span class="token comment">// This overrides the default animation timing.</span><br>     <span class="token comment">// Can have a different animation for each phase.</span><br>     <span class="token punctuation">.</span><span class="token function">easeInOut</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">)</span><br> <span class="token punctuation">}</span></code></pre><p>This demonstrates more advanced use of phaseAnimator. Rather than phases represented by primitive values, they are represented with enum cases. The enum has methods that return phase-based values for specific properties.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">enum</span> <span class="token class-name">MyPhase</span><span class="token punctuation">:</span> <span class="token class-name">CaseIterable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">case</span> initial<span class="token punctuation">,</span> move<span class="token punctuation">,</span> scale<br><br>    <span class="token keyword">var</span> foregroundStyle<span class="token punctuation">:</span> <span class="token class-name">Color</span> <span class="token punctuation">{</span><br>        <span class="token keyword">switch</span> <span class="token keyword">self</span> <span class="token punctuation">{</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>initial<span class="token punctuation">:</span> <span class="token punctuation">.</span>black<br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>move<span class="token punctuation">,</span> <span class="token punctuation">.</span>scale<span class="token punctuation">:</span> <span class="token punctuation">.</span>red<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> scale<span class="token punctuation">:</span> <span class="token class-name">Double</span> <span class="token punctuation">{</span><br>        <span class="token keyword">switch</span> <span class="token keyword">self</span> <span class="token punctuation">{</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>initial<span class="token punctuation">:</span> <span class="token number">1</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>move<span class="token punctuation">,</span> <span class="token punctuation">.</span>scale<span class="token punctuation">:</span> <span class="token number">2</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> verticalOffset<span class="token punctuation">:</span> <span class="token class-name">CGSize</span> <span class="token punctuation">{</span><br>        <span class="token keyword">switch</span> <span class="token keyword">self</span> <span class="token punctuation">{</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>initial<span class="token punctuation">:</span> <span class="token class-name">CGSize</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><br>        <span class="token keyword">case</span> <span class="token punctuation">.</span>move<span class="token punctuation">,</span> <span class="token punctuation">.</span>scale<span class="token punctuation">:</span> <span class="token class-name">CGSize</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">64</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token operator">...</span><br><br><span class="token comment">// This is applied to some view.</span><br><span class="token punctuation">.</span><span class="token function">phaseAnimator</span><span class="token punctuation">(</span><br>     <span class="token class-name">MyPhase</span><span class="token punctuation">.</span>allCases<span class="token punctuation">,</span><br>     trigger<span class="token punctuation">:</span> clickCount<br><span class="token punctuation">)</span> <span class="token punctuation">{</span> content<span class="token punctuation">,</span> phase <span class="token keyword">in</span><br>     content<br>         <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>phase<span class="token punctuation">.</span>foregroundStyle<span class="token punctuation">)</span><br>         <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>phase<span class="token punctuation">.</span>verticalOffset<span class="token punctuation">)</span><br>         <span class="token punctuation">.</span><span class="token function">scaleEffect</span><span class="token punctuation">(</span>phase<span class="token punctuation">.</span>scale<span class="token punctuation">)</span><br><span class="token punctuation">}</span> animation<span class="token punctuation">:</span> <span class="token punctuation">{</span> phase <span class="token keyword">in</span><br>     <span class="token keyword">switch</span> phase <span class="token punctuation">{</span><br>     <span class="token keyword">case</span> <span class="token punctuation">.</span>initial<span class="token punctuation">:</span> <span class="token punctuation">.</span>smooth<br>     <span class="token keyword">case</span> <span class="token punctuation">.</span>move<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">easeInOut</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">0.3</span><span class="token punctuation">)</span><br>     <span class="token keyword">case</span> <span class="token punctuation">.</span>scale<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">spring</span><span class="token punctuation">(</span>duration<span class="token punctuation">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span> bounce<span class="token punctuation">:</span> <span class="token number">0.7</span><span class="token punctuation">)</span><br>     <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>See the demo project at <a href="https://github.com/mvolkmann/KeyframeAnimatorDemo/blob/main/KeyframeAnimatorDemo/ContentView.swift?v=1.0.21" rel="noopener" target="_blank">KeyframeAnimatorDemo</a>. Despite the project name, this does demonstrate using <code>phaseAnimator</code>.</p><h2 id="keyframeanimator" tabindex="-1">keyframeAnimator</h2><p>Keyframes support animating property changes independently. Each &quot;track&quot; of keyframes specifies the times at which to modify a specific property. There can be any number of tracks with different timings, one for each property whose changes should be animated. Keyframes can animate any property that conforms to the Animatable protocol.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">AnimationValues</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> scale <span class="token operator">=</span> <span class="token number">1.0</span><br>    <span class="token keyword">var</span> verticalStretch <span class="token operator">=</span> <span class="token number">1.0</span><br>    <span class="token keyword">var</span> verticalTranslation <span class="token operator">=</span> <span class="token number">0.0</span><br>    <span class="token keyword">var</span> angle <span class="token operator">=</span> <span class="token class-name">Angle</span><span class="token punctuation">.</span>zero<br><span class="token punctuation">}</span><br><br><span class="token operator">...</span><br><br><span class="token comment">// This is applied to some view.</span><br><span class="token punctuation">.</span><span class="token function">keyframeAnimator</span><span class="token punctuation">(</span><br>    initialValue<span class="token punctuation">:</span> <span class="token class-name">AnimationValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    trigger<span class="token punctuation">:</span> clickCount<br><span class="token punctuation">)</span> <span class="token punctuation">{</span> content<span class="token punctuation">,</span> value <span class="token keyword">in</span><br>    content<br>        <span class="token punctuation">.</span><span class="token function">rotationEffect</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>angle<span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">scaleEffect</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>scale<span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">scaleEffect</span><span class="token punctuation">(</span>y<span class="token punctuation">:</span> value<span class="token punctuation">.</span>verticalStretch<span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>y<span class="token punctuation">:</span> value<span class="token punctuation">.</span>verticalTranslation<span class="token punctuation">)</span><br><span class="token punctuation">}</span> keyframes<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span><br>    <span class="token class-name">KeyframeTrack</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>angle<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token punctuation">.</span>zero<span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.58</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.125</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.125</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.125</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token punctuation">.</span>zero<span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.125</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token class-name">KeyframeTrack</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>verticalStretch<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token number">0.6</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.15</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token number">1.05</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.15</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.88</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token number">1.04</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.4</span><span class="token punctuation">)</span><br>        <span class="token class-name">CubicKeyframe</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.22</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token class-name">KeyframeTrack</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>scale<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name">LinearKeyframe</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.36</span><span class="token punctuation">)</span><br>        <span class="token class-name">SpringKeyframe</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span> spring<span class="token punctuation">:</span> <span class="token punctuation">.</span>bouncy<span class="token punctuation">)</span><br>        <span class="token class-name">SpringKeyframe</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> spring<span class="token punctuation">:</span> <span class="token punctuation">.</span>bouncy<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token class-name">KeyframeTrack</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>verticalTranslation<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name">LinearKeyframe</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">)</span><br>        <span class="token class-name">SpringKeyframe</span><span class="token punctuation">(</span><span class="token number">20.0</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">0.15</span><span class="token punctuation">,</span> spring<span class="token punctuation">:</span> <span class="token punctuation">.</span>bouncy<span class="token punctuation">)</span><br>        <span class="token class-name">SpringKeyframe</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">60.0</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> spring<span class="token punctuation">:</span> <span class="token punctuation">.</span>bouncy<span class="token punctuation">)</span><br>        <span class="token class-name">SpringKeyframe</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> spring<span class="token punctuation">:</span> <span class="token punctuation">.</span>bouncy<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br>    <span class="token comment">// Also see MoveKeyframe.</span><br><span class="token punctuation">}</span></code></pre><p>See the demo project at <a href="https://github.com/mvolkmann/KeyframeAnimatorDemo/blob/main/KeyframeAnimatorDemo/ContentView.swift?v=1.0.21" rel="noopener" target="_blank">KeyframeAnimatorDemo</a>.</p><p>Also see <code>mapCameraKeyframeAnimator</code> for animation changes to the <code>centerCoordinate</code>, <code>heading</code>, and <code>distance</code> in a <code>Map</code> <code>camera</code>.</p><p>Also see <code>KeyframeTimeline</code> to evaluate a set of <code>KeyframeTrack</code> instances at a given time within the longest duration. This can be used along with Swift Charts to plot timelines.</p></article>