<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Contacts</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#contactpicker">ContactPicker</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p>iOS apps can access data managed by the Apple Contacts app.</p><h2 id="contactpicker" tabindex="-1">ContactPicker</h2><p>We can define a <code>ContactPicker</code> SwiftUI view that allows the user to select a contact using the same UI as the Apple Contacts app. This is done using the <a href="https://developer.apple.com/documentation/contactsui?v=1.0.20" rel="noopener" target="_blank">Contacts UI</a> framework and its <a href="https://developer.apple.com/documentation/contactsui/cncontactpickerviewcontroller?v=1.0.20" rel="noopener" target="_blank">CNContactPickerViewController</a> class.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">ContactsUI</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContactPicker</span><span class="token punctuation">:</span> <span class="token class-name">UIViewControllerRepresentable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">class</span> <span class="token class-name">Coordinator</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> <span class="token class-name">CNContactPickerDelegate</span> <span class="token punctuation">{</span><br>        <span class="token keyword">private</span> <span class="token keyword">var</span> parent<span class="token punctuation">:</span> <span class="token class-name">ContactPicker</span><br><br>        <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> parent<span class="token punctuation">:</span> <span class="token class-name">ContactPicker</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">self</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">func</span> <span class="token function-definition function">contactPicker</span><span class="token punctuation">(</span><br>            <span class="token omit keyword">_</span> picker<span class="token punctuation">:</span> <span class="token class-name">CNContactPickerViewController</span><span class="token punctuation">,</span><br>            didSelect contact<span class="token punctuation">:</span> <span class="token class-name">CNContact</span><br>        <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            parent<span class="token punctuation">.</span>contact <span class="token operator">=</span> contact<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token attribute atrule">@Binding</span> <span class="token keyword">private</span> <span class="token keyword">var</span> contact<span class="token punctuation">:</span> <span class="token class-name">CNContact</span><span class="token operator">?</span><br><br>    <span class="token keyword">init</span><span class="token punctuation">(</span>contact<span class="token punctuation">:</span> <span class="token class-name">Binding</span><span class="token operator">&lt;</span><span class="token class-name">CNContact</span><span class="token operator">?></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        _contact <span class="token operator">=</span> contact<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeCoordinator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Coordinator</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Coordinator</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeUIViewController</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span><br>        <span class="token operator">-></span> <span class="token class-name">CNContactPickerViewController</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> vc <span class="token operator">=</span> <span class="token class-name">CNContactPickerViewController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        vc<span class="token punctuation">.</span>delegate <span class="token operator">=</span> context<span class="token punctuation">.</span>coordinator<br>        <span class="token keyword">return</span> vc<br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This method is required, but in this case it doesn't need to anything.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">updateUIViewController</span><span class="token punctuation">(</span><br>        <span class="token omit keyword">_</span> uiViewController<span class="token punctuation">:</span> <span class="token class-name">CNContactPickerViewController</span><span class="token punctuation">,</span><br>        context<span class="token punctuation">:</span> <span class="token class-name">Context</span><br>    <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>To use this in a SwiftUI view, do something like the following:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">Contacts</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> cellNumber <span class="token operator">=</span> <span class="token string-literal"><span class="token string">""</span></span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> contact<span class="token punctuation">:</span> <span class="token class-name">CNContact</span><span class="token operator">?</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> firstName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">""</span></span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> lastName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">""</span></span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Text</span><span class="token punctuation">(</span>firstName<span class="token punctuation">)</span><br>            <span class="token class-name">Text</span><span class="token punctuation">(</span>lastName<span class="token punctuation">)</span><br>            <span class="token class-name">Text</span><span class="token punctuation">(</span>cellNumber<span class="token punctuation">)</span><br>            <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Find in Contacts"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                isFindingContact <span class="token operator">=</span> <span class="token boolean">true</span><br>            <span class="token punctuation">}</span><br>            <span class="token punctuation">.</span><span class="token function">buttonStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>borderedProminent<span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> contact<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span><br>            <span class="token keyword">guard</span> <span class="token keyword">let</span> contact <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span><br><br>            firstName <span class="token operator">=</span> contact<span class="token punctuation">.</span>givenName<br>            lastName <span class="token operator">=</span> contact<span class="token punctuation">.</span>familyName<br><br>            <span class="token comment">// Find the first "Mobile" phone number.</span><br>            <span class="token keyword">var</span> phone <span class="token operator">=</span> contact<span class="token punctuation">.</span>phoneNumbers<span class="token punctuation">.</span>first <span class="token punctuation">{</span> phoneNumber <span class="token keyword">in</span><br>                <span class="token keyword">guard</span> <span class="token keyword">let</span> label <span class="token operator">=</span> phoneNumber<span class="token punctuation">.</span>label <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><br>                <span class="token keyword">return</span> label<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Mobile"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br><br>            <span class="token comment">// If none was found, just use the first phone number.</span><br>            <span class="token keyword">if</span> phone <span class="token operator">==</span> <span class="token nil constant">nil</span> <span class="token punctuation">{</span> phone <span class="token operator">=</span> contact<span class="token punctuation">.</span>phoneNumbers<span class="token punctuation">.</span>first <span class="token punctuation">}</span><br><br>            <span class="token comment">// Get the phone number from this object.</span><br>            <span class="token keyword">if</span> <span class="token keyword">let</span> phone <span class="token punctuation">{</span> cellNumber <span class="token operator">=</span> phone<span class="token punctuation">.</span>value<span class="token punctuation">.</span>stringValue <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span>isPresented<span class="token punctuation">:</span> $isFindingContact<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token class-name">ContactPicker</span><span class="token punctuation">(</span>contact<span class="token punctuation">:</span> $contact<span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></article>