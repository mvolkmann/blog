<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Swift Charts</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#resources">Resources</a></li><li><a href="#example-app">Example App</a></li><li><a href="#chart">Chart</a></li><li><a href="#marks">Marks</a><ol><li><a href="#barmark">BarMark</a></li><li><a href="#linemark">LineMark</a></li><li><a href="#pointmark">PointMark</a></li><li><a href="#areamark">AreaMark</a></li><li><a href="#rectanglemark">RectangleMark</a></li><li><a href="#rulemark">RuleMark</a></li><li><a href="#sectormark">SectorMark</a></li></ol></li><li><a href="#selection">Selection</a></li><li><a href="#scrolling">Scrolling</a></li><li><a href="#example-charts">Example Charts</a></li><li><a href="#series-colors">Series Colors</a></li><li><a href="#axis-marks">Axis Marks</a></li><li><a href="#legends">Legends</a></li><li><a href="#scale">Scale</a></li><li><a href="#scrolling-1">Scrolling</a></li><li><a href="#background-and-overlay">Background and Overlay</a></li><li><a href="#event-handling">Event Handling</a></li><li><a href="#animation">Animation</a></li><li><a href="#accessibility">Accessibility</a></li></ol></nav></aside><article><style>img {
        border: 1px solid gray;
    }</style><h2 id="overview" tabindex="-1">Overview</h2><p>Apple introduced the <a href="https://developer.apple.com/documentation/charts?v=1.0.21" rel="noopener" target="_blank">Swift Charts</a> framework in iOS 16.</p><p>&quot;Swift Charts is a powerful and concise SwiftUI framework for transforming your data into informative visualizations. With Swift Charts, you can build effective and customizable charts with minimal code. This framework provides marks, scales, axes, and legends as building blocks that you can combine to develop a broad range of data-driven charts.&quot;</p><p>Swift Charts supports creating bar charts, line charts, area charts, scatter plots, and heat maps.</p><p>Support for pie and donut charts was added in iOS 17.</p><p>Values to be plotted can be quantitative (<code>Int</code>, <code>Double</code>, or <code>Decimal</code>), nominal (<code>String</code> or enum with <code>String</code> values), or temporal (<code>Date</code> representing a date or time).</p><p>One axis must correspond to quantitative data and the other axis must correspond to either nominal or temporal data. If the y values are quantitative then the chart will be vertical and the x values will be used for x-axis labels. If the x values are quantitative then the chart will be horizontal. and the y values will be used for y-axis labels.</p><p>By default charts occupy all the space made available to them by their parent view.</p><h2 id="resources" tabindex="-1">Resources</h2><ul><li><a href="https://developer.apple.com/videos/play/wwdc2022/10136/?v=1.0.21" rel="noopener" target="_blank">Hello Swift Charts</a> from Apple WWDC 2022</li><li><a href="https://developer.apple.com/videos/play/wwdc2022/10137?v=1.0.21" rel="noopener" target="_blank">Swift Charts: Raise the bar</a> from Apple WWDC 2022</li><li><a href="https://www.youtube.com/watch?v=dIvE-E8nlsA?v=1.0.21" rel="noopener" target="_blank">Charts Framework 1 - BarCharts Introduction</a> from Stewart Lynch</li><li><a href="https://www.youtube.com/watch?v=lB3poCA8ZN4?v=1.0.21" rel="noopener" target="_blank">Charts Framework 2 - Visualizing Large Data Sets with Bar Charts</a> from Stewart Lynch</li><li><a href="https://developer.apple.com/videos/play/wwdc2023/10037/?v=1.0.21" rel="noopener" target="_blank">Explore pie charts and interactivity in Swift Charts</a> from Apple WWDC 2023</li></ul><h2 id="example-app" tabindex="-1">Example App</h2><p>See <a href="https://github.com/mvolkmann/ChartsDemo?v=1.0.21" rel="noopener" target="_blank">ChartsDemo</a> which is a SwiftUI app that demonstrates nearly everything shared in the Steward Lynch videos linked above.</p><h2 id="chart" tabindex="-1">Chart</h2><p>The <a href="https://developer.apple.com/documentation/charts/chart?v=1.0.21" rel="noopener" target="_blank">Chart</a> view contains marks that define the chart to be displayed.</p><p>Charts are composed of three kinds of areas, axes (x and y), plot area, and legend. Each of these can be customizes. Axes and the legend can be hidden.</p><p>To set the height of a chart, its background color, and a border, apply the <a href="https://developer.apple.com/documentation/charts/chart/chartplotstyle(content:)?v=1.0.21" rel="noopener" target="_blank">chartPlotStyle</a> view modifier to the <code>Chart</code>. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>    <span class="token operator">...</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span>chartPlotStyle <span class="token punctuation">{</span> plotArea <span class="token keyword">in</span><br>    plotArea<br>        <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token comment">// can also set width</span><br>        <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">border</span><span class="token punctuation">(</span><span class="token punctuation">.</span>purple<span class="token punctuation">,</span> width<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>To customize the x-axis, apply the <a href="https://developer.apple.com/documentation/charts/chart/chartxaxis(content:)?v=1.0.21" rel="noopener" target="_blank">chartXAxis</a> view modifier. To customize the y-axis, apply the <a href="https://developer.apple.com/documentation/charts/chart/chartyaxis(content:)?v=1.0.21" rel="noopener" target="_blank">chartYAxis</a> view modifier. For more on these, see the &quot;Axis Labels&quot; section below.</p><p>To detect tap and drag gestures on the chart, apply the <a href="https://developer.apple.com/documentation/charts/chart/chartoverlay(alignment:content:)?v=1.0.21" rel="noopener" target="_blank">chartOverlay</a> view modifier or the <a href="https://developer.apple.com/documentation/charts/chart/chartbackground(alignment:content:)?v=1.0.21" rel="noopener" target="_blank">chartBackground</a> view modifier. For more on these, see the &quot;Event Handling&quot; section below.</p><h2 id="marks" tabindex="-1">Marks</h2><p>Swift Charts supports six kinds of &quot;marks&quot; for creating various kinds of charts. Each of these serve as direct children of the <a href="https://developer.apple.com/documentation/charts/chart?v=1.0.21" rel="noopener" target="_blank">Chart</a> view. They include:</p><ul><li><a href="https://developer.apple.com/documentation/charts/areamark?v=1.0.21" rel="noopener" target="_blank">AreaMark</a></li><li><a href="https://developer.apple.com/documentation/charts/barmark?v=1.0.21" rel="noopener" target="_blank">BarMark</a></li><li><a href="https://developer.apple.com/documentation/charts/linemark?v=1.0.21" rel="noopener" target="_blank">LineMark</a></li><li><a href="https://developer.apple.com/documentation/charts/pointmark?v=1.0.21" rel="noopener" target="_blank">PointMark</a></li><li><a href="https://developer.apple.com/documentation/charts/rectanglemark?v=1.0.21" rel="noopener" target="_blank">RectangleMark</a></li><li><a href="https://developer.apple.com/documentation/charts/rulemark?v=1.0.21" rel="noopener" target="_blank">RuleMark</a></li><li><a href="https://developer.apple.com/documentation/charts/sectormark?v=1.0.21" rel="noopener" target="_blank">SectorMark</a></li></ul><p>The initializer for each mark type takes <code>x</code> and <code>y</code> arguments that have the type <a href="https://developer.apple.com/documentation/charts/plottablevalue?v=1.0.21" rel="noopener" target="_blank">PlottableValue</a>. Instances are created by calling the <code>PlottableValue</code> static method <code>value</code> which takes a <code>String</code> label and a value that can be a number (quantitative), <code>String</code> (nominal), or <code>Date</code> (temporal).</p><p>It is typical to iterate over a collection of objects that hold data to be plotted using <code>ForEach</code> and create one or more marks from each object. If these objects do not conform to the <code>Identifiable</code> protocol, which requires an <code>id</code> property, add the <code>id</code> argument to the <code>ForEach</code> to specify a key path that uniquely identifiers each object.</p><p>If the only child view of the <code>Chart</code> is a <code>ForEach</code>, the collection can be passed to the <code>Chart</code> initializer and the <code>ForEach</code> can be removed. The <code>Chart</code> initializer also supports the <code>id</code> argument.</p><h3 id="barmark" tabindex="-1">BarMark</h3><p>Instances of the <a href="https://developer.apple.com/documentation/charts/barmark?v=1.0.21" rel="noopener" target="_blank">BarMark</a> struct describe individual bars in a bar charts.</p><p>Negative quantitative values cause the bar to be rendered below the typical x-axis..</p><p>To assign a different color to each corresponding <code>BarMark</code>, apply the <code>foregroundStyle</code> view modifier. This can be passed a specific <code>Color</code>. To allow Swift Charts to automatically choose a different color for the marks in each data series, pass the <code>by</code> argument that identifies the data series. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">BarMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> ageCategory<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">,</span> statistic<span class="token punctuation">.</span>male<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Gender"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token class-name">BarMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> ageCategory<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Female"</span></span><span class="token punctuation">,</span> statistic<span class="token punctuation">.</span>female<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Gender"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Female"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Bars are automatically stacked when there are multiple instances with the same nominal or temporal value. To display the corresponding bars side-by-side instead of stacking them, apply the <code>position</code> view modifier, passing the <code>by</code> argument that identifies the data series. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">BarMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> ageCategory<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">,</span> statistic<span class="token punctuation">.</span>male<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Gender"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Gender"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token class-name">BarMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> ageCategory<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Female"</span></span><span class="token punctuation">,</span> statistic<span class="token punctuation">.</span>female<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Gender"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Female"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Gender"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Female"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>In bar charts that use temporal data, the unit defaults to <code>.hour</code>. With this unit the axis that represents the temporal values is scaled to accommodate 24 bars in each day. To instead display bars that correspond to entire days, pass the <code>unit</code> argument to the <code>BarMark</code> initializer with a value of <code>.day</code>.</p><p>To annotate a bar, apply the <code>annotation</code> view modifier to a <code>BarMark</code>. By default this renders a given view above the bar. To position the annotation on the center of the bar, pass the <code>position</code> argument with a value of <code>.overlay</code>. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">BarMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> value1<span class="token punctuation">,</span> y<span class="token punctuation">:</span> value2<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">annotation</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> <span class="token punctuation">.</span>overlay<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">data<span class="token punctuation">.</span>quantity</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">bold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token punctuation">.</span>white<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3 id="linemark" tabindex="-1">LineMark</h3><p>Instances of the <a href="https://developer.apple.com/documentation/charts/linemark?v=1.0.21" rel="noopener" target="_blank">LineMark</a> struct are used to display line charts.</p><p>To assign a different color to each corresponding <code>LineMark</code>, apply the <code>foregroundStyle</code> view modifier as described in the <code>BarMark</code> section above.</p><p>To display points at the ends of each line, add a <code>PointMark</code> (described in the next section) after each <code>LineMark</code> with the same <code>x</code> and <code>y</code> values.</p><p>An alternative to adding <code>PointMark</code> instances is to apply the <code>symbol</code> view modifier to the <code>LineMark</code> instances. See the examples in the <code>PointMark</code> section below.</p><p>To change the line style, apply the <code>lineStyle</code> view modifier to each <code>LineMark</code>. For example, the following uses a dashed line:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">LineMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> ageCategory<span class="token punctuation">,</span> y<span class="token punctuation">:</span> male<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">lineStyle</span><span class="token punctuation">(</span><span class="token class-name">StrokeStyle</span><span class="token punctuation">(</span>lineWidth<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> dash<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>To smooth the lines, apply the <code>interpolationMethod</code> view modifier to each <code>LineMark</code> with the value <code>.monotone</code>, <code>.cardinal</code>, or <code>.catmullRom</code> (formulated by Edwin Catmull and Raphael Rom). For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">LineMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> ageCategory<span class="token punctuation">,</span> y<span class="token punctuation">:</span> male<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">interpolationMethod</span><span class="token punctuation">(</span><span class="token punctuation">.</span>catmullRom<span class="token punctuation">)</span></code></pre><h3 id="pointmark" tabindex="-1">PointMark</h3><p>Instances of the <a href="https://developer.apple.com/documentation/charts/pointmark?v=1.0.21" rel="noopener" target="_blank">PointMark</a> struct are used to display scatter plots or to add points to line charts.</p><p>To assign a different color to each corresponding <code>PointMark</code>, apply the <code>foregroundStyle</code> view modifier as described in the <code>BarMark</code> section above.</p><p>To display a symbol instead of a filled circle for each point, apply the <code>symbol</code> view modifier to each <code>PointMark</code> passing it a <code>by</code> argument whose value identifies a data series. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">PointMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> ageCategory<span class="token punctuation">,</span> y<span class="token punctuation">:</span> male<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>blue<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">symbol</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Gender"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token class-name">PointMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> category<span class="token punctuation">,</span> y<span class="token punctuation">:</span> female<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">symbol</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Gender"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Female"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>The values <code>&quot;Male&quot;</code> and <code>&quot;Female&quot;</code> identify the data series to which each point belongs. These values could come of the data objects rather than being literal values.</p><h3 id="areamark" tabindex="-1">AreaMark</h3><p>Instances of the <a href="https://developer.apple.com/documentation/charts/areamark?v=1.0.21" rel="noopener" target="_blank">AreaMark</a> struct are used to display area charts which shade the area below single values in a data series (by specifying the <code>y</code> argument) or between two values in a data series (by specifying the <code>yStart</code> and <code>yEnd</code> arguments).</p><p>An example where shading a range of values is useful is when creating a chart that shows a series of minimum, average, and maximum values. <code>LineMark</code> instances can be used to plot the average values. <code>AreaMark</code> instances can be used to shade the area between the minimum and maximum values.</p><p>Areas can be stacked, but cannot overlap.</p><p>The example app draws one line for male data and one line for female data. Toggling the &quot;Show Area&quot; option causes it to only shade below the male line due to this restriction.</p><h3 id="rectanglemark" tabindex="-1">RectangleMark</h3><p>Instances of the <a href="https://developer.apple.com/documentation/charts/rectanglemark?v=1.0.21" rel="noopener" target="_blank">RectangleMark</a> struct are used to display heat maps.</p><p>The following code demonstrates using this to display a heat map that represents hourly temperature forecasts over the 5-day period. For a full implementation that uses <a href="/blog/swift/weatherkit">WeatherKit</a> to get real temperature forecasts, see <a href="https://github.com/mvolkmann/WeatherKitDemo?v=1.0.21" rel="noopener" target="_blank">WeatherKitDemo</a>.</p><p><img alt="Swift Charts heat map" style="width: 45%" src="/blog/assets/swift-charts-heat-map.png?v=1.0.21" title="Swift Charts heat map"></p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">Charts</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">extension</span> <span class="token class-name">Date</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Returns an abbreviated day of the week (ex. Sun).</span><br>    <span class="token keyword">var</span> dayOfWeek<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> dateFormatter <span class="token operator">=</span> <span class="token class-name">DateFormatter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        dateFormatter<span class="token punctuation">.</span>dateFormat <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"EEE"</span></span><br>        <span class="token keyword">return</span> dateFormatter<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Returns 1 for Sunday and 7 for Saturday.</span><br>    <span class="token keyword">var</span> dayOfWeekNumber<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Calendar</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">dateComponents</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">.</span>weekday<span class="token punctuation">]</span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">.</span>weekday<span class="token operator">!</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Returns the hour of a `Date`.</span><br>    <span class="token keyword">var</span> hour<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Calendar</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">.</span>hour<span class="token punctuation">,</span> from<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// This holds a subset of the properties</span><br><span class="token comment">// in the WeatherKit `HourWeather` struct.</span><br><span class="token keyword">struct</span> <span class="token class-name">HourWeather</span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> date<span class="token punctuation">:</span> <span class="token class-name">Date</span><br>    <span class="token keyword">let</span> temperature<span class="token punctuation">:</span> <span class="token class-name">Measurement</span><span class="token operator">&lt;</span><span class="token class-name">UnitTemperature</span><span class="token operator">></span><br><span class="token punctuation">}</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">let</span> daysOfWeek <span class="token operator">=</span><br>        <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"Sun"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Mon"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Tue"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Wed"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Thu"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Fri"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"Sat"</span></span><span class="token punctuation">]</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">let</span> days <span class="token operator">=</span> <span class="token number">5</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">let</span> gradientColors<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Color</span><span class="token punctuation">]</span> <span class="token operator">=</span><br>        <span class="token punctuation">[</span><span class="token punctuation">.</span>blue<span class="token punctuation">,</span> <span class="token punctuation">.</span>green<span class="token punctuation">,</span> <span class="token punctuation">.</span>yellow<span class="token punctuation">,</span> <span class="token punctuation">.</span>orange<span class="token punctuation">,</span> <span class="token punctuation">.</span>red<span class="token punctuation">]</span><br><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> hourlyForecast<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">HourWeather</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><br><br>    <span class="token comment">// This is displayed on the left side of the heat map.</span><br>    <span class="token keyword">private</span> <span class="token keyword">var</span> dayLabels<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span><span class="token punctuation">(</span>spacing<span class="token punctuation">:</span> <span class="token number">21</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">let</span> startIndex <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dayOfWeekNumber <span class="token operator">-</span> <span class="token number">1</span><br>            <span class="token keyword">let</span> range <span class="token operator">=</span><br>                startIndex <span class="token operator">..&lt;</span> startIndex <span class="token operator">+</span> <span class="token keyword">Self</span><span class="token punctuation">.</span>days<br>            <span class="token class-name">ForEach</span><span class="token punctuation">(</span>range<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> index <span class="token keyword">in</span><br>                <span class="token function">dayLabel</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">.</span>daysOfWeek<span class="token punctuation">[</span>index <span class="token operator">%</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">.</span>top<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">HStack</span><span class="token punctuation">(</span>alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>top<span class="token punctuation">,</span> spacing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            dayLabels<br>            <span class="token class-name">ScrollView</span><span class="token punctuation">(</span><span class="token punctuation">.</span>horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token function">heatMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span>onAppear <span class="token punctuation">{</span><br>            <span class="token function">generateData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This displays an abbreviated day of the week (ex. Sun)</span><br>    <span class="token comment">// rotated to read from the right.</span><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">dayLabel</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> day<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Text</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>subheadline<span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">rotationEffect</span><span class="token punctuation">(</span><span class="token class-name">Angle</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>height<span class="token punctuation">:</span> <span class="token number">55</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// We could use WeatherKit to get real temperature forecasts</span><br>    <span class="token comment">// as is done in https://github.com/mvolkmann/WeatherKitDemo.</span><br>    <span class="token comment">// To keep things simple this generates random temperatures.</span><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">generateData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// current date and time</span><br>        <span class="token keyword">let</span> calendar <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span>current<br>        date <span class="token operator">=</span> calendar<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span>bySetting<span class="token punctuation">:</span> <span class="token punctuation">.</span>hour<span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> of<span class="token punctuation">:</span> date<span class="token punctuation">)</span><span class="token operator">!</span><br><br>        <span class="token keyword">var</span> temperature <span class="token operator">=</span> <span class="token number">50.0</span><br><br>        <span class="token keyword">var</span> data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">HourWeather</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><br>        <span class="token keyword">for</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span> <span class="token number">1</span> <span class="token operator">...</span> <span class="token keyword">Self</span><span class="token punctuation">.</span>days <span class="token punctuation">{</span> <span class="token comment">// days</span><br>            <span class="token keyword">for</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span> <span class="token number">0</span> <span class="token operator">...</span> <span class="token number">23</span> <span class="token punctuation">{</span> <span class="token comment">// hours</span><br>                <span class="token comment">// Change the temperature by a random amount</span><br>                <span class="token comment">// of not more than two degrees.</span><br>                temperature <span class="token operator">+=</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">...</span> <span class="token number">2</span><span class="token punctuation">)</span><br>                data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">HourWeather</span><span class="token punctuation">(</span><br>                    date<span class="token punctuation">:</span> date<span class="token punctuation">,</span><br>                    temperature<span class="token punctuation">:</span> <span class="token class-name">Measurement</span><span class="token punctuation">(</span><br>                        value<span class="token punctuation">:</span> temperature<span class="token punctuation">,</span><br>                        unit<span class="token punctuation">:</span> <span class="token class-name">UnitTemperature</span><span class="token punctuation">.</span>fahrenheit<br>                    <span class="token punctuation">)</span><br>                <span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>                <span class="token comment">// Advance to the next hour.</span><br>                date <span class="token operator">=</span> calendar<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span>byAdding<span class="token punctuation">:</span> <span class="token punctuation">.</span>hour<span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> date<span class="token punctuation">)</span><span class="token operator">!</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br><br>        hourlyForecast <span class="token operator">=</span> data<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">heatMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>            <span class="token class-name">ForEach</span><span class="token punctuation">(</span>hourlyForecast<span class="token punctuation">.</span>indices<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> index <span class="token keyword">in</span><br>                <span class="token keyword">let</span> forecast <span class="token operator">=</span> hourlyForecast<span class="token punctuation">[</span>index<span class="token punctuation">]</span><br>                <span class="token function">mark</span><span class="token punctuation">(</span>forecast<span class="token punctuation">:</span> forecast<span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token comment">// Set the range of background colors to be used for</span><br>        <span class="token comment">// each `RectangleMark` created in the `mark` method.</span><br>        <span class="token punctuation">.</span><span class="token function">chartForegroundStyleScale</span><span class="token punctuation">(</span><br>            range<span class="token punctuation">:</span> <span class="token class-name">Gradient</span><span class="token punctuation">(</span>colors<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">.</span>gradientColors<span class="token punctuation">)</span><br>        <span class="token punctuation">)</span><br><br>        <span class="token comment">// Add hour labels on the x-axis.</span><br>        <span class="token punctuation">.</span>chartXAxis <span class="token punctuation">{</span><br>            <span class="token class-name">AxisMarks</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> <span class="token punctuation">.</span>bottom<span class="token punctuation">,</span> values<span class="token punctuation">:</span> <span class="token punctuation">.</span>automatic<span class="token punctuation">)</span> <span class="token punctuation">{</span> axisValue <span class="token keyword">in</span><br>                <span class="token class-name">AxisTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                <span class="token class-name">AxisValueLabel</span><span class="token punctuation">(</span>centered<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                    <span class="token keyword">let</span> index <span class="token operator">=</span> axisValue<span class="token punctuation">.</span>index<br>                    <span class="token keyword">let</span> mod <span class="token operator">=</span> index <span class="token operator">%</span> <span class="token number">12</span><br>                    <span class="token keyword">let</span> hour <span class="token operator">=</span> mod <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">12</span> <span class="token punctuation">:</span> mod<br>                    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">hour</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">\n</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">index <span class="token operator">&lt;</span> <span class="token number">12</span> <span class="token operator">?</span> <span class="token string-literal"><span class="token string">"AM"</span></span> <span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"PM"</span></span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">multilineTextAlignment</span><span class="token punctuation">(</span><span class="token punctuation">.</span>center<span class="token punctuation">)</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token comment">// The y-axis labels generated by Swift Charts appear</span><br>        <span class="token comment">// at the top of each row rather that centered on the row.</span><br>        <span class="token comment">// So this hides them and `dayLabels` provides custom y-axis labels.</span><br>        <span class="token punctuation">.</span><span class="token function">chartYAxis</span><span class="token punctuation">(</span><span class="token punctuation">.</span>hidden<span class="token punctuation">)</span><br><br>        <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">800</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">.</span>days <span class="token operator">*</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This creates an individual cell in the heat map.</span><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">mark</span><span class="token punctuation">(</span>forecast<span class="token punctuation">:</span> <span class="token class-name">HourWeather</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">ChartContent</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> date <span class="token operator">=</span> forecast<span class="token punctuation">.</span>date<br>        <span class="token keyword">let</span> fahrenheit <span class="token operator">=</span> forecast<span class="token punctuation">.</span>temperature<span class="token punctuation">.</span><span class="token function">converted</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> <span class="token punctuation">.</span>fahrenheit<span class="token punctuation">)</span><span class="token punctuation">.</span>value<br><br>        <span class="token keyword">return</span> <span class="token class-name">Plot</span> <span class="token punctuation">{</span><br>            <span class="token class-name">RectangleMark</span><span class="token punctuation">(</span><br>                <span class="token comment">// Why do String values work, but Int values do not?</span><br>                x<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Time"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">date<span class="token punctuation">.</span>hour</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                y<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Day"</span></span><span class="token punctuation">,</span> date<span class="token punctuation">.</span>dayOfWeek<span class="token punctuation">)</span><span class="token punctuation">,</span><br>                width<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">ratio</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                height<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">ratio</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><br>            <span class="token punctuation">)</span><br>            <span class="token comment">// Choose a cell color based on the temperature.</span><br>            <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>by<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Temperature"</span></span><span class="token punctuation">,</span> fahrenheit<span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token comment">// Display the temperature on top of the cell.</span><br>            <span class="token punctuation">.</span><span class="token function">annotation</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> <span class="token punctuation">.</span>overlay<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation"><span class="token class-name">String</span><span class="token punctuation">(</span>format<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"%.0f"</span></span><span class="token punctuation">,</span> fahrenheit<span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">℉"</span></span><span class="token punctuation">)</span><br>                    <span class="token punctuation">.</span><span class="token function">rotationEffect</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">degrees</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>                    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>body<span class="token punctuation">)</span><br>                    <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">55</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3 id="rulemark" tabindex="-1">RuleMark</h3><p>Instances of the <a href="https://developer.apple.com/documentation/charts/rulemark?v=1.0.21" rel="noopener" target="_blank">RuleMark</a> struct are used to add a vertical line (when only the <code>x</code> value is set) or a horizontal line (when only the <code>y</code> value is set).</p><p>To add an text annotation to a <code>RuleMark</code>, apply the <code>annotation</code> view modifier.</p><p>The following example adds a red, dashed, horizontal line at the y value that is the average of the quantitative values being plotted. The text &quot;Average&quot; appears below this line beginning at its leading end.</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">RuleMark</span><span class="token punctuation">(</span>y<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Average"</span></span><span class="token punctuation">,</span> average<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">lineStyle</span><span class="token punctuation">(</span><span class="token class-name">StrokeStyle</span><span class="token punctuation">(</span>lineWidth<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> dash<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">annotation</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> <span class="token punctuation">.</span>bottom<span class="token punctuation">,</span> alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>leading<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>         <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Average"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>caption<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span></code></pre><p>The example in the &quot;Event Handling&quot; section below listens for drag events on the chart and adds a red, dashed, vertical line through the mark being dragged over. Information about the data point is displayed at the top of the line, above the chart.</p><h3 id="sectormark" tabindex="-1">SectorMark</h3><p>Instances of the <a href="https://developer.apple.com/documentation/charts/sectormark?v=1.0.21" rel="noopener" target="_blank">SectorMark</a> struct are used to add slices to pie and donut charts. This was added in iOS 17.</p><p>Each <code>SectorMark</code> specifies an <code>angle</code> argument whose value is an instance of the <code>PlottableValue</code> struct which has many static <code>value</code> methods. The first argument of the <code>value</code> method can be a <code>String</code>, <code>LocalizedStringKey</code>, or <code>Text</code>. The second argument can be a <code>Double</code> (quantitative), <code>Date</code> (temporal), or <code>String</code> (categorical).</p><p>The size (angle) of each <code>SectorMark</code> is computed based on the proportion of its value to the total. The total of the values does not need to be 100.</p><p>To add a gap between the sectors, specify an <code>angularInset</code> argument. For example, <code>angularInset: 2</code>.</p><p>To round the corners of a sector, apply the <code>cornerRadius</code> view modifier to a <code>SectorMark</code>. For example, <code>.cornerRadius(10)</code>.</p><p>To create a donut chart instead of a pie chart, each <code>SectorMark</code> must also specify an <code>innerRadius</code> argument. For example, <code>innerRadius: .ratio(0.618)</code>.</p><p>Each <code>SectorMark</code> can also specify an <code>outerRadius</code> argument, although doing so is not typical. Each <code>SectorMark</code> can have different values for <code>innerRadius</code> and/or <code>outerRadius</code>, but this is also not typical.</p><p>TODO: Is there a way to place text in each <code>SectorMark</code>?</p><p>For an example, see the app in the GitHub repository <a href="https://github.com/mvolkmann/SwiftChartsPieDonut?v=1.0.21" rel="noopener" target="_blank">SwiftChartsPieDonut</a>.</p><p><img alt="Swift Charts donut" style="width: 45%" src="/blog/assets/swift-charts-donut.png?v=1.0.21" title="Swift Charts donut"> <img alt="Swift Charts donut selected" style="width: 45%" src="/blog/assets/swift-charts-donut-selected.png?v=1.0.21" title="Swift Charts donut selected"></p><h2 id="selection" tabindex="-1">Selection</h2><p>iOS 17 added the <a href="https://developer.apple.com/documentation/swiftui/view/chartxselection(value:)?v=1.0.21" rel="noopener" target="_blank">chartXSelection</a>, <a href="https://developer.apple.com/documentation/swiftui/view/chartyselection(value:)?v=1.0.21" rel="noopener" target="_blank">chartYSelection</a>, and <a href="https://developer.apple.com/documentation/swiftui/view/chartangleselection(_:)?v=1.0.21" rel="noopener" target="_blank">chartAngleSelection</a> methods to the <code>Chart</code> struct. These are useful for allowing users to swipe over a chart trigger changes to the way a chart is rendered such as triggering the display of annotations.</p><p>For an example, see the app in the GitHub repository <a href="https://github.com/mvolkmann/SwiftChartsSelection?v=1.0.21" rel="noopener" target="_blank">SwiftChartsSelection</a>.</p><p><img alt="Swift Charts selection" style="width: 45%" src="/blog/assets/swift-charts-selection.png?v=1.0.21" title="Swift Charts selection"></p><h2 id="scrolling" tabindex="-1">Scrolling</h2><p>For charts with a large number of data points, it is convenient to all the chart to be wider than the screen and scroll when the user drags past its ends. This is enabled by calling <code>.chartScrollableAxes(.horizontal)</code> on the<code>Chart</code>.</p><p>For an example, see the app in the GitHub repository <a href="https://github.com/mvolkmann/SwiftChartsScrollable?v=1.0.21" rel="noopener" target="_blank">SwiftChartsScrollable</a>.</p><p>It seems that when scrolling is enabled, selection is disabled. I haven't found a way to enable both. See the issue <a href="https://feedbackassistant.apple.com/feedback/12348843?v=1.0.21" rel="noopener" target="_blank">here</a>.</p><h2 id="example-charts" tabindex="-1">Example Charts</h2><p>This example plots hourly temperature forecasts from hard-coded data. It could of course come from WeatherKit.</p><p>The code can be found at <a href="https://github.com/mvolkmann/SwiftChartsBasic?v=1.0.21" rel="noopener" target="_blank">SwiftChartsBasic</a>.</p><p>There is a segmented <code>Picker</code> at the top that enables switching between two chart representations. The first is the bar chart and the second is a combination of a line chart, area chart, and point chart.</p><p><img alt="Swift Charts bar chart" style="width: 45%" src="/blog/assets/swift-charts-bar.png?v=1.0.21" title="Swift Charts bar chart"> <img alt="Swift Charts line/area/point chart" style="width: 45%" src="/blog/assets/swift-charts-line-area-point.png?v=1.0.21" title="Swift Charts line/area/point chart"></p><p>The bars and points are assigned a color that selected from a gradient based on the temperature value they represent. This is done using the following <code>Array</code> extension:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">extension</span> <span class="token class-name">Array</span> <span class="token keyword">where</span> <span class="token class-name">Element</span><span class="token punctuation">:</span> <span class="token class-name">UIColor</span> <span class="token punctuation">{</span><br>    <span class="token comment">/// Gets a color that is a given percentage through an array of Colors.</span><br>    <span class="token comment">/// - Parameters:</span><br>    <span class="token comment">///   - percentage: Double between 0.0 and 1.0</span><br>    <span class="token comment">/// - Returns: Color object</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">colorAt</span><span class="token punctuation">(</span>percentage<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Color</span> <span class="token punctuation">{</span><br>        <span class="token keyword">guard</span> percentage <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>first <span class="token operator">??</span> <span class="token punctuation">.</span>clear<span class="token punctuation">)</span> <span class="token punctuation">}</span><br>        <span class="token keyword">guard</span> percentage <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>last <span class="token operator">??</span> <span class="token punctuation">.</span>clear<span class="token punctuation">)</span> <span class="token punctuation">}</span><br><br>        <span class="token keyword">let</span> floatIndex <span class="token operator">=</span> percentage <span class="token operator">*</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><br>        <span class="token keyword">let</span> leftIndex <span class="token operator">=</span> <span class="token class-name">Int</span><span class="token punctuation">(</span>floatIndex<span class="token punctuation">.</span><span class="token function">rounded</span><span class="token punctuation">(</span><span class="token punctuation">.</span>down<span class="token punctuation">)</span><span class="token punctuation">)</span><br>        <span class="token keyword">let</span> rightIndex <span class="token operator">=</span> <span class="token class-name">Int</span><span class="token punctuation">(</span>floatIndex<span class="token punctuation">.</span><span class="token function">rounded</span><span class="token punctuation">(</span><span class="token punctuation">.</span>up<span class="token punctuation">)</span><span class="token punctuation">)</span><br>        <span class="token keyword">let</span> defaultIndex <span class="token operator">=</span> <span class="token class-name">Int</span><span class="token punctuation">(</span>floatIndex<span class="token punctuation">.</span><span class="token function">rounded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>        <span class="token keyword">let</span> leftColor <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">[</span>leftIndex<span class="token punctuation">]</span><br>        <span class="token keyword">let</span> rightColor <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">[</span>rightIndex<span class="token punctuation">]</span><br>        <span class="token keyword">let</span> fallbackColor <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">[</span>defaultIndex<span class="token punctuation">]</span><br><br>        <span class="token keyword">var</span> <span class="token punctuation">(</span>r1<span class="token punctuation">,</span> g1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> a1<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">CGFloat</span><span class="token punctuation">,</span> <span class="token class-name">CGFloat</span><span class="token punctuation">,</span> <span class="token class-name">CGFloat</span><span class="token punctuation">,</span> <span class="token class-name">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">=</span><br>            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><br>        <span class="token keyword">guard</span> leftColor<span class="token punctuation">.</span><span class="token function">getRed</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>r1<span class="token punctuation">,</span> green<span class="token punctuation">:</span> <span class="token operator">&amp;</span>g1<span class="token punctuation">,</span> blue<span class="token punctuation">:</span> <span class="token operator">&amp;</span>b1<span class="token punctuation">,</span> alpha<span class="token punctuation">:</span> <span class="token operator">&amp;</span>a1<span class="token punctuation">)</span><br>        <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>fallbackColor<span class="token punctuation">)</span> <span class="token punctuation">}</span><br><br>        <span class="token keyword">var</span> <span class="token punctuation">(</span>r2<span class="token punctuation">,</span> g2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">CGFloat</span><span class="token punctuation">,</span> <span class="token class-name">CGFloat</span><span class="token punctuation">,</span> <span class="token class-name">CGFloat</span><span class="token punctuation">,</span> <span class="token class-name">CGFloat</span><span class="token punctuation">)</span> <span class="token operator">=</span><br>            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><br>        <span class="token keyword">guard</span> rightColor<span class="token punctuation">.</span><span class="token function">getRed</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>r2<span class="token punctuation">,</span> green<span class="token punctuation">:</span> <span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> blue<span class="token punctuation">:</span> <span class="token operator">&amp;</span>b2<span class="token punctuation">,</span> alpha<span class="token punctuation">:</span> <span class="token operator">&amp;</span>a2<span class="token punctuation">)</span><br>        <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>fallbackColor<span class="token punctuation">)</span> <span class="token punctuation">}</span><br><br>        <span class="token keyword">let</span> subPercentage <span class="token operator">=</span> floatIndex <span class="token operator">-</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>leftIndex<span class="token punctuation">)</span><br>        <span class="token keyword">let</span> uiColor <span class="token operator">=</span> <span class="token class-name">UIColor</span><span class="token punctuation">(</span><br>            red<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span><span class="token punctuation">(</span>r1 <span class="token operator">+</span> <span class="token punctuation">(</span>r2 <span class="token operator">-</span> r1<span class="token punctuation">)</span> <span class="token operator">*</span> subPercentage<span class="token punctuation">)</span><span class="token punctuation">,</span><br>            green<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span><span class="token punctuation">(</span>g1 <span class="token operator">+</span> <span class="token punctuation">(</span>g2 <span class="token operator">-</span> g1<span class="token punctuation">)</span> <span class="token operator">*</span> subPercentage<span class="token punctuation">)</span><span class="token punctuation">,</span><br>            blue<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span><span class="token punctuation">(</span>b1 <span class="token operator">+</span> <span class="token punctuation">(</span>b2 <span class="token operator">-</span> b1<span class="token punctuation">)</span> <span class="token operator">*</span> subPercentage<span class="token punctuation">)</span><span class="token punctuation">,</span><br>            alpha<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span><span class="token punctuation">(</span>a1 <span class="token operator">+</span> <span class="token punctuation">(</span>a2 <span class="token operator">-</span> a1<span class="token punctuation">)</span> <span class="token operator">*</span> subPercentage<span class="token punctuation">)</span><br>        <span class="token punctuation">)</span><br>        <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>uiColor<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Here is the code the renders the charts:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">Charts</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">extension</span> <span class="token class-name">Date</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Creates a Date object for a given hour in the current day.</span><br>    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">hour</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> hour<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Date</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> components <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">dateComponents</span><span class="token punctuation">(</span><br>            <span class="token punctuation">[</span><span class="token punctuation">.</span>year<span class="token punctuation">,</span> <span class="token punctuation">.</span>month<span class="token punctuation">,</span> <span class="token punctuation">.</span>day<span class="token punctuation">]</span><span class="token punctuation">,</span><br>            from<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">)</span><br>        components<span class="token punctuation">.</span>hour <span class="token operator">=</span> hour<br>        <span class="token keyword">return</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> components<span class="token punctuation">)</span><span class="token operator">!</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">struct</span> <span class="token class-name">Weather</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><br>    <span class="token keyword">let</span> temperature<span class="token punctuation">:</span> <span class="token class-name">Double</span><br>    <span class="token keyword">var</span> id<span class="token punctuation">:</span> <span class="token class-name">Date</span> <span class="token punctuation">{</span> dateTime <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// This is the data to be plotted.</span><br><span class="token keyword">private</span> <span class="token keyword">let</span> forecast<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Weather</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">43.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">48.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">55.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">60.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">64.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">67.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">69.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">70.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">71.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">71.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">69.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">67.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">65.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">63.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">61.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">58.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> temperature<span class="token punctuation">:</span> <span class="token number">55.0</span><span class="token punctuation">)</span><br><span class="token punctuation">]</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> chartType<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"bar"</span></span><br><br>    <span class="token keyword">let</span> areaColor <span class="token operator">=</span> <span class="token class-name">LinearGradient</span><span class="token punctuation">(</span><br>        gradient<span class="token punctuation">:</span> <span class="token class-name">Gradient</span><span class="token punctuation">(</span>colors<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>yellow<span class="token punctuation">,</span> <span class="token punctuation">.</span>blue<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>        startPoint<span class="token punctuation">:</span> <span class="token punctuation">.</span>top<span class="token punctuation">,</span><br>        endPoint<span class="token punctuation">:</span> <span class="token punctuation">.</span>bottom<br>    <span class="token punctuation">)</span><br><br>    <span class="token comment">// This is used to select bar and point colors</span><br>    <span class="token comment">// based on the temperature they represent.</span><br>    <span class="token keyword">let</span> colors<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">UIColor</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>blue<span class="token punctuation">,</span> <span class="token punctuation">.</span>yellow<span class="token punctuation">,</span> <span class="token punctuation">.</span>red<span class="token punctuation">]</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Picker</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Chart Type"</span></span><span class="token punctuation">,</span> selection<span class="token punctuation">:</span> $chartType<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Bar"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"bar"</span></span><span class="token punctuation">)</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Line"</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"line"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>            <span class="token punctuation">.</span><span class="token function">pickerStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>segmented<span class="token punctuation">)</span><br><br>            <span class="token class-name">Chart</span><span class="token punctuation">(</span>forecast<span class="token punctuation">)</span> <span class="token punctuation">{</span> data <span class="token keyword">in</span><br>                <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token class-name">PlottableValue</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Time"</span></span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>dateTime<span class="token punctuation">)</span><br>                <span class="token keyword">let</span> temp <span class="token operator">=</span> <span class="token class-name">PlottableValue</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Temperature"</span></span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>temperature<span class="token punctuation">)</span><br>                <span class="token keyword">let</span> color <span class="token operator">=</span> <span class="token function">color</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> data<span class="token punctuation">.</span>temperature<span class="token punctuation">)</span><br>                <span class="token keyword">if</span> chartType <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"bar"</span></span> <span class="token punctuation">{</span><br>                    <span class="token comment">// Each BarMark can be a different color.</span><br>                    <span class="token class-name">BarMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> time<span class="token punctuation">,</span> y<span class="token punctuation">:</span> temp<span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><br>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>                    <span class="token comment">// Each PointMark can be a different color,</span><br>                    <span class="token comment">// but LineMarks and AreaMarks cannot.</span><br>                    <span class="token comment">// They can however be gradient colors.</span><br>                    <span class="token class-name">LineMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> time<span class="token punctuation">,</span> y<span class="token punctuation">:</span> temp<span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>blue<span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">interpolationMethod</span><span class="token punctuation">(</span><span class="token punctuation">.</span>catmullRom<span class="token punctuation">)</span><br>                    <span class="token class-name">AreaMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> time<span class="token punctuation">,</span> y<span class="token punctuation">:</span> temp<span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>areaColor<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>                    <span class="token class-name">PointMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> time<span class="token punctuation">,</span> y<span class="token punctuation">:</span> temp<span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This returns a color to use for a given temperature.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">color</span><span class="token punctuation">(</span><span class="token keyword">for</span> temperature<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Color</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> low <span class="token operator">=</span> <span class="token number">30.0</span><br>        <span class="token keyword">let</span> high <span class="token operator">=</span> <span class="token number">100.0</span><br>        <span class="token keyword">let</span> percentage <span class="token operator">=</span> temperature <span class="token operator">&lt;=</span> low <span class="token operator">?</span> <span class="token number">0.0</span> <span class="token punctuation">:</span><br>            temperature <span class="token operator">>=</span> high <span class="token operator">?</span> <span class="token number">1.0</span> <span class="token punctuation">:</span><br>            <span class="token punctuation">(</span>temperature <span class="token operator">-</span> low<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>high <span class="token operator">-</span> low<span class="token punctuation">)</span><br>        <span class="token keyword">return</span> colors<span class="token punctuation">.</span><span class="token function">colorAt</span><span class="token punctuation">(</span>percentage<span class="token punctuation">:</span> percentage<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="series-colors" tabindex="-1">Series Colors</h2><p>To set the color to be used for each data series by its name, apply the <code>chartForegroundStyleScale</code> view modifier to the <code>Chart</code>. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>    <span class="token comment">// chart content goes here</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span><span class="token function">chartForegroundStyleScale</span><span class="token punctuation">(</span><span class="token punctuation">[</span><br>    <span class="token string-literal"><span class="token string">"Male"</span></span><span class="token punctuation">:</span> <span class="token punctuation">.</span>blue<span class="token punctuation">,</span><br>    <span class="token string-literal"><span class="token string">"Female"</span></span><span class="token punctuation">:</span> <span class="token punctuation">.</span>red<span class="token punctuation">,</span><br><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><h2 id="axis-marks" tabindex="-1">Axis Marks</h2><p>Axis marks can be added to the x-axis and y-axis. Each is composed of three optional parts, a grid line, a tick, and a label.</p><p>To customize axis marks, apply the <code>chartXAxis</code> and/or <code>chartYAxis</code> view modifiers to the <code>Chart</code>. Each of these take a closure. Leaving the closure empty causes the axis to be hidden. However, a more explicit way to hide an axis is to pass <code>.hidden</code> to these view modifiers.</p><p>The default axes are the same as what is generated by writing the following:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>    <span class="token comment">// chart content goes here</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span>chartXAxis <span class="token punctuation">{</span><br>    <span class="token class-name">AxisMarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span>chartYAxis <span class="token punctuation">{</span><br>    <span class="token class-name">AxisMarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>To customize axis marks, add arguments to the <code>AxisMarks</code> initializers and/or add a trailing closure that is passed a single axis value.</p><p>The <code>AxisMarks</code> argument <code>position</code> indicates where the axis should appear. The x-axis can appear below or above the chart. The y-axis can appear on the left or right side of the chart.</p><p>The <code>AxisMarks</code> argument <code>values</code> provides an array of desired axis labels.</p><p>Inside the closure passed to <code>AxisMarks</code> it is common to call <code>AxisGridLine</code>, <code>AxisTick</code>, and <code>AxisValueLabel</code>. <code>AxisGridLine</code> causes a grid line to be drawn across the plot area. <code>AxisTick</code> causes a tick to be drawn before an axis label. <code>AxisValueLabel</code> specifies the axis label that should be displayed for the given value.</p><p><code>AxisGridLine</code>, <code>AxisTick</code>, and <code>AxisValueLabel</code> can be called conditionally based on the value passed to the <code>AxisMarks</code> trailing closure so they only appear for some marks.</p><p>The <code>AxisValueLabel</code> argument <code>format</code> specifies how axis labels should be formatted. The <code>AxisValueLabel</code> argument <code>centered</code> specifies whether axis labels should be centered relative to their mark. <code>AxisValueLabel</code> can have a trailing closure that returns the view that should be used to render the label.</p><p>For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>    <span class="token comment">// chart content goes here</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span>chartXAxis <span class="token punctuation">{</span><br>    <span class="token class-name">AxisMarks</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> <span class="token punctuation">.</span>leading<span class="token punctuation">)</span> <span class="token punctuation">{</span> value <span class="token keyword">in</span><br>        <span class="token class-name">AxisGridLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token class-name">AxisTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token class-name">AxisValueLabel</span><span class="token punctuation">(</span><br>            format<span class="token punctuation">:</span> <span class="token punctuation">.</span>dateTime<span class="token punctuation">.</span><span class="token function">month</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">day</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>            centered<span class="token punctuation">:</span> <span class="token boolean">true</span><br>        <span class="token punctuation">)</span><br>        <span class="token comment">// Alternative that formats labels to be</span><br>        <span class="token comment">// a number of millions followed by the letter M.</span><br>        <span class="token comment">// AxisValueLabel {</span><br>        <span class="token comment">//     Text(value == 0 ? "" : "\(value / delta)M")</span><br>        <span class="token comment">// }</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="legends" tabindex="-1">Legends</h2><p>By default, a legend is displayed below each chart.</p><p>To hide the legend, apply the <a href="https://developer.apple.com/documentation/charts/chart/chartlegend(_:)?v=1.0.21" rel="noopener" target="_blank">chartLegend</a> view modifier to the <code>Chart</code>, passing a value of <code>.hidden</code>. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>    <span class="token comment">// chart content goes here</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span><span class="token function">chartLegend</span><span class="token punctuation">(</span><span class="token punctuation">.</span>hidden<span class="token punctuation">)</span></code></pre><p>To change the legend position, apply the <code>chartLegend</code> view modifier to the <code>Chart</code>, passing the <code>position</code> argument with a value like <code>.top</code>, <code>.trailing</code>, or <code>.leading</code>. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">chartLegend</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> <span class="token punctuation">.</span>top<span class="token punctuation">)</span></code></pre><h2 id="scale" tabindex="-1">Scale</h2><p>Swift Charts automatically determines the minimum and maximum quantitative values to be plotted and selects appropriate x-axis and y-axis scales. The default axis scales can be overridden by applying the <a href="https://developer.apple.com/documentation/swiftui/view/chartxscale(domain:range:type:)?v=1.0.21" rel="noopener" target="_blank">chartXScale</a> and <a href="https://developer.apple.com/documentation/swiftui/view/chartyscale(domain:range:type:)?v=1.0.21" rel="noopener" target="_blank">chartYScale</a> view modifiers to the <code>Chart</code>. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>    <span class="token comment">// chart content goes here</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span><span class="token function">chartYScale</span><span class="token punctuation">(</span>domain<span class="token punctuation">:</span> <span class="token number">19</span> <span class="token operator">...</span> <span class="token number">157</span><span class="token punctuation">)</span></code></pre><h2 id="scrolling-1" tabindex="-1">Scrolling</h2><p>To create a chart that is larger that its allocation screen space and can be scrolled horizontally to view all the content:</p><ol><li><p>Embed the <code>Chart</code> in a <code>ScrollView(.horizontal)</code>.</p></li><li><p>Apply the <code>frame</code> view modifier to the <code>ScrollView</code> to set its display width. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">)</span></code></pre></li><li><p>Apply the <code>chartPlotStyle</code> view modifier to the <code>Chart</code> to set the chart width and height. For example:</p><pre class="language-swift"><code class="language-swift"><span class="token punctuation">.</span>chartPlotStyle <span class="token punctuation">{</span> plotArea <span class="token keyword">in</span><br>    plotArea<br>        <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span><span class="token punctuation">.</span>yellow<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span></code></pre></li></ol><p>The y-axis will only be visible when scrolled all the way to the right. The y-axis can be moved to the leading edge of the chart, but then it would only be visible when scrolled all the way to the left. Swift Charts really needs an option to make the y-axis sticky in horizontally scrolling charts and make the x-axis sticky in vertically scrolling charts.</p><p>To scroll vertically instead of horizontally, embed the <code>Chart</code> in a <code>ScrollView</code> without passing <code>.horizontal</code> and set the <code>ScrollView</code> height instead of the width.</p><h2 id="background-and-overlay" tabindex="-1">Background and Overlay</h2><p>The <a href="https://developer.apple.com/documentation/swiftui/view/chartbackground(alignment:content:)?changes=latest_minor?v=1.0.21" rel="noopener" target="_blank">chartBackground</a> view modifier can be applied to a <code>Chart</code> to specify any view that should be rendered behind the chart marks.</p><p>The <code>chartOverlay</code> view modifier can be applied to a <code>Chart</code> to specify any view that should be rendered on top of the chart marks.</p><p>For example:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>    <span class="token comment">// chart content goes here</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span>chartBackground <span class="token punctuation">{</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span><br>    <span class="token class-name">Image</span><span class="token punctuation">(</span>systemName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"flag.checkered"</span></span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">resizable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><h2 id="event-handling" tabindex="-1">Event Handling</h2><p>To listen for tap and drag gestures on a chart, apply the <a href="https://developer.apple.com/documentation/swiftui/view/chartoverlay(alignment:content:)?changes=latest_minor?v=1.0.21" rel="noopener" target="_blank">chartOverlay</a> view modifier to the <code>Chart</code>. Note that drag gestures will not be captured if the <code>Chart</code> is inside a <code>ScrollView</code>.</p><p>For example, the following somewhat complex code displays an annotation above a bar chart when dragging across the bars:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">BarChartDemo</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\</span><span class="token punctuation">.</span>colorScheme<span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token keyword">var</span> colorScheme<br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> selectedData<span class="token punctuation">:</span> <span class="token class-name">MyDataStruct</span><span class="token operator">?</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">var</span> annotation<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token keyword">if</span> <span class="token keyword">let</span> selectedData <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span>selectedData<span class="token punctuation">.</span>key<span class="token punctuation">)</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">selectedData<span class="token punctuation">.</span>quantity</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span>background <span class="token punctuation">{</span><br>            <span class="token class-name">RoundedRectangle</span><span class="token punctuation">(</span>cornerRadius<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> style<span class="token punctuation">:</span> <span class="token punctuation">.</span>continuous<span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>annotationFill<span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">.</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">var</span> annotationFill<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">ShapeStyle</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> fillColor<span class="token punctuation">:</span> <span class="token class-name">Color</span> <span class="token operator">=</span> colorScheme <span class="token operator">==</span> <span class="token punctuation">.</span>light <span class="token operator">?</span><br>            <span class="token punctuation">.</span>white <span class="token punctuation">:</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">.</span>secondarySystemBackground<span class="token punctuation">)</span><br>        <span class="token keyword">return</span> fillColor<span class="token punctuation">.</span><span class="token function">shadow</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span>radius<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>            <span class="token class-name">ForEach</span><span class="token punctuation">(</span>objects<span class="token punctuation">.</span>indices<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> index <span class="token keyword">in</span><br>                <span class="token keyword">let</span> object <span class="token operator">=</span> objects<span class="token punctuation">[</span>index<span class="token punctuation">]</span><br>                <span class="token keyword">let</span> key <span class="token operator">=</span> <span class="token class-name">PlottableValue</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Key Title"</span></span><span class="token punctuation">,</span> object<span class="token punctuation">.</span>key<span class="token punctuation">)</span><br><br>                <span class="token class-name">BarMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> key<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Quantity"</span></span><span class="token punctuation">,</span> object<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>                <span class="token keyword">if</span> object<span class="token punctuation">.</span>key <span class="token operator">==</span> selectedData<span class="token operator">?</span><span class="token punctuation">.</span>key <span class="token punctuation">{</span><br>                    <span class="token class-name">RuleMark</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> key<span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">annotation</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> <span class="token function">annotationPosition</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                            annotation<br>                        <span class="token punctuation">}</span><br>                        <span class="token comment">// Display a red, dashed, vertical line.</span><br>                        <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>red<span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span><span class="token function">lineStyle</span><span class="token punctuation">(</span><span class="token class-name">StrokeStyle</span><span class="token punctuation">(</span>dash<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>                  <span class="token punctuation">}</span><br>              <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token comment">// This fixes the chart jump issue during dragging.</span><br>        <span class="token comment">// See https://developer.apple.com/forums/thread/724770.</span><br>        <span class="token punctuation">.</span><span class="token function">chartYScale</span><span class="token punctuation">(</span>domain<span class="token punctuation">:</span> minYValue<span class="token operator">...</span>maxYValue<span class="token punctuation">)</span><br><br>        <span class="token punctuation">.</span>chartOverlay <span class="token punctuation">{</span> proxy <span class="token keyword">in</span> <span class="token function">chartOverlay</span><span class="token punctuation">(</span>proxy<span class="token punctuation">:</span> proxy<span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This chooses a position based on whether</span><br>    <span class="token comment">// the data point is near one of the chart edges.</span><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">annotationPosition</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> index<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">AnnotationPosition</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> percent <span class="token operator">=</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>statistics<span class="token punctuation">.</span>count<span class="token punctuation">)</span><br>        <span class="token keyword">return</span> percent <span class="token operator">&lt;</span> <span class="token number">0.1</span> <span class="token operator">?</span> <span class="token punctuation">.</span>topTrailing <span class="token punctuation">:</span><br>            percent <span class="token operator">></span> <span class="token number">0.95</span> <span class="token operator">?</span> <span class="token punctuation">.</span>topLeading <span class="token punctuation">:</span><br>            <span class="token punctuation">.</span>top<br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// ChartProxy is useful for supporting user interactions like tap and drag.</span><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">chartOverlay</span><span class="token punctuation">(</span>proxy<span class="token punctuation">:</span> <span class="token class-name">ChartProxy</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">GeometryReader</span> <span class="token punctuation">{</span> geometry <span class="token keyword">in</span> <span class="token comment">// of the overlay view</span><br>            <span class="token keyword">let</span> origin <span class="token operator">=</span> geometry<span class="token punctuation">[</span>proxy<span class="token punctuation">.</span>plotAreaFrame<span class="token punctuation">]</span><span class="token punctuation">.</span>origin<br>            <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">.</span>clear<span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">contentShape</span><span class="token punctuation">(</span><span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>                <span class="token comment">// Handle tap gestures.</span><br>                <span class="token punctuation">.</span>onTapGesture <span class="token punctuation">{</span> value <span class="token keyword">in</span><br>                    <span class="token keyword">let</span> x <span class="token operator">=</span> value<span class="token punctuation">.</span>x <span class="token operator">-</span> origin<span class="token punctuation">.</span>x<br><br>                    <span class="token comment">// The ChartProxy "position" method translates a</span><br>                    <span class="token comment">// data value to a coordinate value within the chart.</span><br>                    <span class="token comment">// The ChartProxy "value" method translates a</span><br>                    <span class="token comment">// coordinate value within the chart to a data value.</span><br>                    <span class="token keyword">if</span> <span class="token keyword">let</span> category<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token operator">=</span> proxy<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>atX<span class="token punctuation">:</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                        <span class="token keyword">let</span> data <span class="token operator">=</span> categoryToDataMap<span class="token punctuation">[</span>category<span class="token punctuation">]</span><br>                        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"got tap on"</span></span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br><br>                <span class="token comment">// Handle drag gestures.</span><br>                <span class="token punctuation">.</span><span class="token function">gesture</span><span class="token punctuation">(</span><br>                    <span class="token class-name">DragGesture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                        <span class="token punctuation">.</span>onChanged <span class="token punctuation">{</span> value <span class="token keyword">in</span><br>                            <span class="token keyword">let</span> x <span class="token operator">=</span> value<span class="token punctuation">.</span>location<span class="token punctuation">.</span>x <span class="token operator">-</span> origin<span class="token punctuation">.</span>x<br>                            <span class="token keyword">if</span> <span class="token keyword">let</span> category<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token operator">=</span> proxy<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>atX<span class="token punctuation">:</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                                selectedData <span class="token operator">=</span> categoryToDataMap<span class="token punctuation">[</span>category<span class="token punctuation">]</span><br>                            <span class="token punctuation">}</span><br>                        <span class="token punctuation">}</span><br>                        <span class="token punctuation">.</span>onEnded <span class="token punctuation">{</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span> selectedData <span class="token operator">=</span> <span class="token nil constant">nil</span> <span class="token punctuation">}</span><br>                <span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="animation" tabindex="-1">Animation</h2><p>Charts can be animated using <code>withAnimation</code> and changing the values to be plotted from zero to their actual value. This can be done at a different point in time for each data point so they each animate individually.</p><p>One way to implement this is described below.</p><ol><li><p>Add a state variable to hold an array of <code>Bool</code> values that indicate the data points that should shown now.</p><pre class="language-swift"><code class="language-swift"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> show<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Bool</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code></pre></li><li><p>In the loop inside the <code>Chart</code> where marks are created, determine if the current data point should be shown now, base its value on that, and use that value in the mark.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">let</span> shouldShow <span class="token operator">=</span> index <span class="token operator">&lt;</span> show<span class="token punctuation">.</span>count <span class="token operator">&amp;&amp;</span> show<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">true</span><br><span class="token keyword">let</span> value <span class="token operator">=</span> shouldShow <span class="token operator">?</span> data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>quantity <span class="token punctuation">:</span> <span class="token number">0</span></code></pre></li><li><p>When the chart appears, call the <code>animateChart</code> function.</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">Chart</span> <span class="token punctuation">{</span><br>    <span class="token comment">// chart content goes here</span><br><span class="token punctuation">}</span><br><span class="token punctuation">.</span>onAppear <span class="token punctuation">{</span> <span class="token function">animateChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></code></pre></li><li><p>Add the following function:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">animateChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    show <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><br>    <span class="token keyword">for</span> index <span class="token keyword">in</span> vm<span class="token punctuation">.</span>statistics<span class="token punctuation">.</span>indices <span class="token punctuation">{</span><br>        <span class="token comment">// Delay rendering each data point</span><br>        <span class="token comment">// a bit longer than the previous one.</span><br>        <span class="token class-name">DispatchQueue</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">asyncAfter</span><span class="token punctuation">(</span><br>            deadline<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.05</span><br>        <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">let</span> spring <span class="token operator">=</span> <span class="token number">0.5</span><br>            <span class="token function">withAnimation</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">interactiveSpring</span><span class="token punctuation">(</span><br>                response<span class="token punctuation">:</span> spring<span class="token punctuation">,</span><br>                dampingFraction<span class="token punctuation">:</span> spring<span class="token punctuation">,</span><br>                blendDuration<span class="token punctuation">:</span> spring<br>            <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                show<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></li></ol><h2 id="accessibility" tabindex="-1">Accessibility</h2><p>To make charts accessible, apply the <code>accessibilityLabel</code> and <code>accessibilityValue</code> view modifiers to each mark. For visually impaired users, the text passed to these will be spoken when VoiceOver is activated.</p></article>