<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>ARKit</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#configuration">Configuration</a></li><li><a href="#anchors">Anchors</a></li><li><a href="#entities">Entities</a></li><li><a href="#getting-started">Getting Started</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://developer.apple.com/documentation/arkit?v=1.0.20" rel="noopener" target="_blank">ARKit</a> is an Apple framework for rendering augmented reality experiences in iOS and iPadOS. ARKit utilizes device front and rear facing cameras and motion sensors.</p><p>One of the most important classes provided by ARKit is <a href="https://developer.apple.com/documentation/realitykit/arview?v=1.0.20" rel="noopener" target="_blank">ARView</a>. This displays a camera stream on a device.</p><p><a href="https://developer.apple.com/documentation/realitykit/?v=1.0.20" rel="noopener" target="_blank">RealityKit</a> is another Apple framework that is often used with ARKit. It renders 3D images and simulates changes to them. It can be used to add virtual objects to an ARKit view.</p><h2 id="configuration" tabindex="-1">Configuration</h2><p>To change the configuration of an <code>ARView</code> session, pass a configuration object to the <code>run</code> method of the <a href="https://developer.apple.com/documentation/arkit/arsession?v=1.0.20" rel="noopener" target="_blank">ARSession</a><br>object stored in the <code>session</code> property of the <code>ARView</code> object. Supported configuration types include:</p><ul><li><p><a href="https://developer.apple.com/documentation/arkit/arbodytrackingconfiguration?v=1.0.20" rel="noopener" target="_blank">ARBodyTrackingConfiguration</a> &quot;tracks human body poses, planar surfaces, and images using the rear-facing camera&quot;.</p></li><li><p><a href="https://developer.apple.com/documentation/arkit/arfacetrackingconfiguration?v=1.0.20" rel="noopener" target="_blank">ARFaceTrackingConfiguration</a> &quot;tracks facial movement and expressions using the front camera&quot;.</p></li><li><p><a href="https://developer.apple.com/documentation/arkit/argeotrackingconfiguration?v=1.0.20" rel="noopener" target="_blank">ARGeoTrackingConfiguration</a> &quot;tracks locations with GPS, map data, and a device's compass&quot;. For a list of supported cities, scroll to the &quot;Supported Areas and Cities&quot; section of the <code>ARGeoTrackingConfiguration</code> page.</p></li><li><p><a href="https://developer.apple.com/documentation/arkit/arimagetrackingconfiguration?v=1.0.20" rel="noopener" target="_blank">ARImageTrackingConfiguration</a> &quot;tracks known images using the rear-facing camera&quot;.</p></li><li><p><a href="https://developer.apple.com/documentation/arkit/arobjectscanningconfiguration?v=1.0.20" rel="noopener" target="_blank">ARObjectScanningConfiguration</a> &quot;recognizes objects and collects high-fidelity data about specific objects using the rear-facing camera&quot;.</p></li><li><p><a href="https://developer.apple.com/documentation/arkit/arorientationtrackingconfiguration?v=1.0.20" rel="noopener" target="_blank">AROrientationTrackingConfiguration</a> &quot;tracks only the device’s orientation using the rear-facing camera&quot;.</p></li><li><p><a href="https://developer.apple.com/documentation/arkit/arpositionaltrackingconfiguration?v=1.0.20" rel="noopener" target="_blank">ARPositionalTrackingConfiguration</a> &quot;tracks only the device’s position in 3D space&quot;.</p></li><li><p><a href="https://developer.apple.com/documentation/arkit/arworldtrackingconfiguration?v=1.0.20" rel="noopener" target="_blank">ARWorldTrackingConfiguration</a> &quot;tracks the position of a device in relation to objects in the environment&quot;.</p></li></ul><h2 id="anchors" tabindex="-1">Anchors</h2><p>An anchor ties entities to a location in a scene such as a coordinate relative to an iPhone location when the app launches. There are several kinds of anchors including a 3D coordinate (specified by a 3x3 matrix of the type <code>SIMD3&lt;Scalar&gt;</code>), a horizontal plane (ex. the floor or a desk top), a vertical plane (ex. a wall), a face, a body, and image in the scene.</p><p>After creating an anchor it must be added to a scene with <code>scene.addAnchor(myAnchor)</code>.</p><h2 id="entities" tabindex="-1">Entities</h2><p>An entity is a 3D object that can be placed in a scene. There are many ways to load entities into a project. One option is to use a USDZ file. The USDZ file format was created by Pixar. Many USDZ files can be downloaded from the <a href="https://developer.apple.com/augmented-reality/quick-look/?v=1.0.20" rel="noopener" target="_blank">Apple Developer website</a>.</p><p>To load an entity from a file and place it at an anchor:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">let</span> entity <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">Entity</span><span class="token punctuation">.</span> <span class="token function">load</span> <span class="token punctuation">(</span>named<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"usdz-file-name"</span></span><span class="token punctuation">)</span><br>anchor<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span></code></pre><p>The Apple <a href="https://developer.apple.com/augmented-reality/tools/?v=1.0.20" rel="noopener" target="_blank">Augmented Reality Tools</a> web page contains links for downloading the tools &quot;Reality Composer&quot; (iPhone and iPad only) and &quot;Reality Converter&quot;.</p><p>The <strong>Reality Composer</strong> iOS app (best used on an iPad) allows users to &quot;easily prototype and produce AR experiences directly with no prior 3D experience&quot;. This includes creating virtual objects, adding animations to them, adding audio that can be triggered in many ways. The app can &quot;record sensor and camera data in the actual location you are building it for, and then replay it on your iOS device&quot;.</p><p>The <strong>Reality Converter</strong> macOS app &quot;converts common 3D file formats such as <code>.obj</code>, <code>.gltf</code>, <code>.fbx</code>, and <code>USD</code> to <code>USDZ</code>. It also lets you view the converted model, customize its material properties with your own textures, and edit the file's metadata.&quot;</p><p>Files produced by these apps can be loaded into an ARKIt app in the same way as USDZ files.</p><p>Entities can be created using the <a href="https://developer.apple.com/documentation/realitykit/meshresource?v=1.0.20" rel="noopener" target="_blank">MeshResource</a> class provided by ARKit. This has the methods <code>generateBox</code>, <code>generatePlane</code>, and <code>generateSphere</code>. For example, to create and display a blue box:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">let</span> block <span class="token operator">=</span> <span class="token class-name">MeshResource</span><span class="token punctuation">.</span><span class="token function">generateBox</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 1 meter on all sides</span><br><span class="token keyword">let</span> material <span class="token operator">=</span> <span class="token class-name">SimpleMaterial</span><span class="token punctuation">(</span>color<span class="token punctuation">:</span> <span class="token class-name">UIColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span>blue<span class="token punctuation">)</span><span class="token punctuation">,</span> isMetallic<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><br><span class="token keyword">let</span> entity <span class="token operator">=</span> <span class="token class-name">ModelEntity</span><span class="token punctuation">(</span>mesh<span class="token punctuation">:</span> block<span class="token punctuation">,</span> materials<span class="token punctuation">:</span> <span class="token punctuation">[</span>material<span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token keyword">let</span> anchor <span class="token operator">=</span> <span class="token class-name">AnchorEntity</span><span class="token punctuation">(</span>plane<span class="token punctuation">:</span> <span class="token punctuation">.</span>horizontal<span class="token punctuation">)</span><br>anchor<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><br>scene<span class="token punctuation">.</span><span class="token function">addAnchor</span><span class="token punctuation">(</span>anchor<span class="token punctuation">)</span></code></pre><h2 id="getting-started" tabindex="-1">Getting Started</h2><p>An Xcode project that uses ARKit can be created in two ways. It can be an SwiftUI &quot;App&quot; or an &quot;Augmented Reality App&quot; which does not use SwiftUI. We will only consider the first option here.</p><p>Currently ARKit views are compatible with UIKit, but not SwiftUI. We need to wrap the <code>ARView</code> in a <code>UIViewRepresentable</code> in order to access it from SwiftUI.</p><ol><li>In Xcode, create a SwiftUI project.</li><li>Select the top entry in the Project Navigator.</li><li>Select the main target.</li><li>Select the &quot;Info&quot; tab.</li><li>Hover over any row and click the &quot;+&quot; button.</li><li>For the value, describe for users why camera access is needed. For example, &quot;Need for augmented reality view&quot;.</li><li>TODO: Finish this!</li></ol></article>