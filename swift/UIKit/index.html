<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>UIKit</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#uikit-integration">UIKit Integration</a></li><li><a href="#type-hierarchy">Type Hierarchy</a></li><li><a href="#uiview">UIView</a></li><li><a href="#relationship-to-swiftui">Relationship to SwiftUI</a></li><li><a href="#uiviewrepresentable">UIViewRepresentable</a><ol><li><a href="#display-only">Display-only</a></li><li><a href="#using-a-binding">Using a Binding</a></li><li><a href="#using-a-view-model">Using a View Model</a></li></ol></li></ol></nav></aside><article><style>img {
        border: 1px solid gray;
    }</style><h2 id="overview" tabindex="-1">Overview</h2><h2 id="uikit-integration" tabindex="-1">UIKit Integration</h2><p>The <a href="https://developer.apple.com/documentation/uikit?v=1.0.22" rel="noopener" target="_blank">UIKit</a> framework predates SwiftUI which is now the preferred framework for building iOS, watchOS, macOS, and tvOS apps.</p><p>UIKIt still has features not present in SwiftUI. When those features are needed, UIKit views can be used inside a SwiftUI app. This is accomplished by wrapping a UIKit view in a struct that conforms to the <a href="https://developer.apple.com/documentation/swiftui/uiviewrepresentable?v=1.0.22" rel="noopener" target="_blank">UIViewRepresentable</a> protocol. This is explained in the <a href="#uiviewrepresentable">UIViewRepresentable</a> section below.</p><h2 id="type-hierarchy" tabindex="-1">Type Hierarchy</h2><p>The hierarchy of a subset of the types defined by UIKit is shown below:</p><ul><li>NSObject<ul><li>UIColor</li><li>UIResponder<ul><li>UIView<ul><li>UIControl<ul><li>UIButton</li><li>UIColorWell</li><li>UIDatePicker</li><li>UIPageControl</li><li>UISegmentedControl</li><li>UISlider</li><li>UIStepper</li><li>UISwitch</li><li>UITextField</li></ul></li><li>UILabel</li><li>UIWindow</li></ul></li><li>UIViewController</li></ul></li></ul></li></ul><h2 id="uiview" tabindex="-1">UIView</h2><p>All views in the UIKit framework are classes that inherit from the <a href="https://developer.apple.com/documentation/uikit/uiview?v=1.0.22" rel="noopener" target="_blank">UIView</a> class, either directly or indirectly. For example, the <a href="https://developer.apple.com/documentation/uikit/uibutton?v=1.0.22" rel="noopener" target="_blank">UIButton</a> class inherits from <a href="https://developer.apple.com/documentation/uikit/uicontrol?v=1.0.22" rel="noopener" target="_blank">UIControl</a> class which inherits <code>UIView</code>.</p><p>UIKit views typically have properties that are set after an instance is created. The following code creates a <a href="https://developer.apple.com/documentation/uikit/uilabel?v=1.0.22" rel="noopener" target="_blank">UILabel</a> and sets some of its properties.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">let</span> label <span class="token operator">=</span> <span class="token class-name">UILabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>label<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token class-name">UIFont</span><span class="token punctuation">.</span><span class="token function">systemFont</span><span class="token punctuation">(</span>ofSize<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">)</span><br>label<span class="token punctuation">.</span>textColor <span class="token operator">=</span> <span class="token punctuation">.</span>red<br>label<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"Hello, World!"</span></span></code></pre><p>UIKit views that need to report on changes to their state or user interactions sometimes do so using a &quot;delegate&quot;. This is an object that conforms to a specific protocol and is assigned to a <code>UIView</code> instance. For example, <a href="https://developer.apple.com/documentation/uikit/uitextview?v=1.0.22" rel="noopener" target="_blank">UITextView</a> has a <code>delegate</code> property whose type is the <a href="https://developer.apple.com/documentation/uikit/uitextviewdelegate?v=1.0.22" rel="noopener" target="_blank">UITextViewDelegate</a> protocol. That protocol defines several methods that are invoked when the user interacts with the <code>UITextView</code> such as <code>textViewDidChange</code>.</p><h2 id="relationship-to-swiftui" tabindex="-1">Relationship to SwiftUI</h2><p>The table below identifies the SwiftUI views that correspond to UIKit concepts:</p><table><thead><tr><th>UIKit</th><th>SwiftUI</th></tr></thead><tbody><tr><td><code>NSAttributedString</code></td><td><code>Text</code> with <code>AttributedString</code></td></tr><tr><td><code>UIActivityIndicatorView</code></td><td><code>ProgressView without a value</code></td></tr><tr><td><code>UIAlertController</code> with style <code>.actionsheet</code></td><td><code>ActionSheet</code></td></tr><tr><td><code>UIAlertController</code> with style <code>.alert</code></td><td><code>Alert</code></td></tr><tr><td><code>UIButton</code></td><td><code>Button</code></td></tr><tr><td><code>UICollectionView</code></td><td><code>LazyVGrid and LazyHGrid</code></td></tr><tr><td><code>UIDatePicker</code></td><td><code>DatePicker</code></td></tr><tr><td><code>UIImageView</code></td><td><code>Image</code></td></tr><tr><td><code>UILabel</code></td><td><code>Text</code></td></tr><tr><td><code>UINavigationController</code></td><td><code>NavigationView</code></td></tr><tr><td><code>UIProgressView</code></td><td><code>ProgressView with a value</code></td></tr><tr><td><code>UISegmentedControl</code></td><td><code>Picker</code></td></tr><tr><td><code>UISlider</code></td><td><code>Slider</code></td></tr><tr><td><code>UIStackView</code> with horizontal axis</td><td><code>HStack</code></td></tr><tr><td><code>UIStackView</code> with vertical axis</td><td><code>VStack</code></td></tr><tr><td><code>UIStepper</code></td><td><code>Stepper</code></td></tr><tr><td><code>UISwitch</code></td><td><code>Toggle</code></td></tr><tr><td><code>UITableView</code></td><td><code>List</code></td></tr><tr><td><code>UITextField</code></td><td><code>TextField</code></td></tr><tr><td><code>UITextField</code> with <code>isSecureTextEntry</code> true</td><td><code>SecureField</code></td></tr><tr><td><code>UITextView</code></td><td><code>TextEditor</code> for plain strings</td></tr></tbody></table><h2 id="uiviewrepresentable" tabindex="-1">UIViewRepresentable</h2><p>UIKit views can be used in a SwiftUI app by wrapping them in a struct that conforms to the <a href="https://developer.apple.com/documentation/swiftui/uiviewrepresentable?v=1.0.22" rel="noopener" target="_blank">UIViewRepresentable</a> protocol. However, there is enough functionality in SwiftUI that this is typically not necessary.</p><p>For cases when it is needed,j</p><h3 id="display-only" tabindex="-1">Display-only</h3><p>When a SwiftUI app needs to use a UIKit view for display purposes and no state changes or user interactions need to be captured, the following approach can be used.</p><p>There is no need to wrap a <code>UILabel</code> in a <code>UIViewRepresentable</code> because SwiftUI provides the <code>Text</code> view which can be used instead. However, doing so provides a simple example of using <code>UIViewRepresentable</code>.</p><p><img alt="UIViewRepresentable with display-only" style="width: 40%" src="/blog/assets/SwiftUI-UIViewRepresentable-DisplayOnly.png?v=1.0.22" title="UIViewRepresentable with display-only"></p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><span class="token keyword">import</span> <span class="token class-name">UIKit</span><br><br><span class="token keyword">struct</span> <span class="token class-name">MyLabel</span><span class="token punctuation">:</span> <span class="token class-name">UIViewRepresentable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> text<span class="token punctuation">:</span> <span class="token class-name">String</span><br><br>    <span class="token comment">// Creates a kind of UIView and configures its initial state.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeUIView</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">UILabel</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> label <span class="token operator">=</span> <span class="token class-name">UILabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        label<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token class-name">UIFont</span><span class="token punctuation">.</span><span class="token function">systemFont</span><span class="token punctuation">(</span>ofSize<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">)</span><br>        label<span class="token punctuation">.</span>textColor <span class="token operator">=</span> <span class="token punctuation">.</span>red<br>        <span class="token comment">// There is no need to set the `text` property here</span><br>        <span class="token comment">// because `updateUIView` will do it.</span><br><br>        <span class="token comment">// This sets the priority with which a view resists</span><br>        <span class="token comment">// being made larger than its intrinsic size.</span><br>        <span class="token comment">// The UILabel will be the minimum size required to fit the text.</span><br>        label<span class="token punctuation">.</span><span class="token function">setContentHuggingPriority</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token keyword">required</span><span class="token punctuation">,</span> <span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>horizontal<span class="token punctuation">)</span><br>        label<span class="token punctuation">.</span><span class="token function">setContentHuggingPriority</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token keyword">required</span><span class="token punctuation">,</span> <span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>vertical<span class="token punctuation">)</span><br><br>        <span class="token keyword">return</span> label<br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Updates the state of the UIView created in `makeUIView`</span><br>    <span class="token comment">// with new data provided by a SwiftUI View.</span><br>    <span class="token comment">// This called after makeUIView and again every time</span><br>    <span class="token comment">// a parameter changes (ex. text).</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">updateUIView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> uiView<span class="token punctuation">:</span> <span class="token class-name">UILabel</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        uiView<span class="token punctuation">.</span>text <span class="token operator">=</span> text<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The struct above can be used in SwiftUI as follows:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> labelText <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"First"</span></span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Toggle Label Text"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                labelText <span class="token operator">=</span> labelText <span class="token operator">==</span> <span class="token string-literal"><span class="token string">"First"</span></span> <span class="token operator">?</span> <span class="token string-literal"><span class="token string">"Second"</span></span> <span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"First"</span></span><br>            <span class="token punctuation">}</span><br>            <span class="token class-name">MyLabel</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> labelText<span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3 id="using-a-binding" tabindex="-1">Using a Binding</h3><p>There are many approaches for getting data back from a <code>UIViewRepresentable</code> subtype. One approach is to pass a binding to the <code>UIViewRepresentable</code> subtype that it can update. Changing the binding will cause the view that owns the binding to update. The following code demonstrates this approach.</p><p><img alt="UIViewRepresentable with Binding" style="width: 40%" src="/blog/assets/SwiftUI-UIViewRepresentable-Binding.png?v=1.0.22" title="UIViewRepresentable with Binding"></p><pre class="language-swift"><code class="language-swift"><span class="token comment">// ContentView.swift</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> isOn <span class="token operator">=</span> <span class="token boolean">false</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">MySwitch</span><span class="token punctuation">(</span>isOn<span class="token punctuation">:</span> $isOn<span class="token punctuation">)</span><br>            <span class="token class-name">Text</span><span class="token punctuation">(</span>isOn <span class="token operator">?</span> <span class="token string-literal"><span class="token string">"ON"</span></span> <span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"OFF"</span></span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><pre class="language-swift"><code class="language-swift"><span class="token comment">// MySwitch.swift</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><span class="token keyword">import</span> <span class="token class-name">UIKit</span><br><br><span class="token comment">// Because SwiftUI provides the `Toggle` view, we don't need to</span><br><span class="token comment">// to wrap a UIKit UISwitch view in a UIViewRepresentable.</span><br><span class="token comment">// This just demonstrates how a binding can be used to</span><br><span class="token comment">// share data from a `UIViewRepresentable` subtype</span><br><span class="token comment">// with a SwiftUI view that uses it.</span><br><span class="token keyword">struct</span> <span class="token class-name">MySwitch</span><span class="token punctuation">:</span> <span class="token class-name">UIViewRepresentable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">typealias</span> <span class="token class-name">UIViewType</span> <span class="token operator">=</span> <span class="token class-name">UISwitch</span><br><br>    <span class="token attribute atrule">@Binding</span> <span class="token keyword">var</span> isOn<span class="token punctuation">:</span> <span class="token class-name">Bool</span><br><br>    <span class="token keyword">init</span><span class="token punctuation">(</span>isOn<span class="token punctuation">:</span> <span class="token class-name">Binding</span><span class="token operator">&lt;</span><span class="token class-name">Bool</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token comment">// The underscore here indicates that we are setting</span><br>        <span class="token comment">// the wrapped value of the binding property above.</span><br>        _isOn <span class="token operator">=</span> isOn<br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This method is required to conform to UIViewRepresentable,</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeUIView</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">UIViewType</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> view <span class="token operator">=</span> <span class="token class-name">UISwitch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>        <span class="token comment">// In order to listen for changes in the value of the UISwitch,</span><br>        <span class="token comment">// we need to register a listener that is an object</span><br>        <span class="token comment">// with a method that is accessible to Objective-C.</span><br>        <span class="token comment">// We can use a Coordinator object for that.</span><br>        view<span class="token punctuation">.</span><span class="token function">addTarget</span><span class="token punctuation">(</span><br>            context<span class="token punctuation">.</span>coordinator<span class="token punctuation">,</span><br>            action<span class="token punctuation">:</span> <span class="token other-directive property">#selector</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>coordinator<span class="token punctuation">.</span><span class="token function">onValueChanged</span><span class="token punctuation">(</span><span class="token omit keyword">_</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>            <span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>valueChanged<br>        <span class="token punctuation">)</span><br><br>        <span class="token keyword">return</span> view<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeCoordinator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Coordinator</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Passing `self` to the `Coordinator`</span><br>        <span class="token comment">// allows it to access the `isOn` binding.</span><br>        <span class="token class-name">Coordinator</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This method is required to conform to UIViewRepresentable,</span><br>    <span class="token comment">// but it doesn't need to do anything.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">updateUIView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> uiView<span class="token punctuation">:</span> <span class="token class-name">UISwitch</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token comment">// do nothing</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">class</span> <span class="token class-name">Coordinator</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span> <span class="token punctuation">{</span><br>        <span class="token keyword">private</span> <span class="token keyword">var</span> parent<span class="token punctuation">:</span> <span class="token class-name">MySwitch</span><br><br>        <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> parent<span class="token punctuation">:</span> <span class="token class-name">MySwitch</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">self</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<br>        <span class="token punctuation">}</span><br><br>        <span class="token attribute atrule">@objc</span><br>        <span class="token keyword">func</span> <span class="token function-definition function">onValueChanged</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> view<span class="token punctuation">:</span> <span class="token class-name">UISwitch</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            parent<span class="token punctuation">.</span>isOn <span class="token operator">=</span> view<span class="token punctuation">.</span>isOn<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The following code provides a similar example where <code>UITextField</code> is wrapped in a <code>UIViewRepresentable</code>. One feature this has that is missing from the SwiftUI <code>TextField</code> view is the ability to include a clear button on the trailing end that is an &quot;X&quot; in a circle. Tapping this clears the value. An easier way to add a clear button to <code>TextField</code> instances is described in the <a href="/blog/swift/SwiftUI/#textfield">SwiftUI TextField</a> section.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token class-name">MyUITextField</span><span class="token punctuation">:</span> <span class="token class-name">UIViewRepresentable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> placeholder <span class="token operator">=</span> <span class="token string-literal"><span class="token string">""</span></span><br>    <span class="token attribute atrule">@Binding</span> <span class="token keyword">var</span> text<span class="token punctuation">:</span> <span class="token class-name">String</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeCoordinator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Coordinator</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Coordinator</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> $text<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeUIView</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">UITextField</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> textField <span class="token operator">=</span> <span class="token class-name">UITextField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>        textField<span class="token punctuation">.</span>borderStyle <span class="token operator">=</span> <span class="token punctuation">.</span>roundedRect<br>        textField<span class="token punctuation">.</span>clearButtonMode <span class="token operator">=</span> <span class="token punctuation">.</span>whileEditing<br>        textField<span class="token punctuation">.</span>delegate <span class="token operator">=</span> context<span class="token punctuation">.</span>coordinator<br>        textField<span class="token punctuation">.</span>placeholder <span class="token operator">=</span> placeholder<br><br>        <span class="token keyword">return</span> textField<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">updateUIView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> uiView<span class="token punctuation">:</span> <span class="token class-name">UITextField</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        uiView<span class="token punctuation">.</span>text <span class="token operator">=</span> text<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">class</span> <span class="token class-name">Coordinator</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> <span class="token class-name">UITextFieldDelegate</span> <span class="token punctuation">{</span><br>        <span class="token attribute atrule">@Binding</span> <span class="token keyword">var</span> text<span class="token punctuation">:</span> <span class="token class-name">String</span><br><br>        <span class="token keyword">init</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token class-name">Binding</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">self</span><span class="token punctuation">.</span>_text <span class="token operator">=</span> text<br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">func</span> <span class="token function-definition function">textFieldDidChangeSelection</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> textField<span class="token punctuation">:</span> <span class="token class-name">UITextField</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            text <span class="token operator">=</span> textField<span class="token punctuation">.</span>text <span class="token operator">??</span> <span class="token string-literal"><span class="token string">""</span></span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>To use this inside a SwiftUI view, add code like the following:</p><pre class="language-swift"><code class="language-swift"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> firstName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"Mark"</span></span><br><span class="token operator">...</span><br><span class="token class-name">MyUITextField</span><span class="token punctuation">(</span>placeholder<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"First Name"</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $firstName<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>height<span class="token punctuation">:</span> <span class="token number">31</span><span class="token punctuation">)</span></code></pre><h3 id="using-a-view-model" tabindex="-1">Using a View Model</h3><p>Another approach for getting data back from a <code>UIViewRepresentable</code> subtype is to store the changeable data in a view model. The following code demonstrates this approach.</p><p>This code renders a map using the UIKit <code>MKMapView</code> class. Initially the map is centered on Apple Park in Cupertino, California. Tapping the &quot;Current Location&quot; button uses Core Location to get the current device location and centers the map there. The user can drag the map to a new location. The latitude and longitude of the map center is displayed above the map and updates during dragging. The user can center the map on the device location by tapping the &quot;Reset&quot; button.</p><p><img alt="UIViewRepresentable with ViewModel" style="width: 40%" src="/blog/assets/SwiftUI-UIViewRepresentable-ViewModel.png?v=1.0.22" title="UIViewRepresentable with ViewModel"></p><pre class="language-swift"><code class="language-swift"><span class="token comment">// ContentView.swift</span><br><span class="token keyword">import</span> <span class="token class-name">CoreLocation</span><br><span class="token keyword">import</span> <span class="token class-name">CoreLocationUI</span><br><span class="token keyword">import</span> <span class="token class-name">MapKit</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@StateObject</span> <span class="token keyword">private</span> <span class="token keyword">var</span> locationManager <span class="token operator">=</span> <span class="token class-name">LocationManager</span><span class="token punctuation">.</span>shared<br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">VStack</span> <span class="token punctuation">{</span><br>            <span class="token keyword">if</span> locationManager<span class="token punctuation">.</span>userLocation <span class="token operator">==</span> <span class="token nil constant">nil</span> <span class="token punctuation">{</span><br>                <span class="token comment">// Tap this to get the device location and pan the map to it.</span><br>                <span class="token class-name">LocationButton</span> <span class="token punctuation">{</span><br>                    locationManager<span class="token punctuation">.</span><span class="token function">requestLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                <span class="token punctuation">}</span><br>                <span class="token punctuation">.</span><span class="token function">foregroundColor</span><span class="token punctuation">(</span><span class="token punctuation">.</span>white<span class="token punctuation">)</span> <span class="token comment">// defaults to black</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>                <span class="token comment">// Tap this to reset the map to the device location.</span><br>                <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Reset"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                    locationManager<span class="token punctuation">.</span><span class="token function">panToDeviceLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                <span class="token punctuation">}</span><br>                <span class="token punctuation">.</span><span class="token function">buttonStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>bordered<span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br><br>            <span class="token comment">// This updates if the user drags the map.</span><br>            <span class="token keyword">if</span> <span class="token keyword">let</span> c <span class="token operator">=</span> locationManager<span class="token punctuation">.</span>mapCenter <span class="token punctuation">{</span><br>                <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Lat: </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">c<span class="token punctuation">.</span>latitude</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">, Lng: </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">c<span class="token punctuation">.</span>longitude</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br><br>            <span class="token class-name">MapView</span><span class="token punctuation">(</span>initialCenter<span class="token punctuation">:</span> locationManager<span class="token punctuation">.</span>initialCenter<span class="token punctuation">)</span><br><br>            <span class="token class-name">Spacer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">struct</span> <span class="token class-name">ContentView_Previews</span><span class="token punctuation">:</span> <span class="token class-name">PreviewProvider</span> <span class="token punctuation">{</span><br>    <span class="token keyword">static</span> <span class="token keyword">var</span> previews<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">ContentView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><pre class="language-swift"><code class="language-swift"><span class="token comment">// LocationManager.swift</span><br><span class="token keyword">import</span> <span class="token class-name">CoreLocation</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">private</span> <span class="token keyword">let</span> appleParkLatitude <span class="token operator">=</span> <span class="token number">37.334_900</span><br><span class="token keyword">private</span> <span class="token keyword">let</span> appleParkLongitude <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">122.009_020</span><br><br><span class="token keyword">class</span> <span class="token class-name">LocationManager</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> <span class="token class-name">ObservableObject</span><span class="token punctuation">,</span> <span class="token class-name">CLLocationManagerDelegate</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@Published</span> <span class="token keyword">var</span> error<span class="token punctuation">:</span> <span class="token class-name">Error</span><span class="token operator">?</span><br><br>    <span class="token comment">// This is the requested map center.</span><br>    <span class="token attribute atrule">@Published</span> <span class="token keyword">var</span> initialCenter <span class="token operator">=</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">(</span><br>        latitude<span class="token punctuation">:</span> appleParkLatitude<span class="token punctuation">,</span><br>        longitude<span class="token punctuation">:</span> appleParkLongitude<br>    <span class="token punctuation">)</span><br><br>    <span class="token comment">// This is the current map center which differs</span><br>    <span class="token comment">// from initialCenter if the user drags the map.</span><br>    <span class="token attribute atrule">@Published</span> <span class="token keyword">var</span> mapCenter<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token operator">?</span><br><br>    <span class="token comment">// This is the device location.</span><br>    <span class="token comment">// It is not updated if the device moves.</span><br>    <span class="token attribute atrule">@Published</span> <span class="token keyword">var</span> userLocation<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token operator">?</span><br><br>    <span class="token keyword">let</span> manager <span class="token operator">=</span> <span class="token class-name">CLLocationManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>    <span class="token keyword">static</span> <span class="token keyword">var</span> shared <span class="token operator">=</span> <span class="token class-name">LocationManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>    <span class="token keyword">override</span> <span class="token keyword">private</span> <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token keyword">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        manager<span class="token punctuation">.</span>delegate <span class="token operator">=</span> <span class="token keyword">self</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This is called when the device location is determined.</span><br>    <span class="token comment">// An attempt to determine the location is triggered by</span><br>    <span class="token comment">// the `requestLocation` method below.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">locationManager</span><span class="token punctuation">(</span><br>        <span class="token omit keyword">_</span> manager<span class="token punctuation">:</span> <span class="token class-name">CLLocationManager</span><span class="token punctuation">,</span><br>        didUpdateLocations locations<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">CLLocation</span><span class="token punctuation">]</span><br>    <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        userLocation <span class="token operator">=</span> locations<span class="token punctuation">.</span>first<span class="token operator">?</span><span class="token punctuation">.</span>coordinate<br>        initialCenter <span class="token operator">=</span> userLocation<span class="token operator">!</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This is called if there is an error determining the device location.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">locationManager</span><span class="token punctuation">(</span><br>        <span class="token omit keyword">_</span> manager<span class="token punctuation">:</span> <span class="token class-name">CLLocationManager</span><span class="token punctuation">,</span><br>        didFailWithError error<span class="token punctuation">:</span> <span class="token class-name">Error</span><br>    <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"LocationManager error:"</span></span><span class="token punctuation">)</span><br>        <span class="token keyword">self</span><span class="token punctuation">.</span>error <span class="token operator">=</span> error<br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This sets the map center to the device location.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">panToDeviceLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">guard</span> <span class="token keyword">let</span> userLocation <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span><br><br>        <span class="token comment">// Hack alert!</span><br>        <span class="token comment">// If the initial map center is already at the user location ...</span><br>        <span class="token keyword">if</span> initialCenter <span class="token operator">==</span> userLocation <span class="token punctuation">{</span><br>            <span class="token comment">// Change it slightly to try `MapView` to re-render.</span><br>            initialCenter<span class="token punctuation">.</span>longitude <span class="token operator">+=</span> <span class="token number">0.0000001</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            <span class="token comment">// Go to the user location.</span><br>            initialCenter <span class="token operator">=</span> userLocation<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This is called by `ContentView`.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">requestLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        manager<span class="token punctuation">.</span><span class="token function">requestLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><pre class="language-swift"><code class="language-swift"><span class="token comment">// MapView.swift</span><br><span class="token keyword">import</span> <span class="token class-name">MapKit</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token comment">/**<br> For now we have to wrap an MKMapView in a UIViewRepresentable<br> in order to use some MapKit features in SwiftUI<br> such as displaying satellite images.<br><br> I was getting the error "The following Metal object is being<br> destroyed while still required to be alive by the command buffer".<br> This thread provided a solution:<br> https://developer.apple.com/forums/thread/699119<br> I had to edit the current Xcode scheme, click "Run" in the left nav,<br> and uncheck the "API Validation" checkbox<br> in the Diagnostics ... Metal section.<br> */</span><br><span class="token keyword">struct</span> <span class="token class-name">MapView</span><span class="token punctuation">:</span> <span class="token class-name">UIViewRepresentable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">typealias</span> <span class="token class-name">UIViewType</span> <span class="token operator">=</span> <span class="token class-name">MKMapView</span><br><br>    <span class="token keyword">let</span> initialCenter<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><br><br>    <span class="token comment">// This method is required to conform to UIViewRepresentable.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeUIView</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">UIViewType</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Other `mapType` options are `.standard` and `.satellite`.</span><br>        <span class="token class-name">MKMapView</span><span class="token punctuation">.</span><span class="token function">appearance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mapType <span class="token operator">=</span> <span class="token punctuation">.</span>hybrid<br><br>        <span class="token keyword">let</span> mapView <span class="token operator">=</span> <span class="token class-name">UIViewType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        mapView<span class="token punctuation">.</span>delegate <span class="token operator">=</span> context<span class="token punctuation">.</span>coordinator<br><br>        <span class="token keyword">let</span> meters <span class="token operator">=</span> <span class="token number">750.0</span><br>        mapView<span class="token punctuation">.</span>region <span class="token operator">=</span> <span class="token class-name">MKCoordinateRegion</span><span class="token punctuation">(</span><br>            center<span class="token punctuation">:</span> initialCenter<span class="token punctuation">,</span><br>            latitudinalMeters<span class="token punctuation">:</span> meters<span class="token punctuation">,</span><br>            longitudinalMeters<span class="token punctuation">:</span> meters<br>        <span class="token punctuation">)</span><br><br>        <span class="token comment">// Add a blue circle over the current user location.</span><br>        mapView<span class="token punctuation">.</span>showsUserLocation <span class="token operator">=</span> <span class="token boolean">true</span><br><br>        <span class="token keyword">return</span> mapView<br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// This is called initially and again every time</span><br>    <span class="token comment">// ContentView passes a new value for `initialCenter`.</span><br>    <span class="token attribute atrule">@MainActor</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">updateUIView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> mapView<span class="token punctuation">:</span> <span class="token class-name">UIViewType</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        mapView<span class="token punctuation">.</span>centerCoordinate <span class="token operator">=</span> initialCenter<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeCoordinator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Coordinator</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Use this if `Coordinator` needs access to its parent.</span><br>        <span class="token comment">// Coordinator(self)</span><br>        <span class="token class-name">Coordinator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">class</span> <span class="token class-name">Coordinator</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> <span class="token class-name">MKMapViewDelegate</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Use this if access to the parent is needed.</span><br>        <span class="token comment">/*<br>         private var parent: MapView<br><br>         init(_ parent: MapView) {<br>             self.parent = parent<br>         }<br>         */</span><br><br>        <span class="token comment">// This is called when the user drags the map.</span><br>        <span class="token keyword">func</span> <span class="token function-definition function">mapViewDidChangeVisibleRegion</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> mapView<span class="token punctuation">:</span> <span class="token class-name">UIViewType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Task</span> <span class="token punctuation">{</span> <span class="token attribute atrule">@MainActor</span> <span class="token keyword">in</span><br>                <span class="token class-name">LocationManager</span><span class="token punctuation">.</span>shared<span class="token punctuation">.</span>mapCenter <span class="token operator">=</span> mapView<span class="token punctuation">.</span>centerCoordinate<br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><pre class="language-swift"><code class="language-swift"><span class="token comment">// CLLocationCoordinate2DExtension.swift</span><br><span class="token keyword">import</span> <span class="token class-name">MapKit</span><br><br><span class="token keyword">extension</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">:</span> <span class="token class-name">Equatable</span> <span class="token punctuation">{</span><br>    <span class="token comment">// This is need in order to compare instances of this type.</span><br>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token operator">==</span> <span class="token punctuation">(</span><br>        lhs<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">,</span><br>        rhs<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><br>    <span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span><br>        lhs<span class="token punctuation">.</span>latitude <span class="token operator">==</span> rhs<span class="token punctuation">.</span>latitude <span class="token operator">&amp;&amp;</span> lhs<span class="token punctuation">.</span>longitude <span class="token operator">==</span> rhs<span class="token punctuation">.</span>longitude<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></article>