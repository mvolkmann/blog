<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Lottie</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#installing">Installing</a></li><li><a href="#animation-files">Animation Files</a></li><li><a href="#stewart-lynch-solution">Stewart Lynch Solution</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p>The <a href="https://airbnb.design/lottie/?v=1.0.20" rel="noopener" target="_blank">Lottie</a> is a mobile, cross-platform, open-source library for rendering vector motion graphics that are described by JSON files. It was created by Airbnb.</p><p>Currently there is support for using Lottie in UIKit, but not SwiftUI. However, we can wrap using the the UIKit version in a <code>UIViewRepresentable</code> so it can be used in SwiftUI.</p><p>The iOS version of Lottie uses the <a href="https://developer.apple.com/documentation/quartzcore?v=1.0.20" rel="noopener" target="_blank">Core Animation</a> framework.</p><h2 id="installing" tabindex="-1">Installing</h2><p>To install Lottie in an Xcode project:</p><ol><li>Select File ... Add Packages...</li><li>Paste &quot;<a href="https://github.com/airbnb/lottie-spm.git">https://github.com/airbnb/lottie-spm.git</a>&quot; into the Search input in the upper-right.</li><li>Click the &quot;Add Package&quot; button.</li><li>Click the &quot;Add Package&quot; button in the next dialog that appears.</li></ol><h2 id="animation-files" tabindex="-1">Animation Files</h2><p>Many Lottie animations are available at <a href="https://lottiefiles.com?v=1.0.20" rel="noopener" target="_blank">LottieFiles</a>. This requires creating a free account.</p><p>There are many free animations and also some that require a paid account. To see the free animations, select Discover ... Free Ready-to-use Animations. A search input in the upper-right enables filtering the list of animations.</p><p>To download an animation, click it. This opens a dialog that can offer customization options. Once all the options have been specified, click the copy button under &quot;Lottie Animation URL&quot;. Paste this into a new browser tab and select File ... Save As... in the web browser to save the animation in a JSON file. This is easier than clicking the &quot;Download&quot; button at the top of the dialog because that places the file in a &quot;workspace&quot; associated with your account rather than directly downloading the file.</p><p>Add each animation JSON file to the app <code>Bundle</code> with the following steps:</p><ul><li>Select the top entry in the Project Navigator.</li><li>Select the main target.</li><li>Select the &quot;Build Phases&quot; tab.</li><li>Expand the &quot;Copy Bundle Resources&quot; section.</li><li>Click the &quot;+&quot; button.</li><li>Select a file to be added.</li><li>Click the &quot;Add&quot; button.</li></ul><h2 id="stewart-lynch-solution" tabindex="-1">Stewart Lynch Solution</h2><p>There is a fair amount of complexity in setting this up. Stewart Lynch provides a fantastic solution in his YouTube video <a href="https://www.youtube.com/watch?v=kUjHl7zfCeg?v=1.0.20" rel="noopener" target="_blank">Lottie 4 in SwiftUI</a>. The follow code is a modified version of what Stewart provides:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">Lottie</span><br><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">struct</span> <span class="token class-name">LottieView</span><span class="token punctuation">:</span> <span class="token class-name">UIViewRepresentable</span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> animationView<span class="token punctuation">:</span> <span class="token class-name">LottieAnimationView</span><br>    <span class="token keyword">let</span> contentMode<span class="token punctuation">:</span> <span class="token class-name">UIView</span><span class="token punctuation">.</span><span class="token class-name">ContentMode</span><br>    <span class="token keyword">let</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token comment">// of the animation</span><br>    <span class="token keyword">let</span> loopMode<span class="token punctuation">:</span> <span class="token class-name">LottieLoopMode</span><br>    <span class="token attribute atrule">@Binding</span> <span class="token keyword">var</span> play<span class="token punctuation">:</span> <span class="token class-name">Bool</span><br>    <span class="token keyword">let</span> speed<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span><br><br>    <span class="token keyword">init</span><span class="token punctuation">(</span><br>        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span><br>        loopMode<span class="token punctuation">:</span> <span class="token class-name">LottieLoopMode</span> <span class="token operator">=</span> <span class="token punctuation">.</span>playOnce<span class="token punctuation">,</span><br>        speed<span class="token punctuation">:</span> <span class="token class-name">CGFloat</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><br>        contentMode<span class="token punctuation">:</span> <span class="token class-name">UIView</span><span class="token punctuation">.</span><span class="token class-name">ContentMode</span> <span class="token operator">=</span> <span class="token punctuation">.</span>scaleAspectFit<span class="token punctuation">,</span><br>        play<span class="token punctuation">:</span> <span class="token class-name">Binding</span><span class="token operator">&lt;</span><span class="token class-name">Bool</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token function">constant</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><br>    <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        animationView <span class="token operator">=</span> <span class="token class-name">LottieAnimationView</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> name<span class="token punctuation">)</span><br>        <span class="token keyword">self</span><span class="token punctuation">.</span>contentMode <span class="token operator">=</span> contentMode<br>        <span class="token keyword">self</span><span class="token punctuation">.</span>loopMode <span class="token operator">=</span> loopMode<br>        <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<br>        _play <span class="token operator">=</span> play<br>        <span class="token keyword">self</span><span class="token punctuation">.</span>speed <span class="token operator">=</span> speed<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">makeUIView</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">UIView</span> <span class="token punctuation">{</span><br>        animationView<span class="token punctuation">.</span>contentMode <span class="token operator">=</span> contentMode<br>        animationView<span class="token punctuation">.</span>translatesAutoresizingMaskIntoConstraints <span class="token operator">=</span> <span class="token boolean">false</span><br>        animationView<span class="token punctuation">.</span>heightAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>heightAnchor<span class="token punctuation">)</span><br>            <span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span><br>        animationView<span class="token punctuation">.</span>widthAnchor<span class="token punctuation">.</span><span class="token function">constraint</span><span class="token punctuation">(</span>equalTo<span class="token punctuation">:</span> view<span class="token punctuation">.</span>widthAnchor<span class="token punctuation">)</span><br>            <span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span><br>        animationView<span class="token punctuation">.</span>loopMode <span class="token operator">=</span> loopMode<br>        animationView<span class="token punctuation">.</span>animationSpeed <span class="token operator">=</span> speed<br><br>        <span class="token keyword">let</span> view <span class="token operator">=</span> <span class="token class-name">UIView</span><span class="token punctuation">(</span>frame<span class="token punctuation">:</span> <span class="token punctuation">.</span>zero<span class="token punctuation">)</span><br>        view<span class="token punctuation">.</span><span class="token function">addSubview</span><span class="token punctuation">(</span>animationView<span class="token punctuation">)</span><br>        <span class="token keyword">return</span> view<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">updateUIView</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> uiView<span class="token punctuation">:</span> <span class="token class-name">UIView</span><span class="token punctuation">,</span> context<span class="token punctuation">:</span> <span class="token class-name">Context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> play <span class="token punctuation">{</span><br>            animationView<span class="token punctuation">.</span>play <span class="token punctuation">{</span> <span class="token omit keyword">_</span> <span class="token keyword">in</span> play <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre></article>