<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>XCTest</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#unit-test-configuration">Unit Test Configuration</a></li><li><a href="#ui-test-configuration">UI Test Configuration</a></li><li><a href="#implementing-tests">Implementing Tests</a></li><li><a href="#example-unit-test">Example Unit Test</a></li><li><a href="#finding-and-testing-views">Finding and Testing Views</a></li><li><a href="#ui-test-utility-methods">UI Test Utility Methods</a></li><li><a href="#example-ui-test">Example UI Test</a></li><li><a href="#screen-navigation">Screen Navigation</a></li><li><a href="#running-tests-in-xcode">Running Tests in Xcode</a></li><li><a href="#viewing-test-results">Viewing Test Results</a></li><li><a href="#code-coverage">Code Coverage</a></li><li><a href="#ui-view-testing">UI View Testing</a></li><li><a href="#run-from-command-line">Run from Command Line</a></li><li><a href="#github-actions">GitHub Actions</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://developer.apple.com/documentation/xctest?v=1.0.20" rel="noopener" target="_blank">XCTest</a> is a unit testing and UI testing framework for Swift and SwiftUI. &quot;XC&quot; is an abbreviation for &quot;Xcode&quot;.</p><p>Unit tests are for testing non-UI logic such as data services and view models.</p><p>UI Tests are for testing user interface interactions like entering text in <code>TextField</code> views and tapping <code>Button</code> views.</p><h2 id="unit-test-configuration" tabindex="-1">Unit Test Configuration</h2><ol><li><p>Select the topmost entry in the Project Navigator.</p></li><li><p>Select the main target.</p></li><li><p>Click the &quot;+&quot; button at the bottom of the left nav to create a new target.</p></li><li><p>Enter &quot;test&quot; to filter the set of templates displayed.</p></li><li><p>Select &quot;Unit Testing Bundle&quot;.</p></li><li><p>Click the &quot;Next&quot; button.</p></li><li><p>Click the &quot;Finish&quot; button.</p><p>This creates a new folder that appears in the Project Navigator whose name is the project name followed by &quot;Tests&quot;. The new folder contains a <code>.swift</code> file with the same name containing starter test code.</p></li><li><p>Edit the provided <code>.swift</code> files in the new target.</p></li></ol><h2 id="ui-test-configuration" tabindex="-1">UI Test Configuration</h2><ol><li><p>Select the topmost entry in the Project Navigator.</p></li><li><p>Click the &quot;+&quot; button at the bottom of the left nav to create another target.</p></li><li><p>Enter &quot;test&quot; to filter the set of templates displayed.</p></li><li><p>Select &quot;UI Testing Bundle&quot;.</p></li><li><p>Click the &quot;Next&quot; button.</p></li><li><p>Click the &quot;Finish&quot; button.</p><p>This creates a new folder that appears in the Project Navigator whose name is the project name followed by &quot;UITests&quot;. The new folder contains a <code>.swift</code> file with the same name containing starter test code.</p></li><li><p>Edit the provided <code>.swift</code> files in the new target.</p></li></ol><h2 id="implementing-tests" tabindex="-1">Implementing Tests</h2><p>For each set of related test methods:</p><ol><li><p>Create a test file or use the provided example test file.</p><ul><li><p>Create a file in the appropriate directory with a name that ends in <code>Tests.swift</code>.</p><ol><li><p>Select File ... New ... File... or press cmd-n.</p></li><li><p>For non-UI tests, select &quot;Unit Test Case Class&quot; or for UI tests, select &quot;UI Test Case Class&quot;.</p></li><li><p>Enter a name that ends in &quot;Tests&quot;.</p></li><li><p>Click the &quot;Next&quot; button.</p></li><li><p>Select the appropriate test directory.</p></li><li><p>Click the &quot;Create&quot; button.</p><p>The generated class will inherit from <a href="https://developer.apple.com/documentation/xctest/xctestcase?v=1.0.20" rel="noopener" target="_blank">XCTestCase</a>.</p></li><li><p>Add the line <code>@testable import {project-name}</code> before the class definition.</p><p>Replace hyphens in the project name, if any, with underscores.</p></li></ol></li></ul></li><li><p>Define setup steps.</p><p>For setup that cannot throw, override the <code>setUp</code> method. For setup that can throw, override the <code>setUpWithError</code> method.</p></li><li><p>Define tear down steps.</p><p>For tear down that cannot throw, override the <code>tearDown</code> method. For tear down that can throw, override the <code>tearDownWithError</code> method.</p></li><li><p>Add test methods whose names begin with &quot;test&quot;.</p><p>A new instance of the <code>XCTestCase</code> subtype is created before running each of these methods, so it is not possible for them to share state. This is good because it prevents a test method from being effected by previous runs of other test methods.</p><p>A good pattern to follow in test methods is &quot;given, when, then&quot;. The &quot;given&quot; part establish the conditions to be tested. The &quot;when&quot; part takes some action to be tested. The &quot;then&quot; part makes assertions that should not be true.</p></li><li><p>Make assertions by calling the <code>XCTAssert{kind}</code> functions.</p><p>Assertion kind values include <code>Nil</code>, <code>NotNil</code>, <code>True</code>, <code>False</code>, <code>Equal</code>, <code>NotEqual</code>, <code>Identical</code>, <code>LessThan</code>, <code>LessThanOrEqual</code>, <code>GreaterThan</code>, <code>GreaterThanOrEqual</code>, <code>NoThrow</code>, and <code>ThrowsError</code>. Each of these has a version that takes and does not take an error message.</p><p>For documentation on the provided assertion functions, see <a href="https://developer.apple.com/documentation/xctest?v=1.0.20" rel="noopener" target="_blank">Test Assertions</a> (scroll down a bit).</p><p>Here is an example of an assertion that verifies that a function throws a specific error:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">XCTAssertThrowsError</span><span class="token punctuation">(</span><br>   <span class="token keyword">try</span> <span class="token function">getData</span><span class="token punctuation">(</span>date<span class="token punctuation">:</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>   <span class="token string-literal"><span class="token string">"failed to get data"</span></span><br><span class="token punctuation">)</span> <span class="token punctuation">{</span> error <span class="token keyword">in</span><br>   <span class="token keyword">let</span> myError <span class="token operator">=</span> error <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">MyErrorType</span><br>   <span class="token class-name">XCTAssertEqual</span><span class="token punctuation">(</span>myError<span class="token punctuation">,</span> <span class="token class-name">MyErrorType</span><span class="token punctuation">.</span>invalidDate<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>An alternative to using <code>XCTAssertThrowsError</code> is ot use <code>do</code> and <code>catch</code> along with <a href="https://developer.apple.com/documentation/xctest/xctfail?v=1.0.20" rel="noopener" target="_blank">XCTFail</a> as follows:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">do</span> <span class="token punctuation">{</span><br>    <span class="token keyword">try</span> <span class="token function">someAsyncFunction</span><span class="token punctuation">(</span>someArguments<span class="token punctuation">)</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span><br>    <span class="token class-name">XCTFail</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"some message"</span></span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre></li></ol><h2 id="example-unit-test" tabindex="-1">Example Unit Test</h2><p>The following code defines a <code>struct</code> with a simple <code>static</code> function:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">Foundation</span><br><br><span class="token keyword">struct</span> <span class="token class-name">Math</span> <span class="token punctuation">{</span><br>    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span>n1<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">,</span> n2<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Double</span> <span class="token punctuation">{</span><br>        n1 <span class="token operator">+</span> n2<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The following code defines unit tests for the <code>struct</code> defined above:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">XCTest</span><br><br><span class="token attribute atrule">@testable</span> <span class="token keyword">import</span> <span class="token class-name">XCTestDemo</span><br><span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">MathTests</span><span class="token punctuation">:</span> <span class="token class-name">XCTestCase</span> <span class="token punctuation">{</span><br>    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">setUpWithError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Put setup code here. This method is called before</span><br>        <span class="token comment">// the invocation of each test method in the class.</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">tearDownWithError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Put teardown code here. This method is called after</span><br>        <span class="token comment">// the invocation of each test method in the class.</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">testAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> actual <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>n1<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> n2<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">)</span><br>        <span class="token keyword">let</span> expected <span class="token operator">=</span> <span class="token number">3.0</span><br>        <span class="token class-name">XCTAssertEqual</span><span class="token punctuation">(</span>actual<span class="token punctuation">,</span> expected<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="finding-and-testing-views" tabindex="-1">Finding and Testing Views</h2><p>UI test cases create an instance of <a href="https://developer.apple.com/documentation/xctest/xcuiapplication?v=1.0.20" rel="noopener" target="_blank">XCUIApplication</a> and typically store it in a variable named <code>app</code>.</p><p>A call to <code>app.launch()</code> is required to launch the app.</p><p><code>XCUIApplication</code> inherits from <a href="https://developer.apple.com/documentation/xctest/xcuielement?v=1.0.20" rel="noopener" target="_blank">XCUIElement</a>. This enables finding all the <code>View</code> elements within the application.</p><p>The following table highlights properties in the <code>XCUIElement</code> class. Some of these are only available when running on a specific platform. For example, window elements are available in macOS, but not in iOS.</p><p>Some of these properties are defined by the following protocols to which <code>XCUIElement</code> conforms: <a href="https://developer.apple.com/documentation/xctest/xcuielementattributes?v=1.0.20" rel="noopener" target="_blank">XCUIElementAttributes</a> and <a href="https://developer.apple.com/documentation/xctest/xcuielementtypequeryprovider?v=1.0.20" rel="noopener" target="_blank">XCUIElementTypeQueryProvider</a>.</p><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td><code>alerts: XCUIElementQuery</code></td><td>query that matches alert elements</td></tr><tr><td><code>buttons: XCUIElementQuery</code></td><td>query that matches button elements</td></tr><tr><td><code>checkBoxes: XCUIElementQuery</code></td><td>query that matches checkbox elements</td></tr><tr><td><code>comboBoxes: XCUIElementQuery</code></td><td>query that matches combo box elements</td></tr><tr><td><code>datePickers: XCUIElementQuery</code></td><td>query that matches date picker elements</td></tr><tr><td><code>debugDescription: String</code></td><td>debugging information</td></tr><tr><td><code>dialogs: XCUIElementQuery</code></td><td>query that matches dialog elements</td></tr><tr><td><code>elementType: XCUIElement.ElementType</code></td><td>enum value from <a href="https://developer.apple.com/documentation/xctest/xcuielement/elementtype?v=1.0.20" rel="noopener" target="_blank">XCUIElement.ElementType</a></td></tr><tr><td><code>exists: Bool</code></td><td>indicates if the element exists on the screen</td></tr><tr><td><code>firstMatch: XCUIElement</code></td><td>first element that matches</td></tr><tr><td><code>hasFocus: Bool</code></td><td>indicates whether the element has focus</td></tr><tr><td><code>identifier: String</code></td><td>associated with the element using the <code>.accessibilityIdentifier(&quot;id&quot;)</code> view modifier</td></tr><tr><td><code>images: XCUIElementQuery</code></td><td>query that matches image elements</td></tr><tr><td><code>isEnabled: Bool</code></td><td>indicates whether the element is enabled</td></tr><tr><td><code>isHittable: Bool</code></td><td>indicates if a hit point can be determined (visible?)</td></tr><tr><td><code>isSelected: Bool</code></td><td>indicates whether the element is selected</td></tr><tr><td><code>label: String</code></td><td>label value of the element</td></tr><tr><td><code>links: XCUIElementQuery</code></td><td>query that matches link elements</td></tr><tr><td><code>maps: XCUIElementQuery</code></td><td>query that matches map elements</td></tr><tr><td><code>menuBarItems: XCUIElementQuery</code></td><td>query that matches menu bar item elements</td></tr><tr><td><code>menuBars: XCUIElementQuery</code></td><td>query that matches menu bar elements</td></tr><tr><td><code>menuItems: XCUIElementQuery</code></td><td>query that matches menu item elements</td></tr><tr><td><code>menus: XCUIElementQuery</code></td><td>query that matches menu elements</td></tr><tr><td><code>navigationBars: XCUIElementQuery</code></td><td>query that matches navigation bar elements</td></tr><tr><td><code>pickers: XCUIElementQuery</code></td><td>query that matches picker elements</td></tr><tr><td><code>placeholderValue: String?</code></td><td>placeholder value of the element (ex. in a <code>TextField</code>)</td></tr><tr><td><code>progressIndicators: XCUIElementQuery</code></td><td>query that matches progress indicator elements</td></tr><tr><td><code>radioButtons: XCUIElementQuery</code></td><td>query that matches radio button elements</td></tr><tr><td><code>radioGroups: XCUIElementQuery</code></td><td>query that matches radio group elements</td></tr><tr><td><code>scrollBars: XCUIElementQuery</code></td><td>query that matches scroll bar elements</td></tr><tr><td><code>scrollViews: XCUIElementQuery</code></td><td>query that matches scroll view elements</td></tr><tr><td><code>secureTextFields: XCUIElementQuery</code></td><td>query that matches secure text field elements</td></tr><tr><td><code>sheets: XCUIElementQuery</code></td><td>query that matches sheet elements</td></tr><tr><td><code>sliders: XCUIElementQuery</code></td><td>query that matches slider elements</td></tr><tr><td><code>staticTexts: XCUIElementQuery</code></td><td>query that matches label elements</td></tr><tr><td><code>switches: XCUIElementQuery</code></td><td>query that matches switch elements</td></tr><tr><td><code>textFields: XCUIElementQuery</code></td><td>query that matches text field elements</td></tr><tr><td><code>textViews: XCUIElementQuery</code></td><td>query that matches text elements</td></tr><tr><td><code>title: String</code></td><td>title value of the element</td></tr><tr><td><code>toggles: XCUIElementQuery</code></td><td>query that matches toggle elements</td></tr><tr><td><code>toolbarButtons: XCUIElementQuery</code></td><td>query that matches toolbar button elements</td></tr><tr><td><code>toolbars: XCUIElementQuery</code></td><td>query that matches toolbar elements</td></tr><tr><td><code>value: Any?</code></td><td>raw value of the element</td></tr><tr><td><code>webViews: XCUIElementQuery</code></td><td>query that matches web view elements</td></tr><tr><td><code>windows: XCUIElementQuery</code></td><td>query that matches window elements</td></tr></tbody></table><p>The following table highlights methods in the <code>XCUIElement</code> class.</p><table><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td><code>children(matching) -&gt; XCUIElementQuery</code></td><td>gets all the child elements of a given type</td></tr><tr><td><code>click()</code></td><td>clicks the element in a macOS app</td></tr><tr><td><code>descendants(matching) -&gt; XCUIElementQuery</code></td><td>gets all the descendant elements of a given type</td></tr><tr><td><code>doubleClick()</code></td><td>double-clicks the element in a macOS app</td></tr><tr><td><code>doubleTap()</code></td><td>double-taps the element in an iOS app</td></tr><tr><td><code>hover()</code></td><td>moves the pointer over the element in an iPad or macOS app</td></tr><tr><td><code>pinch(withScale, velocity)</code></td><td>pinches with two touches</td></tr><tr><td><code>press(forDuration)</code></td><td>long-presses an element in an iOS app</td></tr><tr><td><code>rightClick()</code></td><td>right-clicks the element in a macOS app</td></tr><tr><td><code>rotate(angle, withVelocity)</code></td><td>rotates with two touches</td></tr><tr><td><code>scroll(byDeltaX, deltaY)</code></td><td>scrolls the view in an iPad or macOS app</td></tr><tr><td><code>swipeDown()</code></td><td>swipes down</td></tr><tr><td><code>swipeLeft()</code></td><td>swipes left</td></tr><tr><td><code>swipeRight()</code></td><td>swipes right</td></tr><tr><td><code>swipeUp()</code></td><td>swipes up</td></tr><tr><td><code>tap()</code></td><td>tap the element in an iOS app</td></tr><tr><td><code>typeText(String)</code></td><td>types text into an element that accepts input like a <code>TextField</code>, <code>SecureField</code>, or <code>TextEditor</code></td></tr><tr><td><code>waitForExistence(timeout) -&gt; Bool</code></td><td>waits as long as the timeout and returns a <code>Bool</code> indicating if the element exists</td></tr></tbody></table><p>The following table highlights properties in the <a href="https://developer.apple.com/documentation/xctest/xcuielementquery?v=1.0.20" rel="noopener" target="_blank">XCUIElementQuery</a> class.</p><table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td><code>allElementsBoundByIndex: [XCUIElement]</code></td><td>array of matching elements</td></tr><tr><td><code>count: Int</code></td><td>number of matching elements</td></tr><tr><td><code>element: XCUIElement</code></td><td>the single matching element; test fails if not exactly one</td></tr><tr><td><code>firstMatch: XCUIElement</code></td><td>first matching element</td></tr></tbody></table><p>The following table highlights methods in the <a href="https://developer.apple.com/documentation/xctest/xcuielementquery?v=1.0.20" rel="noopener" target="_blank">XCUIElementQuery</a> class.</p><table><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td><code>element(boundBy: Int) -&gt; XCUIElement</code></td><td>matching element at a given index</td></tr><tr><td><code>subscript(String) -&gt; XCUIElement</code></td><td>returns the descendant element with a given accessibility identifier using <code>[id]</code> syntax</td></tr></tbody></table><h2 id="ui-test-utility-methods" tabindex="-1">UI Test Utility Methods</h2><p>The following utility methods defined in an extension of the <code>XCTestCase</code> class simplify writing tests.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">XCTest</span><br><br><span class="token keyword">extension</span> <span class="token class-name">XCTestCase</span> <span class="token punctuation">{</span><br>    <span class="token comment">// This is static because extensions cannot define stored properties.</span><br>    <span class="token keyword">static</span> <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token class-name">XCUIApplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>    <span class="token comment">// Verifies that a `Button` with a given label exists.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">buttonExists</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> label<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token class-name">XCTAssertTrue</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>buttons<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">.</span>exists<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Enters text in a `SecureField` with a given label.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">enterSecureText</span><span class="token punctuation">(</span>label<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">Self</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>secureTextFields<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token keyword">for</span> char <span class="token keyword">in</span> text <span class="token punctuation">{</span><br>            <span class="token keyword">Self</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>keys<span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token comment">/* Tests fail with this approach.<br>         let field = Self.app.secureTextFields[label]<br>         field.tap()<br>         field.typeText(text)<br>         */</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Enters text in a `TextField` with a given label.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">enterText</span><span class="token punctuation">(</span>label<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">Self</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>textFields<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token keyword">for</span> char <span class="token keyword">in</span> text <span class="token punctuation">{</span><br>            <span class="token keyword">let</span> key <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>keys<span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">]</span><br>            key<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token comment">/* Tests fail with this approach.<br>         let field = Self.app.textFields[label]<br>         field.tap()<br>         field.typeText(text)<br>         */</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Taps a `Button` with a given label.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">tapButton</span><span class="token punctuation">(</span>label<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">Self</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>buttons<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Searches for text anywhere on the screen.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">textExists</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> text<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token class-name">XCTAssertTrue</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>staticTexts<span class="token punctuation">[</span>text<span class="token punctuation">]</span><span class="token punctuation">.</span>exists<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Searches for text in a view with a specific `accessibilityIdentifier`.</span><br>    <span class="token keyword">func</span> <span class="token function-definition function">textExists</span><span class="token punctuation">(</span>identifier<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> actual <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>staticTexts<span class="token punctuation">[</span>identifier<span class="token punctuation">]</span><span class="token punctuation">.</span>label<br>        <span class="token class-name">XCTAssertEqual</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> actual<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="example-ui-test" tabindex="-1">Example UI Test</h2><p>The following code defines a custom <code>View</code>:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">SwiftUI</span><br><br><span class="token keyword">struct</span> <span class="token class-name">Counter</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span><br><br>    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span><br>        <span class="token class-name">HStack</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"+"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> count <span class="token operator">+=</span> <span class="token number">1</span> <span class="token punctuation">}</span><br>            <span class="token comment">// Applying the `accessibilityIdentifier` view modifier</span><br>            <span class="token comment">// to a view makes it easy to find it in a UI test.</span><br>            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">count</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">accessibilityIdentifier</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"count"</span></span><span class="token punctuation">)</span><br>            <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"-"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> count <span class="token operator">+=</span> <span class="token number">1</span> <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The following code defines UI tests for the <code>View</code> defined above:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">XCTest</span><br><br><span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">CounterTests</span><span class="token punctuation">:</span> <span class="token class-name">XCTestCase</span> <span class="token punctuation">{</span><br>    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">setUpWithError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Put setup code here. This method is called before</span><br>        <span class="token comment">// the invocation of each test method in the class.</span><br><br>        <span class="token comment">// In UI tests it is usually best to</span><br>        <span class="token comment">// stop immediately when a failure occurs.</span><br>        continueAfterFailure <span class="token operator">=</span> <span class="token boolean">false</span><br><br>        <span class="token comment">// In UI tests it’s important to set the initial state, such as</span><br>        <span class="token comment">// interface orientation, that is required for before your tests run.</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">override</span> <span class="token keyword">func</span> <span class="token function-definition function">tearDownWithError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Put teardown code here. This method is called after</span><br>        <span class="token comment">// the invocation of each test method in the class.</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">func</span> <span class="token function-definition function">testIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token punctuation">{</span><br>        <span class="token comment">// UI tests must launch the application that they test.</span><br>        <span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token class-name">XCUIApplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        app<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>        <span class="token function">tapButton</span><span class="token punctuation">(</span>label<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"+"</span></span><span class="token punctuation">)</span><br>        <span class="token function">tapButton</span><span class="token punctuation">(</span>label<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"+"</span></span><span class="token punctuation">)</span><br>        <span class="token comment">// "count" is the accessibility identifier that</span><br>        <span class="token comment">// was associated with the `Text` view that</span><br>        <span class="token comment">// holds the count in the `Counter` view above.</span><br>        <span class="token comment">// This approach is less brittle than relying on other properties</span><br>        <span class="token comment">// of a view that might change such as the label of a `Button`.</span><br>        <span class="token keyword">try</span> <span class="token function">textExists</span><span class="token punctuation">(</span>identifier<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"count"</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"2"</span></span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>In the <code>setUpWithError</code> method of test files, add the following:</p><pre class="language-swift"><code class="language-swift"><span class="token class-name">XCTestCase</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="screen-navigation" tabindex="-1">Screen Navigation</h2><p>When implementing test methods that need to navigate to a common set of screens, consider implementing a separate function that navigates to each screen and call those from tests that require the navigation. This avoids repeating the navigation code and makes it easier to update if the screen hierarchy changes.</p><p>These navigation functions can call each other. For example, if the app begins at screen A, and the user must navigate to screen B, then screen C, then screen D, the following functions can be written:</p><ul><li><code>goToB</code>: navigates from A to B</li><li><code>goToC</code>: navigates from A to C by first calling <code>goToB</code></li><li><code>goToD</code>: navigates from A to D by first calling <code>goToC</code></li></ul><h2 id="running-tests-in-xcode" tabindex="-1">Running Tests in Xcode</h2><ol><li>To run a single test method, click the diamond where the line number of the first line of the method would normally appear. If the diamonds don't appear, click a different source file and they click back on the test file.</li><li>To run all the test methods in the file, click the diamond where the line number of the first line of the class would normally appear.</li><li>To run all the tests in Project Navigator folder, click the diamond to the right of the folder name.</li><li>To run all the tests, select Product ... Test or press cmd-u.</li></ol><p>In UI tests, the on-screen keyboard doesn't always appear. If it doesn't, tests that require typing in text fields will fail. To fix this, go the Simulator app, select I/O ... Keyboard, and unselect &quot;Connect Hardware Keyboard&quot;.</p><h2 id="viewing-test-results" tabindex="-1">Viewing Test Results</h2><p>To see a report on test results:</p><ol><li>Click the &quot;Show Report Navigator&quot; button, which is the last button at the top of the Project Navigator, and then click a test run with a specific time.</li><li>In the editor panel where test results are displayed, click a category of test results to view which include &quot;All&quot;, &quot;Passed&quot;, &quot;Failed&quot;, &quot;Skipped&quot;, &quot;Expected Failures&quot;, and &quot;Mixed&quot;.</li></ol><h2 id="code-coverage" tabindex="-1">Code Coverage</h2><p>To enable collecting code coverage data:</p><ol><li>Click the target dropdown at the top of Xcode.</li><li>Select &quot;Edit Scheme...&quot;.</li><li>Select &quot;Test&quot; in the left nav.</li><li>Click the &quot;Options&quot; tab.</li><li>Check the &quot;Gather coverage for&quot; checkbox.</li><li>Select &quot;some targets&quot; in the dropdown to the right of this checkbox.</li><li>Click the &quot;+&quot; button to select a target.</li><li>Select the target of the main app.</li><li>Click the &quot;Close&quot; button.</li><li>Run all the tests again.</li><li>View the test results as described above.</li><li>Click &quot;Coverage&quot; under the new test run.</li><li>Expand the test folder displayed to see the coverage percentage of each source file.</li></ol><h2 id="ui-view-testing" tabindex="-1">UI View Testing</h2><p>In a test method, to wait for a specific view to be created:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">let</span> viewExists <span class="token operator">=</span> someView<span class="token punctuation">.</span><span class="token function">waitForExistence</span><span class="token punctuation">(</span>timeout<span class="token punctuation">:</span> seconds<span class="token punctuation">)</span><br><span class="token class-name">XCTAssertTrue</span><span class="token punctuation">(</span>viewExists<span class="token punctuation">)</span></code></pre><p>To generate test code by recording user interactions:</p><ol><li>Click inside a test function where code should be inserted.</li><li>Click the red &quot;record&quot; circle at the bottom of the editor pane of the test source file.</li><li>Wait for the app to begin running in the Simulator.</li><li>Interact with the UI to navigation to the point within the app where assertions should be made. This includes tapping text fields to move focus into them, typing text, tapping buttons, and selecting items from pickers.</li><li>Optionally manually improve the generated test code.</li><li>Add assertions about what should be in the UI.</li></ol><h2 id="run-from-command-line" tabindex="-1">Run from Command Line</h2><p>See <a href="https://www.appsdeveloperblog.com/run-xcode-unit-tests-from-the-command-line/?v=1.0.20" rel="noopener" target="_blank">Run Xcode Unit Tests From The Command Line</a>.</p><p>To enable this, enter <code>sudo xcode-select -s /Applications/Xcode.app/Contents/Developer</code></p><p>Start the Simulator app. Will the tests fail without this? To toggle between light and dark mode, select Features ... Toggle Appearance.</p><p><code>cd</code> to a directory containing a <code>.xcodeproj</code> file.</p><p>To get lists of targets, build configurations, and schemes defined in an Xcode project, enter <code>xcodebuild -list</code></p><p>To get a list of available devices supported by the simulator, enter <code>xcrun simctl list devices</code></p><p>To build and run all the XCTests, enter an <code>xcodebuild</code> command similar to the the following:</p><pre class="language-bash"><code class="language-bash">xcodebuild <span class="token punctuation">\</span><br>  <span class="token parameter variable">-scheme</span> MyApp <span class="token punctuation">\</span><br>  <span class="token parameter variable">-destination</span> <span class="token string">'name=iPhone 13'</span><br>  <span class="token parameter variable">-enableCodeCoverage</span> YES <span class="token punctuation">\</span><br>  clean <span class="token builtin class-name">test</span></code></pre><p>Add <code>-quiet</code> to reduce the output and only show errors.</p><p>If</p><h2 id="github-actions" tabindex="-1">GitHub Actions</h2><p>See <a href="https://vmois.dev/xcode-github-actions/?v=1.0.20" rel="noopener" target="_blank">How to use GitHub Actions for testing Xcode project</a>.</p></article>