<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>AppInfo</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#appinfo-struct">AppInfo struct</a></li><li><a href="#creating-instance">Creating Instance</a></li><li><a href="#link-to-help">Link to Help</a></li><li><a href="#link-to-app-store">Link to App Store</a></li></ol></nav></aside><article><h2 id="overview" tabindex="-1">Overview</h2><p>It is possible to determine a lot of information about an app from its bundle and from the App Store (for released apps).</p><h2 id="appinfo-struct" tabindex="-1">AppInfo struct</h2><p>The following code gathers information about an app and makes it available through computed properties.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">import</span> <span class="token class-name">Foundation</span><br><br><span class="token keyword">struct</span> <span class="token class-name">AppInfo</span> <span class="token punctuation">{</span><br>    <span class="token keyword">static</span> <span class="token keyword">let</span> infoDict <span class="token operator">=</span> <span class="token class-name">Bundle</span><span class="token punctuation">.</span>main<span class="token punctuation">.</span>infoDictionary<span class="token operator">!</span><br><br>    <span class="token keyword">var</span> json<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">init</span><span class="token punctuation">(</span>json<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">self</span><span class="token punctuation">.</span>json <span class="token operator">=</span> json<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token function-definition function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token keyword">throws</span> <span class="token operator">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> urlPrefix <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"https://itunes.apple.com/lookup?bundleId="</span></span><br>        <span class="token keyword">let</span> identifier <span class="token operator">=</span> infoDict<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"CFBundleIdentifier"</span></span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">String</span> <span class="token operator">??</span> <span class="token string-literal"><span class="token string">""</span></span><br>        <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">URL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">urlPrefix</span><span class="token interpolation-punctuation punctuation">)</span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation">identifier</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><span class="token punctuation">)</span><br>        <span class="token keyword">guard</span> <span class="token keyword">let</span> url <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            <span class="token keyword">throw</span> <span class="token string-literal"><span class="token string">"AppStoreService: bad URL </span><span class="token interpolation-punctuation punctuation">\(</span><span class="token interpolation"><span class="token class-name">String</span><span class="token punctuation">(</span>describing<span class="token punctuation">:</span> url<span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">"</span></span><br>        <span class="token punctuation">}</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"url ="</span></span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><br><br>        <span class="token comment">// Using the ephemeral configuration avoids caching.</span><br>        <span class="token keyword">let</span> session <span class="token operator">=</span> <span class="token class-name">URLSession</span><span class="token punctuation">(</span>configuration<span class="token punctuation">:</span> <span class="token punctuation">.</span>ephemeral<span class="token punctuation">)</span><br>        <span class="token keyword">let</span> <span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token omit keyword">_</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token keyword">await</span> session<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> url<span class="token punctuation">)</span><br>        <span class="token keyword">guard</span> <span class="token keyword">let</span> json <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token class-name">JSONSerialization</span><span class="token punctuation">.</span><span class="token function">jsonObject</span><span class="token punctuation">(</span><br>            with<span class="token punctuation">:</span> data<span class="token punctuation">,</span><br>            options<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>allowFragments<span class="token punctuation">]</span><br>        <span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            <span class="token keyword">throw</span> <span class="token string-literal"><span class="token string">"AppStoreService: bad JSON"</span></span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">guard</span> <span class="token keyword">let</span> results <span class="token operator">=</span><br>            <span class="token punctuation">(</span>json<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">"results"</span></span><span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token keyword">Any</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>first <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token keyword">Any</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            <span class="token keyword">throw</span> <span class="token string-literal"><span class="token string">"AppStoreService: JSON missing results"</span></span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">return</span> <span class="token keyword">Self</span><span class="token punctuation">(</span>json<span class="token punctuation">:</span> results<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">date</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> key<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Date</span> <span class="token punctuation">{</span><br>        json<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">Date</span> <span class="token operator">??</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">double</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> key<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Double</span> <span class="token punctuation">{</span><br>        json<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">Double</span> <span class="token operator">??</span> <span class="token number">1.2</span> <span class="token comment">// 0</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">info</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> key<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">String</span> <span class="token punctuation">{</span><br>        <span class="token keyword">Self</span><span class="token punctuation">.</span>infoDict<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">String</span> <span class="token operator">??</span> <span class="token string-literal"><span class="token string">""</span></span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">int</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> key<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Int</span> <span class="token punctuation">{</span><br>        json<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">Int</span> <span class="token operator">??</span> <span class="token number">0</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">private</span> <span class="token keyword">func</span> <span class="token function-definition function">string</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> key<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">String</span> <span class="token punctuation">{</span><br>        json<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">String</span> <span class="token operator">??</span> <span class="token string-literal"><span class="token string">""</span></span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> appId<span class="token punctuation">:</span> <span class="token class-name">Int</span> <span class="token punctuation">{</span> <span class="token function">int</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"trackId"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> appURL<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"trackViewUrl"</span></span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string-literal"><span class="token string">"&amp;country=US"</span></span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> author<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"sellerName"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> bundleId<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"bundleId"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> description<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"description"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> supportURL<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"sellerUrl"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> haveLatestVersion<span class="token punctuation">:</span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> order <span class="token operator">=</span> storeVersion<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>installedVersion<span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">.</span>numeric<span class="token punctuation">)</span><br>        <span class="token keyword">return</span> order <span class="token operator">!=</span> <span class="token punctuation">.</span>orderedDescending<br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">var</span> installedVersion<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"CFBundleShortVersionString"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> identifier<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"CFBundleIdentifier"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> minimumOsVersion<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"minimumOsVersion"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"trackName"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token comment">// "Promotional Text" is not present in the App Store JSON.</span><br>    <span class="token keyword">var</span> price<span class="token punctuation">:</span> <span class="token class-name">Double</span> <span class="token punctuation">{</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"price"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> releaseDate<span class="token punctuation">:</span> <span class="token class-name">Date</span> <span class="token punctuation">{</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"currentVersionReleaseDate"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> releaseNotes<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"releaseNotes"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token keyword">var</span> storeVersion<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"version"</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="creating-instance" tabindex="-1">Creating Instance</h2><p>The following code gets an instance of <code>AppInfo</code> in a SwiftUI view:</p><pre class="language-swift"><code class="language-swift"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> appInfo<span class="token punctuation">:</span> <span class="token class-name">AppInfo</span><span class="token operator">?</span><br><br><span class="token operator">...</span><br><br><span class="token punctuation">.</span>task <span class="token punctuation">{</span><br>    <span class="token keyword">do</span> <span class="token punctuation">{</span><br>        appInfo <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token keyword">await</span> <span class="token class-name">AppInfo</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span><br>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Error getting AppInfo:"</span></span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="link-to-help" tabindex="-1">Link to Help</h2><p>The following code uses <code>AppInfo</code> to add a help button to the navigation bar. Tapping this opens the app support page in Safari.</p><pre class="language-swift"><code class="language-swift"><span class="token punctuation">.</span>toolbar <span class="token punctuation">{</span><br>    <span class="token class-name">ToolbarItem</span><span class="token punctuation">(</span>placement<span class="token punctuation">:</span> <span class="token punctuation">.</span>navigationBarTrailing<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token keyword">let</span> appInfo <span class="token punctuation">{</span><br>            <span class="token class-name">Link</span><span class="token punctuation">(</span>destination<span class="token punctuation">:</span> <span class="token function">URL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> appInfo<span class="token punctuation">.</span>supportURL<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Image</span><span class="token punctuation">(</span>systemName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">"questionmark.circle"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="link-to-app-store" tabindex="-1">Link to App Store</h2><p>The following code uses <code>AppInfo</code> to inform users when a newer version of the app is available in App Store and provides a link that directs them to the App Store so it can be installed.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">if</span> <span class="token keyword">let</span> appInfo<span class="token punctuation">,</span><br>    <span class="token operator">!</span>appInfo<span class="token punctuation">.</span>haveLatestVersion<span class="token punctuation">,</span><br>    <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">URL</span><span class="token punctuation">(</span>string<span class="token punctuation">:</span> appInfo<span class="token punctuation">.</span>appURL<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token class-name">Link</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Update Available"</span></span><span class="token punctuation">,</span> destination<span class="token punctuation">:</span> url<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre></article>