<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Web Components</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#basic-example">Basic Example</a></li><li><a href="#custom-elements">Custom Elements</a></li><li><a href="#shadow-dom">Shadow DOM</a></li><li><a href="#es-modules">ES Modules</a></li><li><a href="#html-template">HTML Template</a></li></ol></nav></aside><article><style>img {
    border: 1px solid gray;
  }</style><figure style="width: 30%"><img alt="Web Components logo" style="border: 0" src="/blog/assets/web-components-logo.svg?v=1.1.1"></figure><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://www.webcomponents.org/introduction?v=1.1.1" rel="noopener" target="_blank">Web components</a> &quot;are a set of web platform APIs that allow you to create new custom, reusable, encapsulated HTML tags to use in web pages and web apps.&quot;</p><p>Web components encapsulate their markup, styles, and functionality by using a &quot;shadow DOM&quot;.</p><p>Implementing a web component requires a bit more effort than implementing components using a framework like Svelte. The extra effort is worthwhile for components that will be used in multiple apps written using multiple frameworks. Even if you are only using one web framework today, that may change in the future. The investment in creating high quality, reusable web components will pay off in the long run.</p><p>Implementing a reusable library of UI components that can only be used in web applications that are implemented with a specific framework is not a good time investment. It is much better to implement them as web components so they can be used in all web applications, regardless of the web framework they use. The <a href="/blog/topics/#/blog/shoelace?v=1.1.1" rel="noopener" target="_blank">Shoelace</a> library of web components is a great example.</p><p>While you could implement every UI component of a web app as a web component, that is a bit harder than using other web framework like Svelte. Consider only implementing web components for general purpose UI components that will be used in multiple apps.</p><h2 id="basic-example" tabindex="-1">Basic Example</h2><p>The following file <code>src/greet-message.js</code> defines a web component.</p><pre class="language-js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">GreetMessage</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span><br>  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'name is a required attribute'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    div<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'purple'</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// The "mode" option is required and the recommended value is "open".</span><br>    <span class="token comment">// When set to "open", `this.shadowRoot` is set.</span><br>    <span class="token comment">// When set to "closed", it is not.</span><br>    <span class="token keyword">const</span> shadow <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    shadow<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Using shadow DOM is not required.  We can replace</span><br>    <span class="token comment">// the previous two lines with the following.</span><br>    <span class="token comment">// this.appendChild(div);</span><br><br>    <span class="token comment">// Yet another way this could be implemented ...</span><br>    <span class="token comment">/*<br>    this.attachShadow({mode: 'open'});<br>    this.shadowRoot.innerHTML = `<br>      &lt;div style="color: purple;">Hello, ${name}!&lt;/div><br>    `;<br>    */</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'greet-message'</span><span class="token punctuation">,</span> GreetMessage<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>The value of <code>this.shadowRoot</code>, when set, is a <a href="https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot?v=1.1.1" rel="noopener" target="_blank">ShadowRoot</a> object. This can be accessed in other lifecycle methods such as <code>connectedCallback</code>. One use is to register listeners for <code>slotchange</code> events.</p><p>The following HTML renders an instance of the web component defined above.</p><pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Web Components Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/src/greet-message.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>greet-message</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>World<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>greet-message3</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="custom-elements" tabindex="-1">Custom Elements</h2><p><a href="https://html.spec.whatwg.org/multipage/custom-elements.html?v=1.1.1" rel="noopener" target="_blank">Custom Elements</a> provide a way to define and use custom HTML elements.</p><p>The names of custom elements must be all lowercase and contain at least one hyphen. This avoids name conflicts with standard HTML elements.</p><h2 id="shadow-dom" tabindex="-1">Shadow DOM</h2><p>The <a href="https://dom.spec.whatwg.org/#interface-shadowroot?v=1.1.1" rel="noopener" target="_blank">Shadow DOM</a> provides a way to encapsulate the content and styling of a custom element.</p><p>Many standard HTML elements utilize a shadow DOM. Examples include <code>input</code>, <code>audio</code>, <code>video</code>, and <code>detail</code>. This can be seen by examining such elements in the &quot;Elements&quot; tab of the Chrome DevTools. Click the settings gear icon, scroll to the &quot;Elements&quot; section, and check &quot;Show user agent shadow DOM&quot;.</p><h2 id="es-modules" tabindex="-1">ES Modules</h2><p><a href="https://html.spec.whatwg.org/multipage/webappapis.html#integration-with-the-javascript-module-system?v=1.1.1" rel="noopener" target="_blank">ES Modules</a> define the mechanisms for exporting and importing JavaScript modules.</p><h2 id="html-template" tabindex="-1">HTML Template</h2><p>The HTML <a href="https://html.spec.whatwg.org/multipage/scripting.html#the-template-element?v=1.1.1" rel="noopener" target="_blank">template element</a> provides a way to define an HTML fragment that can be cloned and inserted multiple times into a DOM tree.</p><p><code>template</code> elements have their CSS <code>display</code> property set to <code>none</code> so their content is not rendered.</p><p>Templates can contain slots that are used to insert content. Each template can contain one unnamed slot and any number of named slots. This is primarily useful when <code>template</code> elements are cloned by web components.</p><p>The following code demonstrates using the <code>template</code> element inside a web component. This approach has the advantage that the content of a web component can be described with HTML instead of using DOM methods like <code>createElement</code> and <code>appendChild</code>. However, it has the disadvantage that the web component definition must assume that a <code>template</code> with a given <code>id</code> has been defined outside it.</p><p>HTML does not define a mechanism for including one HTML file into another. So we can't define templates in a separate file that is included.</p><p><img alt="Web Components and templates" style="width: 40%" src="/blog/assets/web-component-templates.png?v=1.1.1"></p><pre class="language-js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span><br><span class="token operator">&lt;</span>html<span class="token operator">></span><br>  <span class="token operator">&lt;</span>head<span class="token operator">></span><br>    <span class="token operator">&lt;</span>title<span class="token operator">></span>Template Demo<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span><br>    <span class="token operator">&lt;</span>script<span class="token operator">></span><br>      window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token comment">// The class name is not required to match the custom element name.</span><br>        <span class="token keyword">class</span> <span class="token class-name">Card</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span><br>          <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">const</span> shadowRoot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'open'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">const</span> template <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'card'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token comment">// Passing true creates a deep clone.</span><br>            shadowRoot<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>template<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'my-card'</span><span class="token punctuation">,</span> Card<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><br>  <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><br>  <span class="token operator">&lt;</span>body<span class="token operator">></span><br>    <span class="token operator">&lt;</span>h1<span class="token operator">></span>Template Demo<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><br><br>    <span class="token operator">&lt;</span>template id<span class="token operator">=</span><span class="token string">"card"</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> This styling is only scoped when the<br>           template is used <span class="token keyword">in</span> a web component<span class="token punctuation">.</span> <span class="token operator">--</span><span class="token operator">></span><br>      <span class="token operator">&lt;</span>style<span class="token operator">></span><br>        <span class="token punctuation">.</span>card <span class="token punctuation">{</span><br>          <span class="token literal-property property">display</span><span class="token operator">:</span> inline<span class="token operator">-</span>block<span class="token punctuation">;</span><br>          background<span class="token operator">-</span>color<span class="token operator">:</span> cornflowerblue<span class="token punctuation">;</span><br>          <span class="token literal-property property">border</span><span class="token operator">:</span> 3px solid blue<span class="token punctuation">;</span><br>          border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">.</span>5rem<span class="token punctuation">;</span><br>          <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">.</span>5rem<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        h2 <span class="token punctuation">{</span><br>          <span class="token literal-property property">color</span><span class="token operator">:</span> orange<span class="token punctuation">;</span><br>          margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span><br>      <span class="token operator">&lt;</span>section <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"card"</span><span class="token operator">></span><br>        <span class="token operator">&lt;</span>h2<span class="token operator">></span><span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">"title"</span><span class="token operator">></span>Untitled<span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">></span><br>        <span class="token operator">&lt;</span>h3<span class="token operator">></span><span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">"header"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">></span><br>        <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">"body"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><br>        <span class="token operator">&lt;</span>h3<span class="token operator">></span><span class="token operator">&lt;</span>slot name<span class="token operator">=</span><span class="token string">"footer"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">></span><br>      <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><br><br>    <span class="token operator">&lt;</span>my<span class="token operator">-</span>card<span class="token operator">></span><br>      <span class="token operator">&lt;</span>span slot<span class="token operator">=</span><span class="token string">"title"</span><span class="token operator">></span>Title #<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><br>      <span class="token operator">&lt;</span>span slot<span class="token operator">=</span><span class="token string">"header"</span><span class="token operator">></span>header #<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><br>      <span class="token operator">&lt;</span>span slot<span class="token operator">=</span><span class="token string">"body"</span><span class="token operator">></span>body #<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><br>      <span class="token operator">&lt;</span>span slot<span class="token operator">=</span><span class="token string">"footer"</span><span class="token operator">></span>footer #<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>card<span class="token operator">></span><br><br>    <span class="token operator">&lt;</span>my<span class="token operator">-</span>card<span class="token operator">></span><br>      <span class="token operator">&lt;</span>span slot<span class="token operator">=</span><span class="token string">"title"</span><span class="token operator">></span>Title #<span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><br>      <span class="token operator">&lt;</span>span slot<span class="token operator">=</span><span class="token string">"body"</span><span class="token operator">></span>body #<span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><br>    <span class="token operator">&lt;</span><span class="token operator">/</span>my<span class="token operator">-</span>card<span class="token operator">></span><br>  <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><br><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></code></pre></article>