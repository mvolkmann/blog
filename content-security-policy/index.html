<link rel="preload" as="style" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/prism-a11y.css"><link rel="stylesheet" href="/blog/assets/topic.css"><script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><h2>Content Security Policy (CSP)</h2><aside><nav class="toc"><ol><li><a href="#overview">Overview</a></li><li><a href="#directives">Directives</a></li><li><a href="#example-header-values">Example Header Values</a></li><li><a href="#reporting">Reporting</a></li><li><a href="#example">Example</a></li><li><a href="#questions">Questions</a></li></ol></nav></aside><article><style>img {
    border: 1px solid gray;
  }</style><h2 id="overview" tabindex="-1">Overview</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" target="_blank">Content Security Policy</a> provides the ability to detect and prevent some types of attacks, including Cross-Site Scripting (XSS) and data injection. It can also report attack attempts.</p><p>There are two ways to enable CSP.</p><ol><li>&quot;Content-Security-Policy&quot; HTTP response header</li><li>HTML <code>meta</code> tag</li></ol><p>It both cases, the policy is specified by a list of directives separated by semicolons. Each directive is specified with a name and one or more values, all separated by a space. The values are allowed URL patterns or the keyword &quot;self&quot;.</p><p>The following <code>meta</code> tag is an example.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span><br>  <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span><br>  <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src 'self'; img-src https://*; script-src 'none';<span class="token punctuation">"</span></span><br><span class="token punctuation">/></span></span></code></pre><p>Some features can only be enabled in an HTTP header. Which?</p><p>can only execute scripts downloaded from approved domains using approved protocols (ex. HTTPS)</p><h2 id="directives" tabindex="-1">Directives</h2><p>Commonly used directives include:</p><ul><li><code>default-src</code>: restricts access to all kinds of resources</li><li><code>connect-src</code>: restricts use of <a>, fetch, XMLHttpRequest, WebSocket, and more</a></li><li><code>font-src</code>: restricts @font-face CSS at-rule</li><li><code>form-action</code>: restricts URLs used in <code>form</code> element <code>action</code> attributes</li><li><code>img-src</code>: restricts <code>&lt;img&gt;</code> elements</li><li><code>media-src</code>: restricts <code>&lt;audio&gt;</code> and <code>&lt;video&gt;</code> elements</li><li><code>object-src</code>: restricts <code>&lt;object&gt;</code> and <code>&lt;embed&gt;</code> elements</li><li><code>report-to</code>: specifies the URL where violation reports are sent</li><li><code>script-src-attr</code>: restricts sources for JavaScript inline event handlers like <code>onclick</code></li><li><code>script-src-elem</code>: restricts <code>&lt;script&gt;</code> elements</li><li><code>script-src</code>: combines the previous two in one directive</li><li><code>worker-src</code>: restricts Worker, SharedWorker, and ServiceWorker scripts</li></ul><p>It is recommended to make <code>default-src</code> very restrictive (maybe just &quot;self&quot;) and used more specific directives to open access for specific kinds of resources.</p><p>See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" target="_blank">Content Security Policy</a> for a table of CSP directives that are supported by each browser.</p><h2 id="example-header-values" tabindex="-1">Example Header Values</h2><ul><li><p><code>Content-Security-Policy: default-src 'self' demo.com *.demo.com</code></p><p>This specifies that by default all resources must come from the same domain ss this request OR from <code>demo.com</code> or any domain that ends in <code>demo.com</code>.</p></li><li><p><code>Content-Security-Policy: default-src 'self'; img-src *; media-src my-media.org; script-src https://coder.io</code></p><p>This specifies that images can come from anywhere, audio and video can come from <code>my-media.org</code>, scripts can come from <code>coder.io</code> only using HTTPS, and all other resources must come from the same domain as this request. <code>default-src</code> specifies the policy for all resource types unless policies for specific resource types are also provided.</p></li></ul><h2 id="reporting" tabindex="-1">Reporting</h2><p>To report attempts to violate the CSP but not prevent them, use the <code>Content-Security-Policy-Report-Only</code> header. It seems odd to want only report these attempts.</p><p>Specify the <code>Content-Security-Policy</code> AND <code>Content-Security-Policy-Report</code> headers to both prevent violations and report attempted violations. The policies specified in each can be the same or they can differ.</p><p>Include the <code>report-to: {url}</code> directive in the <code>Content-Security-Policy-Report</code> header to indicate where POST requests including violation details should be sent. This must be specified in an HTTP response header, not in a <code>meta</code> tag.</p><p>The report is a JSON object with many properties including:</p><ul><li><code>blocked-uri</code> gives the URI that violated a policy.</li><li><code>disposition</code> will be &quot;enforce&quot; or &quot;report&quot;.</li><li><code>document-uri</code> gives the URI of the document that requested the resource.</li><li><code>effective-directive</code> gives the directive that was violated.</li><li><code>script-sample</code> gives the first 40 characters of violating script or CSS.</li></ul><p>The following is an example report that describes an issue with getting an image from Unsplash. Note the properties &quot;effective-directive&quot; and &quot;blocked-uri&quot;.</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"csp-report"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"document-uri"</span><span class="token operator">:</span> <span class="token string">"http://localhost:3000/"</span><span class="token punctuation">,</span><br>    <span class="token property">"referrer"</span><span class="token operator">:</span> <span class="token string">"http://localhost:3000/"</span><span class="token punctuation">,</span><br>    <span class="token property">"violated-directive"</span><span class="token operator">:</span> <span class="token string">"img-src"</span><span class="token punctuation">,</span><br>    <span class="token property">"effective-directive"</span><span class="token operator">:</span> <span class="token string">"img-src"</span><span class="token punctuation">,</span><br>    <span class="token property">"original-policy"</span><span class="token operator">:</span> <span class="token string">"default-src 'self'; connect-src 'self' https://jsonplaceholder.typicode.com ws:; font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com; media-src 'self' http://commondatastorage.googleapis.com; script-src-elem 'self' https://unpkg.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; report-uri /csp-report"</span><span class="token punctuation">,</span><br>    <span class="token property">"disposition"</span><span class="token operator">:</span> <span class="token string">"report"</span><span class="token punctuation">,</span><br>    <span class="token property">"blocked-uri"</span><span class="token operator">:</span> <span class="token string">"https://images.unsplash.com/photo-1629985692757-48648f4f1fc1"</span><span class="token punctuation">,</span><br>    <span class="token property">"line-number"</span><span class="token operator">:</span> <span class="token number">55</span><span class="token punctuation">,</span><br>    <span class="token property">"source-file"</span><span class="token operator">:</span> <span class="token string">"http://localhost:3000/"</span><span class="token punctuation">,</span><br>    <span class="token property">"status-code"</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span><br>    <span class="token property">"script-sample"</span><span class="token operator">:</span> <span class="token string">""</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h2 id="example" tabindex="-1">Example</h2><p>The following code implements an HTTP server using the JavaScript-based <a href="https://hono.dev" target="_blank">Hono</a> library.</p><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token keyword">type</span> <span class="token class-name">Context</span><span class="token punctuation">,</span> Hono<span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">Next</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span>serveStatic<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'hono/bun'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token string">'./reload-server.js'</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> policies <span class="token operator">=</span> <span class="token punctuation">[</span><br>  <span class="token comment">// Only resources from the current domain are allowed</span><br>  <span class="token comment">// unless overridden by a more specific directive.</span><br>  <span class="token string">"default-src 'self'"</span><span class="token punctuation">,</span><br><br>  <span class="token comment">// This allows sending HTTP requests to the JSONPlaceholder API.</span><br>  <span class="token comment">// It also allows reload-client.js to create a WebSocket.</span><br>  <span class="token string">"connect-src 'self' https://jsonplaceholder.typicode.com ws:"</span><span class="token punctuation">,</span><br><br>  <span class="token comment">// This allows getting Google fonts.</span><br>  <span class="token comment">// "link" tags for Google fonts have an href</span><br>  <span class="token comment">// that begins with https://fonts.googleapis.com.</span><br>  <span class="token comment">// The linked font file contains @font-face CSS rules</span><br>  <span class="token comment">// with a src URL beginning with https://fonts.gstatic.com.</span><br>  <span class="token string">"font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com"</span><span class="token punctuation">,</span><br><br>  <span class="token comment">// This allows getting images from Unsplash.</span><br>  <span class="token string">"img-src 'self' https://images.unsplash.com"</span><span class="token punctuation">,</span><br><br>  <span class="token comment">// This allows getting videos from googleapis.</span><br>  <span class="token string">"media-src 'self' http://commondatastorage.googleapis.com"</span><span class="token punctuation">,</span><br><br>  <span class="token comment">// This allows downloading the htmx library from a CDN.</span><br>  <span class="token string">"script-src-elem 'self' https://unpkg.com"</span><span class="token punctuation">,</span><br><br>  <span class="token comment">// This allows htmx.min.js to insert style elements.</span><br>  <span class="token string">"style-src 'self' 'unsafe-inline' https://fonts.googleapis.com"</span><br><span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> csp <span class="token operator">=</span> policies<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'; '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server.tsx: csp ='</span><span class="token punctuation">,</span> csp<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Serve static files from the public directory.</span><br><span class="token comment">// app.use('/*', serveStatic({root: './public'}));</span><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">,</span> next<span class="token operator">:</span> Next<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  c<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Content-Security-Policy'</span><span class="token punctuation">,</span> csp<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><br>    <span class="token string">'Content-Security-Policy-Report-Only'</span><span class="token punctuation">,</span><br>    csp <span class="token operator">+</span> <span class="token string">'; report-uri /csp-report'</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token function">serveStatic</span><span class="token punctuation">(</span><span class="token punctuation">{</span>root<span class="token operator">:</span> <span class="token string">'./public'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/version'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">// Return a Response whose body contains</span><br>  <span class="token comment">// the version of Bun running on the server.</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'v'</span> <span class="token operator">+</span> Bun<span class="token punctuation">.</span>version<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This receives reports of CSP violations in a JSON object.</span><br>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/csp-report'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token operator">:</span> Context<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> report <span class="token operator">=</span> <span class="token keyword">await</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>report<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  c<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'CSP violation'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> app<span class="token punctuation">;</span></code></pre><p>The following HTML file in <code>public/index.html</code> relies on the CSP defined in the server to access several resources.</p><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>CSP Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br><br>    <span class="token comment">&lt;!-- This loads a Google font. --></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><br>      <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><br>      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://fonts.googleapis.com/css?family=Kode+Mono<span class="token punctuation">"</span></span><br>    <span class="token punctuation">/></span></span><br><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>styles.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br><br>    <span class="token comment">&lt;!-- This loads the htmx library from a CDN. --></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><br>      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/htmx.org@1.9.10<span class="token punctuation">"</span></span><br>      <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5xLSi8nO7UC<span class="token punctuation">"</span></span><br>      <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span><br>    <span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>    <span class="token comment">&lt;!-- We could get the htmx library from<br>         a local copy instead of from a CDN. --></span><br>    <span class="token comment">&lt;!-- &lt;script src="htmx.min.js">&lt;/script> --></span><br><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>reload-client.js<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>This demonstrates the Google font "Kode Mono".<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><br><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span><br>      <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Grand Prismatic Spring<span class="token punctuation">"</span></span><br>      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://images.unsplash.com/photo-1629985692757-48648f4f1fc1<span class="token punctuation">"</span></span><br>      <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span><br>    <span class="token punctuation">/></span></span><br><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span><br>      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4<span class="token punctuation">"</span></span><br>      <span class="token attr-name">controls</span><br>      <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span><br>    <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span><br><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><br>      <span class="token comment">&lt;!-- When this button is clicked,<br>           an HTTP GET request is sent to /version.<br>           The text it returns replaces the innerHTML<br>           of the element with id "version". --></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">hx-get</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/version<span class="token punctuation">"</span></span> <span class="token attr-name">hx-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#version<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Get Bun Version<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>version<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br><br>    <span class="token comment">&lt;!-- This should require the form-action CSP directive, but it doesn't. --></span><br>    <span class="token comment">&lt;!-- &lt;form method="post" action="https://jsonplaceholder.typicode.com/todos"> --></span><br><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><br>      <span class="token attr-name">hx-post</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://jsonplaceholder.typicode.com/todos<span class="token punctuation">"</span></span><br>      <span class="token attr-name">hx-target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#todo<span class="token punctuation">"</span></span><br>    <span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span>Title:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span>Body:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>body<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>Submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>todo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="questions" tabindex="-1">Questions</h2><p>Does using a CSP remove the need to sanitize HTML?</p><p>In &quot;stored cross-site scripting&quot;, script tags entered in text input get stored in databases and later displayed on pages. They are not executed if they are used as <code>textContent</code>, but are if they are used as <code>innerHTML</code>.</p><p>There are other types of cross-site scripting attacks. What are they?</p></article>